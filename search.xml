<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>æ­å»ºæœåŠ¡å™¨äº²è‡ªä½“éªŒè·¨åŸŸ</title>
    <url>/2019/01/18/COR/</url>
    <content><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>è·¨åŸŸè¿™ä¸¤ä¸ªå­—å°±åƒç‹—çš®è†è¯ä¸€æ ·å„¿ç²˜åœ¨æ¯ä¸€ä¸ªå‰ç«¯erèº«ä¸Š æˆ‘é‡è§äº†å¾ˆå¤šå¼€å‘è€…ä¸€èˆ¬éƒ½æ˜¯ä¸ºäº†åº”ä»˜é¢è¯• éšä¾¿èƒŒå‡ ä¸ªæ–¹æ¡ˆ çŸ¥é“æ¦‚å¿µ ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå¹²<br>åˆ°äº†çœŸæ­£çš„å·¥ä½œ å¼€å‘ç¯å¢ƒæœ‰ <code>webpack-dev-server</code>æå®š çº¿ä¸Šæœ‰è¿ç»´å¤§å“¥ä¼šé…å¥½ï¼Œé…ä»€ä¹ˆæˆ‘ä¸ç®¡ åæ­£ä¸ä¼šè·¨åŸŸå°±æ˜¯äº†<br>ä½†æ˜¯.. è¿™æ ·å„¿æ··æ—¥å­ ä½ çš„è‰¯å¿ƒä¸ä¼šç—›å—ï¼Ÿ</p>
<p>ç—›å®šæ€ç—› å†³å¿ƒä¸å®šæ—¶æ›´æ–° ä¸è¦å†é—®æˆ‘ XX çš„é—®é¢˜ç³»åˆ— ä¹‹ <font color="red">ä¸è¦å†é—®æˆ‘è·¨åŸŸçš„é—®é¢˜äº†</font></p>
<p>å…¶å®å›¢é˜Ÿçš„å°ä¼™ä¼´åˆ†äº«è¿‡ç±»ä¼¼çš„ ä½†æ˜¯ä¸åŠ¨æ‰‹è¯•ä¸€ä¸‹ è·Ÿä½ é¢è¯•å‰çš„æ­»è®°ç¡¬èƒŒæœ¬è´¨ä¸Šæ²¡æœ‰ä»»ä½•åŒºåˆ«<br><a id="more"></a></p>
<h2 id="ä½ éœ€è¦äº†è§£çš„å‡ ä¸ªæ¦‚å¿µ"><a href="#ä½ éœ€è¦äº†è§£çš„å‡ ä¸ªæ¦‚å¿µ" class="headerlink" title="ä½ éœ€è¦äº†è§£çš„å‡ ä¸ªæ¦‚å¿µ"></a>ä½ éœ€è¦äº†è§£çš„å‡ ä¸ªæ¦‚å¿µ</h2><ul>
<li>ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ</li>
</ul>
<p><strong>å®˜æ–¹è§£é‡Š</strong><br>è·¨åŸŸèµ„æºå…±äº«(CORS) æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå®ƒä½¿ç”¨é¢å¤–çš„ HTTP å¤´æ¥å‘Šè¯‰æµè§ˆå™¨  è®©è¿è¡Œåœ¨ä¸€ä¸ª origin (domain) ä¸Šçš„Webåº”ç”¨è¢«å‡†è®¸è®¿é—®æ¥è‡ªä¸åŒæºæœåŠ¡å™¨ä¸Šçš„æŒ‡å®šçš„èµ„æºã€‚å½“ä¸€ä¸ªèµ„æºä»ä¸è¯¥èµ„æºæœ¬èº«æ‰€åœ¨çš„æœåŠ¡å™¨ä¸åŒçš„åŸŸã€åè®®æˆ–ç«¯å£è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œèµ„æºä¼šå‘èµ·ä¸€ä¸ªè·¨åŸŸ HTTP è¯·æ±‚ã€‚</p>
<p>æ¯”å¦‚ï¼Œç«™ç‚¹ <a href="http://domain-a.com" target="_blank" rel="noopener">http://domain-a.com</a> çš„æŸ HTML é¡µé¢é€šè¿‡ <img> çš„ src è¯·æ±‚ <a href="http://domain-b.com/image.jpgã€‚ç½‘ç»œä¸Šçš„è®¸å¤šé¡µé¢éƒ½ä¼šåŠ è½½æ¥è‡ªä¸åŒåŸŸçš„CSSæ ·å¼è¡¨ï¼Œå›¾åƒå’Œè„šæœ¬ç­‰èµ„æºã€‚" target="_blank" rel="noopener">http://domain-b.com/image.jpgã€‚ç½‘ç»œä¸Šçš„è®¸å¤šé¡µé¢éƒ½ä¼šåŠ è½½æ¥è‡ªä¸åŒåŸŸçš„CSSæ ·å¼è¡¨ï¼Œå›¾åƒå’Œè„šæœ¬ç­‰èµ„æºã€‚</a></p>
<ul>
<li>ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè·¨åŸŸï¼Ÿ</li>
</ul>
<font color="red">å‡ºäºå®‰å…¨åŸå› ï¼Œæµè§ˆå™¨é™åˆ¶ä»è„šæœ¬å†…å‘èµ·çš„è·¨æºHTTPè¯·æ±‚ï¼ˆä¹Ÿå¯èƒ½è·¨ç«™è¯·æ±‚å¯ä»¥æ­£å¸¸å‘èµ·ï¼Œä½†æ˜¯è¿”å›ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº†ï¼‰</font>

<p>è·¨åŸŸçš„äº§ç”Ÿæ¥æºäºç°ä»£æµè§ˆå™¨æ‰€é€šç”¨çš„<code>åŒæºç­–ç•¥</code>ï¼Œæ‰€è°“åŒæºæ˜¯æŒ‡<code>&quot;åè®®+åŸŸå+ç«¯å£&quot;</code>ä¸‰è€…ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ‰å…è®¸è®¿é—®ç›¸åŒçš„<code>cookie</code>ã€<code>localStorage</code>æˆ–æ˜¯å‘é€<code>Ajax</code>è¯·æ±‚ç­‰ç­‰</p>
<p><strong>å¸¸è§çš„è·¨åŸŸåœºæ™¯</strong></p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">URL                                      è¯´æ˜                    æ˜¯å¦å…è®¸é€šä¿¡</span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/a.js</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/b.js         åŒä¸€åŸŸåï¼Œä¸åŒæ–‡ä»¶æˆ–è·¯å¾„           å…è®¸</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/lab/c.js</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com:8000/a.js</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/b.js         åŒä¸€åŸŸåï¼Œä¸åŒç«¯å£                ä¸å…è®¸</span></span><br><span class="line"> </span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/a.js</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//www.domain.com/b.js        åŒä¸€åŸŸåï¼Œä¸åŒåè®®                ä¸å…è®¸</span></span><br><span class="line"> </span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/a.js</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//192.168.4.12/b.js           åŸŸåå’ŒåŸŸåå¯¹åº”ç›¸åŒip              ä¸å…è®¸</span></span><br><span class="line"> </span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain.com/a.js</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//x.domain.com/b.js           ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒ                ä¸å…è®¸</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//domain.com/c.js</span></span><br><span class="line"> </span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain1.com/a.js</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//www.domain2.com/b.js        ä¸åŒåŸŸå                         ä¸å…è®¸</span></span><br></pre></td></tr></table></figure>
<ul>
<li>ç°ä»£çš„è·¨åŸŸè§£å†³æ–¹æ¡ˆ</li>
</ul>
<ol>
<li>é€šè¿‡jsonpè·¨åŸŸ</li>
<li>document.domain + iframeè·¨åŸŸ</li>
<li>location.hash + iframe</li>
<li>window.name + iframeè·¨åŸŸ</li>
<li>postMessageè·¨åŸŸ</li>
<li><font color="red">è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰</font></li>
<li>nginxä»£ç†è·¨åŸŸ</li>
<li>nodejsä¸­é—´ä»¶ä»£ç†è·¨åŸŸ</li>
<li>WebSocketåè®®è·¨åŸŸ</li>
</ol>
<h2 id="æ­å»ºæœåŠ¡å°è¯•è¿˜åŸè·¨åŸŸè¿‡ç¨‹"><a href="#æ­å»ºæœåŠ¡å°è¯•è¿˜åŸè·¨åŸŸè¿‡ç¨‹" class="headerlink" title="æ­å»ºæœåŠ¡å°è¯•è¿˜åŸè·¨åŸŸè¿‡ç¨‹"></a>æ­å»ºæœåŠ¡å°è¯•è¿˜åŸè·¨åŸŸè¿‡ç¨‹</h2><p><strong>é€šè¿‡koaæ­å»ºä¸¤ä¸ªæœ¬åœ°server ä¸¤ä¸ªserveréƒ½å®šä¹‰äº†ä¸€ä¸ªGETè¯·æ±‚æ¥å£/ajaxã€‚é™¤ç›‘å¬portä¸åŒå¤–ï¼Œapp.jsè¿˜è®¾ç½®äº†é™æ€æœåŠ¡ã€‚</strong></p>
<p><img src="/images/cors/koa1.png" alt="koa1"></p>
<p><strong>app.js port:8000</strong></p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"><span class="keyword">const</span> index = <span class="built_in">require</span>(<span class="string">'./routes/index'</span>)</span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">'koa-views'</span>)</span><br><span class="line"><span class="keyword">const</span> serve = <span class="built_in">require</span>(<span class="string">'koa-static'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼•å…¥é™æ€èµ„æº</span></span><br><span class="line"><span class="keyword">const</span> staticPath = path.resolve(__dirname, <span class="string">'/public'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®é™æ€æœåŠ¡</span></span><br><span class="line"><span class="keyword">const</span> staticServe = serve(staticPath, &#123;</span><br><span class="line">  setHeaders: <span class="function">(<span class="params">res, path, stats</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (path.indexOf(<span class="string">'jpg'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">      res.setHeader(<span class="string">'Cache-Control'</span>, [<span class="string">'private'</span>, <span class="string">'max-age=60'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(staticServe);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¢åŠ æ¨¡ç‰ˆå¼•æ“ é»˜è®¤ç›´æ¥æ¸²æŸ“htmlæ–‡ä»¶</span></span><br><span class="line">app.use(views(__dirname + <span class="string">'/views'</span>));</span><br><span class="line"><span class="comment">// å¼•å…¥è·¯ç”±é…ç½®æ–‡ä»¶</span></span><br><span class="line">app.use(index.routes(), index.allowedMethods())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.get(<span class="string">'/ajax'</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'get request'</span>, ctx.request.header.referer);</span><br><span class="line">  ctx.body = <span class="string">'received'</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8000</span>,<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'app1 server is listening port 8000'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'demo in run.....'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// route.js</span></span><br><span class="line"></span><br><span class="line"> router.get(<span class="string">'/ajax'</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'get request'</span>, ctx.request.header.referer);</span><br><span class="line">    ctx.body = <span class="string">'received'</span>;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p><strong>app2.js port:3000</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> koa();</span><br><span class="line"><span class="keyword">const</span> app2Route = <span class="built_in">require</span>(<span class="string">'./routes/app2Route'</span>)</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">'koa2-cors'</span>);</span><br><span class="line"></span><br><span class="line">app.use(app2Route.routes(), app2Route.allowedMethods())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">ctx,next</span>) </span>&#123;</span><br><span class="line">    ctx.response.body = <span class="string">'3000ç«¯å£'</span>;</span><br><span class="line"><span class="keyword">await</span> next();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.use(main)</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'app2 server is listening port 3000'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// route.js</span></span><br><span class="line"></span><br><span class="line"> router.get(<span class="string">'/ajax'</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'get request'</span>, ctx.request.header.referer);</span><br><span class="line">    ctx.body = <span class="string">'received'</span>;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p><strong>å‰ç«¯æ¨¡ç‰ˆ</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>cross-origin test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">"width: 600px; margin: 200px auto; text-align: center"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"getAjax()"</span>&gt;</span>GET ç®€å•è¯·æ±‚<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"getJsonP()"</span>&gt;</span>JSONP<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"corsWithJson()"</span>&gt;</span>POST éç®€å•è¯·æ±‚<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://code.jquery.com/jquery-2.1.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> baseUrl = <span class="string">'http://localhost:3000'</span>;</span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">getAjax</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();            </span></span><br><span class="line"><span class="actionscript">    xhr.open(<span class="string">'GET'</span>,  baseUrl + <span class="string">'/ajax'</span>, <span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">// readyState == 4è¯´æ˜è¯·æ±‚å·²å®Œæˆ</span></span></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span> &amp;&amp; xhr.status == <span class="number">200</span> || xhr.status == <span class="number">304</span>) &#123; </span></span><br><span class="line"><span class="actionscript">        <span class="comment">// ä»æœåŠ¡å™¨è·å¾—æ•°æ®  </span></span></span><br><span class="line">        alert(xhr.responseText);</span><br><span class="line"><span class="actionscript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(xhr.status);</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.send();</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆç®€å• å¤§æ¦‚é•¿è¿™æ ·å„¿</p>
<p><img src="/images/cors/koa2.png" alt="koa2"></p>
<p><strong>AJAX</strong></p>
<p>æµ‹è¯•case</p>
<ol>
<li><p>åŒåŸŸä¸‹è¯·æ±‚ajax ä¸æ¶‰åŠè·¨åŸŸ</p>
<p>è¯·æ±‚æ¥å£ï¼š<code>baseUrl = &#39;http://localhost:8000&#39;;</code><br>æµ‹è¯•ç»“æœğŸ‘‡<br><img src="/images/cors/koa3.png" alt="koa3"></p>
</li>
</ol>
<ol start="2">
<li>è·¨åŸŸajaxè¯·æ±‚<br>è¯·æ±‚æ¥å£ï¼š<code>baseUrl = &#39;http://localhost:3000&#39;;</code><br>æµ‹è¯•ç»“æœğŸ‘‡<br><img src="/images/cors/koa4.png" alt="koa4"><br>å¾ˆæ˜æ˜¾ è·¨åŸŸäº†</li>
</ol>
<h3 id="é’ˆå¯¹æµè§ˆå™¨çš„Ajaxè¯·æ±‚è·¨åŸŸçš„ä¸»è¦è§£å†³æ–¹æ¡ˆæœ‰ï¼šJSONPã€CORSã€‚"><a href="#é’ˆå¯¹æµè§ˆå™¨çš„Ajaxè¯·æ±‚è·¨åŸŸçš„ä¸»è¦è§£å†³æ–¹æ¡ˆæœ‰ï¼šJSONPã€CORSã€‚" class="headerlink" title="é’ˆå¯¹æµè§ˆå™¨çš„Ajaxè¯·æ±‚è·¨åŸŸçš„ä¸»è¦è§£å†³æ–¹æ¡ˆæœ‰ï¼šJSONPã€CORSã€‚"></a>é’ˆå¯¹æµè§ˆå™¨çš„Ajaxè¯·æ±‚è·¨åŸŸçš„ä¸»è¦è§£å†³æ–¹æ¡ˆæœ‰ï¼šJSONPã€CORSã€‚</h3><ul>
<li><p><strong>JSONP</strong></p>
  <font color="red">åŸç†</font>

<p>  è™½ç„¶æµè§ˆå™¨åŒæºç­–ç•¥é™åˆ¶äº†XMLHttpRequestè¯·æ±‚ä¸åŒåŸŸä¸Šçš„æ•°æ®ã€‚ä½†æ˜¯ï¼Œåœ¨é¡µé¢ä¸Šå¼•å…¥ä¸åŒåŸŸçš„jsè„šæœ¬æ˜¯å¯ä»¥çš„ï¼Œè€Œä¸”scriptå…ƒç´ è¯·æ±‚çš„è„šæœ¬ä¼šè¢«æµè§ˆå™¨ç›´æ¥è¿è¡Œ</p>
  <font color="red">æµ‹è¯•</font>

<p>  <code>origin.html</code>æ·»åŠ </p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">getJsonP</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    script.src = baseUrl + <span class="string">'/jsonp?type=json&amp;callback=onBack'</span>;</span><br><span class="line">    <span class="built_in">document</span>.head.appendChild(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onBack</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    alert(<span class="string">'JSONP CALLBACK:  '</span> + <span class="built_in">JSON</span>.stringify(res) + <span class="string">''</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>getJsonPæ–¹æ³•ä¼šåœ¨å½“å‰é¡µé¢æ·»åŠ ä¸€ä¸ªscriptï¼Œsrcå±æ€§æŒ‡å‘è·¨åŸŸçš„GETè¯·æ±‚<br>é€šè¿‡queryæ ¼å¼å¸¦ä¸Šè¯·æ±‚çš„å‚æ•°ã€‚callbackæ˜¯å…³é”®ï¼Œç”¨äºå®šä¹‰è·¨åŸŸè¯·æ±‚å›è°ƒçš„å‡½æ•°åç§°ï¼Œè¿™ä¸ªå€¼å¿…é¡»åå°å’Œè„šæœ¬ä¿æŒä¸€è‡´</p>
<p>åœ¨<code>app2.js</code>æ·»åŠ è·¯ç”±</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">router.<span class="keyword">get</span>(<span class="string">'/jsonp'</span>, async (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> req = ctx.request.query;</span><br><span class="line">  console.log(req);</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">data</span> = &#123;</span><br><span class="line">    <span class="keyword">data</span>: req.type</span><br><span class="line">  &#125;</span><br><span class="line">  ctx.body = req.callback + <span class="string">'('</span>+ JSON.stringify(<span class="keyword">data</span>) +<span class="string">')'</span>;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.use(router.routes());</span><br></pre></td></tr></table></figure>
<p>é’ˆå¯¹jsonpè¯·æ±‚ï¼Œåå°è¦åšçš„æ˜¯ï¼š</p>
<p>è·å–è¯·æ±‚å‚æ•°ä¸­çš„callbackå€¼ï¼Œå¦‚æœ¬ä¾‹ä¸­çš„onBack<br>å°†callbackçš„å€¼ä»¥function(args)çš„æ ¼å¼ä½œä¸ºresponseã€‚</p>
<p>é‡å¯æœåŠ¡ è§¦å‘é¡µé¢çš„ <code>JSONP</code>ğŸ”˜<br><img src="/images/cors/koa5.png" alt="koa5"></p>
<font color="red">ä¼˜ç‚¹</font><br>JSONPæ–¹æ¡ˆçš„å…¼å®¹æ€§å¥½ï¼ŒIEæµè§ˆå™¨ä¹Ÿæ”¯æŒã€‚<br><br><font color="red">ç¼ºç‚¹</font>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">å› ä¸ºæ˜¯åˆ©ç”¨çš„<span class="tag">&lt;<span class="name">script</span>&gt;</span>å…ƒç´ ï¼Œæ‰€ä»¥åªæ”¯æŒGETè¯·æ±‚ã€‚</span><br><span class="line">ç¼ºä¹é”™è¯¯å¤„ç†æœºåˆ¶</span><br></pre></td></tr></table></figure>
<ul>
<li>CORS</li>
</ul>
<p>CORSå³è·¨åŸŸèµ„æºåˆ†äº«ï¼Œæ˜¯W3Cåˆ¶å®šçš„æ ‡å‡†ã€‚</p>
<ol>
<li>ç‰¹æ€§<br>CORSéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚</li>
</ol>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">å¤§å¤šä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒï¼ŒIE <span class="number">10</span>ä»¥ä¸‹ä¸æ”¯æŒã€‚</span><br><span class="line">åªè¦æœåŠ¡å™¨ç«¯å®ç°äº†CORSæ¥å£ï¼Œæµè§ˆå™¨å°±èƒ½è‡ªåŠ¨å®ç°åŸºäºCORSçš„è·¨åŸŸè¯·æ±‚ã€‚</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ä¸¤ç§è¯·æ±‚</li>
</ol>
<p>æµè§ˆå™¨å°†CORSè¯·æ±‚åˆ†æˆä¸¤ç±»ï¼šç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚ã€‚</p>
<ul>
<li>ç®€å•è¯·æ±‚<br>æ»¡è¶³æ¡ä»¶ï¼šè¯·æ±‚ç±»å‹ä¸º <font color="red"><code>HEADï¼ŒGETï¼ŒPOSTä¹‹ä¸€</code></font>ï¼›<br>è¯·æ±‚å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§ï¼š</li>
</ul>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">Accept</span><br><span class="line">Accept-Language</span><br><span class="line">Content-Language</span><br><span class="line">Last-Event-ID</span><br><span class="line">Content-<span class="keyword">Type</span>ï¼šåªé™äºä¸‰ä¸ªå€¼application/x-www-<span class="keyword">form</span>-urlencodedã€multipart/<span class="keyword">form</span>-<span class="keyword">data</span>ã€text/plain</span><br></pre></td></tr></table></figure>
<p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šç›´æ¥å‘å‡ºï¼ŒåŒæ—¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ Originå­—æ®µã€‚</p>
<p>Originç”¨æ¥è¯´æ˜è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®® + åŸŸå + ç«¯å£ï¼‰ã€‚æœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå€¼ï¼Œå†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚ã€‚<br>å¦‚æœOriginæŒ‡å®šçš„æºï¼Œä¸åœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå›åº”ã€‚æµè§ˆå™¨å‘ç°ï¼Œè¿™ä¸ªå›åº”çš„å¤´ä¿¡æ¯æ²¡æœ‰åŒ…å«Access-Control-Allow-Originå­—æ®µï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œå°±çŸ¥é“å‡ºé”™äº†ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¢«XMLHttpRequestçš„onerrorå›è°ƒå‡½æ•°æ•è·ã€‚æ³¨æ„ï¼Œè¿™ç§é”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸ºHTTPå›åº”çš„çŠ¶æ€ç æœ‰å¯èƒ½æ˜¯200ã€‚</p>
<p>å›é¡¾ä¸‹ç›´æ¥Ajaxæµ‹è¯•è·¨åŸŸçš„è¯·æ±‚æŠ¥æ–‡ï¼š</p>
<p><img src="/images/cors/koa6.png" alt="koa6"><br>æµè§ˆå™¨ä¸ºè¿™ä¸ªç®€å•çš„GETè¯·æ±‚æ·»åŠ äº†Originï¼Œè€Œå“åº”å¤´ä¿¡æ¯ä¸­æ²¡æœ‰Access-Control-Allow-Originï¼Œæµè§ˆå™¨åˆ¤æ–­è¯·æ±‚è·¨åŸŸï¼Œç»™å‡ºé”™è¯¯æç¤ºã€‚</p>
<ul>
<li>éç®€å•è¯·æ±‚</li>
</ul>
<p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯PUTæˆ–DELETEï¼Œæˆ–è€…Content-Typeå­—æ®µçš„ç±»å‹æ˜¯application/jsonã€‚</p>
<p>éç®€å•è¯·æ±‚çš„CORSè¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€é¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚</p>
<p>æµè§ˆå™¨å…ˆè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨çš„åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPåŠ¨è¯å’Œå¤´ä¿¡æ¯å­—æ®µã€‚åªæœ‰å¾—åˆ°è‚¯å®šç­”å¤ï¼Œæµè§ˆå™¨æ‰ä¼šå‘å‡ºæ­£å¼çš„XMLHttpRequestè¯·æ±‚ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p>
<p>åœ¨<font color="red">origin.html</font>ä¸­æ·»åŠ ä¸€ä¸ªpostè¯·æ±‚ï¼š</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">corsWithJson</span><span class="params">()</span></span> &#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">      url: baseUrl + <span class="string">'/cors'</span>,</span><br><span class="line">      <span class="built_in">type</span>: <span class="string">'post'</span>,</span><br><span class="line">      contentType: <span class="string">'application/json'</span>,</span><br><span class="line">      data: &#123;</span><br><span class="line">        <span class="built_in">type</span>: <span class="string">'json'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      success: <span class="function"><span class="keyword">function</span><span class="params">(data)</span></span> &#123;</span><br><span class="line">        console.<span class="built_in">log</span>(data);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è®¾ç½®Content-Typeä¸ºappliaction/jsonä½¿å…¶æˆä¸ºéç®€å•è¯·æ±‚ï¼š</p>
<p>å¯åŠ¨æœåŠ¡<br><img src="/images/cors/koa7.png" alt="koa7"><br>â€œé¢„æ£€â€è¯·æ±‚çš„æ–¹æ³•ä¸ºOPTIONSï¼ŒæœåŠ¡å™¨åˆ¤æ–­Originä¸ºè·¨åŸŸ</p>
<p>é™¤äº†Originå­—æ®µï¼Œâ€é¢„æ£€â€è¯·æ±‚çš„å¤´ä¿¡æ¯åŒ…æ‹¬ä¸¤ä¸ªç‰¹æ®Šå­—æ®µã€‚</p>
<p>ï¼ˆ1ï¼‰<strong>Access-Control-Request-Method</strong><br>è¯¥å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„CORSè¯·æ±‚ä¼šç”¨åˆ°å“ªäº›HTTPæ–¹æ³•ï¼Œä¸Šä¾‹æ˜¯PUTã€‚<br>ï¼ˆ2ï¼‰<strong>Access-Control-Request-Headers</strong><br>è¯¥å­—æ®µæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæµè§ˆå™¨CORSè¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µï¼Œä¸Šä¾‹æ˜¯content-typeã€‚</p>
<font color="red">æœåŠ¡ç«¯è®¾ç½®CORS</font>

<p>åœ¨app2.jså¼•å…¥koa2-corsï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">app.<span class="keyword">use</span>(cors(&#123;</span><br><span class="line">  origin: <span class="function"><span class="keyword">function</span> <span class="params">(ctx)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (ctx.url === <span class="string">'/cors'</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">"*"</span>; <span class="comment">// å…è®¸æ¥è‡ªæ‰€æœ‰åŸŸåè¯·æ±‚</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">'http://localhost:3201'</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  exposeHeaders: [<span class="string">'WWW-Authenticate'</span>, <span class="string">'Server-Authorization'</span>],</span><br><span class="line">  maxAge: <span class="number">5</span>,</span><br><span class="line">  credentials: <span class="keyword">true</span>,</span><br><span class="line">  allowMethods: [<span class="string">'GET'</span>, <span class="string">'POST'</span>, <span class="string">'DELETE'</span>], <span class="comment">//è®¾ç½®å…è®¸çš„HTTPè¯·æ±‚ç±»å‹</span></span><br><span class="line">  allowHeaders: [<span class="string">'Content-Type'</span>, <span class="string">'Authorization'</span>, <span class="string">'Accept'</span>],</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p>é‡å¯æœåŠ¡åï¼Œæµè§ˆå™¨é‡æ–°å‘é€POSTè¯·æ±‚ã€‚å¯ä»¥çœ‹åˆ°æµè§ˆå™¨å‘é€äº†ä¸¤æ¬¡è¯·æ±‚ã€‚</p>
<p><img src="/images/cors/koa8.png" alt="koa8"></p>
<p>ï¼ˆ1ï¼‰<strong>Access-Control-Allow-Methods</strong><br>è¯¥å­—æ®µå¿…éœ€ï¼Œå®ƒçš„å€¼æ˜¯é€—å·åˆ†éš”çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•ã€‚æ³¨æ„ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰æ”¯æŒçš„æ–¹æ³•ï¼Œè€Œä¸å•æ˜¯æµè§ˆå™¨è¯·æ±‚çš„é‚£ä¸ªæ–¹æ³•ã€‚è¿™æ˜¯ä¸ºäº†é¿å…å¤šæ¬¡â€é¢„æ£€â€è¯·æ±‚ã€‚<br>ï¼ˆ2ï¼‰<strong>Access-Control-Allow-Headers</strong><br>å¦‚æœæµè§ˆå™¨è¯·æ±‚åŒ…æ‹¬Access-Control-Request-Headerså­—æ®µï¼Œåˆ™Access-Control-Allow-Headerså­—æ®µæ˜¯å¿…éœ€çš„ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œè¡¨æ˜æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰å¤´ä¿¡æ¯å­—æ®µï¼Œä¸é™äºæµè§ˆå™¨åœ¨â€é¢„æ£€â€ä¸­è¯·æ±‚çš„å­—æ®µã€‚<br>ï¼ˆ3ï¼‰<strong>Access-Control-Allow-Credentials</strong><br>è¯¥å­—æ®µå¯é€‰ã€‚å®ƒçš„å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€Cookieã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCookieä¸åŒ…æ‹¬åœ¨CORSè¯·æ±‚ä¹‹ä¸­ã€‚è®¾ä¸ºtrueï¼Œå³è¡¨ç¤ºæœåŠ¡å™¨æ˜ç¡®è®¸å¯ï¼ŒCookieå¯ä»¥åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œä¸€èµ·å‘ç»™æœåŠ¡å™¨ã€‚è¿™ä¸ªå€¼ä¹Ÿåªèƒ½è®¾ä¸ºtrueï¼Œå¦‚æœæœåŠ¡å™¨ä¸è¦æµè§ˆå™¨å‘é€Cookieï¼Œåˆ é™¤è¯¥å­—æ®µå³å¯ã€‚<br>ï¼ˆ4ï¼‰<strong>Access-Control-Max-Age</strong><br>è¯¥å­—æ®µå¯é€‰ï¼Œç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ã€‚ä¸Šé¢ç»“æœä¸­ï¼Œæœ‰æ•ˆæœŸæ˜¯20å¤©ï¼ˆ1728000ç§’ï¼‰ï¼Œå³å…è®¸ç¼“å­˜è¯¥æ¡å›åº”1728000ç§’ï¼ˆå³20å¤©ï¼‰ï¼Œåœ¨æ­¤æœŸé—´ï¼Œä¸ç”¨å‘å‡ºå¦ä¸€æ¡é¢„æ£€è¯·æ±‚ã€‚</p>
<p>ç°åœ¨ä¸ºæ­¢ é»˜è®¤ä½ å·²ç»å®Œå…¨ç†è§£è·¨åŸŸäº†å“¦</p>
<p>ç¤ºä¾‹ä¸­çš„æºä»£ç </p>
]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>CORS</tag>
      </tags>
  </entry>
  <entry>
    <title>ES6ç³»åˆ—(ä¸€)</title>
    <url>/2017/04/20/ES6/</url>
    <content><![CDATA[<p><strong>æ•°ç»„çš„æ‰©å±•</strong><br>Array.form() å°†ä¸¤ç±»å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„<br>1.ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡<br>2.å¯éå†çš„å¯¹è±¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">let</span> arrayLike = &#123;</span><br><span class="line"><span class="string">'0'</span>:<span class="string">'a'</span>,</span><br><span class="line"><span class="string">'1'</span>:<span class="string">'b'</span>,</span><br><span class="line"><span class="string">'2'</span>:<span class="string">'c'</span>,</span><br><span class="line"><span class="string">'3'</span>:<span class="string">'d'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ES5å†™æ³•</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">var</span> arr1 = []<span class="selector-class">.slice</span><span class="selector-class">.call</span>(arrayLike)</span><br></pre></td></tr></table></figure>
<p>ES6 å†™æ³•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.form(arrayLike)</span><br></pre></td></tr></table></figure>
<p>ä»»ä½•æœ‰lengthå±æ€§çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡Array.fromæ–¹æ³•è½¬ä¸ºæ•°ç»„ï¼Œè€Œæ­¤æ—¶æ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•è½¬æ¢ã€‚</p>
<p>å€¼å¾—æé†’çš„æ˜¯ï¼Œæ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰ä¹Ÿå¯ä»¥å°†æŸäº›æ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="comment">// argumentså¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> <span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  var args = [...arguments];</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// NodeListå¯¹è±¡</span></span></span><br><span class="line"><span class="function">[...<span class="title">document</span>.<span class="title">querySelectorAll</span><span class="params">(<span class="string">'div'</span>)</span>]</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Array</span>.<span class="title">from</span>è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„<span class="title">map</span>æ–¹æ³•</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Array</span>.<span class="title">from</span><span class="params">(arrayLike, x =&gt; x * x)</span>;</span></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">Array</span>.from(arrayLike).map(x =&gt; x * x);</span><br><span class="line"></span><br><span class="line"><span class="keyword">Array</span>.<span class="keyword">of</span>()</span><br><span class="line"><span class="keyword">Array</span>.<span class="keyword">of</span>æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">Array</span>.<span class="keyword">of</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3,11,8]</span></span><br><span class="line"><span class="keyword">Array</span>.<span class="keyword">of</span>(<span class="number">3</span>) <span class="comment">// [3]</span></span><br><span class="line"><span class="keyword">Array</span>.<span class="keyword">of</span>(<span class="number">3</span>).length <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].find(<span class="function"><span class="keyword">function</span><span class="params">(value, <span class="keyword">index</span>, arr)</span> <span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  return value &gt; 9;</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span>) <span class="comment">// 10</span></span></span><br></pre></td></tr></table></figure>
<p>fillæ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].<span class="built_in">fill</span>(<span class="number">7</span>)</span><br></pre></td></tr></table></figure>
<p>ES6æä¾›ä¸‰ä¸ªæ–°çš„æ–¹æ³•â€”â€”<strong>entries()</strong>ï¼Œ<strong>keys()</strong>å’Œ<strong>values()</strong>â€”â€”ç”¨äºéå†æ•°ç»„</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>);     <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p><strong>for of å¾ªç¯</strong></p>
<p>ES6 å¼•å…¥ rest å‚æ•°ï¼ˆå½¢å¼ä¸ºâ€œâ€¦å˜é‡åâ€ï¼‰ï¼Œç”¨äºè·å–å‡½æ•°çš„å¤šä½™å‚æ•°</p>
<p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆspreadï¼‰æ˜¯ä¸‰ä¸ªç‚¹ï¼ˆâ€¦ï¼‰ã€‚å®ƒå¥½æ¯” rest å‚æ•°çš„é€†è¿ç®—ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚<br>console.log(â€¦[1, 2, 3])<br>// 1 2 3</p>
<p>å‡½æ•°çš„nameå±æ€§ï¼Œè¿”å›è¯¥å‡½æ•°çš„å‡½æ•°åã€‚</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">foo.name <span class="comment">// "foo"</span></span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="red" size="4">ï¼ˆ1ï¼‰å‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚</font>

<p>å¯¹è±¡çš„æ‰©å±•<br>var bax= {bac} = var baz = {bac:bac}</p>
<figure class="highlight monkey"><table><tr><td class="code"><pre><span class="line">var o = &#123;</span><br><span class="line"><span class="function"><span class="keyword">method</span>:</span><span class="function"><span class="keyword">function</span>(</span>)&#123;&#125;</span><br><span class="line">&#125; ==</span><br><span class="line">var o = &#123;</span><br><span class="line"> <span class="function"><span class="keyword">method</span>(</span>)&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>let propKey = â€˜fooâ€™;</p>
<p>let obj = {<br>  [propKey]: true,<br>  [â€˜aâ€™ + â€˜bcâ€™]: 123<br>};</p>
<p>const person = {<br>  sayName() {<br>    console.log(â€˜hello!â€™);<br>  },<br>};</p>
<p>person.sayName.name   // â€œsayNameâ€</p>
<p>Object.isï¼ˆï¼‰ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¸¥æ ¼æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ===ï¼‰çš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.<span class="keyword">is</span>(<span class="string">'foo'</span>, <span class="string">'foo'</span>)</span><br><span class="line"><span class="comment">// true</span></span><br><span class="line"><span class="built_in">Object</span>.<span class="keyword">is</span>(&#123;&#125;, &#123;&#125;)</span><br><span class="line"><span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">ä¸åŒä¹‹å¤„åªæœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯+<span class="number">0</span>ä¸ç­‰äº<span class="number">-0</span>ï¼ŒäºŒæ˜¯NaNç­‰äºè‡ªèº«</span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="green" size="4">Object.is(+0, -0) // false<br></font>

<font face="STCAIYUN" color="blue" size="4">Object.is(NaN, NaN) // true<br></font>

<p>Object.assign() å®è¡Œçš„æ˜¯<font face="STCAIYUN" color="red" size="4">æµ…æ‹·è´ä¸æ˜¯æ·±æ‹·è´<br></font><br><strong>å¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§çš„å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</strong></p>
<p>ä¾‹å­</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = <span class="comment">&#123;a: &#123;b: 1&#125;</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="keyword">Object</span>.assign(<span class="comment">&#123;&#125;</span>, obj1);</span><br><span class="line"></span><br><span class="line">obj1.a.b = <span class="number">2</span>; å¦‚æœå€¼æ›´æ”¹ åˆ™æ‹·è´ä¹‹åçš„å€¼ä¹Ÿæ˜¯å˜åŒ–çš„</span><br><span class="line">obj2.a.b <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">å¦‚æœè¯¥å‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šå…ˆè½¬æˆå¯¹è±¡ï¼Œç„¶åè¿”å›ã€‚</span><br><span class="line"></span><br><span class="line">typeof <span class="keyword">Object</span>.assign(<span class="number">2</span>) <span class="comment">// "object"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Object</span>.assignå¯ä»¥ç”¨æ¥å¤„ç†æ•°ç»„ï¼Œä½†æ˜¯ä¼šæŠŠæ•°ç»„è§†ä¸ºå¯¹è±¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="keyword">Object</span>.assign([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"><span class="comment">// [4, 5, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Object</span>.assign(someClass.prototype,<span class="comment">&#123;</span></span><br><span class="line"><span class="comment">someMethod()&#123;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">&#125;</span>,</span><br><span class="line">antherMethod()<span class="comment">&#123;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">===</span><br><span class="line"><span class="comment">// ç­‰åŒäºä¸‹é¢çš„å†™æ³•</span></span><br><span class="line">SomeClass.prototype.someMethod = <span class="function"><span class="keyword">function</span> <span class="params">(arg1, arg2)</span> <span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  Â·Â·Â·</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span>;</span></span><br><span class="line">SomeClass.prototype.anotherMethod = <span class="function"><span class="keyword">function</span> <span class="params">()</span> <span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  Â·Â·Â·</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span>;</span></span><br></pre></td></tr></table></figure>
<p><strong>å…‹éš†å¯¹è±¡</strong><br>åªèƒ½å¯é€šä»–è‡ªèº«çš„å€¼è€Œä¸èƒ½å¯é€šå®ƒç»§æ‰¿çš„å€¼</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">clone</span>(origin)&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="type">Object.assign(&#123;&#125;,origin)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">origin</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> originProto = <span class="built_in">Object</span>.getPrototypeOf(origin);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(<span class="built_in">Object</span>.create(originProto), origin);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">Object.getOwnPropertyDescriptor</span> <span class="string">è·å–è¯¥å±æ€§çš„æè¿°å¯¹è±¡</span></span><br><span class="line"><span class="string">let</span> <span class="string">obj</span> <span class="string">=</span> <span class="string">&#123;</span> <span class="attr">foo:</span> <span class="number">123</span> <span class="string">&#125;;</span></span><br><span class="line"><span class="string">Object.getOwnPropertyDescriptor(obj,</span> <span class="string">'foo'</span><span class="string">)</span></span><br><span class="line"><span class="string">//</span>  <span class="string">&#123;</span></span><br><span class="line"><span class="string">//</span>    <span class="attr">value:</span> <span class="number">123</span><span class="string">,</span></span><br><span class="line"><span class="string">//</span>    <span class="attr">writable:</span> <span class="literal">true</span><span class="string">,</span></span><br><span class="line"><span class="string">//</span>    <span class="attr">enumerable:</span> <span class="literal">true</span><span class="string">,</span></span><br><span class="line"><span class="string">//</span>    <span class="attr">configurable:</span> <span class="literal">true</span></span><br><span class="line"><span class="string">//</span>  <span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>Object.keysæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®åã€‚</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">var obj = &#123; foo: <span class="string">'bar'</span>, baz: <span class="number">42</span> &#125;;</span><br><span class="line">Object.keys(obj)</span><br><span class="line"><span class="regexp">//</span> [<span class="string">"foo"</span>, <span class="string">"baz"</span>]</span><br></pre></td></tr></table></figure>
<p><img src="media/14879652049673/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-02-25%20%E4%B8%8B%E5%8D%8812.58.09.png" alt="å±å¹•å¿«ç…§ 2017-02-25 ä¸‹åˆ12.58.09"></p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; foo: <span class="string">'bar'</span>, baz: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.values(obj)</span><br><span class="line"><span class="comment">// ["bar", 42]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">var obj = &#123; foo: <span class="string">'bar'</span>, baz: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="symbol">Object</span>.entries(obj)</span><br><span class="line">// [ [<span class="string">"foo"</span>, <span class="string">"bar"</span>], [<span class="string">"baz"</span>, <span class="number">42</span>] ]</span><br></pre></td></tr></table></figure>
<p><strong>ES6 ä¸­éå†å¯¹è±¡çš„å±æ€§</strong></p>
<font face="STCAIYUN" color="red" size="4">forâ€¦in </font>å¾ªç¯éå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆä¸å«Symbolå±æ€§ï¼‰<br> <font face="STCAIYUN" color="red" size="4">Object.keys</font>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆä¸å«Symbolå±æ€§ï¼‰ã€‚<br> <font face="STCAIYUN" color="red" size="4">Object.getOwnPropertyNames</font>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ˆä¸å«Symbolå±æ€§ï¼Œä½†æ˜¯åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰<br> <font face="STCAIYUN" color="red" size="4">Object.getOwnPropertySymbols</font>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰Symbolå±æ€§ã€‚<br><br><font face="STCAIYUN" color="red" size="4"><strong>proto</strong>å±æ€§ï¼ˆå‰åå„ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰</font>ï¼Œç”¨æ¥è¯»å–æˆ–è®¾ç½®å½“å‰å¯¹è±¡çš„prototypeå¯¹è±¡ã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨ï¼ˆåŒ…æ‹¬ IE11ï¼‰éƒ½éƒ¨ç½²äº†è¿™ä¸ªå±æ€§ã€‚<br><br><br><br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// es6çš„å†™æ³•</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  method: <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123; ... &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.__proto__ = someOtherObj;</span><br></pre></td></tr></table></figure><br><br><figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">let <span class="keyword">proto</span> = &#123;&#125;;</span><br><span class="line">let obj = &#123; x: <span class="number">10</span> &#125;;</span><br><span class="line">Object.<span class="built_in">set</span>PrototypeOf(obj, <span class="keyword">proto</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">proto</span>.y = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">proto</span>.z = <span class="number">40</span>;</span><br><span class="line"></span><br><span class="line">obj.x // <span class="number">10</span></span><br><span class="line">obj.y // <span class="number">20</span></span><br><span class="line">obj.z // <span class="number">40</span></span><br><span class="line">ä¸Šé¢ä»£ç å°†<span class="keyword">proto</span>å¯¹è±¡è®¾ä¸ºobjå¯¹è±¡çš„åŸå‹ï¼Œæ‰€ä»¥ä»objå¯¹è±¡å¯ä»¥è¯»å–<span class="keyword">proto</span>å¯¹è±¡çš„å±æ€§ã€‚</span><br></pre></td></tr></table></figure><br><br><strong>ES6å¼•å…¥çš„åŸå§‹ç±»å‹â€œ</strong><br><font face="STCAIYUN" color="red" size="4">Symbol</font><br>å‡¡æ˜¯å±æ€§åå±äºSymbolç±»å‹ï¼Œå°±éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯ä»¥ä¿è¯ä¸ä¼šä¸å…¶ä»–å±æ€§åäº§ç”Ÿå†²çªã€‚<br>Symbolå‡½æ•°å‰<font face="STCAIYUN" color="red" size="4">ä¸èƒ½ä½¿ç”¨newå‘½ä»¤</font>ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„Symbolæ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡<br>ç”±äºSymbolå€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸èƒ½æ·»åŠ å±æ€§ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ä¸€ç§ç±»ä¼¼äºå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ã€‚<br>Symbolå€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚<br>ä½†æ˜¯ï¼ŒSymbolå€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚<br>å¦å¤–ï¼ŒSymbolå€¼ä¹Ÿå¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ï¼Œä½†æ˜¯ä¸èƒ½è½¬ä¸ºæ•°å€¼ã€‚<br><br>let s = Symbol();<br><br>typeof s<br><br><strong>æ•°ç»„å»é‡</strong><br><br>æ–°å¢çš„æ•°æ®ç»“æ„ <font face="STCAIYUN" color="red" size="4">Set Map </font>


<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">const s = new Set();</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>].forEach(x =&gt; s.add(x));</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">var <span class="builtin-name">set</span> = new <span class="builtin-name">Set</span>([1, 2, 3, 4, 4]);</span><br><span class="line">[<span class="built_in">..</span>.<span class="builtin-name">set</span>]</span><br></pre></td></tr></table></figure>
<p>// å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜<br>åœ¨Setå†…éƒ¨ï¼Œä¸¤ä¸ªNaNæ˜¯ç›¸ç­‰ã€‚</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">[<span class="built_in">..</span>.new <span class="builtin-name">Set</span>(array)]</span><br><span class="line">var <span class="builtin-name">set</span> = new <span class="builtin-name">Set</span>([1,1,2,2,3,4,5,5,6])</span><br><span class="line">[<span class="built_in">..</span>.<span class="builtin-name">set</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="built_in">map</span> = <span class="literal">new</span> <span class="built_in">Map</span>(<span class="meta">[</span></span><br><span class="line">  <span class="meta">[</span><span class="string">'F'</span>, <span class="string">'no'</span><span class="meta">]</span>,</span><br><span class="line">  <span class="meta">[</span><span class="string">'T'</span>,  <span class="string">'yes'</span><span class="meta">]</span>,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">let</span> <span class="built_in">key</span> of <span class="built_in">map</span>.keys()) &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="built_in">key</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="red" size="4">Proxyï¼ˆä»£ç†å™¨ï¼‰ å…ƒç¼–ç¨‹ï¼ˆå¯¹ç¼–ç¨‹è¯­è¨€è¿›è¡Œç¼–ç¨‹ï¼‰</font>


<p><strong>åœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰è®¾ç½®ä¸€å±‚æ‹¦æˆª å¤–ç•Œå¯¹å®ƒçš„è®¿é—®å¿…é¡»å…ˆé€šè¿‡è¿™ä¸€å±‚æ‹¦æˆª</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="keyword">get</span>: function (target, key, receiver) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`getting <span class="subst">$&#123;key&#125;</span>!`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, receiver);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="keyword">set</span>: function (target, key, value, receiver) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`setting <span class="subst">$&#123;key&#125;</span>!`</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, receiver);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>é‡å†™äº†getå’Œsetæ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="keyword">get</span>: function(target, property) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">35</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">proxy.time <span class="comment">// 35</span></span><br><span class="line">proxy.name <span class="comment">// 35</span></span><br><span class="line">proxy.title <span class="comment">// 35</span></span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="red" size="4">Promise(æ‰¿è¯º)</font>

<p>æ‰€è°“Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromise æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚Promise æä¾›ç»Ÿä¸€çš„ APIï¼Œå„ç§å¼‚æ­¥æ“ä½œéƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">'å¼‚æ­¥æ“ä½œæˆåŠŸ'</span>)&#123;</span><br><span class="line">resolve(value)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">reject(error)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">æˆåŠŸ</span><br><span class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">å¤±è´¥</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>éå†å™¨å¯¹è±¡æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ã€‚</p>
<p>å›è°ƒå‡½æ•°<br>äº‹ä»¶ç›‘å¬<br>å‘å¸ƒ/è®¢é˜…<br>Promise å¯¹è±¡</p>
<p>Generatorå‡½æ•°<br>yieldè¡¨ç¤ºæ‰§è¡Œåˆ°æ­¤å¤„æ‰§è¡Œæƒå°†äº¤ç»™å…¶å®ƒåç¨‹ä¹Ÿå°±æ˜¯è¯´yield å‘½ä»¤éƒ¨ä¸¤ä¸ªé˜¶æ®µçš„åˆ†ç•Œçº¿</p>
<p>Generator å‡½æ•°ä¸åŒäºæ™®é€šå‡½æ•°çš„å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå³æ‰§è¡Œå®ƒä¸ä¼šè¿”å›ç»“æœï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line"> <span class="keyword">try</span>&#123;</span><br><span class="line"> <span class="keyword">var</span> y = <span class="keyword">yield</span> x +<span class="number">2</span>;</span><br><span class="line"> &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(e)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> y</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fetch = <span class="built_in">require</span>(<span class="string">'node-fetch'</span>);</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">var</span> <span class="built_in">url</span> = <span class="string">'http://api.github.com/users/github'</span>;</span><br><span class="line"> <span class="keyword">var</span> result = <span class="keyword">yield</span> fetch (<span class="built_in">url</span>);</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">'ds'</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p> Thunk å‡½æ•°æ˜¯è‡ªåŠ¨æ‰§è¡Œgeneratorå‡½æ•°çš„ä¸€ç§æ–¹æ³•</p>
<p> ä¼ åè°ƒç”¨</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"> f(x + <span class="number">5</span>)</span><br><span class="line"><span class="comment">// ä¼ åè°ƒç”¨æ—¶ï¼Œç­‰åŒäº</span></span><br><span class="line"><span class="function"><span class="title">f</span><span class="params">(x + <span class="number">5</span>)</span></span></span><br></pre></td></tr></table></figure>
<p> ä¼ å€¼è°ƒç”¨</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"> f(x + <span class="number">5</span>)</span><br><span class="line"><span class="comment">// ä¼ å€¼è°ƒç”¨æ—¶ï¼Œç­‰åŒäº</span></span><br><span class="line"><span class="function"><span class="title">f</span><span class="params">(<span class="number">6</span>)</span></span></span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="red" size="4">Thunkæ˜¯ä¼ åè°ƒç”¨çš„å®ç°</font>ï¼Œå°†å‚æ•°æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶çš„å‡½æ•°ä¸­ï¼Œå†å°†è¿™ä¸ªä¸´æ—¶å‡½æ•°ä¼ å…¥å‡½æ•°ä½“<br><br>è¿™ä¸ªä¸´æ—¶å‡½æ•°å«åš<strong>Thunk</strong> å‡½æ•°<br><br><br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span><span class="params">(m)</span></span>&#123;</span><br><span class="line"> <span class="keyword">return</span> m*<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f(x+<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">ç­‰åŒäº</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> thunk = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x+<span class="number">5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">(thunk)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> thunk()*<span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br><font face="STCAIYUN" color="red" size="4">async ï¼šGenerator å‡½æ•°çš„è¯­æ³•ç³–</font>



<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> asyncReadFile = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> f1 = <span class="keyword">await</span> readFile(<span class="string">'/etc/fstab'</span>);</span><br><span class="line">  <span class="keyword">var</span> f2 = <span class="keyword">await</span> readFile(<span class="string">'/etc/shells'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(f1.toString());</span><br><span class="line">  <span class="built_in">console</span>.log(f2.toString());</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>async ğŸŒ§ï¸generatoræ¯”è¾ƒ</strong></p>
<ol>
<li>asyncæœ‰å†…ç½®æ‰§è¡Œå™¨ ä¸éœ€è¦è°ƒç”¨nextæ–¹æ³•<br>æ‹¥æœ‰æ›´å¥½çš„è¯­ä¹‰ï¼ˆæ¯”èµ·æ˜Ÿå·å’Œyield è¯­ä¹‰æ›´æ¸…æ¥šäº†ï¼‰</li>
<li>asyncå‡½æ•°è¿”å›çš„æ˜¯promiseå¯¹è±¡æ¯” Generatorå‡½æ•°è¿”å›å€¼æ˜¯Iteratorå¯¹è±¡æ–¹ä¾¿å¤šäº† å¯ä»¥ç”¨thenæ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥æ“ä½œ</li>
</ol>
<p><strong>asyncå’Œawait</strong></p>
<ul>
<li>asyncè¡¨ç¤ºå‡½æ•°ä¸­æœ‰å¼‚æ­¥æ“ä½œ</li>
<li>awaitè¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…ç»“æœ</li>
<li>asyncå‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼ŒåŒ…è£…æˆçš„ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œawaitå‘½ä»¤å°±æ˜¯å†…éƒ¨thenå‘½ä»¤çš„è¯­æ³•ç³–ã€‚</li>
<li>asyncå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨thenæ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°awaitå°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚</li>
</ul>
<p>é”™è¯¯å¤„ç†</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å‡ºé”™äº†'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> val1 = <span class="keyword">await</span> firstStep();</span><br><span class="line">    <span class="keyword">var</span> val2 = <span class="keyword">await</span> secondStep(val1);</span><br><span class="line">    <span class="keyword">var</span> val3 = <span class="keyword">await</span> thirdStep(val1, val2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Final: '</span>, val3);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> somethingThatReturnsAPromise();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="class"><a href="#class" class="headerlink" title="class"></a>class</h3><p><strong>åŸºæœ¬å½¢å¼</strong></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constructor</span>(x,y)&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.x = x;</span><br><span class="line"><span class="keyword">this</span>.y = y</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">toString()&#123;</span><br><span class="line"> <span class="keyword">return</span>  <span class="string">'('</span> + <span class="keyword">this</span>.x + <span class="string">', '</span> + <span class="keyword">this</span>.y + <span class="string">')'</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Classä¸å­˜åœ¨å˜é‡æå‡ï¼ˆhoistï¼‰ï¼Œè¿™ä¸€ç‚¹ä¸ES5å®Œå…¨ä¸åŒã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> MyClass = <span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</span><br><span class="line">  getClassName() &#123;</span><br><span class="line">    <span class="keyword">return</span> Me.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç±»åæ˜¯MyClass è€Œä¸æ˜¯me Meåªåœ¨Classçš„å†…éƒ¨ä»£ç å¯ç”¨ï¼ŒæŒ‡ä»£å½“å‰ç±»ã€‚</p>
<p>const MyClass = class { /<em> â€¦ </em>/ };</p>
<p><strong>æ¨¡å—åŠ è½½æ–¹æ¡ˆ</strong></p>
<ul>
<li>CommonJsåº”ç”¨äºæœåŠ¡å™¨</li>
<li><p>AMDåº”ç”¨äºæµè§ˆå™¨</p>
<p>ES6 æä¾›æ¨¡å—åŠŸèƒ½ å°½é‡çš„é™æ€åŒ–)</p>
</li>
</ul>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;statï¼Œexutï¼ŒreadFile&#125; <span class="keyword">from</span> <span class="string">'fs'</span></span><br></pre></td></tr></table></figure>
<p> Es6æ¨¡å—æ˜¯ç¼–è¯‘æ—¶åŠ è½½<br> ES6çš„æ¨¡å—è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">f</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"> <span class="keyword">export</span> &#123;f&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;lastName <span class="keyword">as</span> surname&#125; <span class="keyword">from</span> <span class="string">'./profile'</span></span><br><span class="line"><span class="keyword">import</span>å‘½ä»¤å…·æœ‰æå‡æ•ˆæœ</span><br></pre></td></tr></table></figure>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">å¯¼å‡º</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span></span><br><span class="line"></span><br><span class="line">å¼•å…¥</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">'./circle'</span>; æ¨¡å—çš„æ•´ä½“åŠ è½½</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨importå‘½ä»¤çš„æ—¶å€™ç”¨æˆ·ä¸éœ€è¦çŸ¥é“æ‰€åŠ è½½çš„å˜é‡åæˆ–è€…å‡½æ•°å ç”¨è¿™ä¸ªè¯­æ³•å¯ä»¥ä¸ºæ¨¡å—æŒ‡å®šé»˜è®¤è¾“å‡º</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p> å¼•å…¥çš„æ—¶å€™importå¯ä»¥ä¸ºè¯¥åŒ¿åå‡½æ•°æŒ‡å®šä»»æ„çš„åå­—ï¼Œè¿™ä¸ªæ—¶å€™import çš„åé¢ä¸ä½¿ç”¨å¤§æ‹¬å·</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> customName <span class="keyword">from</span>  ..</span><br><span class="line"></span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">ee</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</span><br><span class="line">&#125;</span><br><span class="line">==</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'ee'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> foo;</span><br></pre></td></tr></table></figure>
<p> fooçš„å‡½æ•°åfoo åœ¨æ¨¡å—å¤–éƒ¨æ—¶æ— æ•ˆçš„ è§†åŒåŒ¿åå‡½æ•°åŠ è½½</p>
<p> ä½¿ç”¨exportæ—¶ï¼Œå¯¹åº”çš„importè¯­å¥éœ€è¦ä½¿ç”¨å¤§æ‹¬å·ã€‚</p>
<p> ä½¿ç”¨ export default  å¯¹åº”çš„importè¯­å¥ä¸éœ€è¦å¤§æ‹¬å·</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// ç¬¬ä¸€ç»„</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">crc32</span>(<span class="params"></span>) </span>&#123; <span class="comment">// è¾“å‡º</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> crc32 <span class="keyword">from</span> <span class="string">'crc32'</span>; <span class="comment">// è¾“å…¥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> xxx &#125; <span class="keyword">from</span> <span class="string">'modules'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒç»„</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">crc32</span>(<span class="params"></span>) </span>&#123; <span class="comment">// è¾“å‡º</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;crc32&#125; <span class="keyword">from</span> <span class="string">'crc32'</span>; <span class="comment">// è¾“å…¥</span></span><br></pre></td></tr></table></figure>
<p>æœ¬è´¨ä¸Šï¼Œexport defaultå°±æ˜¯è¾“å‡ºä¸€ä¸ªå«åšdefaultçš„å˜é‡æˆ–æ–¹æ³•ï¼Œç„¶åç³»ç»Ÿå…è®¸ä½ ä¸ºå®ƒå–ä»»æ„åå­—ã€‚æ‰€ä»¥ï¼Œä¸‹é¢çš„å†™æ³•æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<p>import { default as xxx } from â€˜modulesâ€™</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> &#123;<span class="builtin-name">add</span> as default&#125;;</span><br></pre></td></tr></table></figure>
<p>// ç­‰åŒäº</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">// <span class="keyword">export</span> <span class="keyword">default</span> add;</span><br></pre></td></tr></table></figure>
<p>ES6æ¨¡å—</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span> <span class="attr">src</span>=<span class="string">"foo.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>éƒ½æ˜¯å¼‚æ­¥åŠ è½½ï¼Œä¸ä¼šé€ æˆå µå¡æµè§ˆå™¨ï¼Œå³ç­‰åˆ°æ•´ä¸ªé¡µé¢æ¸²æŸ“å®Œï¼Œå†æ‰§è¡Œæ¨¡å—è„šæœ¬ï¼Œç­‰åŒäºæ‰“å¼€äº†<script>æ ‡ç­¾çš„deferå±æ€§ã€‚</p>
<p>æ‹·è´æ•°ç»„</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">const</span> <span class="keyword">itemCopy </span>= []<span class="comment">;</span></span><br><span class="line"><span class="symbol">const</span> <span class="keyword">item </span>= [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">itemCopy </span>= [...<span class="keyword">item]</span></span><br><span class="line"><span class="keyword">console.log(itemCopy)</span></span><br></pre></td></tr></table></figure>
</script></p>]]></content>
      <tags>
        <tag>js</tag>
        <tag>es6</tag>
      </tags>
  </entry>
  <entry>
    <title>Expressæ¡†æ¶ç³»åˆ—(ä¸€)ä¹‹æ¦‚è¿°</title>
    <url>/2017/04/17/Express%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97(%E4%B8%80)%E4%B9%8B%E6%A6%82%E8%BF%B0/</url>
    <content><![CDATA[<p>å‚è€ƒæ–‡æ¡£ï¼š<a href="http://javascript.ruanyifeng.com/nodejs/express.html" target="_blank" rel="noopener">http://javascript.ruanyifeng.com/nodejs/express.html</a><br>Expressæ˜¯ç›®å‰æœ€æµè¡Œçš„åŸºäºNode.jsçš„Webå¼€å‘æ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ã€‚</p>
<p>åˆ›å»ºæµ‹è¯•é¡¹ç›®<br><code>mkdir hello-world</code></p>
<p>è¿›å…¥è¯¥ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"hello-world"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"hello world test app"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"0.0.1"</span>,</span><br><span class="line">  <span class="attr">"private"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"express"</span>: <span class="string">"4.x"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®‰è£… express<br><code>npm install</code><br>æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä»¥åï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªå¯åŠ¨æ–‡ä»¶ï¼Œå‡å®šå«åš<code>index.jsã€‚</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="keyword">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.<span class="keyword">use</span>(express.<span class="keyword">static</span>(__dirname + <span class="string">'/public'</span>));</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">8080</span>);</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œå¯åŠ¨è„šæœ¬<br><code>node index</code><br>è®¿é—® <a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a><br>å®ƒä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å½“å‰ç›®å½•çš„<strong>public</strong>å­ç›®å½•ï¼ˆä¸¥æ ¼æ¥è¯´ï¼Œæ˜¯æ‰“å¼€publicç›®å½•çš„index.htmlæ–‡ä»¶ï¼‰ã€‚å¦‚æœpublicç›®å½•ä¹‹ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶my_image.pngï¼Œé‚£ä¹ˆå¯ä»¥ç”¨<a href="http://localhost:8080/my_image.pngè®¿é—®è¯¥æ–‡ä»¶ã€‚" target="_blank" rel="noopener">http://localhost:8080/my_image.pngè®¿é—®è¯¥æ–‡ä»¶ã€‚</a></p>
<p>ç›®å½•ç»“æ„<br><img src="media/14906850474605/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-28%20%E4%B8%8B%E5%8D%883.55.13.png" alt="å±å¹•å¿«ç…§ 2017-03-28 ä¸‹åˆ3.55.13"></p>
<p>æ‰§è¡Œç»“æœ<br><img src="media/14906850474605/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-28%20%E4%B8%8B%E5%8D%883.54.14.png" alt="å±å¹•å¿«ç…§ 2017-03-28 ä¸‹åˆ3.54.14"><br>ä¹Ÿå¯ä»¥<a href="http://localhost:8080/WX.jpeg" target="_blank" rel="noopener">http://localhost:8080/WX.jpeg</a></p>
<p>ä¹Ÿå¯ä»¥ç”ŸæˆåŠ¨æ€ç½‘é¡µ</p>
<figure class="highlight plain"><figcaption><span>express </span></figcaption><table><tr><td class="code"><pre><span class="line">var app = express();</span><br><span class="line">app.get(&apos;/&apos;, function (req, res) &#123;</span><br><span class="line">  res.send(&apos;Hello world!&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">app.listen(3000);</span><br></pre></td></tr></table></figure>
<p> è¿è¡Œå¯åŠ¨è„šæœ¬<br><code>node index</code></p>
<p><img src="media/14906850474605/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-03-28%20%E4%B8%8B%E5%8D%883.57.07.png" alt="å±å¹•å¿«ç…§ 2017-03-28 ä¸‹åˆ3.57.07"></p>
<p>å¯åŠ¨è„šæœ¬index.jsçš„<strong>app.get</strong>æ–¹æ³•ï¼Œç”¨äºæŒ‡å®šä¸åŒçš„è®¿é—®è·¯å¾„æ‰€å¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œè¿™å«åšâ€œ<strong>è·¯ç”±</strong>â€ï¼ˆroutingï¼‰ã€‚ä¸Šé¢ä»£ç åªæŒ‡å®šäº†æ ¹ç›®å½•çš„å›è°ƒå‡½æ•°ï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªè·¯ç”±è®°å½•ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¯èƒ½æœ‰å¤šä¸ªè·¯ç”±è®°å½•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.send(<span class="string">'Hello world!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">'/customer'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.send(<span class="string">'customer page'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">'/admin'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.send(<span class="string">'admin page'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>æ¯”è¾ƒåºå¤§çš„æ—¶å€™å¯ä»¥å•ç‹¬å­˜æ”¾<br>egï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// routes/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">app</span>) </span>&#123;</span><br><span class="line">  app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">'Hello world'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  app.get(<span class="string">'/customer'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.send(<span class="string">'customer page'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  app.get(<span class="string">'/admin'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.send(<span class="string">'admin page'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>åŸå…ˆçš„indexå¼•å…¥</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"><span class="keyword">var</span> routes = <span class="built_in">require</span>(<span class="string">'./routes'</span>)(app);</span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>DomContentLoaded ä¸ load</title>
    <url>/2018/03/30/DomContentLoaded%20%E4%B8%8E%20load/</url>
    <content><![CDATA[<h2 id="æµè§ˆå™¨æ¸²æŸ“åŸç†"><a href="#æµè§ˆå™¨æ¸²æŸ“åŸç†" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“åŸç†"></a>æµè§ˆå™¨æ¸²æŸ“åŸç†</h2><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line">å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨åœ°å€è¾“å…¥<span class="built_in">url</span>æ—¶ï¼Œæµè§ˆå™¨ä¼šå‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†è¯·æ±‚çš„htmlæ–‡æ¡£å‘é€å›æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°†æ–‡æ¡£ä¸‹è½½ä¸‹æ¥å ä¾¿å¼€å§‹ä»ä¸Šåˆ°ä¸‹è§£æï¼Œè§£æå®Œæˆå ä¼šç”Ÿæˆdomï¼Œå¦‚æœé¡µé¢ä¸­æœ‰css ä¼šæ ¹æ®cssçš„å†…å®¹ å½¢æˆcssdom ç„¶å domå’Œcssä¼šç”Ÿæˆä¸€ä¸ªæ¸²æŸ“æ ‘ æœ€åæµè§ˆå™¨ä¼šæ ¹æ®æ¸²æŸ“æ ‘çš„å†…å®¹è®¡ç®—å‡ºå„ä¸ªèŠ‚ç‚¹åœ¨é¡µé¢ä¸­çš„ç¡®åˆ‡å¤§å°å’Œä½ç½®ï¼Œå¹¶å°†å…¶ç»˜åˆ¶åœ¨æµè§ˆå™¨ä¸Š</span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/746387-20170407181220066-2064922697.png" alt></p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">åœ¨è§£æhtmlçš„è¿‡ç¨‹ä¸­ æœ‰æ—¶å€™è§£æä¼šè¢«ä¸­æ–­ï¼Œè¿™æ˜¯å› ä¸º<span class="keyword">javascriptä¼šé˜»å¡domçš„è§£æ </span>å½“è§£æè¿‡ç¨‹ä¸­é‡åˆ°<span class="keyword">scriptæ ‡ç­¾çš„æ—¶å€™ </span>ä¾¿ä¼šåœæ­¢è§£æè¿‡ç¨‹ æŠ“è½¬è€Œå»å¤„ç†è„šæœ¬ å¦‚æœè„šæœ¬æ˜¯å†…è”çš„ æµè§ˆå™¨ä¼šå…ˆå»æ‰§è¡Œè¿™æ®µå†…è”çš„è„šæœ¬ï¼Œå¦‚æœè„šæœ¬æ˜¯å¤–é“¾çš„  é‚£ä¹ˆå…ˆå»åŠ è½½è„šæœ¬ ç„¶åæ‰§è¡Œ åœ¨å¤„ç†å®Œè„šæœ¬ä¹‹å  æµè§ˆå™¨ä¾¿ç»§ç»­è§£æhtmlæ–‡æ¡£</span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•è®¡ç®—DomContentLoaded-åŠ è½½æ—¶é—´"><a href="#å¦‚ä½•è®¡ç®—DomContentLoaded-åŠ è½½æ—¶é—´" class="headerlink" title="å¦‚ä½•è®¡ç®—DomContentLoaded åŠ è½½æ—¶é—´"></a>å¦‚ä½•è®¡ç®—DomContentLoaded åŠ è½½æ—¶é—´</h3><p>å½“æ–‡æ¡£ä¸­æ²¡æœ‰è„šæœ¬æ—¶ æµè§ˆå™¨è§£æå®Œæˆæ–‡æ¡£ä¾¿èƒ½è§¦å‘ DomContentLoaded äº‹ä»¶ å¦‚æœæ–‡æ¡£åŒ…å«è„šæœ¬ åˆ™è„šæœ¬ä¼šé˜»å¡æ–‡æ¡£çš„è§£æ è€Œè„šæœ¬éœ€è¦ç­‰ä½äºå‰é¢çš„cssåŠ è½½å®Œæ‰èƒ½æ‰§è¡Œ åœ¨ä»»ä½•æƒ…å†µä¸‹  DomContentLoaded çš„è§¦å‘ä¸éœ€è¦ç­‰å¾…å›¾ç‰‡ç­‰å…¶ä»–èµ„æºåŠ è½½å®Œæˆ</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">DOMContentLoadedä¸åŒçš„æµè§ˆå™¨å¯¹å…¶æ”¯æŒä¸åŒï¼Œæ‰€ä»¥åœ¨å®ç°çš„æ—¶å€™æˆ‘ä»¬éœ€è¦åšä¸åŒæµè§ˆå™¨çš„å…¼å®¹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼‰æ”¯æŒDOMContentLoadedäº‹ä»¶çš„ï¼Œå°±ä½¿ç”¨DOMContentLoadedäº‹ä»¶ï¼›</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ï¼‰IE6ã€IE7ä¸æ”¯æŒDOMContentLoadedï¼Œä½†å®ƒæ”¯æŒonreadystatechangeäº‹ä»¶ï¼Œè¯¥äº‹ä»¶çš„ç›®çš„æ˜¯æä¾›ä¸æ–‡æ¡£æˆ–å…ƒç´ çš„åŠ è½½çŠ¶æ€æœ‰å…³çš„ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>) æ›´ä½çš„ieè¿˜æœ‰ä¸ªç‰¹æœ‰çš„æ–¹æ³•doScrollï¼Œ é€šè¿‡é—´éš”è°ƒç”¨ï¼šdocument.documentElement.doScroll(<span class="string">"left"</span>);</span><br><span class="line">å¯ä»¥æ£€æµ‹DOMæ˜¯å¦åŠ è½½å®Œæˆã€‚ å½“é¡µé¢æœªåŠ è½½å®Œæˆæ—¶ï¼Œè¯¥æ–¹æ³•ä¼šæŠ¥é”™ï¼Œç›´åˆ°doScrollä¸å†æŠ¥é”™æ—¶ï¼Œå°±ä»£è¡¨DOMåŠ è½½å®Œæˆäº†ã€‚è¯¥æ–¹æ³•æ›´æ¥è¿‘DOMContentLoadedçš„å®ç°ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•è®¡ç®—load-åŠ è½½æ—¶é—´"><a href="#å¦‚ä½•è®¡ç®—load-åŠ è½½æ—¶é—´" class="headerlink" title="å¦‚ä½•è®¡ç®—load åŠ è½½æ—¶é—´"></a>å¦‚ä½•è®¡ç®—load åŠ è½½æ—¶é—´</h3><p>é¡µé¢ä¸Šæ‰€æœ‰çš„èµ„æºï¼ˆå›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ç­‰ï¼‰è¢«åŠ è½½ä»¥åæ‰ä¼šè§¦å‘loadäº‹ä»¶ï¼Œç®€å•æ¥è¯´ï¼Œé¡µé¢çš„loadäº‹ä»¶ä¼šåœ¨DOMContentLoadedè¢«è§¦å‘ä¹‹åæ‰è§¦å‘ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†CSSæ”¾åœ¨å¤´éƒ¨-å°†jsæ”¾åœ¨å°¾éƒ¨"><a href="#æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†CSSæ”¾åœ¨å¤´éƒ¨-å°†jsæ”¾åœ¨å°¾éƒ¨" class="headerlink" title="æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†CSSæ”¾åœ¨å¤´éƒ¨ å°†jsæ”¾åœ¨å°¾éƒ¨"></a>æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸€å†å¼ºè°ƒå°†CSSæ”¾åœ¨å¤´éƒ¨ å°†jsæ”¾åœ¨å°¾éƒ¨</h3><p>å› ä¸ºæµè§ˆå™¨ç”ŸæˆDomæ ‘çš„æ—¶å€™æ˜¯ä¸€è¡Œä¸€è¡Œè¯»htmlä»£ç çš„  scriptæ ‡ç­¾æ”¾åœ¨æœ€åé¢å°±ä¸ä¼šå½±å“å‰é¢çš„é¡µé¢æ¸²æŸ“ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†<br>æ—¢ç„¶Domæ ‘å®Œå…¨ç”Ÿæˆå¥½é¡µé¢æ‰èƒ½æ¸²æŸ“å‡ºæ¥ æµè§ˆå™¨åˆå¿…é¡»è¯»å®Œå…¨éƒ¨çš„htmlæ‰èƒ½ç”Ÿæˆå®Œæˆçš„domæ ‘ scriptæ ‡ç­¾æ”¾ä¸æ”¾åœ¨åº•éƒ¨æ˜¯ä¸æ˜¯ä¹Ÿä¸€æ · å› ä¸ºdomæ ‘çš„ç”Ÿæˆéœ€è¦æ•´ä¸ªæ–‡æ¡£è§£æå®Œæˆ</p>
<font color="red">chromeé¡µé¢æ¸²æŸ“è¿‡ç¨‹ä¸­ ä¼šæœ‰ firstpaintçš„æ¦‚å¿µï¼Œç°ä»£æµè§ˆå™¨ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæ¸²æŸ“å¼•æ“å°†å°è¯•å°½å¿«åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å†…å®¹ ä»–ä¸ä¼šç­‰åˆ°æ‰€æœ‰çš„htmlè§£æå®Œæˆæ‰å¼€å§‹æ„å»ºå’Œå¸ƒå±€domæ ‘ éƒ¨åˆ†çš„å†…å®¹è¢«è§£æå¹¶å±•ç¤º ä¹Ÿå°±æ˜¯è¯´ æµè§ˆå™¨èƒ½å¤Ÿæ¸²æŸ“ä¸å®Œæ•´çš„domæ ‘å’Œcssdom å°½å¿«çš„å‡å°‘ç™½å±æ—¶é—´<br></font>

<p>å‡å¦‚æˆ‘ä»¬å°†jsæ”¾åœ¨header jså°†ä¼šé˜»å¡è§£ædom domçš„å†…å®¹ä¼šå½±å“åˆ° firstpaint å¯¼è‡´firstpaintå»¶å æ‰€ä»¥è¯´æˆ‘ä»¬ä¼šå°†jsæ”¾åœ¨åé¢ ä»¥å‡å°‘firstpaintæ—¶é—´ä½†æ˜¯ä¸ä¼šå‡å°‘ DomContentLoaded è¢«è§¦å‘çš„æ—¶é—´</p>
]]></content>
      <categories>
        <category>web</category>
      </categories>
  </entry>
  <entry>
    <title>Expressæ¡†æ¶ç³»åˆ—(ä¸‰)ä¹‹æ–¹æ³•</title>
    <url>/2018/04/18/Express%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97(%E4%B8%89)%E4%B9%8B%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h3 id="allæ–¹æ³•å’ŒHTTPåŠ¨è¯æ–¹æ³•"><a href="#allæ–¹æ³•å’ŒHTTPåŠ¨è¯æ–¹æ³•" class="headerlink" title="allæ–¹æ³•å’ŒHTTPåŠ¨è¯æ–¹æ³•"></a>allæ–¹æ³•å’ŒHTTPåŠ¨è¯æ–¹æ³•</h3><p>é’ˆå¯¹ä¸åŒçš„è¯·æ±‚ï¼ŒExpressæä¾›äº†useæ–¹æ³•çš„ä¸€äº›åˆ«åã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¹Ÿå¯ä»¥ç”¨åˆ«åçš„å½¢å¼æ¥å†™ã€‚</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">var express = require(<span class="string">"express"</span>);</span><br><span class="line">var http = require(<span class="string">"http"</span>);</span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">app.all(<span class="string">"*"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>, <span class="keyword">next</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  <span class="keyword">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="keyword">get</span>(<span class="string">"/"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"Welcome to the homepage!"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="keyword">get</span>(<span class="string">"/about"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"Welcome to the about page!"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="keyword">get</span>(<span class="string">"*"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"404!"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">http.createServer(app).listen(<span class="number">1337</span>);</span><br></pre></td></tr></table></figure>
<p>é™¤äº†getæ–¹æ³•ä»¥å¤–ï¼ŒExpressè¿˜æä¾›postã€putã€deleteæ–¹æ³•ï¼Œå³HTTPåŠ¨è¯éƒ½æ˜¯Expressçš„æ–¹æ³•ï¼Œexpresså…è®¸æ¨¡å¼åŒ¹é…</p>
<h3 id="setæ–¹æ³•"><a href="#setæ–¹æ³•" class="headerlink" title="setæ–¹æ³•"></a>setæ–¹æ³•</h3><p>ç”¨äºæŒ‡å®šå˜é‡çš„å€¼</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">app.<span class="built_in">set</span>(<span class="string">'views'</span>,<span class="variable">_dirname</span>+<span class="string">'/views'</span>)</span><br><span class="line">app.<span class="built_in">set</span>(<span class="string">"view engine"</span>, <span class="string">"jade"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="response-å¯¹è±¡"><a href="#response-å¯¹è±¡" class="headerlink" title="response å¯¹è±¡"></a>response å¯¹è±¡</h3><p>response.redirect()å…è®¸ç½‘å€çš„é‡å®šå‘<br><code>response.redirect(&quot;/hello/anime&quot;);</code></p>
<p>response.sendFile()ç”¨äºå‘é€æ–‡ä»¶<br><code>response.sendFile(&quot;/path/to/anime.mp4&quot;)</code></p>
<p>response.render() ç”¨äºæ¸²æŸ“ç½‘é¡µæ¨¡ç‰ˆ</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">app.<span class="keyword">get</span>(<span class="string">"/"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.render(<span class="string">"index"</span>, &#123; message: <span class="string">"Hello World"</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨renderæ–¹æ³•ï¼Œå°†messageå˜é‡ä¼ å…¥indexæ¨¡ç‰ˆï¼Œæ¸²æŸ“æˆHTMLç½‘é¡µ</p>
<h3 id="requestå¯¹è±¡"><a href="#requestå¯¹è±¡" class="headerlink" title="requestå¯¹è±¡"></a>requestå¯¹è±¡</h3><p>request.ip:ç”¨äºè·å–HTTPè¯·æ±‚çš„IPåœ°å€<br>request.files ç”¨äºè·å–ä¸Šä¼ çš„æ–‡ä»¶</p>
<h3 id="æ­å»ºHTTPSæœåŠ¡å™¨"><a href="#æ­å»ºHTTPSæœåŠ¡å™¨" class="headerlink" title="æ­å»ºHTTPSæœåŠ¡å™¨"></a>æ­å»º<a href="http://baike.baidu.com/link?url=RDLn4MhlPev2MMCPjJvGa0aEf2Fg2DzGyz-Eqo7AwmYdYDjPTvyZuku-svVMjAlHcvsZm9PQ4bGPcjFW7VPcDK" target="_blank" rel="noopener">HTTPS</a>æœåŠ¡å™¨</h3><p>ä½¿ç”¨expressæ­å»ºhttpsåŠ å¯†æœåŠ¡å™¨</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">  key: fs.readFileSync(<span class="string">'E:/ssl/myserver.key'</span>),</span><br><span class="line">  cert: fs.readFileSync(<span class="string">'E:/ssl/myserver.crt'</span>),</span><br><span class="line">  passphrase: <span class="string">'1234'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>);</span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">  res.send(<span class="string">'Hello World Expressjs'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> server = https.createServer(options, app);</span><br><span class="line">server.listen(<span class="number">8084</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>Expressæ¡†æ¶ç³»åˆ—(äºŒ)ä¹‹è¿è¡ŒåŸç†</title>
    <url>/2017/04/18/Express%E6%A1%86%E6%9E%B6%E7%B3%BB%E5%88%97(%E4%BA%8C)%E4%B9%8B%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86/</url>
    <content><![CDATA[<h3 id="åº•å±‚HTTPæ¨¡å—"><a href="#åº•å±‚HTTPæ¨¡å—" class="headerlink" title="åº•å±‚HTTPæ¨¡å—"></a>åº•å±‚HTTPæ¨¡å—</h3><p>Expressæ¡†æ¶å»ºç«‹åœ¨node.jså†…ç½®çš„httpæ¨¡å—ä¸Šï¼Œ<strong>æ¡†æ¶çš„æ ¸å¿ƒæ˜¯å¯¹HTTPæ¨¡å—çš„å†åŒ…è£…</strong><br>httpæ¨¡å—ç”ŸæˆæœåŠ¡å™¨çš„åŸå§‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">  response.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>&#125;);</span><br><span class="line">    response.end(<span class="string">" express hahahah"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">4040</span>, <span class="string">"localhost"</span>);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç å…³é”®æ˜¯httpæ¨¡å—çš„<strong>createServer</strong>æ–¹æ³•ï¼Œè¡¨ç¤ºç”Ÿæˆä¸€ä¸ªhttpæœåŠ¡å™¨å®ä¾‹ï¼Œè¯¥æ–¹æ³•æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨HTTPè¯·æ±‚å’ŒHTTPå“åº”çš„<strong>request</strong>å¯¹è±¡å’Œ<strong>response</strong>å¯¹è±¡</p>
<p><img src="http://oucjferwh.bkt.clouddn.com/node2-1.png" alt></p>
<p>ä¸Šé¢çš„ä»£ç ç”¨Expressæ”¹å†™å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">var</span> app = express();</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.send(<span class="string">'Hello world!'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">7000</span>);</span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/node2-2.png" alt></p>
<p>å¯ä»¥å‘ç°ä¸¤ç«¯ä»£ç ç‰¹åˆ«ç›¸ä¼¼ï¼ŒåŸæ¥æ˜¯ç”¨http.createServeræ–¹æ³•æ–°å»ºä¸€ä¸ªappå®ä¾‹ï¼Œç°åœ¨åˆ™æ˜¯ç”¨Expressçš„æ„é€ æ–¹æ³•ï¼Œç”Ÿæˆä¸€ä¸ªEpresså®ä¾‹ï¼Œä¸¤ç§æ–¹æ³•çš„å›è°ƒå‡½æ•°éƒ½æ˜¯ç›¸åŒçš„ï¼Œ<br>Expressç­‰äºåœ¨HTTPæ¨¡å—ä¹‹ä¸Šï¼ŒåŠ äº†ä¸€ä¸ª<strong>ä¸­é—´å±‚</strong></p>
<h3 id="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"><a href="#ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"></a>ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</h3><p>ä¸­é—´ä»¶å°±æ˜¯å¤„ç†HTTPè¯·æ±‚çš„å‡½æ•°ï¼Œ<br>ç‰¹ç‚¹ï¼šä¸€ä¸ªä¸­é—´ä»¶å¤„ç†å®Œå†ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼ŒAPPå®ä¾‹åœ¨è¿è¡Œä¸­ä¼šè°ƒç”¨ä¸€ç³»åˆ—çš„ä¸­é—´ä»¶</p>
<p>æ¯ä¸ªä¸­é—´ä»¶å¯ä»¥ä»APPå®ä¾‹æ¥æ”¶ä¸‰ä¸ªå‚æ•° request(ä»£è¡¨HTTPè¯·æ±‚)ï¼Œresponse(ä»£è¡¨HTTPå“åº”),nextå›è°ƒå‡½æ•°(ä»£è¡¨ä¸‹ä¸€ä¸ªä¸­é—´ä»¶)ï¼Œæ¯ä¸€ä¸ªä¸­é—´ä»¶éƒ½å¯ä»¥å¯¹HTTPè¯·æ±‚(requestå¯¹è±¡)è¿›è¡ŒåŠ å·¥ï¼Œå¹¶ä¸”å†³å®šæ˜¯å¦è°ƒç”¨nextæ–¹æ³•ï¼Œå°†requestå¯¹è±¡å†ä¼ ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</p>
<p>æœ€ç®€å•çš„ä¸­é—´ä»¶</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uselessMiddleware</span><span class="params">(req,res,next)</span></span>&#123;</span><br><span class="line"><span class="built_in">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ä¸Šé¢ä»£ç çš„<span class="built_in">next</span>å°±æ˜¯ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚å¦‚æœå®ƒå¸¦æœ‰å‚æ•°ï¼Œåˆ™ä»£è¡¨æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå‚æ•°ä¸ºé”™è¯¯æ–‡æœ¬ã€‚</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uselessMiddleware</span><span class="params">(req, res, next)</span></span> &#123;</span><br><span class="line">  <span class="built_in">next</span>(<span class="string">'å‡ºé”™äº†ï¼'</span>);</span><br><span class="line">&#125;</span><br><span class="line">æŠ›å‡ºé”™è¯¯ä»¥åï¼Œåé¢çš„ä¸­é—´ä»¶å°†ä¸å†æ‰§è¡Œï¼Œç›´åˆ°å‘ç°ä¸€ä¸ªé”™è¯¯å¤„ç†å‡½æ•°ä¸ºæ­¢ã€‚</span><br></pre></td></tr></table></figure>
<h5 id="useæ–¹æ³•"><a href="#useæ–¹æ³•" class="headerlink" title="useæ–¹æ³•"></a>useæ–¹æ³•</h5><p>useæ˜¯expressæ³¨å†Œä¸­é—´ä»¶çš„æ–¹æ³•ï¼Œä½¿ç”¨app.useæ–¹æ³•ï¼Œæ³¨å†Œäº†ä¸¤ä¸ªä¸­é—´ä»¶ï¼Œæ”¶åˆ°HTTPè¯·æ±‚åï¼Œå…ˆè°ƒç”¨ç¬¬ä¸€ä¸ªä¸­é—´ä»¶ï¼Œæ ¹æ®next()ç¡®å®šæ˜¯å¦æŠŠrequestå¯¹è±¡ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">var express = require(<span class="string">"express"</span>);</span><br><span class="line">var http = require(<span class="string">"http"</span>);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>, <span class="keyword">next</span>) &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="string">"In comes a "</span> + <span class="built_in">request</span>.method + <span class="string">" to "</span> + <span class="built_in">request</span>.url);</span><br><span class="line">  <span class="keyword">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"Hello world!\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">http.createServer(app).listen(<span class="number">1337</span>);</span><br></pre></td></tr></table></figure>
<p>useæ–¹æ³•å†…éƒ¨é€šè¿‡<code>request.url</code>çš„å±æ€§å¯ä»¥æ ¹æ®è®¿é—®è·¯å¾„è¿›è¡Œåˆ¤æ–­ï¼Œæ®æ­¤å°±èƒ½å®ç°ç®€å•çš„è·¯ç”±ï¼Œ</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">var express = require(<span class="string">"express"</span>);</span><br><span class="line">var http = require(<span class="string">"http"</span>);</span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">function</span>(<span class="built_in">request</span>,<span class="built_in">response</span>,<span class="keyword">next</span>)&#123;</span><br><span class="line">     <span class="keyword">if</span>(<span class="built_in">request</span>.url == <span class="string">"/"</span>)&#123;</span><br><span class="line">    <span class="built_in">response</span>.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">    <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"Welcome to the homepage!\n"</span>);</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">next</span>();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>, <span class="keyword">next</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">request</span>.url == <span class="string">"/about"</span>) &#123;</span><br><span class="line">    <span class="built_in">response</span>.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">app.use(<span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.writeHead(<span class="number">404</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"404 error!\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">http.createServer(app).listen(<span class="number">1337</span>);</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ä¸€ç§æ¯”è¾ƒæ¸…æ™°çš„æ–¹å¼ï¼ˆä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œåªå¯¹æ ¹ç›®å½•çš„è¯·æ±‚ï¼Œè°ƒç”¨æŸä¸ªä¸­é—´ä»¶ã€‚<br>ï¼‰<br><code>app.use(&#39;/path&#39;, someMiddleware);</code><br>æŒ‰ç…§è¿™ä¸ªæ€æƒ³ï¼Œæ”¹é€ ä¸­é—´ä»¶</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">var express = require(<span class="string">"express"</span>);</span><br><span class="line">var http = require(<span class="string">"http"</span>);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">"/home"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>, <span class="keyword">next</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"Welcome to the homepage!\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">"/about"</span>, <span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>, <span class="keyword">next</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.writeHead(<span class="number">200</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"Welcome to the about page!\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">function</span>(<span class="built_in">request</span>, <span class="built_in">response</span>) &#123;</span><br><span class="line">  <span class="built_in">response</span>.writeHead(<span class="number">404</span>, &#123; <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span> &#125;);</span><br><span class="line">  <span class="built_in">response</span>.<span class="keyword">end</span>(<span class="string">"404 error!\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">http.createServer(app).listen(<span class="number">1337</span>);</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>é¢å‘æœªæ¥çš„API-GraphQL</title>
    <url>/2019/12/23/GraphQL/</url>
    <content><![CDATA[<h1 id="å¼€ç¯‡"><a href="#å¼€ç¯‡" class="headerlink" title="å¼€ç¯‡"></a>å¼€ç¯‡</h1><p>ä½ æœ‰æ²¡æœ‰é‡åˆ°ä»¥ä¸‹é—®é¢˜</p>
<ul>
<li>å­—æ®µå†—ä½™</li>
</ul>
<p><img src="http://cdn.anruence.com/%E7%A3%90%E7%9F%B3%E6%95%B0%E6%8D%AE.png" alt="image"></p>
<ul>
<li>è‹¥å¹²ä¸ªä¸å¾—ä¸å‘çš„HTTPè¯·æ±‚</li>
</ul>
<p><img src="http://cdn.anruence.com/graphql1.png" alt="image"></p>
<p>å‘ç”Ÿè¿™äº›ï¼Œå¹¶ä¸æ˜¯å‰ç«¯eræœ¬æ„ï¼Œä½†æ˜¯åˆè¦æ‰¿æ‹…è¯¸å¦‚é¡µé¢æ¸²æŸ“æ…¢ç­‰å‰¯ä½œç”¨è€Œè¢«ç”¨æˆ·è¯Ÿç—…<br>ç©¶å…¶åŸå› ï¼Œæ˜¯å‰ç«¯åœ¨æ•°æ®å±‚é¢æ²¡æœ‰ä¸»åŠ¨æƒ</p>
<p>é’ˆå¯¹ä½†ä¸é™äºä»¥ä¸Šç§ç§<br>æˆ‘ä»¬éœ€è¦ä»¥å‰ç«¯çš„è®¾è®¡è€…å’Œå¼€å‘è€…çš„è§’åº¦å‡ºå‘ è®¾è®¡æ–°çš„æ•°æ®æŸ¥è¯¢æ–¹å¼</p>
<p>Facebookå·¥ç¨‹å¸ˆç‡å…ˆæå‡ºRESTfulæ¶æ„ä½“ç³»çš„æ›¿ä»£æ–¹æ¡ˆ</p>
<p>å¹¶ä¸”åº”ç”¨åœ¨äº†å…¶åº”ç”¨ä¸­</p>
<p><a href="https://www.youtube.com/watch?v=WxPtYJRjLL0&amp;t=2s" target="_blank" rel="noopener">Facebook ä½¿ç”¨graphqlé‡æ„ä»–ä»¬çš„pcç«™</a></p>
<p>æ¥ä¸‹æ¥ è®©æˆ‘ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œç”±æµ…è‡³æ·±èŠèŠè¢«ç§°ä¹‹ä¸ºé¢å‘æœªæ¥çš„APIçš„-GraphQL</p>
<a id="more"></a>
<h1 id="æ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ"><a href="#æ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ" class="headerlink" title="æ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ"></a>æ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ</h1><p>æœ¬æ–‡ä¸»è¦ä»‹ç»æ¥è§¦GraphQLè¿™æ®µæ—¶é—´ï¼Œè§‰å¾—å¿…é¡»è¦æŒæ¡çš„ä¸€äº›æ ¸å¿ƒ é€‚åˆä»¥ä¸‹äººç¾¤</p>
<ul>
<li>å®Œå…¨æ²¡å¬è¯´è¿‡GraphQL</li>
<li>å¬è¯´è¿‡GraphQLçš„è¯»è€…ï¼Œæƒ³æ·±å…¥äº†è§£ä¸€ä¸‹</li>
<li>æƒ³ç³»ç»Ÿåœ°å­¦ä¹ GraphQLçš„è¯»è€…</li>
<li>æ­£åœ¨è°ƒç ”GraphQLæŠ€æœ¯çš„è¯»è€…</li>
</ul>
<p>å¸®åŠ©ä½ å¯¹GraphQLå»ºç«‹ä¸€ä¸ªç»Ÿè§‚å…¨å±€çš„è®¤çŸ¥åŠåŸç†æ€§çš„è§£è¯»</p>
<p>ä½ å¯èƒ½ä¼šå¾—åˆ°ä»¥ä¸‹è§£ç­”</p>
<ul>
<li>é‡æ–°æ€è€ƒRESTful</li>
<li>what GraphQL</li>
<li>RESTful &amp; GraphQL</li>
<li>how GraphQL</li>
<li>GraphQLç»„æˆé“¾è·¯</li>
<li>é˜»ç¢ä½ ä½¿ç”¨GraphQLçš„Nä¸ªé—®é¢˜</li>
<li>ç°æœ‰åº”ç”¨çš„æ¥å…¥æ–¹å¼</li>
<li>GraphQLä¸è¶³</li>
<li>åŸºäºGraphQLçš„ç¤¾åŒºè§£å†³æ–¹æ¡ˆ</li>
<li>å°ç»“</li>
</ul>
<h1 id="é‡æ–°æ€è€ƒRESTful"><a href="#é‡æ–°æ€è€ƒRESTful" class="headerlink" title="é‡æ–°æ€è€ƒRESTful"></a>é‡æ–°æ€è€ƒRESTful</h1><ul>
<li>æ¥å£æ•°è†¨èƒ€ï¼Œéœ€è‡ªè¡Œç»„åˆå¤šä¸ªæ¥å£æ‰èƒ½è·å–åˆ°å®Œæ•´çš„æ•°æ®ç»“æ„</li>
<li>APIæ–‡æ¡£æ›´æ–°ä¸åŠæ—¶ï¼Œè”è°ƒåŸºæœ¬é çŒœ</li>
<li>å®¢æˆ·ç«¯å¯¹æ¥å£æ•°æ®ç±»å‹æ ¡éªŒ</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">- é™¤äº†æœåŠ¡ç«¯è¦æ ¡éªŒå®¢æˆ·ç«¯ä¼ æ¥çš„å‚æ•°ï¼Œå®¢æˆ·ç«¯è‡ªå·±ä¹Ÿéœ€è¦å»æ ¡éªŒæœåŠ¡ç«¯è¿”å›çš„å‚æ•°</span><br><span class="line">- æ¯”å¦‚å®¢æˆ·ç«¯è¦çš„æ˜¯æ•°ç»„ï¼Œä½ æœ‰æ²¡æœ‰è¿”å›æ•°ç»„</span><br><span class="line">- éœ€è¦ä¾èµ–ç±»ä¼¼å‡º<span class="keyword">var</span> x = <span class="keyword">data</span>?(<span class="keyword">data</span>.obj?<span class="keyword">data</span>.obj.name:<span class="literal">null</span>):<span class="literal">null</span>å…¼å®¹</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¥å£å­—æ®µå†—ä½™ï¼Œç§»åŠ¨/PCéœ€æ±‚æ— æ³•æ»¡è¶³</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>å†—ä½™æ•°æ®çš„è¿”å›æµªè´¹äº†æµé‡</span><br><span class="line"><span class="bullet">- </span>æœåŠ¡ç«¯å†³å®šæœ‰å“ªäº›æ•°æ®è·å–æ–¹å¼ï¼Œå®¢æˆ·ç«¯åªèƒ½æŒ‘é€‰ä½¿ç”¨ï¼Œå¦‚æœæ•°æ®è¿‡äºå†—ä½™ä¹Ÿåªèƒ½é»˜é»˜æ¥æ”¶å†å¯¹æ•°æ®è¿›è¡Œå¤„ç†</span><br><span class="line"><span class="bullet">- </span>è€Œæ•°æ®ä¸èƒ½æ»¡è¶³éœ€æ±‚åˆ™éœ€è¦è¯·æ±‚æ›´å¤šçš„æ¥å£</span><br></pre></td></tr></table></figure>
<ul>
<li>å‰åç«¯å­—æ®µå‘½åè§„èŒƒä¸ä¸€è‡´ï¼Œ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¾èµ–æ•°æ®å±‚é€é‡è½¬æ¢</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»´æŠ¤å¤šç‰ˆæœ¬æ¥å£</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä»»ä½•çš„å˜åŠ¨éƒ½ä¼šè¢«è§†ä¸ºä¸€ç§ç ´åæ€§çš„æ”¹å˜ï¼Œè€Œç ´åæ€§æ”¹å˜å°±éœ€è¦æ›´æ–°APIçš„ç‰ˆæœ¬</span><br></pre></td></tr></table></figure>
<h2 id="æˆ‘çš„è¯‰æ±‚"><a href="#æˆ‘çš„è¯‰æ±‚" class="headerlink" title="æˆ‘çš„è¯‰æ±‚"></a>æˆ‘çš„è¯‰æ±‚</h2><ol>
<li>å¯ä¸å¯ä»¥å®¢æˆ·ç«¯è¦ä»€ä¹ˆå­—æ®µï¼ŒæœåŠ¡ç«¯å°±ç»™ä»€ä¹ˆå­—æ®µçš„å€¼ï¼Ÿ</li>
<li>å¯ä¸å¯ä»¥å®šä¹‰ä¸€ä¸ªè¿”å›æ•°æ®æ ¼å¼ä¸è¯·æ±‚çš„æ•°æ®æ ¼å¼çš„ä¸€ä¸ªå¼ºç±»å‹çš„çº¦æŸï¼Ÿ</li>
<li>èƒ½ä¸èƒ½å®¢æˆ·ç«¯å¯ä»¥é—®æœåŠ¡ç«¯è¦1ã€2ã€3è¿™äº›æ•°æ®ï¼ŒæœåŠ¡ç«¯ä¸€æ¬¡ç»™æˆ‘è¿”å›å°±è¡Œï¼Ÿ</li>
</ol>
<p>GraphQLçš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³RESTfulçš„ç—›ç‚¹</p>
<h1 id="what-GraphQL"><a href="#what-GraphQL" class="headerlink" title="what GraphQL"></a>what GraphQL</h1><p><a href="http://graphql.org" target="_blank" rel="noopener">GraphQlå®˜ç½‘</a></p>
<p><a href="https://graphql.cn/" target="_blank" rel="noopener">GraphQLä¸­æ–‡ç½‘</a></p>
<blockquote>
<p>å®ƒæ—¢æ˜¯ä¸€ç§ç”¨äº API çš„æŸ¥è¯¢è¯­è¨€(è§„èŒƒ) ä¹Ÿæ˜¯ä¸€ä¸ªæ»¡è¶³ä½ æ•°æ®æŸ¥è¯¢çš„è¿è¡Œæ—¶</p>
</blockquote>
<p>å¼ºç±»å‹å¯ä»¥åœ¨æŸ¥è¯¢æ‰§è¡Œä¹‹å‰è¿›è¡ŒéªŒè¯</p>
<p>ç”¨äºç»„ç»‡åº”ç”¨ç¨‹åºä¸­æ•°æ®çš„åˆ›å»ºï¼Œè¯»å–ï¼Œæ›´æ–°å’Œåˆ é™¤ï¼ˆæ˜¯çš„ï¼ŒCRUDï¼‰</p>
<p>è„‘è¢‹é‡Œå·¨å¤§çš„é—®å·â“ APIæ€ä¹ˆå°±å¯ä»¥æŸ¥è¯¢å‘¢ï¼Ÿ</p>
<p>è¿™æ­£æ˜¯å…¶å¼ºå¤§ä¹‹å¤„</p>
<blockquote>
<p>ask exactly what you want.</p>
</blockquote>
<ul>
<li>ç”¨å·²æœ‰çš„ä»£ç å’ŒæŠ€æœ¯æ¥è¿›è¡Œæ•°æ®æºç®¡ç†</li>
<li>å¯¹APIæ•°æ®æä¾›äº†ä¸€å¥—æ˜“äºç†è§£çš„å®Œæ•´æè¿°</li>
<li>éæ•°æ®åº“æŸ¥è¯¢è¯­è¨€ï¼Œä¸æ˜¯ä¸€é—¨è¯­è¨€/æ¡†æ¶ </li>
<li>ä¸ç»‘å®šä»»ä½•çš„æ•°æ®åº“æˆ–è€…å­˜å‚¨å¼•æ“</li>
<li>ä½¿å¾—å®¢æˆ·ç«¯èƒ½æŒ‰éœ€è·å–æ•°æ®ï¼Œæ— å†—ä½™</li>
<li>è®©APIæ›´å®¹æ˜“éšç€æ—¶é—´æ¨ç§»è€Œæ¼”è¿›</li>
<li>GraphQL = Graph (å›¾è¡¨åŒ–/å¯è§†åŒ–)+ QL (æŸ¥è¯¢è¯­è¨€)</li>
<li>æ˜¯ä¸€ç§æè¿°å®¢æˆ·ç«¯å¦‚ä½•å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®çš„APIè¯­æ³•</li>
</ul>
<h1 id="RESTful-amp-GraphQL"><a href="#RESTful-amp-GraphQL" class="headerlink" title="RESTful &amp; GraphQL"></a>RESTful &amp; GraphQL</h1><h2 id="èµ„æºè·å–"><a href="#èµ„æºè·å–" class="headerlink" title="èµ„æºè·å–"></a>èµ„æºè·å–</h2><p><img src="http://cdn.anruence.com/rest.png" alt="image"></p>
<ul>
<li>RESTful ç”¨ä¸åŒURLæ¥åŒºåˆ†èµ„æºï¼ŒGraphQL ç”¨ç‰¹æœ‰çš„ç±»å‹åŒºåˆ†èµ„æº</li>
<li>è·å–ç›¸åŒèµ„æºREST APIéœ€è¦èšåˆå¤šä¸ªæ¥å£</li>
<li>è·å–ç›¸åŒèµ„æºGraphQLåªéœ€ä¸€æ¬¡è¯·æ±‚è·å–å¤šç»„æ•°æ®</li>
<li>GraphQLæ›´æœ‰æ•ˆç‡æ›´å¼ºå¤§æ›´çµæ´»ï¼Œå¯¹å‰ç«¯æ›´å‹å¥½</li>
</ul>
<h2 id="æ•°æ®è·å–"><a href="#æ•°æ®è·å–" class="headerlink" title="æ•°æ®è·å–"></a>æ•°æ®è·å–</h2><p><img src="http://cdn.anruence.com/graphql%20%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96.png" alt="image"></p>
<ul>
<li>è·å–æ•°æ®çš„æ–¹å¼ç”±==è¿™é‡Œæœ‰ä»€ä¹ˆ==å‘ ==ä½ éœ€è¦ä»€ä¹ˆ==è½¬å˜ </li>
<li>GraphQLå¯ä»¥ç®€åŒ–ç†è§£æˆä¸€ä¸ªçµæ´»çš„ajaxæ¥å£</li>
<li>å®¢æˆ·ç«¯å®Œå…¨è‡ªä¸»å†³å®šè·å–ä¿¡æ¯çš„å†…å®¹ï¼ŒæœåŠ¡ç«¯è´Ÿè´£ç²¾ç¡®çš„è¿”å›ç›®æ ‡æ•°æ®</li>
</ul>
<h2 id="GraphQLä¼˜ç‚¹"><a href="#GraphQLä¼˜ç‚¹" class="headerlink" title="GraphQLä¼˜ç‚¹"></a>GraphQLä¼˜ç‚¹</h2><ul>
<li>è¯·æ±‚ä½ æ‰€è¦çš„æ•°æ®ï¼Œä¸å¤šä¸å°‘</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>å‘ä½ çš„ API å‘å‡ºä¸€ä¸ª GraphQL è¯·æ±‚å°±èƒ½å‡†ç¡®è·å¾—ä½ æƒ³è¦çš„æ•°æ®ï¼Œä¸å¤šä¸å°‘ã€‚</span><br><span class="line"><span class="bullet">- </span>GraphQL æŸ¥è¯¢æ€»æ˜¯è¿”å›å¯é¢„æµ‹çš„ç»“æœã€‚ä½¿ç”¨ GraphQL çš„åº”ç”¨å¯ä»¥å·¥ä½œå¾—åˆå¿«åˆç¨³ï¼Œå› ä¸ºæ§åˆ¶æ•°æ®çš„æ˜¯åº”ç”¨ï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨ã€‚</span><br></pre></td></tr></table></figure>
<p><img src="http://cdn.anruence.com/graphql-fetchdata.png" alt="image"></p>
<ul>
<li>è·å–å¤šä¸ªèµ„æºï¼Œåªéœ€è¦ä¸€ä¸ªè¯·æ±‚</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>GraphQL æŸ¥è¯¢ä¸ä»…èƒ½å¤Ÿè·å¾—èµ„æºçš„å±æ€§ï¼Œè¿˜èƒ½æ²¿ç€èµ„æºé—´å¼•ç”¨è¿›ä¸€æ­¥æŸ¥è¯¢</span><br><span class="line"><span class="bullet">- </span>å…¸å‹çš„ REST API è¯·æ±‚å¤šä¸ªèµ„æºæ—¶å¾—è½½å…¥å¤šä¸ª URL</span><br><span class="line"><span class="bullet">- </span>GraphQL å¯ä»¥é€šè¿‡ä¸€æ¬¡è¯·æ±‚å°±è·å–ä½ åº”ç”¨æ‰€éœ€çš„æ‰€æœ‰æ•°æ®</span><br><span class="line"><span class="bullet">- </span>å³ä½¿æ˜¯æ¯”è¾ƒæ…¢çš„ç§»åŠ¨ç½‘ç»œè¿æ¥ä¸‹ï¼Œä½¿ç”¨ GraphQL çš„åº”ç”¨ä¹Ÿèƒ½è¡¨ç°å¾—è¶³å¤Ÿè¿…é€Ÿã€‚</span><br></pre></td></tr></table></figure>
<p><img src="http://cdn.anruence.com/graphQL-huoqu.png" alt="image"></p>
<ul>
<li>æè¿°æ‰€æœ‰å¯èƒ½çš„ç±»å‹ç³»ç»Ÿï¼ˆå¼ºç±»å‹è‡ªèº«ï¼‰</li>
</ul>
<p>å¼ºç±»å‹å¯ä»¥åœ¨æŸ¥è¯¢æ‰§è¡Œä¹‹å‰è¿›è¡ŒéªŒè¯</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>GraphQL API åŸºäºç±»å‹å’Œå­—æ®µçš„æ–¹å¼è¿›è¡Œç»„ç»‡ï¼Œè€Œéå…¥å£ç«¯ç‚¹</span><br><span class="line"><span class="bullet">- </span>ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªå•ä¸€å…¥å£ç«¯ç‚¹å¾—åˆ°ä½ æ‰€æœ‰çš„æ•°æ®èƒ½åŠ›</span><br><span class="line"><span class="bullet">- </span>GraphQL ä½¿ç”¨ç±»å‹æ¥ä¿è¯åº”ç”¨åªè¯·æ±‚å¯èƒ½çš„æ•°æ®</span><br><span class="line"><span class="bullet">- </span>è¿˜æä¾›äº†æ¸…æ™°çš„è¾…åŠ©æ€§é”™è¯¯ä¿¡æ¯</span><br><span class="line"><span class="bullet">- </span>åº”ç”¨å¯ä»¥ä½¿ç”¨ç±»å‹ï¼Œè€Œé¿å…ç¼–å†™æ‰‹åŠ¨è§£æä»£ç ã€‚</span><br></pre></td></tr></table></figure>
<ul>
<li>å¼ºå¤§çš„å¼€å‘è€…å·¥å…·</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>ä»£ç å³æ–‡æ¡£</span><br><span class="line"><span class="bullet">- </span>ä¸ç”¨ç¦»å¼€ç¼–è¾‘å™¨å°±èƒ½å‡†ç¡®çŸ¥é“ä½ å¯ä»¥ä» API ä¸­è¯·æ±‚çš„æ•°æ®</span><br><span class="line"><span class="bullet">- </span>å‘é€æŸ¥è¯¢ä¹‹å‰å°±èƒ½é«˜äº®æ½œåœ¨é—®é¢˜ï¼Œé«˜äº®ä»£ç æ™ºèƒ½æç¤º</span><br><span class="line"><span class="bullet">- </span>æä¾›äº†GraphiQLå›¾å½¢ç•Œé¢ç¼–å†™å¯æµ‹è¯•çš„æŸ¥è¯¢è¯­å¥</span><br></pre></td></tr></table></figure>
<ul>
<li>æ— ç‰ˆæœ¬çº¦æŸ å¹³æ»‘æ¼”è¿›ï¼ˆ<font color="red">GraphQLçš„è®¾è®¡ç²¾é«“</font>ï¼‰</li>
</ul>
<blockquote>
<p>ç”±äºä»…è¿”å›æ˜ç¡®çš„è¯·æ±‚æ•°æ®ï¼Œæ‰€ä»¥è®¾è®¡è‰¯å¥½çš„ã€ŒGraphQL APIã€ä¸å­˜åœ¨ã€Œæ¥å£çªå˜ã€çš„æƒ…å†µï¼Œè¿™æ˜¯ä»ã€Œç‰ˆæœ¬åŒ–ã€åˆ°ã€Œæ— ç‰ˆæœ¬ã€çš„ä¸€ä¸ªæ˜ç¡®è½¬å˜ï¼</p>
</blockquote>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>ç»™ä½ çš„ GraphQL API æ·»åŠ å­—æ®µå’Œç±»å‹è€Œæ— éœ€å½±å“ç°æœ‰æŸ¥è¯¢</span><br><span class="line"><span class="bullet">- </span>è€æ—§çš„å­—æ®µå¯ä»¥åºŸå¼ƒï¼Œä»å·¥å…·ä¸­éšè—</span><br><span class="line"><span class="bullet">- </span>é€šè¿‡ä½¿ç”¨å•ä¸€æ¼”è¿›ç‰ˆæœ¬ï¼ŒGraphQL API ä½¿å¾—åº”ç”¨å§‹ç»ˆèƒ½å¤Ÿä½¿ç”¨æ–°çš„ç‰¹æ€§ï¼Œå¹¶é¼“åŠ±ä½¿ç”¨æ›´åŠ ç®€æ´ã€æ›´å¥½ç»´æŠ¤çš„æœåŠ¡ç«¯ä»£ç </span><br></pre></td></tr></table></figure>
<h1 id="GraphQLæ”¹å–„RESTful"><a href="#GraphQLæ”¹å–„RESTful" class="headerlink" title="GraphQLæ”¹å–„RESTful"></a>GraphQLæ”¹å–„RESTful</h1><p>äº†è§£äº†GraphQLçš„ä¸€å¤§å †ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¼€ç¯‡çš„è¯‰æ±‚è§£å†³äº†å—ï¼Ÿ</p>
<p><img src="http://cdn.anruence.com/graphql99.png" alt="image"></p>
<p>åˆ°è¿™é‡Œ æˆ‘ä»¬çœ‹åˆ°äº†GraphQL åŸåˆ™ä¸Šçš„å¯è¡Œæ€§</p>
<h1 id="How-GraphQL"><a href="#How-GraphQL" class="headerlink" title="How GraphQL"></a>How GraphQL</h1><p>æ¥ä¸‹æ¥ è¶çƒ­æ‰“é“ æ¥èŠèŠæ€ä¹ˆç”¨GraphQL</p>
<p><img src="http://cdn.anruence.com/graphql-banner.png" alt="image"></p>
<p>å®˜ç½‘ä¸Šç‰¹åˆ«é†’ç›®çš„ä¸€å¼ å›¾ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p>
<ul>
<li>æœåŠ¡ç«¯å®šä¹‰å¥½å¼ºç±»å‹çš„æ•°æ®å…¥å‚å’Œè¿”å›çš„æ•°æ®ç»“æ„</li>
<li>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰æŸ¥è¯¢è¯­å¥ï¼ˆGraphQLæŸ¥è¯¢åè®®ï¼‰çš„è¯·æ±‚ï¼Œå®šä¹‰å¥½è¿”å›æ•°æ®çš„æ ¼å¼åŠç±»å‹</li>
<li>è¿”å›ç¬¦åˆå®¢æˆ·ç«¯é¢„æœŸçš„Jsonå­—ç¬¦ä¸²ç»“æœ</li>
</ul>
<font color="red">å†é€šä¿—ä¸€ç‚¹</font>

<p>æˆ‘ä»¬æ‹¥æœ‰UIï¼Œå¹¶ä¸”éœ€è¦ç”¨æ•°æ®å¡«å……å®ƒï¼Œå› æ­¤æˆ‘ä»¬å‘æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢<br>ä½¿ç”¨ä¼ ç»Ÿçš„REST APIï¼Œæˆ‘ä»¬çš„æŸ¥è¯¢å°†ä»¥GETè¯·æ±‚çš„å½¢å¼å‡ºç° å€ŸåŠ©GraphQLï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§ç”¨äºè¯·æ±‚æ•°æ®çš„æ–°è¯­æ³•</p>
<h3 id="ä¸€ä¸ªåŸºç¡€çš„GraphQLæœåŠ¡"><a href="#ä¸€ä¸ªåŸºç¡€çš„GraphQLæœåŠ¡" class="headerlink" title="ä¸€ä¸ªåŸºç¡€çš„GraphQLæœåŠ¡"></a>ä¸€ä¸ªåŸºç¡€çš„GraphQLæœåŠ¡</h3><h4 id="GraphQLæœåŠ¡-ç±»å‹ï¼ˆschemaï¼‰-è§£æå™¨-ï¼ˆresolveï¼‰"><a href="#GraphQLæœåŠ¡-ç±»å‹ï¼ˆschemaï¼‰-è§£æå™¨-ï¼ˆresolveï¼‰" class="headerlink" title="GraphQLæœåŠ¡ = ç±»å‹ï¼ˆschemaï¼‰ + è§£æå™¨ ï¼ˆresolveï¼‰"></a>GraphQLæœåŠ¡ = ç±»å‹ï¼ˆschemaï¼‰ + è§£æå™¨ ï¼ˆresolveï¼‰</h4><p>æ˜ç¡®ä»¥ä¸‹çŸ¥è¯†ç‚¹</p>
<ul>
<li>ä¸ºäº†å‘å‡ºGraphQLè¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªGraphQLæœåŠ¡å™¨</li>
<li>GraphQLæœåŠ¡å™¨æ˜¯é™„åŠ äº†GraphQLæ¨¡å¼çš„å¸¸è§„HTTPæœåŠ¡å™¨</li>
<li>ç±»å‹ç³»ç»Ÿæè¿°äº†æ•°æ®çš„ç±»å‹ä¸ç»“æ„ï¼Œä½†å®ƒåªæ˜¯å½¢çŠ¶ï¼Œä¸åŒ…å«çœŸæ­£çš„æ•°æ®</li>
<li>é€šè¿‡ç¼–å†™Resolverå‡½æ•°ï¼Œä»è€Œå»è·å–çœŸæ­£çš„æ•°æ®</li>
</ul>
<p><img src="http://cdn.anruence.com/graphQL%20lizi.png" alt="image"></p>
<ul>
<li>æœåŠ¡ç«¯ï¼ˆæˆ–ä¸­é—´å±‚ï¼‰éœ€è¦æè¿°æ‰€æœ‰å¯èƒ½çš„ç±»å‹ç³»ç»Ÿï¼ˆschemaï¼‰</li>
</ul>
<p><img src="http://cdn.anruence.com/graphql.png" alt="image"></p>
<ul>
<li>æŒ‰ä½ æ‰€éœ€è¯·æ±‚ä½ æ‰€éœ€è¦çš„æ•°æ®ï¼Œè§£å†³äº†ä¸åŒå®¢æˆ·ç«¯ä¸åŒçš„æ¸²æŸ“éœ€æ±‚</li>
</ul>
<p>æ˜¯ä¸æ˜¯è´¼ç®€å•ï½</p>
<p>ä¸çŸ¥é“ä½ æ²¡æœ‰æ³¨æ„åˆ° ä¸Šé¢æˆ‘ä»¬æåˆ°äº†<font color="red">GraphQLæŸ¥è¯¢åè®®</font></p>
<h2 id="GraphQLæŸ¥è¯¢åè®®"><a href="#GraphQLæŸ¥è¯¢åè®®" class="headerlink" title="GraphQLæŸ¥è¯¢åè®®"></a>GraphQLæŸ¥è¯¢åè®®</h2><p>GraphQLæœ‰ä¸‰ç§è¯·æ±‚æ–¹å¼</p>
<ul>
<li>query(è¯·æ±‚)   </li>
<li>mutation(ä¿®æ”¹)</li>
<li>subscribe(è®¢é˜…)</li>
</ul>
<p>GraphQLçš„æ ¸å¿ƒä¾èµ–äºç®€å•çš„GETæˆ–POSTè¯·æ±‚æ¥å°†æ•°æ®å¾€è¿”äºå®¢æˆ·ç«¯ï¼Œè€ŒGraphQLåªæ˜¯ä¸€ä¸ªç»è¿‡ä¿®é¥°çš„GETæˆ–POSTè¯·æ±‚ï¼Œé€šè¿‡ <a href="https://myapp.com/graphql" target="_blank" rel="noopener">https://myapp.com/graphql</a><br>ä¹‹ç±»çš„URLå‘é€åˆ°GraphQLæœåŠ¡å™¨</p>
<p>æ˜¯çš„ï¼Œè™½ç„¶GraphQLç¡®å®å¼•å…¥äº†ä¸€äº›æ–°çš„æ¦‚å¿µæ¥ç»„ç»‡æ•°æ®è¿›è¡Œäº¤äº’ï¼Œä½†åœ¨å¹•åï¼Œä½†GraphQLä»ç„¶ä¾é è‰¯å¥½çš„HTTPè¯·æ±‚æ¥å®ç°å…¶ç¥å¥‡æ•ˆæœ</p>
<p>åªéœ€è¦ä¸ºç±»å‹ç³»ç»Ÿçš„å­—æ®µç¼–å†™å‡½æ•°ï¼ŒGraphQL å°±èƒ½é€šè¿‡ä¼˜åŒ–å¹¶å‘çš„æ–¹å¼æ¥è°ƒç”¨å®ƒä»¬</p>
<p>å…·ä½“å‚ç…§å¦‚ä¸Šçš„demoï¼Œå»ºè®®æ‹·è´ä»£ç äº²è‡ªæ„Ÿå—ä¸€ä¸‹</p>
<h1 id="GraphQLç»„æˆé“¾è·¯"><a href="#GraphQLç»„æˆé“¾è·¯" class="headerlink" title="GraphQLç»„æˆé“¾è·¯"></a>GraphQLç»„æˆé“¾è·¯</h1><p>å½“ç„¶äº† å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œæˆ‘ä»¬æ— éå…³æ³¨ä¸¤ç‚¹</p>
<ul>
<li>å®¢æˆ·ç«¯åšä»€ä¹ˆï¼Ÿ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‘æœåŠ¡ç«¯å‘é€æŸ¥è¯¢å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>
<ul>
<li>æœåŠ¡ç«¯åšä»€ä¹ˆï¼Ÿ</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">åŸºäºGraphQLæ„å»ºç±»å‹ç³»ç»Ÿ </span><br><span class="line">å®šä¹‰ä¸<span class="keyword">Query</span>ä¸‹å­—æ®µå¯¹åº”çš„resolver</span><br><span class="line">å¯ä»¥åœ¨resolverè·å–çœŸæ­£çš„æ•°æ®</span><br></pre></td></tr></table></figure>
<h2 id="èµ„æºè·¯å¾„å›¾"><a href="#èµ„æºè·¯å¾„å›¾" class="headerlink" title="èµ„æºè·¯å¾„å›¾"></a>èµ„æºè·¯å¾„å›¾</h2><p><img src="http://cdn.anruence.com/ziyuanlujing.png" alt="image"></p>
<p>å®¢æˆ·ç«¯ Schema æœ¬è´¨ä¸Šå°±æ˜¯ä¸€æ®µå­—ç¬¦ä¸²ï¼ŒæœåŠ¡ç«¯å¦‚ä½•è¯†åˆ«å¹¶å“åº”è¿™æ®µå­—ç¬¦ä¸²ï¼Ÿ</p>
<h2 id="æœåŠ¡ç«¯æ‰§è¡Œè¿‡ç¨‹"><a href="#æœåŠ¡ç«¯æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="æœåŠ¡ç«¯æ‰§è¡Œè¿‡ç¨‹"></a>æœåŠ¡ç«¯æ‰§è¡Œè¿‡ç¨‹</h2><p><img src="http://cdn.anruence.com/%E6%9C%8D%E5%8A%A1%E7%AB%AF.png" alt="image"></p>
<p>æ‹¿åˆ°å®¢æˆ·ç«¯å­—ç¬¦ä¸²ä¹‹åï¼Œä¾èµ–å®˜æ–¹ç±»åº“graphql-js,æœåŠ¡ç«¯å…·ä½“æ‰§è¡Œç»å†ä¸‰ä¸ªé˜¶æ®µ</p>
<ul>
<li>è§£æï¼šé€å­—ç¬¦æ‰«æï¼Œå¦‚æœä¸ç¬¦åˆæœåŠ¡ç«¯å®šä¹‰çš„ASTè§„èŒƒï¼Œè§£æè¿‡ç¨‹ä¼šç›´æ¥è·‘å‡ºè¯­æ³•å¼‚å¸¸ï¼Œå½“ç„¶äº†ï¼Œæ˜¯ç»“æ„åŒ–æŠ¥é”™</li>
<li>æ ¡éªŒï¼šå‘èµ·äº†æŸ¥è¯¢ï¼ŒGraphQLä¼šè§£ææˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥ï¼Œç¡®ä¿å•Šæˆ‘ä»¬æŸ¥è¯¢çš„ç»“æ„æ˜¯å­˜åœ¨çš„ï¼Œå‚æ•°æ˜¯è¶³å¤Ÿçš„ï¼Œç±»å‹æ˜¯ä¸€è‡´çš„ï¼Œä»»ä½•ç¯èŠ‚å‡ºäº†é—®é¢˜ï¼Œéƒ½å°†è¿”å›é”™è¯¯ä¿¡æ¯</li>
<li>æ‰§è¡Œï¼šéªŒè¯é€šè¿‡åï¼ŒGraphqLä¼šæ ¹æ®queryè¯­å¥åŒ…å«çš„å­—æ®µç»“æ„ä¸€ä¸€è§¦å‘å¯¹åº”çš„Resolverå‡½æ•°ï¼Œè·å–æŸ¥è¯¢ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´ å¦‚æœå‰ç«¯æ²¡æœ‰æŸ¥è¯¢æŸä¸ªå­—æ®µï¼Œå°±ä¸ä¼šè§¦å‘è¯¥å­—æ®µå¯¹åº”çš„Resolverå‡½æ•°ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿå¯¹æ•°æ®çš„è·å–è¡Œä¸º</li>
</ul>
<p>æ³¨ï¼šå¦‚æœReaolverè¿”å›çš„æ•°æ®ç»“æ„ï¼Œå¤§äºSchemaé‡Œæç»˜çš„ç»“æ„ï¼Œé‚£ä¹ˆå¤šå‡ºæ¥çš„éƒ¨åˆ†ä¼šè¢«å¿½ç•¥ï¼Œè¿™æ˜¯ä¸€ä¸ªåˆç†çš„è®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶Schema æ¥æ§åˆ¶å‰ç«¯çš„æ•°æ®è®¿é—®æƒé™ï¼Œé˜²æ­¢æ„å¤–çš„å°†ç”¨æˆ·çš„éšç§ä¿¡æ¯æ³„æ¼å‡ºå» </p>
<h1 id="é˜»ç¢ä½ ä½¿ç”¨GraphQLçš„Nä¸ªé—®é¢˜"><a href="#é˜»ç¢ä½ ä½¿ç”¨GraphQLçš„Nä¸ªé—®é¢˜" class="headerlink" title="é˜»ç¢ä½ ä½¿ç”¨GraphQLçš„Nä¸ªé—®é¢˜"></a>é˜»ç¢ä½ ä½¿ç”¨GraphQLçš„Nä¸ªé—®é¢˜</h1><p>æ—¢ç„¶GraphQLé‚£ä¹ˆæ–¹ä¾¿ï¼Œä¸ºå•¥æ²¡æœ‰å¤§ç«å‘¢ï¼Ÿ<br>ç»“åˆäº†å¤šç¯‡æ–‡ç« ï¼Œæ•´ç†äº†è‹¥å¹²äº†é˜»æ­¢ä½ ä½¿ç”¨GraphQLçš„Nä¸ªé—®é¢˜</p>
<p>ä¸€èµ·æ¥çœ‹ä¸€çœ‹</p>
<h2 id="GraphQLä¸€å®šè¦æ“ä½œæ•°æ®åº“ï¼Ÿ"><a href="#GraphQLä¸€å®šè¦æ“ä½œæ•°æ®åº“ï¼Ÿ" class="headerlink" title="GraphQLä¸€å®šè¦æ“ä½œæ•°æ®åº“ï¼Ÿ"></a>GraphQLä¸€å®šè¦æ“ä½œæ•°æ®åº“ï¼Ÿ</h2><ul>
<li>æ•°æ®æä¾›æ–¹ç¼–å†™GraphQL Schema</li>
<li>æ•°æ®æ¶ˆè´¹æ–¹ç¼–å†™GraphQL Query</li>
<li>GraphQLåªæ˜¯å…³äºschemaå’Œresolverçš„ä¸€ä¸€å¯¹åº”å’Œè°ƒç”¨ï¼Œå®ƒå¹¶ä¸ºå¯¹æ•°æ®çš„è·å–æ–¹å¼å’Œæ¥æºåšä»»ä½•å‡è®¾</li>
</ul>
<h2 id="GraphQL-è·Ÿ-RESTful-api-æ˜¯å¯¹ç«‹çš„ï¼Ÿ"><a href="#GraphQL-è·Ÿ-RESTful-api-æ˜¯å¯¹ç«‹çš„ï¼Ÿ" class="headerlink" title="GraphQL è·Ÿ RESTful api æ˜¯å¯¹ç«‹çš„ï¼Ÿ"></a>GraphQL è·Ÿ RESTful api æ˜¯å¯¹ç«‹çš„ï¼Ÿ</h2><p>ä¸¤è€…ä¸ä»…ä¸æ˜¯å¯¹ç«‹çš„ï¼Œè¿˜å¯ä»¥ç›¸äº’ç»“åˆ<br>äº‹å®ä¸Šå¯ä»¥æŠŠQuery ä¸‹çš„å­—æ®µï¼Œç†è§£ä¸ºä¸€ä¸ªä¸ª RESTful API</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="type">Query</span> &#123;</span><br><span class="line">   hello: <span class="type">String</span>,</span><br><span class="line">   sayhi:<span class="type">String</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="GraphQLä¸ä¸€å®šéœ€è¦Schemaï¼ˆç±»å‹ç³»ç»Ÿï¼‰ï¼Ÿ"><a href="#GraphQLä¸ä¸€å®šéœ€è¦Schemaï¼ˆç±»å‹ç³»ç»Ÿï¼‰ï¼Ÿ" class="headerlink" title="GraphQLä¸ä¸€å®šéœ€è¦Schemaï¼ˆç±»å‹ç³»ç»Ÿï¼‰ï¼Ÿ"></a>GraphQLä¸ä¸€å®šéœ€è¦Schemaï¼ˆç±»å‹ç³»ç»Ÿï¼‰ï¼Ÿ</h2><ul>
<li>GraphQL Type System æ˜¯ä¸€ä¸ªé™æ€çš„ç±»å‹ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºé™æ€ç±»å‹ GraphQL</li>
<li>æ­¤å¤–ï¼Œç¤¾åŒºè¿˜æœ‰ä¸€ç§åŠ¨æ€ç±»å‹çš„ GraphQL å®è·µï¼Œå®ƒè·Ÿé™æ€ç±»å‹çš„ GraphQL å·®åˆ«åœ¨äºï¼Œæ²¡æœ‰äº†åŸºäº Schema çš„æ•°æ®å½¢çŠ¶éªŒè¯é˜¶æ®µï¼Œè€Œæ˜¯ç›´æ¥æ— è„‘åœ°æ ¹æ® query æŸ¥è¯¢è¯­å¥é‡Œçš„å­—æ®µï¼Œå»è§¦å‘ Resolver å‡½æ•°ï¼ŒåŠ¨æ€ç±»å‹çš„ GraphQL æœ‰ä¸€å®šçš„ä¾¿åˆ©æ€§ï¼Œä¸è¿‡ï¼Œå®ƒåŒæ—¶ä¸§å¤±äº† GraphQL çš„éƒ¨åˆ†ç²¾é«“</li>
</ul>
<h2 id="GraphQL-ä¸€å®šæ˜¯åç«¯æœåŠ¡ï¼Ÿ"><a href="#GraphQL-ä¸€å®šæ˜¯åç«¯æœåŠ¡ï¼Ÿ" class="headerlink" title="GraphQL ä¸€å®šæ˜¯åç«¯æœåŠ¡ï¼Ÿ"></a>GraphQL ä¸€å®šæ˜¯åç«¯æœåŠ¡ï¼Ÿ</h2><p>å°½ç®¡ç»å¤§å¤šæ•° GraphQLï¼Œéƒ½ä»¥ server çš„å½¢å¼å­˜åœ¨ã€‚ ä½†å®ƒå¹¶æ²¡æœ‰é™åˆ¶åœ¨åç«¯åœºæ™¯</p>
<p> <a href="https://codesandbox.io/s/youthful-mestorf-r8s38" target="_blank" rel="noopener">åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ</a> </p>
<h1 id="ç°æœ‰åº”ç”¨çš„æ¥å…¥æ–¹å¼"><a href="#ç°æœ‰åº”ç”¨çš„æ¥å…¥æ–¹å¼" class="headerlink" title="ç°æœ‰åº”ç”¨çš„æ¥å…¥æ–¹å¼"></a>ç°æœ‰åº”ç”¨çš„æ¥å…¥æ–¹å¼</h1><h2 id="æš´åŠ›æ”¹é€ RESTful-Likeæ¨¡å¼"><a href="#æš´åŠ›æ”¹é€ RESTful-Likeæ¨¡å¼" class="headerlink" title="æš´åŠ›æ”¹é€ RESTful-Likeæ¨¡å¼"></a>æš´åŠ›æ”¹é€ RESTful-Likeæ¨¡å¼</h2><p>RESTful -&gt; GraphQL</p>
<ul>
<li>å°±æ˜¯ç®€å•ç²—æš´çš„æŠŠ RESTful API æœåŠ¡ï¼Œæ›¿æ¢æˆ GraphQL å®ç°ã€‚ä¹‹å‰æœ‰å¤šå°‘ RESTful æœåŠ¡ï¼Œé‡æ„åå°±æœ‰å¤šå°‘ GraphQL æœåŠ¡ï¼Œ</li>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¢å‘ä¸¤ä¸ª GraphQL æœåŠ¡å‘èµ·çš„æŸ¥è¯¢æ˜¯ä¸¤æ¬¡è¯·æ±‚ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‰ç«¯éœ€è¦äº§å“æ•°æ®æ—¶ï¼Œä»ä¹‹å‰è°ƒç”¨äº§å“ç›¸å…³çš„ RESTful APIï¼Œå˜æˆæŸ¥è¯¢äº§å“ç›¸å…³çš„ GraphQLã€‚ä¸è¿‡ï¼Œéœ€è¦è®¢å•ç›¸å…³çš„æ•°æ®æ—¶ï¼Œå¯èƒ½è¦æŸ¥è¯¢å¦ä¸€ä¸ª GraphQL æœåŠ¡</span><br></pre></td></tr></table></figure>
<ul>
<li>å®ƒæ˜¯ä¸€ä¸ªç®€å•çš„ä¸€å¯¹ä¸€å…³ç³»</li>
</ul>
<p>æ”¶ç›Šç”šå¾® é€‰å‹å¤±è¯¯</p>
<h2 id="ä½œä¸ºä¸­é—´å±‚"><a href="#ä½œä¸ºä¸­é—´å±‚" class="headerlink" title="ä½œä¸ºä¸­é—´å±‚"></a>ä½œä¸ºä¸­é—´å±‚</h2><p>åŒæ ·æ˜¯API Gatewayè§’è‰²çš„GraphQLæœåŠ¡ï¼Œåœ¨å®ç°æ–¹å¼ä¸Šæœ‰ä¸åŒçš„åˆ†ç±» </p>
<ul>
<li>1ï¼Œä¼ ç»Ÿæ„ä¹‰ä¸Šçš„åç«¯æœåŠ¡ï¼ˆåŒ…å«å¤§é‡çœŸå®çš„æ•°æ®æ“ä½œå’Œå¤„ç†çš„ GraphQLï¼‰</li>
<li>2ï¼Œ<font color="red">GraphQL as BFF</font>ï¼ˆè½¬å‘æ¥å£è¯·æ±‚ï¼Œèšåˆæ•°æ®ç»“æœçš„GraphQLï¼‰</li>
</ul>
<p>æˆ‘ä»¬ä»Šå¤©ä¸»è¦è®¨è®º ç¬¬äºŒç§</p>
<p><img src="http://cdn.anruence.com/%E6%8E%A5%E5%85%A5%E6%96%B9%E5%BC%8F.png" alt="image"></p>
<ul>
<li>å‰ç«¯ä¸å†ç›´æ¥è°ƒç”¨å…·ä½“çš„ RESTful ç­‰æ¥å£ï¼Œè€Œæ˜¯é€šè¿‡ GraphQL å»é—´æ¥è·å–äº§å“ã€è®¢å•ã€æœç´¢ç­‰æ•°æ®</li>
<li>åœ¨ GraphQL è¿™ä¸ªä¸­é—´å±‚é‡Œï¼Œæˆ‘ä»¬å°†å„ä¸ªå¾®æœåŠ¡ï¼ŒæŒ‰ç…§å®ƒä»¬çš„æ•°æ®å…³è”ï¼Œæ•´åˆæˆä¸€ä¸ªåŸºäº GraphQL Schema çš„æ•°æ®å…³ç³»ç½‘ç»œã€‚å‰ç«¯å¯ä»¥é€šè¿‡ GraphQL æŸ¥è¯¢è¯­å¥ï¼ŒåŒæ—¶å‘èµ·å¯¹å¤šä¸ªå¾®æœåŠ¡çš„æ•°æ®çš„è·å–ã€ç­›é€‰ã€è£å‰ªç­‰è¡Œä¸ºã€‚</li>
<li>ä½œä¸º API Gateway çš„ GraphQL æœåŠ¡ï¼Œå¯ä»¥åœ¨å…¶ Resolver å†…ï¼Œå‘å‰é¢æåˆ°çš„ RESTful-like çš„ GraphQL å‘èµ·æŸ¥è¯¢è¯·æ±‚</li>
<li>æ—¢é¿å…äº†å‰ç«¯éœ€è¦ä¸€å¯¹å¤šçš„é—®é¢˜ï¼Œä¹Ÿè§£å†³äº† API Gateway GraphQL éœ€è¦è¯·æ±‚ RESTful å…¨é‡æ•°æ®æ¥å£çš„å†…éƒ¨å†—ä½™é—®é¢˜</li>
</ul>
<p><img src="http://cdn.anruence.com/airbnb.png" alt="image"></p>
<p>å°† GraphQL schemasè½¬åŒ–ä¸º Thhrift IDLï¼Œå†ç»Ÿä¸€æ“ä½œåº•å±‚æ•°æ®</p>
<p><img src="http://cdn.anruence.com/%E5%BE%AE%E6%9C%8D%E5%8A%A1..png" alt="image"></p>
<h1 id="GraphQLä¸è¶³"><a href="#GraphQLä¸è¶³" class="headerlink" title="GraphQLä¸è¶³"></a>GraphQLä¸è¶³</h1><ul>
<li>æ”¹é€ æˆæœ¬ï¼šåç«¯æœåŠ¡éœ€è¦æŒ‰é¢†åŸŸè¿›è¡Œé‡æ„</li>
<li>å­˜é‡å¤§ï¼šè¿ç§»å›°éš¾</li>
<li>æ•°æ®åº“æ€§èƒ½</li>
</ul>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>GraphQL è™½ç„¶è§£å†³å°†å¤šä¸ª HTTP è¯·æ±‚èšåˆæˆäº†ä¸€ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯schema ä¼šé€å±‚è§£ææ–¹å¼é€’å½’è·å–å…¨éƒ¨æ•°æ®</span><br><span class="line"><span class="bullet">- </span>å‰ç«¯è¯·æ±‚å°‘äº†ä½†æ˜¯queryå¾ˆå¤š æ•°æ®åº“è®¾è®¡å½±å“æ—¥åæ€§èƒ½</span><br><span class="line"><span class="bullet">- </span>åç«¯å¯¹å‰ç«¯æ”¹é€ æ— æ„ŸçŸ¥ï¼šå‰ç«¯ä¿®æ”¹äº†GraphQLçš„è¯·æ±‚æ ¼å¼ï¼Œå¯èƒ½ä¼šé€ æˆæ·±å±‚åµŒå¥—ï¼Œå¯¹åç«¯æœåŠ¡æœ‰è¾ƒå¤§å½±å“</span><br></pre></td></tr></table></figure>
<ul>
<li>ä¾µå…¥æ€§ï¼šå‰ç«¯åˆ©å¥½ï¼Œå´éœ€è¦æœåŠ¡ç«¯é¼åŠ›æ”¯æŒ</li>
<li>å¤æ‚æ€§ï¼šå­¦ä¹ æˆæœ¬é«˜</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">éœ€è¦äº†è§£GraphQLä¸€æ•´å¥—ç±»å‹ç³»ç»Ÿ</span><br></pre></td></tr></table></figure>
<ul>
<li>å…¸å‹çš„N+1é—®é¢˜</li>
</ul>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨REST API æ˜¯å¾ˆå®¹æ˜“è¯„ä¼° ï¼Œè¯†åˆ«å’Œè§£å†³<span class="built_in">N</span>+<span class="number">1</span>é—®é¢˜çš„</span><br><span class="line">ä½¿ç”¨GraphQLä¼šä½¿è¿™ä¸ªé—®é¢˜å˜å¾—ç›¸å¯¹å¤æ‚</span><br></pre></td></tr></table></figure>
<ul>
<li>æ•°æ®ç¼“å­˜é—®é¢˜</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="built_in">REST</span>å¼ºåˆ¶ä½¿ç”¨å…·æœ‰ç¼“å­˜æœºåˆ¶çš„HTTPåè®® ï¼Œå¯ä»¥é€šè¿‡å®ƒ é¿å…æ´»å›å»å¤šä½™èµ„æº</span><br><span class="line">GraphQLæ²¡æœ‰ç¼“å­˜æœºåˆ¶ï¼Œå®ƒæŠŠç¼“å­˜çš„é‡ä»»äº¤ç»™äº†ç”¨æˆ·</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯è§ï¼Œæ•´ä½“æ¥çœ‹ï¼Œå®é™…æ¥å…¥GraphQLå¹¶éæ˜“äº‹ï¼Œå®ƒåªæ˜¯ä¸€å¥—è§„èŒƒï¼Œå„ç§è¯­è¨€å®ç°ä¸ä¸€è‡´ï¼Œå‘¨è¾¹ç”Ÿæ€ä¸å¤Ÿå®Œå–„ï¼Œéœ€è¦åç«¯é…åˆæ”¹é€ ï¼Œæˆæœ¬å¤§ï¼Œ</li>
<li>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å„ç§é”™è¯¯å¤„ç†ï¼Œæ—¥å¿—ä¸ŠæŠ¥åŠç¼“å­˜æœºåˆ¶çš„å¤„ç†åŠæ³•è‰¯è ä¸é½</li>
</ul>
<p>æ­£å› å¦‚æ­¤ï¼ŒGraphQLå¾ˆé•¿ä¸€æ®µæ—¶é—´è¿˜ä¸èƒ½å‘æŒ¥å…¶å·¨å¤§ä½œç”¨</p>
<p>è¿™ä¸€åˆ‡ éšç€ Apollo ç™»åœº æ­£åœ¨é€æ­¥æ”¹å–„</p>
<h1 id="åŸºäºGraphQLçš„ç¤¾åŒºè§£å†³æ–¹æ¡ˆ"><a href="#åŸºäºGraphQLçš„ç¤¾åŒºè§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŸºäºGraphQLçš„ç¤¾åŒºè§£å†³æ–¹æ¡ˆ"></a>åŸºäºGraphQLçš„ç¤¾åŒºè§£å†³æ–¹æ¡ˆ</h1><h2 id="Apollo"><a href="#Apollo" class="headerlink" title="Apollo"></a>Apollo</h2><p>å¯ä»¥æŠŠGraphQLç†è§£æˆNodeJSçš„httpåŒ…ï¼Œé‚£ä¹ˆApollo-serverå°±ç±»ä¼¼äºåœ¨å‰é¢åŸºç¡€ä¸Šå°è£…å‡ºæ¥çš„æ¡†æ¶</p>
<h3 id="Apollo-Client"><a href="#Apollo-Client" class="headerlink" title="Apollo-Client"></a>Apollo-Client</h3><p>webï¼ŒiOSï¼ŒAndroidä¸‰ç«¯çš„å®ç°</p>
<h3 id="Apollo-Server"><a href="#Apollo-Server" class="headerlink" title="Apollo-Server"></a>Apollo-Server</h3><p>koaï¼Œexpressç­‰NodeJsWebçš„å®ç°</p>
<p>è¿˜æä¾›äº†å¦‚ä¸‹èƒ½åŠ›</p>
<h3 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h3><p>æ¥å£æ ¼å¼äº”èŠ±å…«é—¨ï¼Œé”™è¯¯å¤„ç†ä¹Ÿæ²¡æœ‰ç»Ÿä¸€çš„æ–¹æ¡ˆï¼ŒApolloä¼šå°†æ‰€æœ‰çš„é”™è¯¯å†…å®¹æ ¼å¼åŒ–ç»Ÿä¸€çš„é”™è¯¯ä¿¡æ¯ï¼Œä»æ­¤å¯ä»¥æ‘†è„±åç«¯å¸¦æ¥çš„æŸç¼šï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å‰ç«¯å»å¤„ç†ã€‚</p>
<h3 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="headerlink" title="æ¨¡å—åŒ–"></a>æ¨¡å—åŒ–</h3><p>å€ŸåŠ©GraphQLçš„makeExecutableSchemaå’ŒmergeSchemasæ–¹æ³•ï¼Œèƒ½å¤ŸæŒ‰æ¨¡å—å»ç¼–å†™ç±»å‹å®šä¹‰åŠresolveï¼Œæœ€åä½¿ç”¨mergeSchemaså°†ä»–ä»¬åˆå¹¶åˆ°ä¸€èµ·</p>
<h3 id="é”™è¯¯ç›‘æ§"><a href="#é”™è¯¯ç›‘æ§" class="headerlink" title="é”™è¯¯ç›‘æ§"></a>é”™è¯¯ç›‘æ§</h3><p>Apollo serveræä¾›formatErrorï¼ŒformatResponseï¼Œèƒ½å¤Ÿç»†åŒ–åˆ°æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯ä¸€æ¬¡é”™è¯¯çš„å‘ç”Ÿï¼Œæ–¹ä¾¿æˆ‘ä»¬å»ä¸ŠæŠ¥æ—¥å¿—åŠé”™è¯¯</p>
<p>å·¥ä½œæµç¨‹</p>
<p><img src="http://cdn.anruence.com/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88wee.png" alt="image"></p>
<p>æ¥å…¥æ¶æ„è®¾æƒ³</p>
<p><img src="http://cdn.anruence.com/jiagoushaxiang.png" alt="image"></p>
<ul>
<li>é€šè¿‡å¤ç”¨ç°æœ‰çš„RESTæ¥å£ï¼Œåšåˆ°æ— éœ€åç«¯é…åˆæ”¹é€ </li>
<li>åœ¨æˆ‘ä»¬å¼€å‘çš„é¡¹ç›®é‡Œï¼Œç”±äºä¼šå¯¹æ¥ä¸åŒçš„åç«¯å›¢é˜Ÿï¼Œä¼´éšç€ä¸€äº›å†å²é—ç•™é—®é¢˜ï¼Œæ¥å£æ ¼å¼äº”èŠ±å…«é—¨ï¼Œé”™è¯¯å¤„ç†ä¹Ÿæ²¡æœ‰ç»Ÿä¸€çš„æ–¹æ¡ˆï¼ŒApolloä¼šå°†æ‰€æœ‰çš„é”™è¯¯å†…å®¹æ ¼å¼åŒ–ç»Ÿä¸€çš„é”™è¯¯ä¿¡æ¯ï¼Œä»æ­¤å¯ä»¥æ‘†è„±åç«¯å¸¦æ¥çš„æŸç¼šï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å‰ç«¯å»å¤„ç†</li>
<li>åœ¨å¼€å‘å¤§å‹åº”ç”¨ä¸­ï¼Œæ¨¡å—æ˜¯æ˜¯å¿…ä¸å¯å°‘çš„ã€‚å€ŸåŠ©GraphQLçš„makeExecutableSchemaå’ŒmergeSchemasæ–¹æ³•ï¼Œèƒ½å¤ŸæŒ‰æ¨¡å—å»ç¼–å†™ç±»å‹å®šä¹‰åŠresolveï¼Œæœ€åä½¿ç”¨mergeSchemaså°†ä»–ä»¬åˆå¹¶åˆ°ä¸€èµ·</li>
<li>ç”±äºæ¥å…¥äº†node serverï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç›‘æ§é”™è¯¯ä»¥åŠè¯·æ±‚æ—¥å¿—ç­‰å†…å®¹ï¼ŒApollo serveræä¾›formatErrorï¼ŒformatResponseï¼Œèƒ½å¤Ÿç»†åŒ–åˆ°æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯ä¸€æ¬¡é”™è¯¯çš„å‘ç”Ÿï¼Œæ–¹ä¾¿æˆ‘ä»¬å»ä¸ŠæŠ¥æ—¥å¿—åŠé”™è¯¯</li>
</ul>
<p>æ¥å…¥æˆæœè®¾æƒ³<br><img src="http://cdn.anruence.com/chengguoshexiang.png" alt="image"></p>
<h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><ul>
<li><font color="red">æ›´å‡†ç¡®çš„è·å–ä½ æƒ³è¦çš„æ•°æ®</font> - æ ¸å¿ƒè¯‰æ±‚</li>
<li>æ§åˆ¶æ•°æ®çš„æ˜¯åº”ç”¨è€ŒéæœåŠ¡å™¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åœ¨åº”ç”¨å±‚å¯¹æ•°æ®æ¨¡å‹çš„æŠ½è±¡</span><br></pre></td></tr></table></figure>
<ul>
<li>å°†ä½ éœ€è¦çš„æ•°æ®æ±‡èšæˆæ•°æ®ç½‘æ ¼</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‰ç«¯ä¸èƒ½é€šè¿‡ä¸€æ¬¡æŸ¥è¯¢ç›´æ¥å¾—åˆ°è‡ªå·±æ‰€éœ€è¦çš„æ•°æ®ï¼ŒGraphqlçš„æŸ¥è¯¢ä¸ä»…æŒ‡å®šäº†è¦æŸ¥è¯¢çš„ä¿¡æ¯åŒæ—¶ç»™å‡ºäº†æœŸæœ›çš„æ•°æ®ç»“æ„</span><br></pre></td></tr></table></figure>
<ul>
<li>åº”å¯¹å¤æ‚åœºæ™¯çš„ä¸€ç§æ–°æ€è·¯ thinking in graph</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è®¾è®¡ GraphQLæ¥å£æ›´åƒæ˜¯åœ¨å»ºç«‹èµ„æºä¸èµ„æºä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå•ä¸€å†…èšå›¾çš„è¿‡ç¨‹ GraphQL ç»™äº†æˆ‘ä»¬ä¸€ç§åŸºäºã€Œå›¾ã€çš„è®¾è®¡æ€è·¯</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
  </entry>
  <entry>
    <title>å‰åç«¯åˆ†ç¦»çš„æ¼”è¿›</title>
    <url>/2019/03/05/FrontBackSeparation/</url>
    <content><![CDATA[<p>æœ‰å¹¸å‚ä¸äº†æ‰€åœ¨é¡¹ç›®çš„æ¶æ„å‡çº§ï¼Œåˆæ¬¡æ¥è§¦åˆ°äº†<code>SSR</code>çš„æ¦‚å¿µï¼Œå°±è¶Šå‘æ„Ÿå…´è¶£ æˆ‘ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šä¸€è¾¹äº«å—ç¤¾åŒºçº¢åˆ©ï¼Œä¸€è¾¹èºåŠ¨ä¸å®‰</p>
<p><strong>é²è¿…å…ˆç”Ÿè¯´è¿‡</strong></p>
<blockquote>
<p>æŠ€æœ¯ä¸Šçš„é—®é¢˜æ€»æœ‰æŠ€æœ¯å»è§£å†³<br>æ²¡é”™ æ¯”å¦‚æˆ‘ç°åœ¨å°±å­¦ä¼šé—® <code>ä¸ºä»€ä¹ˆ</code><br>ä¸ºä»€ä¹ˆä¼šå¦‚æ­¤å‘å±•ï¼Ÿä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªæ¦‚å¿µï¼Ÿå®ƒèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿå®ƒä»å“ªé‡Œæ¥.. åˆè¦åˆ°å“ªé‡Œå»..emm..</p>
</blockquote>
<hr>
<p>äº‹å®ä¸Šï¼Œä»»ä½•ä¸€é¡¹æŠ€æœ¯çš„å‘å±• éƒ½æ˜¯ç”±<strong>é—®é¢˜</strong>æ¨åŠ¨çš„ï¼Œæ‰€ä»¥ <code>trouble is friends</code>ï¼</p>
<p>å·¥ä½œæ—¶é—´ä¸çŸ­ä¸é•¿ï¼Œåˆšå¥½ç»å†äº†å‡ ä¸ªé˜¶æ®µ.</p>
<a id="more"></a>
<h3 id="ç¬¬ä¸€é˜¶æ®µï¼ˆé™æ€é¡µé¢ä¸‡å²ï¼‰"><a href="#ç¬¬ä¸€é˜¶æ®µï¼ˆé™æ€é¡µé¢ä¸‡å²ï¼‰" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µï¼ˆé™æ€é¡µé¢ä¸‡å²ï¼‰"></a>ç¬¬ä¸€é˜¶æ®µï¼ˆé™æ€é¡µé¢ä¸‡å²ï¼‰</h3><p>ä¸¤å¹´å‰å…¥èŒçš„æ—¶å€™ï¼Œå°±ç”¨çš„å¦‚æ­¤ç¥å¥‡çš„æŠ€æœ¯ï¼Œå½“æ—¶<code>reactã€vue</code>ç­‰å·²ç»çƒ­ç«æœå¤©äº†ï¼Œæˆ‘è¡¨ç¤ºå¾ˆæƒŠè®¶ï¼Œå› ä¸ºåˆšæ¯•ä¸šå°±åŠ å…¥<code>react</code>å¤§å†›äº†ï¼Œå½“æ—¶è¿˜ç”¨çš„æ˜¯èš‚èšé‡‘æœè¿˜åœ¨<code>degugger</code>é˜¶æ®µçš„ <code>dva</code>,å¯¹äºå½“æ—¶çš„æˆ‘æ¥è®²ï¼Œè¿™ç§æ­Œç¥å¥‡çš„æŠ€æœ¯ç¬¬ä¸€æ¬¡çœŸæ­£æ¥è§¦ï¼Œå†™å¥½é¡µé¢ï¼Œå°±æ‰”ç»™åç«¯å°å“¥å“¥äº†ï¼Œè¿˜çœŸçš„ä¸ä¹ æƒ¯ï¼Œæ¯”è¾ƒé—¹å¿ƒçš„ä¸€ç‚¹æ˜¯ æ²¡æœ‰bugè¿˜å¥½ï¼Œä¸€æ—¦éœ€è¦è°ƒè¯•ï¼Œä¼šè·Ÿåç«¯å°å“¥å“¥ä¸€èµ·çœ‹ï¼Œæ˜¯çœŸçš„æµªè´¹æ—¶é—´ï¼Œé‡ç‚¹æ˜¯æ•ˆç‡ä¹Ÿè´¼ä½.</p>
<p>å…¶å®ç°åœ¨çœ‹æ¥ ï¼Œè¿™å¤§æ¦‚æ˜¯æœ€åˆçš„å‰åç«¯åˆ†ç¦»<br>å‰ç«¯è´Ÿè´£é™æ€é¡µé¢å’Œäº¤äº’ï¼Œåç«¯å¯èƒ½å°±è¦è´Ÿè´£æ•°æ®å¤„ç†å¹¶è¿”å›å®Œæ•´çš„é¡µé¢<br>ä¸€æ—¦æ¶‰åŠåˆ°è¯¸å¦‚JSPã€PHP smarty æ¨¡ç‰ˆçš„ç¼–å†™ï¼Œå°±å®¹æ˜“èŒè´£ä¸æ¸…äº†..ä»¥è‡³äºäº’ç›¸ç”©é”…ï¼</p>
<p><strong>ç¼ºç‚¹æ˜æ˜¾ï¼š</strong></p>
<ol>
<li>å‰åç«¯åˆ†å·¥ä¸æ˜ï¼Œéš¾ä»¥å®ç°æ•ˆç‡æœ€å¤§åŒ–</li>
<li>å‰ç«¯ä¼šæåº¦ä¾èµ–åç«¯ç¯å¢ƒï¼Œæ•°æ®æ ¼å¼çš„æ²Ÿé€šæˆæœ¬è¿‡é«˜</li>
<li>ä¸åˆ©äºå‰ç«¯æŠ€æœ¯çš„å‘å±•</li>
</ol>
<h3 id="ç¬¬äºŒé˜¶æ®µï¼ˆAJAXæ—¶ä»£ï¼‰"><a href="#ç¬¬äºŒé˜¶æ®µï¼ˆAJAXæ—¶ä»£ï¼‰" class="headerlink" title="ç¬¬äºŒé˜¶æ®µï¼ˆAJAXæ—¶ä»£ï¼‰"></a>ç¬¬äºŒé˜¶æ®µï¼ˆAJAXæ—¶ä»£ï¼‰</h3><p>éšç€å‰ç«¯æŠ€æœ¯çš„å‘å±•ï¼Œå°¤å…¶æ˜¯AJAXå’ŒNode.jsçš„å‡ºç°ï¼Œä¸€ç§å‰åç«¯åˆ†ç¦»çš„æ¶æ„æ¨¡å¼åº”è¿è€Œç”Ÿï¼Œæå¤§çš„ç¼“è§£äº†å‰åç«¯RDä¼šäº’ç›¸æ’•é€¼çš„bugï¼Œå‰åç«¯åˆ†å·¥å˜å¾—æ¸…æ™°ï¼Œä»¥AJAXæ¥å£å½“ä½œæ¡¥æ¢ï¼Œå„å–æ‰€éœ€ï¼ˆğŸ˜‚ï¼‰</p>
<p>emm..å¾’æ‰‹ç”»çš„è¿˜ä¸æ˜¯ç‰¹åˆ«å‡†ç¡®çš„å›¾æ¥æ„ä¼šä¸€ä¸‹ç”¨æˆ·è¯·æ±‚é¡µé¢çš„è¿‡ç¨‹<br><img src="/images/cache/ssr1.jpeg" alt="cache_detai"></p>
<h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ol>
<li>åˆ†å·¥æ˜ç¡®ï¼Œå‰åç«¯å„å¸å…¶èŒï¼Œåç«¯ä¸“æ³¨ä¸šåŠ¡é€»è¾‘å’ŒåŠŸèƒ½çš„å®ç°ï¼Œå‰ç«¯ä¸“æ³¨é¡µé¢è®¾è®¡ã€‚</li>
<li>æ¥å£æ˜ç¡®ï¼Œå¹¶è¡Œå¼€å‘ï¼Œåœ¨åç«¯æ¥å£æ²¡æœ‰å®ç°å¥½ä¹‹å‰ï¼Œå‰ç«¯å®Œå…¨å¯ä»¥è‡ªå·±é€šè¿‡Node.jsçš„çš„Webæ¡†æ¶æ¨¡æ‹Ÿæ¥å£<h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4></li>
<li>æ•°æ®è¯·æ±‚ï¼Œå¤„ç†æ‰½å¥½å¤æ‚é€»è¾‘è¢«ç§»æ¤åˆ°æµè§ˆå™¨ç«¯ï¼Œjsè„šæœ¬è¶Šæ¥è¶Šå¤æ‚</li>
<li>ä¸åˆ©äº<strong>SEO</strong>ï¼ˆåé¢ä¼šè§£é‡Šï¼‰å­˜åœ¨æ€§èƒ½é—®é¢˜</li>
<li>è¿™ç§æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·å¿…é¡»ç­‰å¾…jsè„šæœ¬åŠ è½½å®Œæˆï¼ŒçœŸæ­£æ‰§è¡Œæ—¶å‘æ•°æ®è¯·æ±‚ï¼Œç­‰æ•°æ®è¿”å›ï¼Œè„šæœ¬å®Œæˆé¡µé¢çš„æ¸²æŸ“ï¼Œæ‰èƒ½çœ‹åˆ°é¡µé¢ï¼Œå¯¼è‡´<strong>é¦–å±å±•ç°æ—¶é—´æ‹‰é•¿ï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨äº’è”ç½‘ä¸‹ï¼Œå¯¹é¦–å±åŠ è½½æ€§èƒ½çš„å½±å“å¾ˆå¤§</strong></li>
</ol>
<h3 id="ç¬¬ä¸‰é˜¶æ®µï¼ˆSPAï¼‰"><a href="#ç¬¬ä¸‰é˜¶æ®µï¼ˆSPAï¼‰" class="headerlink" title="ç¬¬ä¸‰é˜¶æ®µï¼ˆSPAï¼‰"></a>ç¬¬ä¸‰é˜¶æ®µï¼ˆSPAï¼‰</h3><p><strong>SPA</strong>ï¼ˆsingle page applicationï¼‰ï¼šæ˜¯ä¸€ç§ ç½‘ç»œåº”ç”¨ç¨‹åº(WebApp)æ¨¡å‹<br>åœ¨ä¼ ç»Ÿçš„ç½‘ç«™ä¸­ï¼Œä¸åŒçš„é¡µé¢ä¹‹é—´çš„åˆ‡æ¢éƒ½æ˜¯ç›´æ¥ä»æœåŠ¡å™¨åŠ è½½ä¸€æ•´ä¸ªæ–°çš„é¡µé¢ï¼Œè€ŒSPAæ˜¯é€šè¿‡åŠ¨æ€é‡å†™é¡µé¢çš„éƒ¨åˆ†ä¸ç”¨æˆ·äº¤äº’ï¼Œä»è€Œé¿å…äº†è¿‡å¤šçš„æ•°æ®äº¤æ¢ï¼Œå“åº”é€Ÿåº¦æ›´å¿«</p>
<h4 id="ç›®å‰å¸¸è§çš„SPAæ¡†æ¶"><a href="#ç›®å‰å¸¸è§çš„SPAæ¡†æ¶" class="headerlink" title="ç›®å‰å¸¸è§çš„SPAæ¡†æ¶"></a>ç›®å‰å¸¸è§çš„SPAæ¡†æ¶</h4><ul>
<li>AngularJS</li>
<li>React</li>
<li>Vue.js</li>
</ul>
<p>ä»»ä½•æŠ€æœ¯æ¶æ„çš„å‡çº§éƒ½ä¸å¯èƒ½è„±ç¦»æ—¶ä»£æ°¸è¿œå­˜åœ¨ï¼ŒæŠ€æœ¯çš„æ¼”è¿›ä¸€å®šä¼šéšç€å‘å±•æ„ˆæ¼”æ„ˆçƒˆ</p>
<h4 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ol>
<li>å‰åç«¯åˆ†ç¦»çš„ä¼˜ç‚¹å®ƒéƒ½æœ‰é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒé¡µé¢ä¹‹é—´çš„åˆ‡æ¢å¾ˆå¿«<h4 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4></li>
<li>é¦–å±æ‰“å¼€é€Ÿåº¦å¾ˆæ…¢ï¼Œå› ä¸ºç”¨æˆ·é¦–æ¬¡åŠ è½½éœ€è¦å…ˆä¸‹è½½SPAæ¡†æ¶åŠåº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œç„¶åå†æ¸²æŸ“é¡µé¢</li>
<li>ä¸åˆ©äº<strong>SEO</strong></li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆSPAä¸åˆ©äºSEOï¼Ÿ</strong><br>ç›®å‰è€Œè¨€ï¼Œéƒ¨åˆ†æœç´¢å¼•æ“å¦‚Googleã€bingç­‰ï¼Œå®ƒä»¬çš„çˆ¬è™«è™½ç„¶å·²ç»æ”¯æŒæ‰§è¡ŒJSç”šè‡³æ˜¯é€šè¿‡AJAXè·å–æ•°æ®äº†ï¼Œä½†æ˜¯å¯¹äºå¼‚æ­¥æ•°æ®çš„æ”¯æŒä¹Ÿè¿˜ä¸è¶³(ä¹Ÿå¯èƒ½æ˜¯æœç´¢å¼•æ“æä¾›å•†è§‰å¾—æ²¡å¿…è¦)<br>SPAåº”ç”¨ä¸­ï¼Œé€šå¸¸é€šè¿‡AJAXè·å–æ•°æ®ï¼Œè€Œè¿™é‡Œå°±éš¾ä»¥ä¿è¯æˆ‘ä»¬çš„é¡µé¢èƒ½è¢«æœç´¢å¼•æ“æ­£å¸¸æ”¶å½•åˆ°ã€‚å¹¶ä¸”æœ‰ä¸€äº›æœç´¢å¼•æ“ä¸æ”¯æŒæ‰§è¡ŒJSå’Œé€šè¿‡AJAXè·å–æ•°æ®ï¼Œé‚£å°±æ›´ä¸ç”¨æSEOäº†</p>
<h3 id="ç¬¬å››é˜¶æ®µï¼ˆæœåŠ¡ç«¯æ¸²æŸ“SSRï¼‰"><a href="#ç¬¬å››é˜¶æ®µï¼ˆæœåŠ¡ç«¯æ¸²æŸ“SSRï¼‰" class="headerlink" title="ç¬¬å››é˜¶æ®µï¼ˆæœåŠ¡ç«¯æ¸²æŸ“SSRï¼‰"></a>ç¬¬å››é˜¶æ®µï¼ˆæœåŠ¡ç«¯æ¸²æŸ“SSRï¼‰</h3><h4 id="ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿ</h4><p>æœåŠ¡ç«¯æ¸²æŸ“ä¼šæŠŠæ•°æ®è¯·æ±‚è¿‡ç¨‹æ”¾åœ¨æœåŠ¡ç«¯ï¼Œç›¸å¯¹äºå‰åç«¯åˆ†ç¦»çš„æ–¹å¼ï¼Œè·å–æ•°æ®æå‰ï¼Œé¡µé¢æ¨¡ç‰ˆç»“åˆæ•°æ®çš„æ¸²æŸ“å¤„ç†ä¹Ÿä¼šåœ¨æœåŠ¡ç«¯å®Œæˆ</p>
<h4 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h4><ol>
<li>å½“æµè§ˆå™¨åˆæ¬¡è¯·æ±‚é¡µé¢åï¼Œç”¨æˆ·ç¬¬ä¸€æ¬¡æ‹¿åˆ°çš„HTMLæ–‡æ¡£å·²ç»è¿›è¡Œäº†åˆæ­¥çš„å†…å®¹æ¸²æŸ“ï¼Œ<strong>åˆ©äºSEOä¼˜åŒ– ä¹Ÿè§£å†³äº†é¦–å±çš„æ€§èƒ½é—®é¢˜</strong></li>
<li>æ€»çš„è¯·æ±‚æ•°å¹¶æ²¡æœ‰å˜ï¼Œåªæ˜¯æŠŠæµè§ˆå™¨çš„ä¸€éƒ¨åˆ†æ•°æ®è¯·æ±‚è½¬ç§»åˆ°äº†æœåŠ¡å™¨ä¸Š äº‹å®ä¸Š <strong>æœåŠ¡ç«¯è¿›è¡Œæ•°æ®æ‹‰å–çš„æˆæœ¬è¦å°äºæµè§ˆå™¨ç«¯ï¼Œä¼ è¾“æ›´åŠ é«˜æ•ˆï¼Œè¿™ä¹Ÿæ˜¯æ€§èƒ½æå‡çš„å…³é”®</strong></li>
<li>æ›´å¿«çš„å“åº”æ—¶é—´ï¼Œä¸ç”¨ç­‰å¾…æ‰€æœ‰çš„JSéƒ½ä¸‹è½½å®Œæˆï¼Œæµè§ˆå™¨ä¾¿èƒ½æ˜¾ç¤ºæ¯”è¾ƒå®Œæ•´çš„é¡µé¢äº†</li>
<li>æ›´å¥½çš„SEOï¼Œæˆ‘ä»¬å¯ä»¥å°†SEOçš„å…³é”®ä¿¡æ¯ç›´æ¥åœ¨åå°å°±æ¸²æŸ“æˆHTMLï¼Œè€Œä¿è¯æœç´¢å¼•æ“çš„çˆ¬è™«éƒ½èƒ½çˆ¬å–åˆ°å…³é”®æ•°æ®<h4 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h4></li>
<li>ç›¸å¯¹äºä»…ä»…éœ€è¦æä¾›é™æ€æ–‡ä»¶çš„æœåŠ¡å™¨ï¼ŒSSRä¸­ä½¿ç”¨çš„æ¸²æŸ“ç¨‹åºè‡ªç„¶ä¼šå ç”¨æ›´å¤šçš„CPUå’Œå†…å­˜èµ„æº</li>
<li>ä¸€äº›å¸¸ç”¨çš„æµè§ˆå™¨APIå¯èƒ½æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæ¯”å¦‚windowã€docmentå’Œalertç­‰ï¼Œå¦‚æœä½¿ç”¨çš„è¯éœ€è¦å¯¹è¿è¡Œçš„ç¯å¢ƒåŠ ä»¥åˆ¤æ–­</li>
<li>æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„ç»“æœä¸æµè§ˆå™¨ç«¯çš„ç»“æœä¸ä¸€è‡´</li>
</ol>
<p>æŠ€æœ¯çš„å†å²æ€»æ˜¯æƒŠäººçš„ç›¸ä¼¼ï¼Œè¿™é‡Œçš„æœåŠ¡ç«¯æ¸²æŸ“å’Œå¼€å§‹çš„<code>smarty</code>ç­‰æ¨¡ç‰ˆæ¸²æŸ“å¹¶æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œå½“ç„¶äº†è¿™å¹¶ä¸æ˜¯å€’é€€ï¼Œå®é™…å¼€å‘é¡¹ç›®ä¸­ï¼Œä¾èµ–reactå®ç°çš„æœåŠ¡ç«¯æ¸²æŸ“å¹¶ä¸æ˜¯ç®€å•çš„æ¸²æŸ“å†…å®¹ï¼Œä¹Ÿå¯ä»¥å®ç°å‰åç«¯ä»£ç å¤ç”¨ -&gt; <font color="red">åŒæ„</font></p>
<h3 id="ç¬¬äº”é˜¶æ®µï¼ˆSPA-SSR-åŒæ„ï¼‰"><a href="#ç¬¬äº”é˜¶æ®µï¼ˆSPA-SSR-åŒæ„ï¼‰" class="headerlink" title="ç¬¬äº”é˜¶æ®µï¼ˆSPA+ SSR åŒæ„ï¼‰"></a>ç¬¬äº”é˜¶æ®µï¼ˆSPA+ SSR åŒæ„ï¼‰</h3><h4 id="ä½•ä¸ºåŒæ„ï¼Ÿ"><a href="#ä½•ä¸ºåŒæ„ï¼Ÿ" class="headerlink" title="ä½•ä¸ºåŒæ„ï¼Ÿ"></a>ä½•ä¸ºåŒæ„ï¼Ÿ</h4><p>æœåŠ¡ç«¯æ¸²æŸ“å‡ºæœ€æ ¸å¿ƒï¼Œæœ€åŸºæœ¬çš„ä¿¡æ¯ï¼Œæµè§ˆå™¨ç«¯é’ˆå¯¹äº¤äº’å®Œæˆè¿›ä¸€æ­¥çš„æ¸²æŸ“ï¼Œäº‹ä»¶ç»‘å®šç­‰å¢å¼ºåŠŸèƒ½</p>
<p><strong>ä½†æ˜¯ ä¸¤ç«¯æ¸²æŸ“å¿…å®šæœ‰å¾ˆå¯¹å†—ä½™ä»£ç é€»è¾‘ï¼ˆéƒ½æœ‰fetchæ•°æ®çš„è¿‡ç¨‹ï¼‰</strong></p>
<p>åŒæ„ï¼šå°±æ˜¯å‰åç«¯å…±ç”¨ä¸€å¥—ä»£ç é€»è¾‘ï¼Œå®ƒå°±åƒæ˜¯æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯æ¸²æŸ“çš„äº¤é›†ï¼Œå¼¥è¡¥äº†æœåŠ¡ç«¯å’Œæµè§ˆå™¨ç«¯çš„å·®å¼‚</p>
<p>å¥½åƒå¾ˆé«˜çº§çš„æ ·å­</p>
<p>ä½†æ˜¯ä¼˜åŠ£ä¹Ÿæ¯”è¾ƒæ˜æ˜¾</p>
<h4 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ol>
<li>æ›´å¥½çš„æ€§èƒ½ æ¸²æŸ“æ›´åŠ è¿…é€Ÿ é¦–å±å±•ç°çš„æ—¶é—´æ›´å¿«</li>
<li>SEOä¼˜åŒ–æ”¯æŒï¼ŒæœåŠ¡ç«¯æ”¶åˆ°è¯·å»å ä¼šè¿”å›ä¸€ä¸ªç›¸å¯¹å®Œæ•´ï¼ŒåŒ…å«htmlçš„æ–‡æ¡£ï¼Œæ‰€ä»¥æ›´æœ‰åˆ©äºæœç´¢å¼•æ“çˆ¬è™«è·å–ä¿¡æ¯ï¼ŒåŒæ—¶ï¼Œæ›´å¿«çš„åŠ è½½æ—¶é—´ä¹Ÿæœ‰åˆ©äºæœç´¢ç»“æœå±•ç°æ’åçš„æå‡</li>
<li>å®ç°çµæ´»ï¼ŒæœåŠ¡ç«¯æ¸²æŸ“åšå®¢æˆ·ç«¯æ¸²æŸ“çš„åç»­çš„å·¥ä½œï¼Œå®ç°ä»£ç å¤ç”¨</li>
<li>å¯ç»´æŠ¤æ€§æ›´å¼ºï¼ˆåŒä¸€å¥—ä»£ç é€»è¾‘ç»´æŠ¤æˆæœ¬ä½ï¼‰</li>
<li>å¯¹äºä½ç«¯æœºå‹å‹å¥½,å› ä¸ºé¡µé¢å†…å®¹æ˜¯åœ¨æœåŠ¡ç«¯æ¸²æŸ“çš„ ä¸è‡³äºå‡ºç°ç™½å±</li>
<li>å¼±ç½‘æœ‰å¥½ ä¸ä¼šå†ç­‰jsæ‰§è¡Œå®Œæ¯•å†å»å‘ˆç°é¡µé¢</li>
<li>æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ å¯ä»¥å°†æœ€é‡è¦çš„å…ˆæ¸²æŸ“æ¬¡é‡è¦çš„åæ¸²æŸ“</li>
</ol>
<h4 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><ol>
<li>æœåŠ¡ç«¯é€»è¾‘å¢å¤š</li>
<li>æœåŠ¡ç«¯æ— æ³•å®Œå…¨å¤ç”¨æµè§ˆå™¨ç«¯ä»£ç </li>
<li>å¢åŠ äº†æœåŠ¡å™¨çš„TTFBï¼ˆtime to frist byteï¼‰æ—¶é—´</li>
</ol>
<hr>
<p>æ€»ç»“</p>
<p>åˆç†åˆ©ç”¨SSR ç»“åˆSPA å®ç°åŒæ„åº”ç”¨ æ˜¯æˆ‘ä»¬æ—¥åé‡å¿ƒ<br>ä¸‹ä¸€ç¯‡å°†åŠ¨æ‰‹å†™ä¸ªåŒæ„çš„demo</p>
<p>å°±è¿™æ ·ã€‚</p>
]]></content>
      <categories>
        <category>web</category>
      </categories>
  </entry>
  <entry>
    <title>Reacté™·é˜±</title>
    <url>/2017/07/02/React%E9%99%B7%E9%98%B1/</url>
    <content><![CDATA[<ul>
<li>ä¸è¦æ”¹å˜props</li>
</ul>
<p>é”™è¯¯ä¾‹å­ï¼š</p>
<figure class="highlight vhdl"><table><tr><td class="code"><pre><span class="line">var <span class="keyword">component</span> = &lt;<span class="keyword">Component</span> /&gt;;</span><br><span class="line"><span class="keyword">component</span>.props.foo = x; // bad</span><br><span class="line"><span class="keyword">component</span>.props.bar = y; // also bad</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å†™æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‰‹åŠ¨ç›´æ¥æ·»åŠ çš„å±æ€§Reactåç»­æ²¡åŠæ³•æ£€æŸ¥åˆ°å±æ€§ç±»å‹é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ çš„å±æ€§å‘ç”Ÿç±»å‹é”™è¯¯æ—¶ï¼Œåœ¨æ§åˆ¶å°æ˜¯çœ‹ä¸åˆ°é”™è¯¯ä¿¡æ¯çš„</p>
<p>åœ¨Reactçš„è®¾å®šä¸­ï¼Œåˆå§‹åŒ–å®Œpropsåï¼Œpropsæ˜¯ä¸å¯å˜çš„ã€‚æ”¹å˜propsä¼šå¼•èµ·æ— æ³•æƒ³è±¡çš„åæœ</p>
<p>æ­£ç¡®å†™æ³•ï¼š</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> <span class="built_in">props</span> = &#123;&#125;;</span><br><span class="line"><span class="built_in">props</span>.foo = x;</span><br><span class="line"><span class="built_in">props</span>.bar = y;</span><br><span class="line"><span class="built_in">var</span> component = &lt;Component &#123;...<span class="built_in">props</span>&#125; /&gt;;</span><br></pre></td></tr></table></figure>
<p>å½“éœ€è¦æ‹“å±•æˆ‘ä»¬çš„å±æ€§çš„æ—¶å€™ï¼Œå®šä¹‰ä¸ªä¸€ä¸ªå±æ€§å¯¹è±¡ï¼Œå¹¶é€šè¿‡{â€¦props}çš„æ–¹å¼å¼•å…¥ï¼ŒReactä¼šå¸®æˆ‘ä»¬æ‹·è´åˆ°ç»„ä»¶çš„propså±æ€§ä¸­ã€‚<br>é‡è¦çš„æ˜¯â€”è¿™ä¸ªè¿‡ç¨‹æ˜¯ç”±Reactæ“æ§çš„ï¼Œä¸æ˜¯æ‰‹åŠ¨æ·»èµ‹å€¼çš„å±æ€§</p>
<p>éœ€è¦è¦†ç›–çš„æ—¶å€™å¯ä»¥è¿™ä¹ˆå†™</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">var props</span> = &#123; foo: <span class="string">'default'</span> &#125;;</span><br><span class="line"><span class="attribute">var component</span> = &lt;Component &#123;...props&#125; foo=&#123;<span class="string">'override'</span>&#125; /&gt;;</span><br></pre></td></tr></table></figure>
<ul>
<li>Reacté»˜è®¤ä¼šè¿›è¡ŒHTMLçš„è½¬ä¹‰å¦‚ä¸‹</li>
</ul>
<p>è¾“å…¥ï¼š</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">var content='<span class="tag">&lt;<span class="name">strong</span>&gt;</span>content<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>';</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">React.render(</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;content&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span>,</span></span><br><span class="line"><span class="xml">    document.body</span></span><br><span class="line"><span class="xml">);</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">stonrg</span>&gt;</span>content<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é¿å…è½¬ä¹‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> content=<span class="string">'&lt;strong&gt;content&lt;/strong&gt;'</span>;    </span><br><span class="line"></span><br><span class="line">React.render(</span><br><span class="line">    &lt;div dangerouslySetInnerHTML=&#123;&#123;<span class="attr">__html</span>: content&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">    <span class="built_in">document</span>.body</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>å¦‚æœåœ¨ç¼–å†™æ—¶ä½¿ç”¨äº†reactè‡ªå®šä¹‰å±æ€§  reactæ˜¯ä¸ä¼šæ¸²æŸ“çš„</li>
</ul>
<p>é”™è¯¯åšæ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">React.render(</span><br><span class="line">    &lt;div dd=<span class="string">'xxx'</span>&gt;content&lt;<span class="regexp">/div&gt;,</span></span><br><span class="line"><span class="regexp">    document.body</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<p>æ­£ç¡®åšæ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">React.render(</span><br><span class="line">    &lt;div data-dd=<span class="string">'xxx'</span> aria-dd=<span class="string">'xxx'</span>&gt;content&lt;<span class="regexp">/div&gt;,</span></span><br><span class="line"><span class="regexp">    document.body</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>js</tag>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½ ä¸çŸ¥é“çš„JSç³»åˆ—-ä½œç”¨åŸŸã€å˜é‡æå‡ã€é—­åŒ…</title>
    <url>/2019/03/25/actionScope/</url>
    <content><![CDATA[<p>æ¥çœ‹å‡ ä¸ªæ—¢åŸºæœ¬åˆé‡è¦çš„æ¦‚å¿µæŸ¥æ¼è¡¥ç¼º<br><a id="more"></a></p>
<h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><p>å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€æœ€åŸºç¡€çš„åŠŸèƒ½ä¹‹ä¸€ å°±æ˜¯å­˜å‚¨å˜é‡å½“ä¸­çš„å€¼ï¼Œå¹¶èƒ½åœ¨ä¹‹åå¯¹è¿™ä¸ªå€¼è¿›è¡Œè®¿é—®å’Œä¿®æ”¹<br>å¼•å‡ºä¸‹é¢ä¸¤ä¸ªé—®é¢˜</p>
<ul>
<li>é‚£è¿™äº›å˜é‡å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ</li>
<li>ç¨‹åºéœ€è¦çš„æ—¶å€™ å¦‚ä½•æ‰¾åˆ°ä»–ä»¬ï¼Ÿ</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦ä¸€å¥—è®¾è®¡è‰¯å¥½çš„è§„åˆ™æ¥å­˜å‚¨å˜é‡ï¼Œå¹¶ä¸”ä¹‹åå¯ä»¥æ–¹ä¾¿çš„æ‰¾åˆ°è¿™äº›å˜é‡,å®ƒå« <font color="red">ä½œç”¨åŸŸ</font></p>
<h3 id="jsç¨‹åºç¼–è¯‘åŸç†"><a href="#jsç¨‹åºç¼–è¯‘åŸç†" class="headerlink" title="jsç¨‹åºç¼–è¯‘åŸç†"></a>jsç¨‹åºç¼–è¯‘åŸç†</h3><p>jsæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€,ä½†æ˜¯ä¸ä¼ ç»Ÿçš„ç¼–è¯‘è¯­è¨€ä¸åŒï¼Œä»–ä¸æ˜¯æå‰ç¼–è¯‘çš„</p>
<p>jså¼•æ“è¿›è¡Œç¼–è¯‘çš„æ­¥éª¤å’Œä¼ ç»Ÿçš„ç¼–è¯‘è¯­è¨€éå¸¸ç›¸ä¼¼,ä½†æ˜¯æŸäº›ç¯èŠ‚ä¼šæ›´åŠ å¤æ‚ ä¾‹å¦‚ï¼šåœ¨è¯­æ³•åˆ†æå’Œä»£ç ç”Ÿæˆé˜¶æ®µæœ‰ç‰¹å®šçš„æ­¥éª¤æ¥å¯¹è¿è¡Œæ€§èƒ½è¿›è¡Œä¼˜åŒ–,åŒ…æ‹¬å¯¹å†—ä½™å…ƒç´ çš„ä¼˜åŒ–</p>
<ul>
<li>åˆ†è¯/è¯æ³•åˆ†æ</li>
<li>è§£æ/è¯­æ³•åˆ†æ </li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å°†è¯æ³•å•å…ƒæµï¼ˆæ•°ç»„ï¼‰è½¬åŒ–ä¸ºASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰</span><br></pre></td></tr></table></figure>
<ul>
<li>ä»£ç ç”Ÿæˆ </li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å°†ASTè½¬åŒ–ä¸ºå¯æ‰§è¡Œä»£ç </span><br></pre></td></tr></table></figure>
<p>jså¼•æ“æ‰§è¡Œä¸€æ®µå¯æ‰§è¡Œä»£ç æ—¶ï¼Œä¼šåˆ›å»ºå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¯¹äºæ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œéƒ½æœ‰ä¸‰ä¸ªé‡è¦å±æ€§ï¼š</p>
<ul>
<li><p>å˜é‡å¯¹è±¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ¯ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½ä¼šåˆ†é…ä¸€ä¸ªå˜é‡å¯¹è±¡ï¼Œå˜é‡å¯¹è±¡çš„å±æ€§ç”±å˜é‡å’Œå‡½æ•°å£°æ˜æ„æˆï¼Œåœ¨å‡½æ•°ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹ï¼Œå‚æ•°åˆ—è¡¨ä¹Ÿä¼šè¢«åŠ å…¥åˆ°å˜é‡å¯¹è±¡ä½œä¸ºå±æ€§,ä¸åŒä½œç”¨åŸŸçš„å˜é‡å¯¹è±¡äº’ä¸ç›¸åŒï¼Œå®ƒä¿å­˜äº†å½“å‰ä½œç”¨åŸŸçš„æ‰€æœ‰å‡½æ•°å’Œå˜é‡</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½œç”¨åŸŸé“¾</p>
</li>
<li><p>thisæŒ‡å‘</p>
<p>å½“ä½ çœ‹åˆ°<code>var a = 2</code> ç¨‹åºå†…éƒ¨çš„å·¥ä½œè¿‡ç¨‹</p>
</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">ç¼–è¯‘å™¨å°†è¿™ç«¯ç¨‹åºåˆ†è§£æˆè¯æ³•å•å…ƒ <span class="selector-tag">var</span> <span class="selector-tag">a</span>, a=<span class="number">2</span> ç„¶åå°†è¯æ³•å•å…ƒè§£ææˆä¸€ä¸ªæ ‘ç»“æ„</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.é‡åˆ°<span class="selector-tag">var</span> <span class="selector-tag">a</span> ç¼–è¯‘å™¨ä¼šè¯¢é—®ä½œç”¨åŸŸæ˜¯å¦å·²ç»æœ‰è¯¥å˜é‡çš„åç§°å­˜åœ¨äºåŒä¸€ä¸ªä½œç”¨åŸŸä¸­,å¦‚æœæ˜¯ï¼Œç¼–è¯‘å™¨å¿½ç•¥è¯¥å£°æ˜ å¦åˆ™ä¼šè¦æ±‚ä½œç”¨åŸŸåœ¨å½“å‰ä½œç”¨åŸŸçš„é›†åˆä¸­å£°æ˜ä¸€ä¸ªæ–°çš„å˜é‡ å‘½åä¸ºa</span><br><span class="line"><span class="number">2</span>.å½“ä¸ºå¼•æ“ç”Ÿæˆè¿è¡Œæ—¶æ‰€éœ€è¦çš„ä»£ç  a=<span class="number">2</span> jså¼•æ“è¿è¡Œæ—¶ä¼šè¯¢é—®ä½œç”¨åŸŸï¼Œå½“å‰ä½œç”¨åŸŸçš„é›†åˆä¸­æ˜¯å¦å­˜åœ¨<span class="selector-tag">a</span> å­˜åœ¨ å°±æ˜¯ç”¨ ä¸å­˜åœ¨å°±ç»§ç»­æŸ¥æ‰¾ å¦‚æœè¿˜æ˜¯æ‰¾ä¸åˆ° å°±æŠ›å‡ºå¼‚å¸¸</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼šå˜é‡çš„èµ‹å€¼æ“ä½œä¼šæ‰§è¡Œä¸¤ä¸ªè¿‡ç¨‹</p>
<ul>
<li>ç¼–è¯‘å™¨ä¼šåœ¨å½“å‰ä½œç”¨åŸŸä¸­ç”Ÿæˆä¸€ä¸ªå˜é‡ï¼ˆä¹‹å‰æ²¡æœ‰ç”Ÿæˆè¿‡ï¼‰è¿™ä¼šåœ¨ä»£ç æ‰§è¡Œå‰è¿›è¡Œ</li>
<li>è¿è¡Œæ—¶jså¼•æ“ä¼šåœ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾ï¼ˆLHSæŸ¥è¯¢ï¼‰è¯¥å˜é‡èƒ½æ‰¾åˆ°å°±ç»™ä»–èµ‹å€¼</li>
</ul>
<h4 id="jså¼•æ“æ˜¯å¦‚ä½•æŸ¥æ‰¾å˜é‡çš„ï¼Ÿ"><a href="#jså¼•æ“æ˜¯å¦‚ä½•æŸ¥æ‰¾å˜é‡çš„ï¼Ÿ" class="headerlink" title="jså¼•æ“æ˜¯å¦‚ä½•æŸ¥æ‰¾å˜é‡çš„ï¼Ÿ"></a>jså¼•æ“æ˜¯å¦‚ä½•æŸ¥æ‰¾å˜é‡çš„ï¼Ÿ</h4><p>LHS æŸ¥è¯¢ ï¼ˆèµ‹å€¼æ“ä½œçš„ç›®æ ‡æ˜¯è°ï¼‰<br>RHSæŸ¥è¯¢ ï¼ˆè°æ˜¯èµ‹å€¼æ“ä½œçš„æºå¤´ï¼‰</p>
<h3 id="è¯æ³•ä½œç”¨åŸŸ"><a href="#è¯æ³•ä½œç”¨åŸŸ" class="headerlink" title="è¯æ³•ä½œç”¨åŸŸ"></a>è¯æ³•ä½œç”¨åŸŸ</h3><p>å¤§éƒ¨åˆ†çš„æ ‡å‡†è¯­è¨€ç¼–è¯‘å™¨çš„ç¬¬ä¸€ä¸ªå·¥ä½œå°±å«è¯æ³•åŒ–<br>è¯æ³•åŒ–çš„è¿‡ç¨‹ä¼šå¯¹æºä»£ç è¿›è¡Œæ£€æŸ¥<br>è¯æ³•ä½œç”¨åŸŸå°±æ˜¯å®šä¹‰åœ¨è¯æ³•é˜¶æ®µçš„ä½œç”¨åŸŸ<br>è¯æ³•ä½œç”¨åŸŸæ„å‘³ç€ä½œç”¨åŸŸæ˜¯ç”±ä¹¦å†™ä»£ç æ—¶å‡½æ•°å£°æ˜çš„ä½ç½®å†³å®šçš„</p>
<h3 id="å‡½æ•°ä½œç”¨åŸŸ"><a href="#å‡½æ•°ä½œç”¨åŸŸ" class="headerlink" title="å‡½æ•°ä½œç”¨åŸŸ"></a>å‡½æ•°ä½œç”¨åŸŸ</h3><p>å‡½æ•°æ˜¯jsä¸­æœ€å¸¸è§çš„ä½œç”¨åŸŸå•å…ƒ å£°æ˜åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨çš„å˜é‡æˆ–å‡½æ•°ä¼šåœ¨æ‰€å¤„çš„ä½œç”¨åŸŸä¸­éšè—èµ·æ¥ è¿™ç¬¦åˆæœ€å°æˆæƒï¼ˆæš´éœ²ï¼‰åŸåˆ™</p>
<h4 id="æœ€å°æˆæƒï¼ˆæš´éœ²ï¼‰åŸåˆ™çš„å¥½å¤„ï¼Ÿ"><a href="#æœ€å°æˆæƒï¼ˆæš´éœ²ï¼‰åŸåˆ™çš„å¥½å¤„ï¼Ÿ" class="headerlink" title="æœ€å°æˆæƒï¼ˆæš´éœ²ï¼‰åŸåˆ™çš„å¥½å¤„ï¼Ÿ"></a>æœ€å°æˆæƒï¼ˆæš´éœ²ï¼‰åŸåˆ™çš„å¥½å¤„ï¼Ÿ</h4><ol>
<li>éšè—å†…éƒ¨å®ç° APIå‹å¥½</li>
<li>è§„é¿å†²çª ï¼ˆåŒåæ ‡è¯†ç¬¦ä¹‹é—´çš„å†²çªï¼‰</li>
</ol>
<h3 id="å—ä½œç”¨åŸŸ"><a href="#å—ä½œç”¨åŸŸ" class="headerlink" title="å—ä½œç”¨åŸŸ"></a>å—ä½œç”¨åŸŸ</h3><p>å—ä½œç”¨åŸŸæ˜¯æŒ‡å˜é‡å’Œå‡½æ•°ä¸ä»…å¯ä»¥å±äºæ‰€å¤„çš„ä½œç”¨åŸŸä¹Ÿå¯ä»¥å±äºæŸä¸ªä»£ç å—å„¿{â€¦}<br>ES3å¼€å§‹ try/catchç»“æ„åœ¨catchåˆ†å¥ä¸­å…·æœ‰å—ä½œç”¨åŸŸ<br>ES6å¼•å…¥äº†let const å¯ä»¥ç”¨åœ¨å¾ªç¯ä¸­ ä¼šå°†å½“å‰çš„å€¼é‡æ–°ç»‘å®šåˆ°äº†å¾ªç¯çš„æ¯ä¸€ä¸ªè¿­ä»£ä¸­</p>
<hr>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul>
<li>ä½œç”¨åŸŸæ˜¯ä¸€å¥—è§„åˆ™ï¼Œç”¨äºç¡®å®šåœ¨ä½•å¤„ä»¥åŠå¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œå¦‚æœæŸ¥æ‰¾çš„ç›®çš„æ˜¯å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨LHSæŸ¥è¯¢ï¼Œå¦‚æœç›®çš„æ˜¯ä¸ºäº†è·å–å˜é‡çš„å€¼ é‚£å°±è¿›è¡ŒRHSæŸ¥è¯¢ èµ‹å€¼æ“ä½œä¼šå¯¼è‡´LHSæŸ¥è¯¢</li>
<li>LHSä¸RHSæŸ¥è¯¢éƒ½ä¼šä»å½“å‰ä½œç”¨åŸŸä¸­å¼€å§‹ï¼Œå¦‚æœæœ‰éœ€è¦å°±ä¼šå‘ä¸Šçº§ä½œç”¨åŸŸç»§ç»­æŸ¥æ‰¾ç›®æ ‡æ ‡è¯†ç¬¦ã€‚è¿™æ ·å„¿æ¯æ¬¡ä¸Šå‡ä¸€çº§ä½œç”¨åŸŸï¼Œæœ€åæŠµè¾¾è¿å±…ä½œç”¨åŸŸ æ— è®ºæ‰¾åˆ°æ²¡æ‰¾åˆ°éƒ½ä¼šåœæ­¢</li>
<li>ä¸æˆåŠŸçš„RHSå¼•ç”¨ä¼šæŠ›å‡ºå¼‚å¸¸ ä¸æˆåŠŸçš„RHSå¼•ç”¨ä¼šå¯¼è‡´è‡ªåŠ¨éšå¼åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡</li>
<li>è¯æ³•ä½œç”¨åŸŸæ„å‘³ç€ä½œç”¨åŸŸæ˜¯ç”±ä¹¦å†™ä»£ç æ—¶å‡½æ•°å£°æ˜çš„ä½ç½®å†³å®šçš„ã€‚ç¼–è¯‘çš„è¯æ³•åˆ†æé˜¶æ®µåŸºæœ¬èƒ½å¤ŸçŸ¥é“å…¨éƒ¨æ ‡è¯†ç¬¦åœ¨å“ªé‡Œä»¥åŠå¦‚ä½•å£°æ˜çš„ï¼Œä»è€Œèƒ½å¤Ÿåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚ä½•å¯¹ä»–ä»¬è¿›è¡ŒæŸ¥æ‰¾</li>
<li>eval()ä¸with() å¯ä»¥æ‰©å……è¯æ³•ä½œç”¨åŸŸ ä½†æ˜¯ä¼šæœ‰æ€§èƒ½é—®é¢˜</li>
<li>å‡½æ•°æ˜¯å¸¸è§ä½†ä¸æ˜¯å”¯ä¸€çš„ä½œç”¨åŸŸå•å…ƒï¼Œå‡½æ•°ä½œç”¨åŸŸä¸å—ä½œç”¨åŸŸçš„è¡Œä¸ºæ˜¯ä¸€æ ·å„¿çš„ ä»»ä½•å£°æ˜åœ¨æŸä¸ªä½œç”¨åŸŸå†…çš„å˜é‡éƒ½å°†é™„å±äºè¿™ä¸ªä½œç”¨åŸŸ</li>
<li>ES6ä¸­å¼•å…¥äº†letå…³é”®å­— ç”¨æ¥åœ¨ä»»æ„ä»£ç å—ä¸­å£°æ˜å˜é‡</li>
</ul>
<h2 id="æå‡"><a href="#æå‡" class="headerlink" title="æå‡"></a>æå‡</h2><ul>
<li>å…ˆæœ‰å£°æ˜ åæœ‰èµ‹å€¼</li>
<li>åªæœ‰å£°æ˜æœ¬èº«ä¼šè¢«æå‡ï¼Œè€Œèµ‹å€¼ç­‰å…¶ä»–è¿è¡Œé€»è¾‘ä¼šç•™åœ¨åŸåœ°ï¼Œæå‡ä¸ä¼šæ”¹å˜ä»£ç çš„æ‰§è¡Œé¡ºåº</li>
<li>æ³¨æ„é¿å…é‡å¤å£°æ˜</li>
<li>æ¯ä¸ªä½œç”¨åŸŸéƒ½ä¼šè¿›è¡Œæå‡æ“ä½œ</li>
<li>å‡½æ•°å£°æ˜ä¼šè¢«æå‡ï¼Œå‡½æ•°è¡¨è¾¾å¼ä¸ä¼šè¢«æå‡</li>
<li>å‡½æ•°æå‡ä¼˜å…ˆäºå˜é‡æå‡</li>
<li>ä¸€ä¸ªæ™®é€šå—å†…éƒ¨çš„å‡½æ•°å£°æ˜é€šå¸¸ä¼šè¢«æå‡åˆ°æ‰€åœ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨</li>
<li>æ— è®ºä½œç”¨åŸŸä¸­çš„å£°æ˜å‡ºç°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œéƒ½å°†ä¼šåœ¨ä»£ç æœ¬èº«è¢«æ‰§è¡Œå‰é¦–å…ˆè¢«å¤„ç†ï¼ˆæ‰€æœ‰çš„å˜é‡å£°æ˜å’Œå‡½æ•°å£°æ˜ï¼‰éƒ½ä¼šè¢«ç§»åŠ¨åˆ°å„è‡ªä½œç”¨åŸŸçš„æœ€é¡¶ç«¯</li>
</ul>
<hr>
<h2 id="ä½œç”¨åŸŸé—­åŒ…"><a href="#ä½œç”¨åŸŸé—­åŒ…" class="headerlink" title="ä½œç”¨åŸŸé—­åŒ…"></a>ä½œç”¨åŸŸé—­åŒ…</h2><ul>
<li>é—­åŒ…æ— å¤„ä¸åœ¨ ä½ éœ€è¦çš„æ˜¯è¯†åˆ«å¹¶ä¸”æ‹¥æŠ±å®ƒ</li>
<li>é—­åŒ…æ˜¯åŸºäºè¯æ³•ä½œç”¨åŸŸä¹¦å†™ä»£ç æ—¶äº§ç”Ÿçš„è‡ªç„¶ç»“æœ</li>
<li>å½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸæ—¶å°±äº§ç”Ÿäº†é—­åŒ… å³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œ</li>
<li>é—­åŒ…å¯ä»¥ä½¿å¾—å‡½æ•°å¯ä»¥ç»§ç»­è®¿é—®å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸ</li>
<li>å¦‚æœå°†å‡½æ•°å½“ä½œç¬¬ä¸€çº§çš„å€¼ç±»å‹å¹¶åˆ°å¤„ä¼ é€’ å°±ä¼šçœ‹åˆ°é—­åŒ…åœ¨è¿™äº›å‡½æ•°ä¸­çš„åº”ç”¨</li>
<li>åœ¨å®šæ—¶å™¨ï¼Œäº‹ä»¶ç›‘å¬å™¨ajaxè¯·æ±‚ æˆ–è€…ä»»ä½•å…¶ä»–çš„å¼‚æ­¥ä»»åŠ¡é‡ ä¹‹è¦ä½¿ç”¨äº†å›è°ƒå‡½æ•° å®é™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…</li>
<li>é—­åŒ… å°±æ˜¯å…³äºå¦‚ä½•åœ¨å‡½æ•°ä½œä¸ºå€¼æŒ‰éœ€ä¼ é€’çš„è¯æ³•ç¯å¢ƒä¸­ä¹¦å†™ä»£ç çš„</li>
</ul>
<h3 id="å¾ªç¯ä¸é—­åŒ…"><a href="#å¾ªç¯ä¸é—­åŒ…" class="headerlink" title="å¾ªç¯ä¸é—­åŒ…"></a>å¾ªç¯ä¸é—­åŒ…</h3><p>å—ä½œç”¨åŸŸå’Œé—­åŒ…è”æ‰‹ä¾¿å¯å¤©ä¸‹æ— æ•Œ</p>
<p>ä½¿ç”¨IIFEï¼ˆè‡ªæ‰§è¡Œå‡½æ•°ï¼‰</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(var <span class="built_in">i</span> =<span class="number">1</span>; <span class="built_in">i</span>&lt;=<span class="number">5</span>;<span class="built_in">i</span>++)&#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span><span class="params">(j)</span>&#123;</span></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span><span class="params">()</span>&#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'j'</span>,<span class="built_in">j</span>);</span><br><span class="line">  &#125;,<span class="built_in">i</span>*<span class="number">100</span>)</span><br><span class="line">  &#125;)(<span class="built_in">i</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">letç”¨æ¥åŠ«æŒå—ä½œç”¨åŸŸ å¹¶ä¸”åœ¨è¿™ä¸ªå—ä½œç”¨åŸŸä¸­å£°æ˜ä¸€ä¸ªå˜é‡</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(var <span class="built_in">i</span> =<span class="number">1</span>; <span class="built_in">i</span>&lt;=<span class="number">5</span>;<span class="built_in">i</span>++)&#123;</span><br><span class="line">  let <span class="built_in">j</span> = <span class="built_in">i</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span><span class="params">()</span>&#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="built_in">j</span>);</span><br><span class="line">  &#125;,<span class="built_in">i</span>*<span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>å¾ªç¯å¤´éƒ¨çš„letå£°æ˜ æ¯æ¬¡è¿­ä»£éƒ½ä¼šå£°æ˜</span><br><span class="line"><span class="keyword">for</span>(let <span class="built_in">i</span> =<span class="number">1</span>; <span class="built_in">i</span>&lt;=<span class="number">5</span>;<span class="built_in">i</span>++)&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> <span class="title">timer</span><span class="params">()</span>&#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="built_in">i</span>);</span><br><span class="line">  &#125;,<span class="built_in">i</span>*<span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>ä½œç”¨åŸŸ</tag>
        <tag>é—­åŒ…</tag>
      </tags>
  </entry>
  <entry>
    <title>å®ç°ä¸€ä¸ªSSRåŒæ„åº”ç”¨</title>
    <url>/2019/03/06/SSRDemo/</url>
    <content><![CDATA[<p>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€æ˜“çš„æœåŠ¡ç«¯æ¸²æŸ“æµç¨‹ï¼Œæ„åœ¨ä½“ä¼šSSRå¸¦æ¥çš„çº¢åˆ©<br><a id="more"></a><br>é¡µé¢æºç æ¥è‡ª<a href>ReactçŠ¶æ€ç®¡ç†ä¸åŒæ„å®æˆ˜</a></p>
<h2 id="å‡ ä¸ªé‡è¦çš„æ¦‚å¿µ"><a href="#å‡ ä¸ªé‡è¦çš„æ¦‚å¿µ" class="headerlink" title="å‡ ä¸ªé‡è¦çš„æ¦‚å¿µ"></a>å‡ ä¸ªé‡è¦çš„æ¦‚å¿µ</h2><p>å®ç°<code>SSR</code>æ˜¯ä¾é <code>React</code>æä¾›çš„<code>ReactDomServer</code>å¯¹è±¡</p>
<p>å®ƒä¸»è¦æä¾›äº†åªèƒ½åœ¨æœåŠ¡ç«¯ä½¿ç”¨çš„<code>renderToString()</code>ä¸<code>renderToStaticMarkup()</code>æ–¹æ³•</p>
<h3 id="renderToString-renderToStaticMarkup"><a href="#renderToString-renderToStaticMarkup" class="headerlink" title="renderToString()/renderToStaticMarkup()"></a>renderToString()/renderToStaticMarkup()</h3><p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong> <code>ReactDomServer.renderTostring(element)</code>/<br><code>ReactDomServer.renderToStaticMarkup(element)</code></p>
<h4 id="å…±åŒç‚¹ï¼š"><a href="#å…±åŒç‚¹ï¼š" class="headerlink" title="å…±åŒç‚¹ï¼š"></a>å…±åŒç‚¹ï¼š</h4><ul>
<li>éƒ½æ¥æ”¶ä¸€ä¸ªReact Element å¹¶<strong>å°†æ­¤ Element è½¬åŒ–ä¸ºHTMLå­—ç¬¦ä¸²,é€šè¿‡æµè§ˆå™¨è¿”å›</strong>ï¼Œå®ç°äº†åœ¨æœåŠ¡ç«¯å°†é¡µé¢æ‹¼æ¥å­—ç¬¦ä¸²æ’å…¥HTMLæ–‡æ¡£ä¸­å¹¶è¿”å›ç»™æµè§ˆå™¨ å®Œæˆåˆæ­¥æœåŠ¡ç«¯æ¸²æŸ“çš„ç›®çš„</li>
</ul>
<h4 id="ä¸åŒç‚¹"><a href="#ä¸åŒç‚¹" class="headerlink" title="ä¸åŒç‚¹"></a>ä¸åŒç‚¹</h4><ul>
<li>renderToString(<font color="red">æ³¨ï¼šReact 15</font>) ç”Ÿæˆçš„HTMLå­—ç¬¦ä¸²çš„æ¯ä¸ªDomèŠ‚ç‚¹éƒ½æœ‰<code>data-react-id</code>å±æ€§ï¼Œæ ¹èŠ‚ç‚¹ä¼šæœ‰ä¸€ä¸ª<code>data-react-checkSum</code>å±æ€§</li>
<li>renderToStaticMarkup ä¸å¸¦<code>data-react-checkSum</code>å±æ€§ æµè§ˆå™¨æ¸²æŸ“æ—¶å¿…ä¼šé‡æ–°æ¸²æŸ“ç»„ä»¶</li>
</ul>
<hr>
<p><font color="red">å…³äºdata-react-checkSum</font>ï¼š</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">å¦‚æœä¸¤ä¸ªç»„ä»¶æœ‰ç›¸åŒçš„propså’Œ<span class="type">Dom</span>ç»“æ„ï¼Œè¿™ä¸ªå€¼æ˜¯ä¸€æ ·çš„</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬çŸ¥é“ æœåŠ¡ç«¯æ¸²æŸ“å®Œé¡µé¢å†…å®¹éš¾è¿‡ä¹‹åï¼Œæµè§ˆå™¨ç«¯ä¹Ÿä¼šæ¸²æŸ“ä»¥å®Œæˆç»„ä»¶çš„äº¤äº’ç­‰èƒ½åŠ›ï¼Œæµè§ˆå™¨ç«¯ä¼šç”Ÿæˆç»„ä»¶çš„<span class="class"><span class="keyword">data</span>-react-checkSumå€¼ ç„¶åè·ŸæœåŠ¡ç«¯æ¸²æŸ“ç»„ä»¶çš„å€¼åšå¯¹æ¯”ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™ä¸å†é‡å¤æ¸²æŸ“</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸€å¼ è‰å›¾èƒ½å¤§æ¦‚æè¿°è¿™ä¸ªè¿‡ç¨‹å˜¤å˜¤å˜¤.<br><img src="/images/ssr/ssrcc.png" alt="cache_detai"></p>
<hr>
<h3 id="ReactDom-hydrate"><a href="#ReactDom-hydrate" class="headerlink" title="ReactDom.hydrate()"></a>ReactDom.hydrate()</h3><p>React 16ä»¥åé€šè¿‡<br><code>renderToString</code>æ¸²æŸ“çš„ç»„ä»¶ä¸å†å¸¦æœ‰<code>data-react-*</code>å±æ€§ï¼Œå› æ­¤æµè§ˆå™¨ç«¯çš„æ¸²æŸ“æ–¹å¼æ— æ³•ç®€å•é€šè¿‡<code>data-react-checksum</code>æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“</p>
<p>åŸºäºè¿™æ ·å„¿çš„èƒŒæ™¯ä¸‹<code>ReactDom</code>æä¾›äº†ä¸€ä¸ªæ–°çš„API <code>ReactDom.hydrate()</code> ç”¨æ³•åŒ<code>render()</code>åœ¨æµè§ˆå™¨ç«¯æ¸²æŸ“ç»„ä»¶</p>
<p>å½“ç„¶ï¼Œreactæ˜¯å‘ä¸‹å…¼å®¹çš„ï¼Œæµè§ˆå™¨ç«¯åœ¨æ¸²æŸ“ç»„ä»¶æ—¶ä½¿ç”¨render()ä»ç„¶æ²¡æœ‰é—®é¢˜ï¼Œä½†ä¸è®ºæ˜¯é¢å‘æœªæ¥ï¼Œè¿˜æ˜¯åŸºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œéƒ½åº”è¯¥é‡‡ç”¨æ›´å¥½çš„æ¨¡å¼</p>
<hr>
<h3 id="renderToNodeStream-renderToStaticNodeStream"><a href="#renderToNodeStream-renderToStaticNodeStream" class="headerlink" title="renderToNodeStream()/renderToStaticNodeStream()"></a>renderToNodeStream()/renderToStaticNodeStream()</h3><p><font color="red">React 16 </font>ä¸ºäº†ä¼˜åŒ–é¡µé¢çš„åˆå§‹åŠ è½½é€Ÿåº¦ç¼©çŸ­TTFBæ—¶é—´,æä¾›äº†è¿™ä¸¤ä¸ªæ–¹æ³•</p>
<p><strong>æ¦‚å¿µ</strong><br>è¯¥æ–¹æ³•æŒç»­äº§ç”Ÿå­èŠ‚æµ è¿”å› <code>Readable stream</code> æœ€ç»ˆ<strong>é€šè¿‡æµå½¢å¼è¿”å›çš„HTMLå­—ç¬¦ä¸²</strong><br>è¿™æ · æœåŠ¡ç«¯å¤„ç†å†…å®¹æ—¶æ˜¯å®æ—¶å‘æµè§ˆå™¨ç«¯ä¼ è¾“æ•°æ®è€Œä¸æ˜¯ä¸€æ¬¡æ€§å¤„ç†å®Œæˆåæ‰å¼€å§‹è¿”å›ç»“æœçš„</p>
<p><code>renderToStaticNodeStream</code> ä¹‹äº <code>renderToNodeStream</code> ä¹Ÿæ˜¯ä¸ä¼šäº§ç”Ÿ<code>data-react-*</code>å±æ€§ï¼Œå¯¹äºé™æ€é¡µé¢ å¯ä»¥é‡‡ç”¨æ­¤æ–¹æ³•ã€‚</p>
<h2 id="å®é™…å¼€å‘ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜"><a href="#å®é™…å¼€å‘ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å®é™…å¼€å‘ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜"></a>å®é™…å¼€å‘ä¸­å¯èƒ½å­˜åœ¨çš„é—®é¢˜</h2><ol>
<li>æœåŠ¡ç«¯ä¸å­˜åœ¨æ”¯æŒç»„ä»¶æŒ‚è½½çš„æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥reactç»„ä»¶åªæœ‰<code>componentDidMount</code>ä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æœ‰æ•ˆï¼Œæ‰€ä»¥åœ¨å…¶ä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ä¸èƒ½ç”¨åˆ°æµè§ˆå™¨çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ <code>windowã€localStorage</code>.</li>
<li>åŒç«¯å¯èƒ½éƒ½æœ‰æ‹‰å–æ•°æ®çš„éœ€æ±‚ï¼Œæ‰€ä»¥ä¸ºäº†å®ç°ä»£ç çš„å¤ç”¨ï¼Œä¸€ç§å…¸å‹çš„åšæ³•å°±æ˜¯æŠŠè¯·æ±‚æ•°æ®çš„é€»è¾‘æ”¾åˆ°Reactç»„ä»¶çš„é™æ€æ–¹æ³•ä¸­ ç„¶ååŒç«¯å…±ç”¨ï¼ŒåŒç«¯è¯·æ±‚æ–¹æ³•ä¸ä¸€è‡´çš„é—®é¢˜å¯ä»¥é€šè¿‡æœåŠ¡ç«¯ä¸æµè§ˆå™¨ç«¯çš„åˆ¤æ–­æ¥å°è£…ä¸€ä¸‹ <strong>æ¯”å¦‚æ ¹æ®windowæ˜¯æµè§ˆå™¨ç‰¹æœ‰å¯¹è±¡</strong></li>
</ol>
<h2 id="React-16-åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸Šçš„æƒŠå–œ"><a href="#React-16-åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸Šçš„æƒŠå–œ" class="headerlink" title="React 16 åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸Šçš„æƒŠå–œ"></a>React 16 åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸Šçš„æƒŠå–œ</h2><p>å‰é¢ä¹Ÿæœ‰æ··æ‚è¯´è¿‡ï¼Œåœ¨æ­¤æ€»ç»“ä¸€ä¸‹</p>
<ul>
<li>åœ¨æµè§ˆå™¨æ¸²æŸ“ç»„ä»¶éœ€è¦é…åˆæœåŠ¡ç«¯ä½¿ç”¨<code>hydrate</code>æ–¹æ³•</li>
<li>æä¾›äº†<code>stream</code>æ–¹å¼çš„æ¥å£</li>
<li>ä¸æµè§ˆå™¨çš„æ–°ç‰¹æ€§ç›¸ä¼¼ï¼Œé™¤äº†èƒ½å¤„ç†<code>React Element</code> ä¹Ÿèƒ½å¤„ç†åˆ«çš„ç±»å‹ï¼Œæ¯”å¦‚<code>string number</code></li>
<li>å› ä¸ºåœ¨è¿”å›ç»“æœDomä¸­åºŸé™¤äº†<code>data-react-checksum</code>ç­‰å±æ€§ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ç”ŸæˆHTMLæ›´åŠ é«˜æ•ˆ</li>
<li>å…è®¸åœ¨æ¸²æŸ“Domä¸­åŠ å…¥éæ ‡å‡†Domå±æ€§</li>
</ul>
<hr>
<p>å¥½äº† æµ‹è¯•ä¸€ä¸‹ï¼ŒåŸºäºNode.jså®ç°ä¸€ä¸ªå°demo</p>
<p><code>Express4.15.3 è¿›è¡ŒæœåŠ¡ç«¯å¤„ç†</code></p>
<p><img src="/images/ssr/ssrvs1.png" alt="ssrvs1"><br>browser: æµè§ˆå™¨ç«¯æ¸²æŸ“<br>serverï¼šæœåŠ¡ç«¯é€»è¾‘<br>shareï¼šåŒæ„çš„éƒ¨åˆ†</p>
<p>è¿è¡Œæ•ˆæœï¼š<br><img src="/images/ssr/ssrvs100.png" alt="ssr"><br><strong>share/app.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">"./logo.svg"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"./App.css"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    alert(<span class="string">'æˆ‘è¢«è§¦å‘è¾£'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">        &lt;div className=<span class="string">"App-header"</span>&gt;</span><br><span class="line">          &lt;img src=&#123;logo&#125; className=<span class="string">"App-logo"</span> alt=<span class="string">"logo"</span> /&gt;</span><br><span class="line">          &lt;h2&gt;Welcome to React <span class="keyword">in</span> the Server&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">        &lt;p className=<span class="string">"App-intro"</span>&gt;ç‚¹å‡»æŒ‰é’®ä½“éªŒ&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">        &lt;button onClick=&#123;e =&gt; this.handleClick()&#125;&gt; æˆ‘æ˜¯æŒ‰é’® &lt;/</span>button&gt;  </span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p><strong>browser/index.js</strong></p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hydrate &#125; <span class="keyword">from</span> <span class="string">"react-dom"</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"../shared/App"</span>;</span><br><span class="line"></span><br><span class="line">hydrate(&lt;App /&gt;, <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>server/index.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">"express"</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; renderToString &#125; <span class="keyword">from</span> <span class="string">"react-dom/server"</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"../shared/App"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static(<span class="string">"public"</span>));</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">"*"</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> htmlMarkup = renderToString(<span class="xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span>);</span></span><br><span class="line"><span class="xml">  res.send(`</span></span><br><span class="line"><span class="xml">      <span class="meta">&lt;!DOCTYPE html&gt;</span></span></span><br><span class="line">      &lt;head&gt;</span><br><span class="line">        &lt;title&gt;Universal Reacl&lt;/title&gt;</span><br><span class="line">        &lt;link rel="stylesheet" href="/css/main.css"&gt;</span><br><span class="line">        &lt;script src="/bundle.js" defer&gt;&lt;/script&gt;</span><br><span class="line">      &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">      &lt;body&gt;</span><br><span class="line">        &lt;div id="root"&gt;$&#123;htmlMarkup&#125;&lt;/div&gt;</span><br><span class="line">      &lt;/body&gt;</span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml">  `);</span></span><br><span class="line"><span class="xml">&#125;);</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">app.listen(process.env.PORT || 3000, () =&gt; &#123;</span></span><br><span class="line"><span class="xml">  console.log("Server is listening");</span></span><br><span class="line"><span class="xml">&#125;);</span></span><br></pre></td></tr></table></figure>
<p><strong>serverç«¯ï¼š</strong>ä½¿ç”¨ <code>renderToString</code>ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œä½¿ç”¨<code>res.send</code>å‘é€ç»™æµè§ˆå™¨<br><strong>clientç«¯ï¼š</strong> idä¸ºrootçš„DomèŠ‚ç‚¹å°±æ¥è‡ªæœåŠ¡ç«¯è¿”å›çš„ç»“æœï¼Œç”¨äº†<code>React.hydrate</code>å®Œæˆäº†æµè§ˆå™¨ç«¯çš„é€»è¾‘å¤„ç†éƒ¨åˆ†</p>
<h3 id="å‡è®¾ä¸€-clientç«¯æ¸²æŸ“ä»ç„¶ä½¿ç”¨render"><a href="#å‡è®¾ä¸€-clientç«¯æ¸²æŸ“ä»ç„¶ä½¿ç”¨render" class="headerlink" title="å‡è®¾ä¸€ clientç«¯æ¸²æŸ“ä»ç„¶ä½¿ç”¨render()"></a>å‡è®¾ä¸€ clientç«¯æ¸²æŸ“ä»ç„¶ä½¿ç”¨render()</h3><p><strong>æµ‹è¯•</strong></p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;render &#125; <span class="keyword">from</span> <span class="string">"react-dom"</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"../shared/App"</span>;</span><br><span class="line"></span><br><span class="line">render(&lt;App /&gt;, <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>));</span><br></pre></td></tr></table></figure>
<p><strong>ç»“æœ</strong><br>ç”±äºå®ç°äº†å‘ä¸‹å…¼å®¹ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¼šç»™å¦‚ä¸‹è­¦å‘Šâš ï¸<br><img src="/images/ssr/hydrate_to_render.png" alt="hydrate_to_rende"></p>
<p><strong>ç»“è®º</strong> å°½é‡ä½¿ç”¨æ–°ç‰¹æ€§</p>
<hr>
<h3 id="å‡è®¾äºŒ-å®Œå…¨ä¾èµ–æœåŠ¡ç«¯æ¸²æŸ“ä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#å‡è®¾äºŒ-å®Œå…¨ä¾èµ–æœåŠ¡ç«¯æ¸²æŸ“ä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="å‡è®¾äºŒ å®Œå…¨ä¾èµ–æœåŠ¡ç«¯æ¸²æŸ“ä¼šå‘ç”Ÿä»€ä¹ˆ"></a>å‡è®¾äºŒ å®Œå…¨ä¾èµ–æœåŠ¡ç«¯æ¸²æŸ“ä¼šå‘ç”Ÿä»€ä¹ˆ</h3><p><strong>æµ‹è¯•</strong><br>å°†<code>browser/index.js</code>ä»£ç æ³¨é‡Šæ‰<br><strong>ç»“æœ</strong><br>é¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œä½†æ˜¯ç‚¹å‡»æŒ‰é’®æ²¡æœ‰ä¸ä¼šå¼¹çª—<br><strong>ç»“è®º</strong> éœ€è¦åŒç«¯ä¸€èµ·å®Œæˆé¡µé¢çš„å±•ç¤ºä¸äº¤äº’</p>
<hr>
<h3 id="å‡è®¾ä¸‰-ä½¿ç”¨React-16-renderToNodeStreamæ¸²æŸ“"><a href="#å‡è®¾ä¸‰-ä½¿ç”¨React-16-renderToNodeStreamæ¸²æŸ“" class="headerlink" title="å‡è®¾ä¸‰ ä½¿ç”¨React 16 renderToNodeStreamæ¸²æŸ“"></a>å‡è®¾ä¸‰ ä½¿ç”¨React 16 renderToNodeStreamæ¸²æŸ“</h3><p><strong>æµ‹è¯• æ›´æ”¹ server/index.js</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">import express from "express";</span><br><span class="line">import React from "react";</span><br><span class="line">import &#123; renderToNodeStream &#125; from "react-dom/server";</span><br><span class="line">import App from "../shared/App";</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.use(express.static("public"));</span><br><span class="line"></span><br><span class="line">app.get("*", (req, res) =&gt; &#123;</span><br><span class="line">  res.write(`</span><br><span class="line">      <span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Universal Reacl<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/css/main.css"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/bundle.js"</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">head</span>&gt;</span>`</span><br><span class="line">  );</span><br><span class="line">  res.write("<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">'root'</span>&gt;</span>"); </span><br><span class="line">  const stream = renderToNodeStream(<span class="tag">&lt;<span class="name">App</span>/&gt;</span>);</span><br><span class="line">  stream.pipe(res, &#123; end: false &#125;);</span><br><span class="line">  stream.on('end', () =&gt; &#123;</span><br><span class="line">    res.write("<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span>");</span><br><span class="line">    res.end();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜ï¼š</strong> ä¸ºäº†é…åˆè¿”å›ä¸€ä¸ªæµï¼Œä½¿ç”¨<code>res.write</code>æ–¹æ³•ä»£æ›¿å…ˆå‰çš„<code>res.end</code></p>
<p><strong>å¥½å¤„</strong><br>ä½¿ç”¨<code>renderToString</code>é¡µé¢TTFBæ—¶é—´</p>
<p><img src="/images/ssr/TTFB2.png" alt="TTFB2"><br>ä½¿ç”¨<code>renderToNodeStream</code>é¡µé¢TTFBæ—¶é—´</p>
<p><img src="/images/ssr/TTFB1.png" alt="TTFB1"></p>
<p><strong>ç»“è®º</strong><br>é‡‡ç”¨æ¸è¿›å¼æµæ¸²æŸ“å¯ä»¥æœ€å¤§é™åº¦çš„ç¼©çŸ­æœåŠ¡å™¨å“åº”æ°´é—´ï¼Œä»è€Œä½¿æµè§ˆå™¨å¯ä»¥æ›´å¿«çš„æ¥æ”¶åˆ°ä¿¡æ¯</p>
<hr>
<h3 id="å‡è®¾ä¸‰-åŒæ„åº”ç”¨ä¸æµè§ˆå™¨æ¸²æŸ“ä¼˜åŠ¿å¯¹æ¯”"><a href="#å‡è®¾ä¸‰-åŒæ„åº”ç”¨ä¸æµè§ˆå™¨æ¸²æŸ“ä¼˜åŠ¿å¯¹æ¯”" class="headerlink" title="å‡è®¾ä¸‰ åŒæ„åº”ç”¨ä¸æµè§ˆå™¨æ¸²æŸ“ä¼˜åŠ¿å¯¹æ¯”"></a>å‡è®¾ä¸‰ åŒæ„åº”ç”¨ä¸æµè§ˆå™¨æ¸²æŸ“ä¼˜åŠ¿å¯¹æ¯”</h3><p>æµè§ˆå™¨æ¸²æŸ“ï¼š<br><img src="/images/ssr/client_render.png" alt="client_rende"></p>
<p>åŒæ„åº”ç”¨ï¼š<br><img src="/images/ssr/ssr.png" alt="ss"></p>
<hr>
<h3 id="å‡è®¾ä¸‰-react16æ¯”react15æ¸²æŸ“æ›´åŠ é«˜æ•ˆ"><a href="#å‡è®¾ä¸‰-react16æ¯”react15æ¸²æŸ“æ›´åŠ é«˜æ•ˆ" class="headerlink" title="å‡è®¾ä¸‰ react16æ¯”react15æ¸²æŸ“æ›´åŠ é«˜æ•ˆ"></a>å‡è®¾ä¸‰ react16æ¯”react15æ¸²æŸ“æ›´åŠ é«˜æ•ˆ</h3><p>React 15<br><img src="/images/ssr/react15_render.png" alt="react15_rende"><br>React 16<br><img src="/images/ssr/react16.png" alt="react16"></p>
<h2 id="é—ç•™é—®é¢˜"><a href="#é—ç•™é—®é¢˜" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h2><ol>
<li>é‰´äº<code>renderToNodeStream()/renderToStaticNodeStream()</code>ä¸<br><code>renderToString()/renderToStaticMarkup()</code><br>React 16ä¹‹åéƒ½ä¸å­˜åœ¨<code>data-react-*</code>äº† åŒæ–¹è¿˜æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
<li>react 16ä¹‹å å¦‚ä½•åšåŒç«¯å¯¹æ¯”ï¼Ÿ å®˜æ–¹è¯´æ˜¯æ ¹æ®<code>ReactDom.hydrate()</code>ä¸<code>renderToString()</code>ç»“åˆåˆ¤æ–­.. ä¸€è„¸æ‡µé€¼</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>æ¨¡æ‹Ÿå®ç°JSçš„bindæ–¹æ³•</title>
    <url>/2019/03/13/bind/</url>
    <content><![CDATA[<h2 id="ä¸ºä»€ä¹ˆè¦å®ç°ä¸€ä¸ªbindå‡½æ•°ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦å®ç°ä¸€ä¸ªbindå‡½æ•°ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å®ç°ä¸€ä¸ªbindå‡½æ•°ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦å®ç°ä¸€ä¸ªbindå‡½æ•°ï¼Ÿ</h2><p><code>bind()</code>å‡½æ•°åœ¨ <code>ECMA-262 ç¬¬äº”ç‰ˆ</code>æ‰è¢«åŠ å…¥<br>å®ƒå¯èƒ½æ— æ³•åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œä¸ºäº†ä¸–ç•Œå’Œå¹³,å¿…è¦çš„æ—¶å€™æˆ‘ä»¬è¦æ‰‹åŠ¨å®ç°å®ƒ</p>
<a id="more"></a>
<h2 id="ç°æœ‰bindå‡½æ•°çš„åŠŸèƒ½ï¼Ÿ"><a href="#ç°æœ‰bindå‡½æ•°çš„åŠŸèƒ½ï¼Ÿ" class="headerlink" title="ç°æœ‰bindå‡½æ•°çš„åŠŸèƒ½ï¼Ÿ"></a>ç°æœ‰bindå‡½æ•°çš„åŠŸèƒ½ï¼Ÿ</h2><p>æ”¹é€ ä¹‹å‰è¦æ¸…æ¥šç°æœ‰<code>bind()</code>å‡½æ•°åšäº†å“ªäº›äº‹å„¿</p>
<p>ä»<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind" target="_blank" rel="noopener">MDN</a>ä¸Šæ‰¾åˆ°ä¸€äº›å…³äºå®ƒçš„å®šä¹‰</p>
<p>bind()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨è°ƒç”¨æ—¶è®¾ç½®thiså…³é”®å­—ä¸ºæä¾›çš„å€¼ã€‚å¹¶åœ¨è°ƒç”¨æ–°å‡½æ•°æ—¶ï¼Œå°†ç»™å®šå‚æ•°åˆ—è¡¨ä½œä¸ºåŸå‡½æ•°çš„å‚æ•°åºåˆ—çš„å‰è‹¥å¹²é¡¹</p>
<p><strong>è¯­æ³•</strong> <code>function.bind(thisArg[, arg1[, arg2[, ...]]])</code></p>
<p>å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°ç»‘å®šå‡½æ•°,å®ƒåŒ…è£…äº†åŸå‡½æ•°å¯¹è±¡<br><code>ceshiFn.bind(myObject)</code></p>
<p>ç»‘å®šå‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨<code>new</code>è¿ç®—ç¬¦æ„é€ ï¼Œæ­¤æ—¶æä¾›çš„<code>this</code>å€¼ä¼šè¢«å¿½ç•¥ï¼Œä½†å‰ç½®å‚æ•°ï¼ˆarg1,arg2ï¼‰ä»ä¼šæä¾›ç»™æ¨¡æ‹Ÿå‡½æ•°</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">var <span class="function"><span class="keyword">Fn</span> </span>= ceshiFn.bind(myObject,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="keyword">new</span> <span class="function"><span class="keyword">Fn</span>(<span class="params"></span>)</span></span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ <code>myObject</code> è¢«å¿½ç•¥ ä½†æ˜¯ å‚æ•°ä¾ç„¶ä¼šä¼ é€’ç»™<code>ceshiFn</code>ä»¤å…¶åˆå§‹åŒ–</p>
<p><strong>å‚æ•°ï¼š</strong></p>
<ul>
<li><font color="red">thisArg</font>ï¼šå½“è¢«ç»‘å®šçš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå°†å®ƒçš„<code>this</code>å…³é”®å­—è®¾ç½®ä¸º<code>thisArg</code></li>
<li><font color="red">arg1ï¼Œarg2</font>:è¢«è°ƒç”¨æ—¶ï¼Œè¿™äº›å‚æ•°å°†ä¼ é€’ç»™è¢«ç»‘å®šçš„æ–¹æ³•</li>
</ul>
<p><strong>è¿”å›å€¼ï¼š</strong><br>æŒ‡å®šçš„<code>this</code>å€¼å’Œåˆå§‹åŒ–å‚æ•°æ”¹é€ è¿‡åŸå‡½æ•°æ‹·è´</p>
<h3 id="ç»§ç»­æ¢ç´¢bindå‡½æ•°çš„åŠŸèƒ½"><a href="#ç»§ç»­æ¢ç´¢bindå‡½æ•°çš„åŠŸèƒ½" class="headerlink" title="ç»§ç»­æ¢ç´¢bindå‡½æ•°çš„åŠŸèƒ½"></a>ç»§ç»­æ¢ç´¢bindå‡½æ•°çš„åŠŸèƒ½</h3><figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">var obj = &#123;&#125;;</span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">'obj'</span>,obj)</span><br><span class="line">console.<span class="built_in">log</span>(typeof <span class="function"><span class="keyword">Function</span>.<span class="title">prototype</span></span>.<span class="keyword">bind</span>)  // <span class="keyword">bind</span></span><br><span class="line">console.<span class="built_in">log</span>(typeof <span class="function"><span class="keyword">Function</span>.<span class="title">prototype</span></span>.<span class="keyword">bind</span>()) //<span class="keyword">bind</span></span><br><span class="line">console.<span class="built_in">log</span>(<span class="function"><span class="keyword">Function</span>.<span class="title">prototype</span></span>.<span class="keyword">bind</span>.<span class="keyword">name</span>) //<span class="keyword">bind</span></span><br><span class="line">console.<span class="built_in">log</span>(<span class="function"><span class="keyword">Function</span>.<span class="title">prototype</span></span>.<span class="keyword">bind</span>().<span class="keyword">name</span>) // bound</span><br></pre></td></tr></table></figure>
<p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¾—å‡ºä»¥ä¸‹ç»“è®º</p>
<ol>
<li><code>bind</code>æ˜¯ <code>Function</code>åŸå‹é“¾ä¸­ <code>Function.prototype</code>çš„ä¸€ä¸ªå±æ€§ï¼Œæ¯ä¸ªå‡½æ•°éƒ½å¯ä»¥è°ƒç”¨å®ƒ</li>
<li><code>bind</code>æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°åä¸º<code>bind</code>çš„å‡½æ•°ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªåä¸º<code>bound</code> çš„å‡½æ•°</li>
</ol>
<p>ä¸‹é¢è¿™ä¸ªä¾‹å­</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">'yishu'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">original</span>(<span class="params">a, b</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    <span class="built_in">console</span>.log([a, b]);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bound = original.bind(obj, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">var</span> boundResult = bound(<span class="number">2</span>); <span class="comment">// 'yishu', [1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(boundResult); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(original.bind.name); <span class="comment">// 'bind'</span></span><br><span class="line"><span class="built_in">console</span>.log(original.bind.length); <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(original.bind().length); <span class="comment">// 2 è¿”å›originalå‡½æ•°çš„å½¢å‚ä¸ªæ•°</span></span><br><span class="line"><span class="built_in">console</span>.log(bound.name); <span class="comment">// 'bound original'</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).bind().name); <span class="comment">// 'bound '</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).bind().length); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<ol>
<li><code>bind</code>æ˜¯å‡½æ•°å¯è¢«ä¼ å‚æ•°ï¼Œè¿”å›å€¼<code>bound</code>ä¹Ÿæ˜¯å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä¼ å‚æ•°</li>
<li>è¢«<code>bind()</code>ç»‘å®šçš„å‡½æ•°çš„thiså…³é”®å­—æ˜¯<code>bind()</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°</li>
<li>ä¼ é€’<code>bind</code>çš„å…¶ä»–å‚æ•°è¢«æ¥æ”¶å¤„ç†äº†ï¼Œ<code>bind()</code>ä¹‹åè¿”å›çš„å‡½æ•°<code>bound</code>å‡½æ•°çš„å‚æ•°ä¹Ÿè¢«æ¥æ”¶å¤„ç†äº†ï¼Œä¹Ÿå°±æ˜¯è¯´è¢«åˆå¹¶å¤„ç†äº†</li>
<li>å¹¶ä¸”<code>bind()</code>åçš„<code>name</code>ä¸º<code>bound + ç©ºæ ¼ + è°ƒç”¨bindçš„å‡½æ•°å</code>ã€‚å¦‚æœæ˜¯åŒ¿åå‡½æ•°åˆ™æ˜¯<code>bound + ç©ºæ ¼</code></li>
<li>bindåçš„è¿”å›å€¼å‡½æ•°<code>bound</code>ï¼Œæ‰§è¡Œåè¿”å›å€¼æ˜¯åŸå‡½æ•°ï¼ˆoriginalï¼‰çš„è¿”å›å€¼</li>
<li>bindå‡½æ•°å½¢å‚ï¼ˆå³å‡½æ•°çš„lengthï¼‰æ˜¯1ã€‚bindåè¿”å›çš„boundå‡½æ•°å½¢å‚æ ¹æ®ç»‘å®šçš„å‡½æ•°åŸå‡½æ•°ï¼ˆoriginalï¼‰å½¢å‚ä¸ªæ•°ç¡®å®š</li>
</ol>
<p>åˆ°è¿™é‡Œ æˆ‘ä»¬æ ¹æ®å¾—å‡ºçš„ç»“è®º å°±å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„bindå‡½æ•°äº†</p>
<h3 id="æ ¸å¿ƒåŠŸèƒ½çš„bindFnå‡½æ•°"><a href="#æ ¸å¿ƒåŠŸèƒ½çš„bindFnå‡½æ•°" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½çš„bindFnå‡½æ•°"></a>æ ¸å¿ƒåŠŸèƒ½çš„bindFnå‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.bindFn = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¿è¯æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨äº†bindFnå‡½æ•°</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span> != <span class="string">'function'</span>)&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="keyword">this</span> + <span class="string">'must be a function'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¿å­˜é™¤äº†thisArgä¹‹å¤–çš„å…¶ä»–å½¢å‚ è½¬æˆæ•°ç»„</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'bindFn'</span>,<span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">let</span> arg = [].slice.call(<span class="built_in">arguments</span> ,<span class="number">1</span>);</span><br><span class="line">   <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">var</span> bound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// bindè¿”å›çš„å‡½æ•° çš„å‚æ•°è½¬æˆæ•°ç»„</span></span><br><span class="line">        <span class="keyword">var</span> boundArgs = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="comment">// applyä¿®æ”¹thisæŒ‡å‘ï¼ŒæŠŠä¸¤ä¸ªå‡½æ•°çš„å‚æ•°åˆå¹¶ä¼ ç»™selfå‡½æ•°ï¼Œå¹¶æ‰§è¡Œselfå‡½æ•°ï¼Œè¿”å›æ‰§è¡Œç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> self.apply(thisArg, arg.concat(boundArgs));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯•</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">'yishu'</span>,</span><br><span class="line">    age:<span class="number">18</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">original</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log([].slice.call(<span class="built_in">arguments</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bound = original.bindFn(obj,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">bound(<span class="number">7</span>); <span class="comment">// [3, 4, 5, 7]</span></span><br></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸ŠæŠŠbindçš„æ ¸å¿ƒåŠŸèƒ½å†™å®Œäº†ï¼Œä¹Ÿèƒ½å¤Ÿé€‚ç”¨å¤§éƒ¨åˆ†åœºæ™¯äº†<code>bindFn</code>åªèƒ½èƒ½åšåˆ°çš„åªæ˜¯æ°¸ä¹…åœ°ç»‘å®šæŒ‡å®šçš„<code>this</code> ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°<code>MDN</code>ä¸Šå…³äº<code>bindå‡½æ•°</code>æè¿° è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯<font color="red">å½“ä½ ä½¿ç”¨<code>newæ“ä½œç¬¦</code>è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶</font><br>æ˜¯è¿™ä¹ˆè¯´çš„</p>
<blockquote>
<p>thisArgï¼šå½“ä½¿ç”¨new æ“ä½œç¬¦è°ƒç”¨ç»‘å®šå‡½æ•°æ—¶ï¼Œè¯¥å‚æ•°æ— æ•ˆã€‚<br>ä¸€ä¸ªç»‘å®šå‡½æ•°ä¹Ÿèƒ½ä½¿ç”¨newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡ï¼šè¿™ç§è¡Œä¸ºå°±åƒæŠŠåŸå‡½æ•°å½“æˆæ„é€ å™¨ã€‚æä¾›çš„<code>this</code>å€¼è¢«å¿½ç•¥ï¼ŒåŒæ—¶è°ƒç”¨æ—¶çš„å‚æ•°è¢«æä¾›ç»™æ¨¡æ‹Ÿå‡½æ•°</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹åŸç”Ÿçš„bindå¯¹äºä½¿ç”¨newçš„æƒ…å†µæ˜¯æ€ä¹ˆæ ·çš„</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">'yishu'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">original</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'this'</span>, <span class="keyword">this</span>.name,[].slice.call(<span class="built_in">arguments</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bound = original.bind(obj,<span class="number">1</span>);</span><br><span class="line">bound(<span class="number">2</span>,<span class="number">3</span>) <span class="comment">//this yishu (3)Â [1, 2, 3]</span></span><br><span class="line"><span class="keyword">new</span> bound(<span class="number">2</span>,<span class="number">3</span>) <span class="comment">//this undefined (3)Â [1, 2, 3]s</span></span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ <code>this</code>æŒ‡å‘äº†<code>new bound()</code>ç”Ÿæˆçš„æ–°å¯¹è±¡ï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°<code>name</code>ä¸º<code>yishu</code>çš„å€¼äº†ï¼Œä½†æ˜¯å‚æ•°ä¾ç„¶ä¼ é€’çš„</p>
<p><strong>ç»“è®º</strong></p>
<ul>
<li><code>bind</code>åŸå…ˆæŒ‡å‘<code>obj</code>çš„å¤±æ•ˆäº†ï¼Œå…¶ä»–å‚æ•°æœ‰æ•ˆã€‚</li>
<li><code>new bound</code>çš„è¿”å›å€¼æ˜¯ä»¥<code>original</code>åŸå‡½æ•°æ„é€ å™¨ç”Ÿæˆçš„æ–°å¯¹è±¡ã€‚<code>original</code>åŸå‡½æ•°çš„<code>this</code>æŒ‡å‘çš„å°±æ˜¯è¿™ä¸ªæ–°å¯¹è±¡</li>
</ul>
<p>æˆ‘ä»¬çœ‹åˆ° åˆæ¶‰åŠåˆ°<code>new</code>æ“ä½œäº†ï¼Œ<a href="http://maying.ink/2019/03/13/new/">å†™è¿‡å…³äºæ¨¡æ‹Ÿnewçš„æ–‡ç« </a><br>ç®€å•æ‘˜è¦ new åšäº†ä»€ä¹ˆ</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ã€‚</span><br><span class="line"><span class="number">2.</span>è¿™ä¸ªå¯¹è±¡ä¼šè¢«æ‰§è¡Œ<span class="string">[[Prototype]]</span>ï¼ˆä¹Ÿå°±æ˜¯__proto__ï¼‰é“¾æ¥ã€‚</span><br><span class="line"><span class="number">3.</span>ç”Ÿæˆçš„æ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„thisã€‚</span><br><span class="line"><span class="number">4.</span>é€šè¿‡newåˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡å°†æœ€ç»ˆè¢«<span class="string">[[Prototype]]</span>é“¾æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„prototypeå¯¹è±¡ä¸Šã€‚</span><br><span class="line"><span class="number">5.</span>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹Object(åŒ…å«Functoin, Array, Date, RegExg, Error)ï¼Œé‚£ä¹ˆnewè¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ ï¼Œå½“ä½¿ç”¨<code>new</code>è°ƒç”¨çš„æ—¶å€™ï¼Œ<code>bind</code>çš„è¿”å›å€¼å‡½æ•°<code>bound</code>å†…éƒ¨è¦æ¨¡æ‹Ÿå®ç°<code>new</code>å®ç°çš„æ“ä½œ,ä¼¼æ›¾ç›¸è¯†äº†</p>
<h3 id="bindFnå‡½æ•°çš„å‡çº§"><a href="#bindFnå‡½æ•°çš„å‡çº§" class="headerlink" title="bindFnå‡½æ•°çš„å‡çº§"></a>bindFnå‡½æ•°çš„å‡çº§</h3><p>åŒºåˆ†æ˜¯å¦æ˜¯newè°ƒç”¨ å½“ä½¿ç”¨newè°ƒç”¨éœ€è¦åœ¨bindå‡½æ•°è¿”å›å€¼å‡½æ•°é‡Œå®ç°æ¨¡æ‹Ÿ<code>new</code>çš„æ“ä½œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.bindFn = <span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">thisArg</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="keyword">this</span> !== <span class="string">'function'</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="keyword">this</span> + <span class="string">' must be a function'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å­˜å‚¨è°ƒç”¨bindçš„å‡½æ•°æœ¬èº«</span></span><br><span class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// å»é™¤thisArgçš„å…¶ä»–å‚æ•° è½¬æˆæ•°ç»„</span></span><br><span class="line">    <span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> bound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// bindè¿”å›çš„å‡½æ•° çš„å‚æ•°è½¬æˆæ•°ç»„</span></span><br><span class="line">        <span class="keyword">var</span> boundArgs = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">var</span> finalArgs = args.concat(boundArgs);</span><br><span class="line">        <span class="comment">// new è°ƒç”¨æ—¶ï¼Œå…¶å®this instanceof boundåˆ¤æ–­ä¹Ÿä¸æ˜¯å¾ˆå‡†ç¡®ã€‚es6 new.targetå°±æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„ã€‚</span></span><br><span class="line">        <span class="comment">//new.targetå±æ€§å…è®¸ä½ æ£€æµ‹å‡½æ•°æˆ–æ„é€ æ–¹æ³•æ˜¯å¦æ˜¯é€šè¿‡newè¿ç®—ç¬¦è¢«è°ƒç”¨çš„</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">new</span>.target)&#123; <span class="comment">//æ£€æµ‹å‡½æ•°æˆ–æ„é€ æ–¹æ³•æ˜¯å¦æ˜¯é€šè¿‡newè¿ç®—ç¬¦è¢«è°ƒç”¨çš„</span></span><br><span class="line">            <span class="comment">// è¿™é‡Œæ˜¯å®ç°ä¸Šæ–‡æè¿°çš„ new çš„ç¬¬ 1, 2, 4 æ­¥</span></span><br><span class="line">            <span class="comment">// 1.åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡</span></span><br><span class="line">            <span class="comment">// 2.å¹¶ä¸”æ‰§è¡Œ[[Prototype]]é“¾æ¥</span></span><br><span class="line">            <span class="comment">// 4.é€šè¿‡`new`åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡å°†æœ€ç»ˆè¢«`[[Prototype]]`é“¾æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„`prototype`å¯¹è±¡ä¸Šã€‚</span></span><br><span class="line">            <span class="comment">// selfå¯èƒ½æ˜¯ES6çš„ç®­å¤´å‡½æ•°ï¼Œæ²¡æœ‰prototypeï¼Œæ‰€ä»¥å°±æ²¡å¿…è¦å†æŒ‡å‘åšprototypeæ“ä½œã€‚</span></span><br><span class="line">            <span class="keyword">if</span>(self.prototype)&#123;</span><br><span class="line">                <span class="comment">// ES5 æä¾›çš„æ–¹æ¡ˆ Object.create()</span></span><br><span class="line">                <span class="comment">// bound.prototype = Object.create(self.prototype);</span></span><br><span class="line">                <span class="comment">// ä½†æ—¢ç„¶æ˜¯æ¨¡æ‹ŸES5çš„bindï¼Œé‚£æµè§ˆå™¨ä¹ŸåŸºæœ¬æ²¡æœ‰å®ç°Object.create()</span></span><br><span class="line">                <span class="comment">// æ‰€ä»¥é‡‡ç”¨ MDN ployfillæ–¹æ¡ˆ https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/create</span></span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">Empty</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">                Empty.prototype = self.prototype;</span><br><span class="line">                bound.prototype = <span class="keyword">new</span> Empty();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¿™é‡Œæ˜¯å®ç°ä¸Šæ–‡æè¿°çš„ new çš„ç¬¬ 3 æ­¥</span></span><br><span class="line">            <span class="comment">// 3.ç”Ÿæˆçš„æ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„`this`ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> result = self.apply(<span class="keyword">this</span>, finalArgs);</span><br><span class="line">            <span class="comment">// è¿™é‡Œæ˜¯å®ç°ä¸Šæ–‡æè¿°çš„ new çš„ç¬¬ 5 æ­¥</span></span><br><span class="line">            <span class="comment">// 5.å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹`Object`(åŒ…å«`Functoin`, `Array`, `Date`, `RegExg`, `Error`)ï¼Œ</span></span><br><span class="line">            <span class="comment">// é‚£ä¹ˆ`new`è¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> isObject = <span class="keyword">typeof</span> result === <span class="string">'object'</span> &amp;&amp; result !== <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">var</span> isFunction = <span class="keyword">typeof</span> result === <span class="string">'function'</span>;</span><br><span class="line">            <span class="keyword">if</span>(isObject || isFunction)&#123;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="comment">//ä¸ä½¿ç”¨newæ“ä½œç¬¦æ—¶</span></span><br><span class="line">            <span class="comment">// applyä¿®æ”¹thisæŒ‡å‘ï¼ŒæŠŠä¸¤ä¸ªå‡½æ•°çš„å‚æ•°åˆå¹¶ä¼ ç»™selfå‡½æ•°ï¼Œå¹¶æ‰§è¡Œselfå‡½æ•°ï¼Œè¿”å›æ‰§è¡Œç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span> self.apply(thisArg, finalArgs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>bindæ˜¯FunctionåŸå‹é“¾ä¸­çš„Function.prototypeçš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¿®æ”¹thisæŒ‡å‘ï¼Œåˆå¹¶å‚æ•°ä¼ é€’ç»™åŸå‡½æ•°ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚</li>
<li>bindè¿”å›çš„å‡½æ•°å¯ä»¥é€šè¿‡newè°ƒç”¨ï¼Œè¿™æ—¶æä¾›çš„thisçš„å‚æ•°è¢«å¿½ç•¥ï¼ŒæŒ‡å‘äº†newç”Ÿæˆçš„å…¨æ–°å¯¹è±¡ã€‚å†…éƒ¨æ¨¡æ‹Ÿå®ç°äº†newæ“ä½œç¬¦ã€‚</li>
<li>bindFn</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœ€ç»ˆç‰ˆ åˆ é™¤æ³¨é‡Š è¯¦ç»†æ³¨é‡Šç‰ˆè¯·çœ‹ä¸Šæ–‡</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.bind = <span class="built_in">Function</span>.prototype.bind || <span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">thisArg</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="keyword">this</span> !== <span class="string">'function'</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="keyword">this</span> + <span class="string">' must be a function'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> bound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> boundArgs = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">        <span class="keyword">var</span> finalArgs = args.concat(boundArgs);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">new</span>.target)&#123;</span><br><span class="line">            <span class="keyword">if</span>(self.prototype)&#123;</span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">Empty</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">                Empty.prototype = self.prototype;</span><br><span class="line">                bound.prototype = <span class="keyword">new</span> Empty();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> result = self.apply(<span class="keyword">this</span>, finalArgs);</span><br><span class="line">            <span class="keyword">var</span> isObject = <span class="keyword">typeof</span> result === <span class="string">'object'</span> &amp;&amp; result !== <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">var</span> isFunction = <span class="keyword">typeof</span> result === <span class="string">'function'</span>;</span><br><span class="line">            <span class="keyword">if</span>(isObject || isFunction)&#123;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> self.apply(thisArg, finalArgs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>bind</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨¡æ‹Ÿå®ç°applyå’Œcallæ–¹æ³•</title>
    <url>/2019/03/13/apply-call/</url>
    <content><![CDATA[<h2 id="å…ˆæ¥é€šè¿‡MDNè®¤è¯†ä¸‹callå’Œapply"><a href="#å…ˆæ¥é€šè¿‡MDNè®¤è¯†ä¸‹callå’Œapply" class="headerlink" title="å…ˆæ¥é€šè¿‡MDNè®¤è¯†ä¸‹callå’Œapply"></a>å…ˆæ¥é€šè¿‡MDNè®¤è¯†ä¸‹callå’Œapply</h2><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><p><code>func.apply(thisArg, [argsArray])</code></p>
<h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><p><strong>thisArg</strong>ï¼šå¯é€‰çš„ï¼Œ<code>func</code>å‡½æ•°è¿è¡Œçš„æ—¶ä½¿ç”¨çš„<code>this</code>å€¼</p>
<a id="more"></a>
<p>âš ï¸ </p>
<ul>
<li>å¦‚æœè¿™ä¸ªå‡½æ•°å¤„äº<font color="red">éä¸¥æ ¼æ¨¡å¼ä¸‹</font> æŒ‡å®šå…¶ä¸º<code>null</code> æˆ–è€… <code>undefined</code>æ—¶ thisç»‘å®šä¼šåº”ç”¨<code>é»˜è®¤è§„åˆ™</code>ï¼ˆ<font color="red">è¿™åœ¨<a href="http://maying.ink/2019/03/11/this/#more">åˆ†æjsæŒ‡å‘é—®é¢˜</a>æ—¶æœ‰æåˆ°</font>ï¼‰</li>
<li>å¦‚æœthisArgæ˜¯åŸå§‹å€¼ä¼šè¢«åŒ…è£…ç§°å¯¹è±¡ <code>.apply(2)</code>ä¼šè¢«åŒ…è£…æˆ<code>.apply(Number(2))</code></li>
</ul>
<hr>
<p><strong>argsArray</strong>ï¼šå¯é€‰çš„ã€‚ä¸€ä¸ªæ•°ç»„æˆ–è€…ç±»æ•°ç»„å¯¹è±¡ï¼Œå…¶ä¸­çš„æ•°ç»„å…ƒç´ å°†ä½œä¸ºå•ç‹¬çš„å‚æ•°ä¼ ç»™ func å‡½æ•°ã€‚å¦‚æœè¯¥å‚æ•°çš„å€¼ä¸º null æˆ–  undefinedï¼Œåˆ™è¡¨ç¤ºä¸éœ€è¦ä¼ å…¥ä»»ä½•å‚æ•°ã€‚ä»ECMAScript 5 å¼€å§‹å¯ä»¥ä½¿ç”¨ç±»æ•°ç»„å¯¹è±¡</p>
<hr>
<p><strong>è¿”å›å€¼</strong>ï¼š<br>è°ƒç”¨æœ‰æŒ‡å®šthiså€¼å’Œå‚æ•°çš„å‡½æ•°çš„ç»“æœ</p>
<hr>
<p>å‡ ä¸ªæœ‰ç”¨çš„ä¾‹å­æ„Ÿå—ä¸‹applyçš„é­”åŠ›</p>
<p><strong>æ±‚æ•°ç»„æœ€å¤§æœ€å°å€¼</strong></p>
<p>èªæ˜çš„applyç”¨æ³•å…è®¸ä½ åœ¨æŸäº›æœ¬æ¥éœ€è¦å†™æˆéå†æ•°ç»„å˜é‡çš„ä»»åŠ¡ä¸­ä½¿ç”¨å†…å»ºçš„å‡½æ•°</p>
<p>ä½¿ç”¨<code>Math.max/Math.min</code>æ¥æ‰¾å‡ºä¸€ä¸ªæ•°ç»„ä¸­çš„æœ€å¤§/æœ€å°å€¼</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> numbers = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>];</span><br><span class="line"><span class="built_in">var</span> <span class="built_in">max</span> = Math.<span class="built_in">max</span>.<span class="built_in">apply</span>(null, numbers);</span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">max</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">var</span> <span class="built_in">min</span> = Math.<span class="built_in">min</span>.<span class="built_in">apply</span>(null, numbers);</span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">min</span>);</span><br></pre></td></tr></table></figure>
<p><strong>applyè®¾ç½®çš„thiså€¼</strong></p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">var doSth = function(a, b)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">console</span>.log([a, b]);</span><br><span class="line">&#125;</span><br><span class="line">doSth.apply(<span class="literal">null</span>, [<span class="number">1</span>, <span class="number">2</span>]); <span class="regexp">//</span> <span class="keyword">this</span>æ˜¯<span class="built_in">window</span>  <span class="regexp">//</span> [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">doSth.apply(<span class="number">0</span>, [<span class="number">1</span>, <span class="number">2</span>]); <span class="regexp">//</span> <span class="keyword">this</span> æ˜¯ Number(<span class="number">0</span>) <span class="regexp">//</span> [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">doSth.apply(<span class="literal">true</span>); <span class="regexp">//</span> <span class="keyword">this</span> æ˜¯ Boolean(<span class="literal">true</span>) <span class="regexp">//</span> [<span class="literal">undefined</span>, <span class="literal">undefined</span>]</span><br><span class="line">doSth.call(<span class="literal">undefined</span>, <span class="number">1</span>, <span class="number">2</span>); <span class="regexp">//</span> <span class="keyword">this</span> æ˜¯ <span class="built_in">window</span> <span class="regexp">//</span> [<span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<p><strong>ç”¨applyå°†ä¸€ä¸ªæ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„</strong></p>
<p>å¦‚æœæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ•°ç»„æ¥æ¨é€ï¼Œå®ƒå®é™…ä¸Šä¼šå°†è¯¥æ•°ç»„ä½œä¸ºå•ä¸ªå…ƒç´ æ·»åŠ ï¼Œè€Œä¸æ˜¯å•ç‹¬æ·»åŠ å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ•°ç»„å†…çš„æ•°ç»„<br><code>concat</code>ç¡®å®å…·æœ‰æˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºï¼Œä½†å®ƒå®é™…ä¸Šå¹¶ä¸é™„åŠ åˆ°ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°æ•°ç»„<br>ç”¨<code>apply</code>å°±èƒ½ç®€å•å®ç°</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> <span class="built_in">array</span> = ['a', 'b'];</span><br><span class="line"><span class="built_in">var</span> elements = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="built_in">array</span>.<span class="built_in">push</span>.<span class="built_in">apply</span>(<span class="built_in">array</span>,elements) //Â [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">//<span class="built_in">array</span>.<span class="built_in">push</span>(elements) //)Â [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, Array(<span class="number">3</span>)]</span><br><span class="line">console.<span class="built_in">log</span>(<span class="built_in">array</span>);</span><br></pre></td></tr></table></figure>
<p>call()ä¸apply()éå¸¸ç›¸ä¼¼</p>
<p><code>fun.call(thisArg, arg1, arg2, ...)</code></p>
<p><strong>callå’Œapplyçš„ä¸åŒç‚¹</strong></p>
<ul>
<li><code>apply</code>åªæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ˜¯<code>æ•°ç»„</code>ä¹Ÿå¯ä»¥æ˜¯<code>ç±»æ•°ç»„</code>ï¼Œå…¶å®ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ï¼Œåç»­çš„å‚æ•°å¿½ç•¥ä¸è®¡</li>
<li><code>call</code>æ¥æ”¶ç¬¬äºŒä¸ªåŠä»¥åä¸€ç³»åˆ—çš„å‚æ•°</li>
</ul>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>é‡æ–°è®¤è¯†äº†callå’Œapplyä¼šå‘ç°<br>å®ƒä»¬ä½œç”¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ”¹å˜å‡½æ•°é‡Œçš„thisæŒ‡å‘ä¸ºç¬¬ä¸€ä¸ªå‚æ•°<code>thisArg</code>ï¼Œå¦‚æœæ˜ç¡®æœ‰å¤šå°‘å‚æ•°ï¼Œé‚£å¯ä»¥ç”¨<code>call</code>ï¼Œä¸æ˜ç¡®åˆ™å¯ä»¥ä½¿ç”¨<code>apply</code>ã€‚ä¹Ÿå°±æ˜¯è¯´å®Œå…¨å¯ä»¥ä¸ä½¿ç”¨<code>call</code>ï¼Œè€Œä½¿ç”¨<code>apply</code>ä»£æ›¿ï¼Œæˆ‘ä»¬åªéœ€è¦æ¨¡æ‹Ÿå®ç°<code>apply</code>ï¼Œ<code>call</code>å¯ä»¥æ ¹æ®å‚æ•°ä¸ªæ•°éƒ½æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç»™åˆ°<code>apply</code>å³å¯</p>
<hr>
<h2 id="æ¨¡æ‹Ÿå®ç°çš„å‡†å¤‡å·¥ä½œ"><a href="#æ¨¡æ‹Ÿå®ç°çš„å‡†å¤‡å·¥ä½œ" class="headerlink" title="æ¨¡æ‹Ÿå®ç°çš„å‡†å¤‡å·¥ä½œ"></a>æ¨¡æ‹Ÿå®ç°çš„å‡†å¤‡å·¥ä½œ</h2><p>æ¨¡æ‹Ÿä¹‹å‰ æˆ‘ä»¬å…ˆå¾—çœ‹çœ‹<a href="http://yanhaijing.com/es5/#book" target="_blank" rel="noopener">ES5è§„èŒƒ</a> å…³äºapply æ‘˜æŠ„ä»¥ä¸‹å‡ æ¡</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">Function.prototype.apply (thisArg, argArray)</span><br><span class="line"></span><br><span class="line">å½“ä»¥ thisArg å’Œ argArray ä¸ºå‚æ•°åœ¨ä¸€ä¸ª func å¯¹è±¡ä¸Šè°ƒç”¨ apply æ–¹æ³•ï¼Œé‡‡ç”¨å¦‚ä¸‹æ­¥éª¤ï¼š</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>å¦‚æœ IsCallable(func) æ˜¯ <span class="literal">false</span>, åˆ™æŠ›å‡ºä¸€ä¸ª TypeError å¼‚å¸¸ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>å¦‚æœ argArray æ˜¯ null æˆ– undefined, åˆ™è¿”å›æä¾› thisArg ä½œä¸º this å€¼å¹¶ä»¥ç©ºå‚æ•°åˆ—è¡¨è°ƒç”¨ func çš„ <span class="string">[[Call]]</span> å†…éƒ¨æ–¹æ³•çš„ç»“æœã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>è¿”å›æä¾› thisArg ä½œä¸º this å€¼å¹¶ä»¥ç©ºå‚æ•°åˆ—è¡¨è°ƒç”¨ func çš„ <span class="string">[[Call]]</span> å†…éƒ¨æ–¹æ³•çš„ç»“æœã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>å¦‚æœ Type(argArray) ä¸æ˜¯ Object, åˆ™æŠ›å‡ºä¸€ä¸ª TypeError å¼‚å¸¸ã€‚</span><br><span class="line">...</span><br><span class="line"><span class="number">9.</span>æä¾› thisArg ä½œä¸º this å€¼å¹¶ä»¥ argList ä½œä¸ºå‚æ•°åˆ—è¡¨ï¼Œè°ƒç”¨ func çš„ <span class="string">[[Call]]</span> å†…éƒ¨æ–¹æ³•ï¼Œè¿”å›ç»“æœã€‚</span><br><span class="line"></span><br><span class="line">apply æ–¹æ³•çš„ length å±æ€§æ˜¯ <span class="number">2</span>ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">10.</span>åœ¨å¤–é¢ä¼ å…¥çš„ thisArg å€¼ä¼šä¿®æ”¹å¹¶æˆä¸º this å€¼ã€‚thisArg æ˜¯ undefined æˆ– null æ—¶å®ƒä¼šè¢«æ›¿æ¢æˆå…¨å±€å¯¹è±¡ï¼Œæ‰€æœ‰å…¶ä»–å€¼ä¼šè¢«åº”ç”¨ ToObject å¹¶å°†ç»“æœä½œä¸º this å€¼ï¼Œè¿™æ˜¯ç¬¬ä¸‰ç‰ˆå¼•å…¥çš„æ›´æ”¹</span><br></pre></td></tr></table></figure>
<p>ç»“åˆä¸Šæ–‡å’Œè§„èŒƒ ï¼Œæ˜ç¡®äº†è¦è§£å†³çš„é—®é¢˜ï¼Œ<strong>æˆ‘ä»¬å¦‚ä½•å°†å‡½æ•°é‡Œçš„thisï¼ˆä¸€èˆ¬æŒ‡å‘windowï¼‰æŒ‡å‘ç¬¬ä¸€ä¸ªå‚æ•°thisArgå‘¢</strong><br>ä¸ç”±å¾—æƒ³èµ·æ¥äº†<a href="http://maying.ink/2019/03/11/this/">ä»‹ç»thisæŒ‡å‘é‚£ä¸€ç¯‡æ–‡ç« </a><br>é‚£å°±é‡‡ç”¨éšå¼ç»‘å®šå‘€ï¼Œä¹Ÿå°±æ˜¯è¯´ æ—¢ç„¶ä»–ç°æœ‰çš„ä¸Šä¸‹æ–‡ç¯å¢ƒæ˜¯windowï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰,é‚£æˆ‘ä»¬å°±æ‰‹åŠ¨ç»™ä»–åˆ›å»ºä¸€ä¸ª<code>éå…¨å±€ä¸Šä¸‹æ–‡</code></p>
<p>çœ‹çœ‹è¿™ä¸ªç†Ÿæ‚‰çš„ä¾‹å­</p>
<figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> doSth = <span class="keyword">function</span>()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    <span class="built_in">console</span>.log(arguments);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> student = &#123;</span><br><span class="line">    name: <span class="string">'yishu'</span>,</span><br><span class="line">    doSth: doSth,</span><br><span class="line">&#125;;</span><br><span class="line">student.doSth(<span class="number">1</span>, <span class="number">2</span>); <span class="regexp">// this === student //</span> <span class="literal">true</span> <span class="regexp">// 'yishu' //</span> [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">doSth.apply(student, [<span class="number">1</span>, <span class="number">2</span>]); <span class="regexp">// this === student //</span> <span class="literal">true</span> <span class="regexp">// 'yishu' //</span> [<span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<p>ä½ èƒ½çœ‹å‡ºæ¥ä»€ä¹ˆï¼Ÿ<br> åœ¨å¯¹è±¡<code>student</code>ä¸ŠåŠ ä¸€ä¸ªå‡½æ•°doSthï¼Œå†æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°é‡Œçš„<code>this</code>å°±æŒ‡å‘äº†è¿™ä¸ªå¯¹è±¡</p>
<p> é‚£æˆ‘ä»¬å°±æ¨¡æ‹Ÿè¿™ä¸ªå¯¹è±¡ï¼Œç»™ä»–æ·»åŠ ä¸€ä¸ªå‡½æ•°,ä½¿ç”¨å‡½æ•°è°ƒç”¨ä¹‹åå†åˆ é™¤å®ƒ</p>
<p> ç¬¬ä¸€ç‰ˆæœ¬</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æµè§ˆå™¨ç¯å¢ƒ éä¸¥æ ¼æ¨¡å¼</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getGlobalObject</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Function</span>.prototype.applyFn = <span class="function"><span class="keyword">function</span> <span class="title">apply</span>(<span class="params">thisArg,argsArray</span>)</span>&#123;</span><br><span class="line">   <span class="comment">// 1.å¦‚æœ `IsCallable(func)` æ˜¯ `false`, åˆ™æŠ›å‡ºä¸€ä¸ª `TypeError` å¼‚å¸¸ã€‚</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="keyword">this</span> !=<span class="string">'function'</span>)&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="keyword">this</span> + <span class="string">'is not function'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 1.å¦‚æœ `IsCallable(func)` æ˜¯ `false`, åˆ™æŠ›å‡ºä¸€ä¸ª `TypeError` å¼‚å¸¸ã€‚</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> argsArray === <span class="string">'undefined'</span> || argsArray === <span class="literal">null</span>)&#123;</span><br><span class="line">    argsArray = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//3.å¦‚æœ Type(argArray) ä¸æ˜¯ Object, åˆ™æŠ›å‡ºä¸€ä¸ª TypeError å¼‚å¸¸ .</span></span><br><span class="line">   <span class="keyword">if</span>(argsArray !== <span class="keyword">new</span> <span class="built_in">Object</span>(argsArray))&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'CreateListFromArrayLike called on non-object'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//4.æ”¹å˜thisçš„æŒ‡å‘ åœ¨å¤–é¢ä¼ å…¥çš„ thisArg å€¼ä¼šä¿®æ”¹å¹¶æˆä¸º this å€¼ å¦‚æœä¼ å…¥çš„æ˜¯ undefinedæˆ–è€…null åˆ™thisæŒ‡å‘åº”ç”¨é»˜è®¤ç»‘å®š</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> thisArg === <span class="string">'undefined'</span> || thisArg === <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="comment">// ES3: thisArg æ˜¯ undefined æˆ– null æ—¶å®ƒä¼šè¢«æ›¿æ¢æˆå…¨å±€å¯¹è±¡ æµè§ˆå™¨é‡Œæ˜¯window</span></span><br><span class="line">        thisArg = getGlobalObject();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¼€å§‹è¡¨æ¼”</span></span><br><span class="line">    thisArg = <span class="keyword">new</span> <span class="built_in">Object</span>(thisArg);</span><br><span class="line">    thisArg.fn = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">//æ¥æ”¶è¿”å›å€¼</span></span><br><span class="line">    <span class="keyword">var</span> fnResult = thisArg.fn(...argsArray);</span><br><span class="line">    <span class="keyword">delete</span> thisArg.fn;</span><br><span class="line">    <span class="keyword">return</span> fnResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> doSth = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> student = &#123;</span><br><span class="line">    name: <span class="string">'é©¬å°è¹'</span>,</span><br><span class="line">    <span class="comment">//doSth: doSth, //æˆ‘ä»¬ä¸»è¦æ¨¡æ‹Ÿäº†è¿™ä¸ªå‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line">doSth.applyFn(student, [<span class="number">1</span>, <span class="number">2</span>]); </span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123;name: "é©¬å°è¹", doSth: Æ’, fn: Æ’&#125;</span></span><br><span class="line"><span class="comment">// é©¬å°è¹</span></span><br><span class="line"><span class="comment">// Arguments(2)Â [1, 2, callee: Æ’, Symbol(Symbol.iterator): Æ’]</span></span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥å¾ˆå®Œç¾ï¼Œé‚£å®ƒæœ‰æ²¡æœ‰é—®é¢˜å‘¢ï¼Ÿ å…¶å®æ˜¯æœ‰çš„</p>
<p><strong>.fnå‡½æ•°åŒåè¦†ç›–é—®é¢˜ï¼Œ<code>thisArg</code>å¯¹è±¡ä¸Šæœ‰<code>fn</code>ï¼Œé‚£å°±è¢«è¦†ç›–äº†ç„¶åè¢«åˆ é™¤äº†</strong></p>
<p>é‚£æˆ‘ä»¬å°±æ‰¾ä¸€ä¸ªå”¯ä¸€å€¼çš„å‡½æ•°å</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">thisArg = new Object(thisArg);</span><br><span class="line">var <span class="emphasis">_fn = '_</span>_fn' + new Date().getTime();</span><br><span class="line">thisArg[_fn] = this;</span><br><span class="line">//æ¥æ”¶è¿”å›å€¼</span><br><span class="line">var fnResult = thisArg[<span class="string">_fn</span>](<span class="link">...argsArray</span>);</span><br><span class="line">delete thisArg[_fn];</span><br><span class="line">return fnResult;</span><br></pre></td></tr></table></figure>
<p>åˆ°ç°åœ¨ ç®€å•ç‰ˆæœ¬çš„<code>apply</code>å·²ç»å®ç°äº†ï¼Œç°å®ä¸šåŠ¡åœºæ™¯ä¸éœ€è¦å»æ¨¡æ‹Ÿå®ç°<code>callå’Œapply</code>,æ¯•ç«Ÿæ˜¯<code>ES3</code>å°±æä¾›çš„æ–¹æ³•</p>
<p>æ—¢ç„¶å®ç°äº†<code>apply</code>,<code>call</code>ä¹Ÿå°±ç®€å•äº†ï¼Œ<strong>åŸç†å°±æ˜¯</strong>æ‹¿åˆ°<code>call</code>çš„å‚æ•° è½¬æ¢æˆæ•°ç»„ï¼Œç„¶åè°ƒç”¨<code>applyFn</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Function</span>.prototype.applyFn = <span class="function"><span class="keyword">function</span> <span class="title">apply</span>(<span class="params">thisArg</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> argsArray = [];</span><br><span class="line">  <span class="keyword">var</span> argumentsLength = <span class="built_in">arguments</span>.length;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; argumentsLength - <span class="number">1</span>; i++)&#123;</span><br><span class="line">    argsArray.push(<span class="built_in">arguments</span>[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.applyFn(thisArg, argsArray);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>é€šè¿‡MDNè®¤è¯†callå’Œapplyï¼Œé˜…è¯»ES5è§„èŒƒï¼Œåˆ°æ¨¡æ‹Ÿå®ç°applyï¼Œå†å®ç°call</li>
</ol>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>call</tag>
        <tag>apply</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½ ä¸çŸ¥é“çš„JSç³»åˆ—-ç†è§£JSä¸­ èµ‹å€¼ï¼Œæµ…æ‹·è´ï¼Œæ·±æ‹·è´</title>
    <url>/2019/03/25/clone/</url>
    <content><![CDATA[<h2 id="å¼€ç¯‡"><a href="#å¼€ç¯‡" class="headerlink" title="å¼€ç¯‡"></a>å¼€ç¯‡</h2><p>åˆå›åˆ°äº†è¿™ä¸ªè€ç”Ÿå¸¸è°ˆï¼Œæ–°ç”Ÿç»æœ›çš„é—®é¢˜ä¸Šï¼Œé€šå¸¸é‡åˆ°è¿™ç§å¤§å®¶éƒ½æ¯”è¾ƒç†Ÿæ‚‰çš„é—®é¢˜ï¼Œåè€Œä¸çŸ¥é“æ€ä¹ˆåˆ—å¤§çº²ï¼Œæ€•ä¸å¤Ÿæ·±å…¥ä¹Ÿæ€•è„±ç¦»ä¸»é¢˜ï½<br>emm..<br>æ­¤æ–‡ç³» ä¸è¦å†é—®æˆ‘XXç³»åˆ—ä¹‹ <font color="red">ä¸è¦å†é—®æˆ‘JS Cloneçš„é—®é¢˜äº†</font></p>
<a id="more"></a>
<h2 id="ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™ä¸‰ç§æƒ…å†µï¼Ÿä¸‰è€…æœ‰ä½•å·®å¼‚"><a href="#ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™ä¸‰ç§æƒ…å†µï¼Ÿä¸‰è€…æœ‰ä½•å·®å¼‚" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™ä¸‰ç§æƒ…å†µï¼Ÿä¸‰è€…æœ‰ä½•å·®å¼‚"></a>ä¸ºä»€ä¹ˆä¼šå­˜åœ¨è¿™ä¸‰ç§æƒ…å†µï¼Ÿä¸‰è€…æœ‰ä½•å·®å¼‚</h2><p><code>clone</code>æœ¬æ¥å¾ˆç®€å•ï¼Œåªæ˜¯å› ä¸ºJSä¸­ä¸åŒçš„æ•°æ®ç±»å‹å­˜å‚¨æ–¹å¼(<strong>å †å’Œæ ˆ</strong>)çš„å·®å¼‚ï¼Œæˆ‘ä»¬æ‰ä¼šè§‰å¾—å®ƒè²Œä¼¼æœ‰ç‚¹â€˜å¤æ‚â€™</p>
<p><img src="/images/clone/clone1.png" alt="clone1"></p>
<p>åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„å·®å¼‚å¦‚ä¸Šå›¾æ‰€ç¤ºäº†<br>å®ƒä»¬å…±åŒçš„ç›®æ ‡å°±æ˜¯<font color="red">ä»¥ä¸€ä¸ªå¯¹è±¡ä¸ºåŸå‹cloneå‡ºå¦å¤–ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå› ä¸ºè‡ªèº«çš„é—®é¢˜äº§ç”Ÿä¸€äº›å‰¯ä½œç”¨ï¼Œä¸‰è€…çš„å·®å¼‚å…¶å®å°±ä½“ç°åœ¨å‰¯ä½œç”¨çš„å·®å¼‚ä¸Š</font></p>
<h3 id="å·®å¼‚ï¼ˆå †å’Œæ ˆï¼‰"><a href="#å·®å¼‚ï¼ˆå †å’Œæ ˆï¼‰" class="headerlink" title="å·®å¼‚ï¼ˆå †å’Œæ ˆï¼‰"></a>å·®å¼‚ï¼ˆå †å’Œæ ˆï¼‰</h3><ul>
<li>æ ˆï¼ˆstackï¼‰ä¸ºè‡ªåŠ¨åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå®ƒç”±ç³»ç»Ÿè‡ªåŠ¨é‡Šæ”¾</li>
<li>è€Œå †ï¼ˆheapï¼‰åˆ™æ˜¯åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œå¤§å°ä¸å®šä¹Ÿä¸ä¼šè‡ªåŠ¨é‡Šæ”¾</li>
</ul>
<hr>
<font color="red">åŸºç¡€ç±»å‹ï¼š</font> å€¼å­˜æ”¾åœ¨æ ˆä¸­ï¼Œ<strong>æ¯”è¾ƒæ˜¯å€¼çš„æ¯”è¾ƒ</strong><br><font color="red">å¼•ç”¨ç±»å‹ï¼š</font> å€¼å­˜æ”¾åœ¨å †ä¸­ï¼Œå˜é‡å®é™…ä¸Šæ˜¯ä¸€ä¸ªå­˜æ”¾åœ¨æ ˆå†…å­˜çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å †å†…å­˜ä¸­çš„åœ°å€ã€‚æ¯ä¸ªç©ºé—´å¤§å°ä¸ä¸€æ ·ï¼Œè¦æ ¹æ®æƒ…å†µå¼€è¿›è¡Œç‰¹å®šçš„åˆ†é…ï¼Œ<strong>å¼•ç”¨ç±»å‹çš„æ¯”è¾ƒæ˜¯å¼•ç”¨çš„æ¯”è¾ƒ</strong><br><br><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">var person1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">var person2 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">console.log(a === b); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><br><br>### èµ‹å€¼<br><br>èµ‹å€¼çš„æ¦‚å¿µ å³ä½¿åˆšå…¥è¡Œä¹Ÿä¸é™Œç”Ÿï¼Œæ¯å¤©éƒ½åœ¨ç”¨çš„<code>&#39;=&#39;</code><br><br>#### åŸç†<br><br><em> åŸºæœ¬ç±»å‹ï¼šåœ¨å†…å­˜ä¸­æ–°å¼€è¾Ÿä¸€æ®µæ ˆå†…å­˜ï¼Œç„¶åå†æŠŠå†å°†å€¼èµ‹å€¼åˆ°æ–°çš„æ ˆä¸­,æ˜¯ä¸¤ä¸ªç‹¬ç«‹ç›¸äº’ä¸å½±å“çš„å˜é‡
</em> å¼•ç”¨ç±»å‹ï¼šèµ‹å€¼æ˜¯ä¼ å€ï¼Œæ˜¯å¯¹è±¡ä¿å­˜åœ¨æ ˆä¸­çš„åœ°å€çš„èµ‹å€¼ï¼Œè¿™æ ·çš„è¯ä¸¤ä¸ªå˜é‡å°±æŒ‡å‘å †å†…å­˜çš„åŒä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤ä¸¤è€…ä¹‹é—´æ“ä½œäº’ç›¸æœ‰å½±å“<br><br>#### Demo<br><br><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">var obj1 = &#123;</span><br><span class="line">  name:<span class="symbol">'maying</span>',</span><br><span class="line">  age:<span class="number">22</span>,</span><br><span class="line">  sex:<span class="string">'å¥³'</span>,</span><br><span class="line">  language : [1,[2,3],[4,5],[9,0]]</span><br><span class="line">&#125;</span><br><span class="line">var sringD = <span class="symbol">'pre</span>';</span><br><span class="line">var obj3 = sringD;</span><br><span class="line">sringD = <span class="symbol">'post</span>';</span><br><span class="line"></span><br><span class="line">var obj2 = obj1;</span><br><span class="line">obj1.name = <span class="symbol">'gaile</span>',</span><br><span class="line">obj1.language[<span class="number">0</span>] = <span class="symbol">'jjj</span>'</span><br><span class="line">console.log(<span class="symbol">'obj1</span>',obj1)</span><br><span class="line">       /*</span><br><span class="line">        &#123;</span><br><span class="line">            age: <span class="number">22</span></span><br><span class="line">            language: (<span class="number">4</span>) [<span class="string">"jjj"</span>, <span class="keyword">Array</span>(<span class="number">2</span>), <span class="keyword">Array</span>(<span class="number">2</span>), <span class="keyword">Array</span>(<span class="number">2</span>)]</span><br><span class="line">            name: <span class="string">"gaile"</span></span><br><span class="line">            sex: <span class="string">"å¥³"</span></span><br><span class="line">        &#125;</span><br><span class="line">       */</span><br><span class="line">console.log(<span class="symbol">'obj2</span>',obj2)</span><br><span class="line">        /*</span><br><span class="line">            age: <span class="number">22</span></span><br><span class="line">            language: (<span class="number">4</span>) [<span class="string">"jjj"</span>, <span class="keyword">Array</span>(<span class="number">2</span>), <span class="keyword">Array</span>(<span class="number">2</span>), <span class="keyword">Array</span>(<span class="number">2</span>)]</span><br><span class="line">            name: <span class="string">"gaile"</span></span><br><span class="line">            sex: <span class="string">"å¥³"</span></span><br><span class="line">        */</span><br><span class="line">console.log(<span class="symbol">'sringD</span>',sringD) //post</span><br><span class="line">console.log(<span class="symbol">'obj3</span>',obj3) //pre</span><br></pre></td></tr></table></figure><br><br>### ç†è§£æµ…æ‹·è´<br><br>ä¹‹å‰çš„å¾ˆå¤šå¹´ï¼Œæˆ‘è®¤ä¸º<strong>èµ‹å€¼å·®ä¸å¤šç­‰äºæµ…æ‹·è´</strong><br>å†™ä¸ªå°demo å‘ç°å®ƒä»¬ä¹‹é—´çš„å·®å¼‚<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj2 = obj1;</span><br><span class="line"><span class="keyword">var</span> obj3 = &#123;...obj1&#125;;</span><br><span class="line">obj1.name = <span class="string">'gaile'</span>,</span><br><span class="line">obj1.language[<span class="number">0</span>] = <span class="string">'jjj'</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'obj1'</span>,obj1)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'obj2'</span>,obj2)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'obj3'</span>,obj3)</span><br></pre></td></tr></table></figure><br><br><img src="/images/clone/qiankaobei2.png" alt="qiankaobei2"><br>èµ‹å€¼å¯¹è±¡ï¼Œæ˜¯å°†å¯¹è±¡æŒ‡é’ˆç›´æ¥èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡<br>æµ…æ‹·è´ï¼Œæ˜¯é‡æ–°åˆ›å»ºäº†æ–°å¯¹è±¡ï¼Œæ‰€ä»¥ä½ æ›´æ”¹<code>obj1.name</code>çš„æ—¶å€™ä¸ä¼šå½±å“åˆ°å®ƒ,ä½†æ˜¯æ”¹å˜å¼•ç”¨ç±»å‹æ—¶å°±ä¸èƒ½å¹¸å…äº†<br><br><strong>æ‰€è°“çš„æµ…æ‹·è´å°±æ˜¯ï¼š</strong><br><br><em> å½“å¯¹ç®€å•çš„æ•°æ®ç±»å‹è¿›è¡Œèµ‹å€¼çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯ç›´æ¥åœ¨æ ˆä¸­æ–°å¼€è¾Ÿä¸€ä¸ªåœ°æ–¹ä¸“é—¨æ¥å­˜å‚¨ä¸€æ ·çš„å€¼
</em> å½“å¯¹å¼•ç”¨ç±»å‹è¿›è¡Œæµ…æ‹·è´ï¼Œåé¢çš„å¯¹è±¡å’Œå‰é¢çš„å¯¹è±¡åœ¨ç¬¬ä¸€å±‚æ•°æ®ç»“æ„ä¸­æŒ‡å‘åŒä¸€ä¸ªå †åœ°å€ï¼Œä½†æ˜¯å¦‚æœå‰é¢çš„æ•°æ®ä¸æ­¢æœ‰ä¸€å±‚ï¼ˆ<font color="red">å±æ€§å€¼æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨åªæ‹·è´é‚£ä¸ªå¼•ç”¨å€¼</font>ï¼‰ï¼Œç±»ä¼¼<br><br><figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">language : <span class="comment">[1,<span class="comment">[2,3]</span>,<span class="comment">[4,5]</span>,<span class="comment">[9,0]</span>]</span></span><br></pre></td></tr></table></figure><br><br><strong>å†…éƒ¨çš„å­å¯¹è±¡çš„æŒ‡é’ˆè¿˜æ˜¯åŒä¸€ä¸ªåœ°å€</strong><br><br>å¦‚æœè¦å®ç°ä¸€ç›´å¾€ä¸‹å¤åˆ¶ å°±å¼•å‡ºäº†æ¥ä¸‹æ¥è¦è¯´çš„<font color="red">æ·±æ‹·è´</font>

<p><strong>ç»“è®ºï¼šæµ…å¤åˆ¶è¦æ¯”å¤åˆ¶æ¥çš„æ·±åˆ»ä¸€ç‚¹ï¼Œè‡³å°‘å®ƒå¼€è¾Ÿäº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¸€å—å„¿æ–°çš„å †å†…å­˜</strong></p>
<h4 id="ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼"><a href="#ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼" class="headerlink" title="ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼"></a>ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼</h4><p>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°æµ…æ‹·è´</p>
<ul>
<li>æ•°ç»„çš„æµ…æ‹·è´</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>. <span class="selector-tag">b</span> = [...a]</span><br><span class="line"><span class="number">2</span>. <span class="selector-tag">b</span> = <span class="selector-tag">a</span>.slice(<span class="number">0</span>) / []<span class="selector-class">.slice</span><span class="selector-class">.call</span>(<span class="selector-tag">a</span>,<span class="number">0</span>)</span><br><span class="line"><span class="number">3</span>. <span class="selector-tag">b</span> = <span class="selector-tag">a</span>.concat() / []<span class="selector-class">.concat</span><span class="selector-class">.call</span>(a)</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹è±¡çš„æµ…æ‹·è´</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>. <span class="selector-tag">b</span> = Object.assign(&#123;&#125;,a)</span><br><span class="line"><span class="number">2</span>. <span class="selector-tag">b</span> = &#123;...a&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢"><a href="#å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢" class="headerlink" title="å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢"></a>å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢</h4><p>åŸç†ï¼šéå†å¯¹è±¡çš„æ¯ä¸ªå±æ€§è¿›è¡Œé€ä¸ªæ‹·è´</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span></span>(obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!obj || typeof obj !== <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="keyword">new</span><span class="type">Obj</span> = obj.constructor === <span class="keyword">Array</span> ? [] : <span class="type"></span>&#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">       <span class="keyword">if</span>(obj.hasOwnProperty(key))&#123;</span><br><span class="line">          <span class="keyword">new</span><span class="type">Obj</span>[key] = obj[key]</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span><span class="type">Obj</span></span><br><span class="line"><span class="type"></span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç†è§£æ·±æ‹·è´"><a href="#ç†è§£æ·±æ‹·è´" class="headerlink" title="ç†è§£æ·±æ‹·è´"></a>ç†è§£æ·±æ‹·è´</h3><p>æ·±æ‹·è´çš„æ„ä¹‰ï¼Œå°±æ˜¯å®Œå…¨å¤åˆ¶ï¼Œå¦‚æœä½ è¯»äº†ä¸Šæ–‡ï¼Œåº”è¯¥å°±æ²¡æœ‰ä»€ä¹ˆç–‘é—®äº†</p>
<p>å°†aå¯¹è±¡å¤åˆ¶ä¸€ä»½ç»™å¯¹è±¡bï¼Œä¸ç®¡aä¸­çš„æ•°æ®ç»“æ„åµŒå¥—æœ‰å¤šæ·±ï¼Œå½“æ”¹å˜aå¯¹è±¡ä¸­çš„ä»»æ„æ·±åº¦çš„æŸä¸ªå€¼åï¼Œbä¸­çš„è¯¥å€¼ä¸ä¼šå—ä»»ä½•å½±å“</p>
<h4 id="ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼-1"><a href="#ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼-1" class="headerlink" title="ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼"></a>ç›®å‰å¯è¡Œçš„å®ç°æ–¹å¼</h4><ul>
<li><code>JSON.stringify()`</code>å’ŒJSON.parse()`çš„æ··åˆé…å¯¹ä½¿ç”¨ </li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj4 = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj1)) </span><br><span class="line"></span><br><span class="line">obj1.name=<span class="string">'yishu'</span>,</span><br><span class="line"></span><br><span class="line">obj1.language[<span class="number">1</span>] = [<span class="string">"äºŒ"</span>,<span class="string">"ä¸‰"</span>];</span><br><span class="line">obj4.language[<span class="number">2</span>] = [<span class="string">"å››"</span>,<span class="string">"äº”"</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj1);   </span><br><span class="line"><span class="built_in">console</span>.log(obj4);</span><br></pre></td></tr></table></figure>
<p><img src="/images/clone/deepclone.png" alt="deepclone"><br><code>obj1</code>,<code>obj4</code> æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œæ›´æ”¹æ•°æ®äº’ä¸å½±å“ï¼Œè¾¾åˆ°äº†æˆ‘ä»¬è¦çš„ç›®çš„</p>
<p><strong>å®ƒç²—æš´ï¼Œæœ‰ç”¨ï¼Œä½†æ˜¯ä¹Ÿæœ‰ç¼ºç‚¹</strong></p>
<ol>
<li><code>åœ¨JSON.stringify()</code>åšåºåˆ—åŒ–æ—¶ï¼Œ<code>undefined</code>ã€<code>function</code>ä»¥åŠ<code>symbol</code>å€¼ï¼Œä¼šè¢«å¿½ç•¥</li>
</ol>
<p>ä¾‹å¦‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: &#123;<span class="attr">b</span>: <span class="string">'old'</span>&#125;, </span><br><span class="line">  c:<span class="literal">undefined</span>, </span><br><span class="line">  d: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  e:  <span class="built_in">Symbol</span>(<span class="string">''</span>)</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">var</span> newObj = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj))</span><br><span class="line">newObj.a.b = <span class="string">'new'</span></span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"><span class="built_in">console</span>.log(newObj)</span><br></pre></td></tr></table></figure>
<p>ç»“æœ<br><img src="/images/clone/jsonquedian.png" alt="jsonquedian"></p>
<h4 id="å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢-1"><a href="#å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢-1" class="headerlink" title="å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢"></a>å¦‚æœè¦ä½ è‡ªå·±å®ç°å‘¢</h4><p>åŸç†ï¼šä½¿ç”¨é€’å½’ï¼Œéå†æ¯ä¸€ä¸ªå¯¹è±¡å±æ€§è¿›è¡Œæ‹·è´</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a: &#123;<span class="attr">b</span>: <span class="string">'old'</span>&#125;, </span><br><span class="line">  c:<span class="literal">undefined</span>, </span><br><span class="line">  d: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">  e:  <span class="built_in">Symbol</span>(<span class="string">''</span>)</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!obj || <span class="keyword">typeof</span> obj !== <span class="string">'object'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> newObj = obj.constructor === <span class="built_in">Array</span> ? [] : &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span> &amp;&amp; obj[key]) &#123;</span><br><span class="line">        newObj[key] = copy(obj[key])</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        newObj[key] = obj[key]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> newObj</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newObj = copy(obj)</span><br><span class="line">newObj.a.b = <span class="string">'new'</span></span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br><span class="line"><span class="built_in">console</span>.log(newObj)</span><br></pre></td></tr></table></figure>
<p><img src="/images/clone/jsonquedian.png" alt="jsonquedian"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>èµ‹å€¼ï¼šå¼•ç”¨å¤åˆ¶ æ‰§å‘åŒä¸€ä¸ªå¯¹è±¡</li>
<li>æµ…æ‹·è´ ï¼šç”Ÿæˆä¸€ä¸ªæ–°å¯¹è±¡ï¼Œåªèƒ½æ‹·è´ä¸€å±‚ï¼Œå½“å±æ€§å€¼æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨åªæ‹·è´é‚£ä¸ªå¼•ç”¨å€¼</li>
<li>æ·±æ‹·è´ï¼šå®Œå…¨æ‹·è´ï¼Œå‰åå¯¹è±¡æ²¡æœ‰ä»»ä½•å…³ç³»</li>
</ul>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.zhihu.com/question/23031215" target="_blank" rel="noopener">https://www.zhihu.com/question/23031215</a><br><a href="https://segmentfault.com/a/1190000018204798" target="_blank" rel="noopener">https://segmentfault.com/a/1190000018204798</a></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>clone</tag>
      </tags>
  </entry>
  <entry>
    <title>React diff ç®—æ³•</title>
    <url>/2019/04/01/diff/</url>
    <content><![CDATA[<p>ç†è§£reactçš„diffç®—æ³•</p>
<a id="more"></a>
<p><img src="/images/passive/diff.png" alt="jsworke"></p>
<h2 id="åŒçº§èŠ‚ç‚¹çš„ç§»åŠ¨-å¢åŠ -åˆ é™¤çš„å…·ä½“å®ç°"><a href="#åŒçº§èŠ‚ç‚¹çš„ç§»åŠ¨-å¢åŠ -åˆ é™¤çš„å…·ä½“å®ç°" class="headerlink" title="åŒçº§èŠ‚ç‚¹çš„ç§»åŠ¨ å¢åŠ  åˆ é™¤çš„å…·ä½“å®ç°"></a>åŒçº§èŠ‚ç‚¹çš„ç§»åŠ¨ å¢åŠ  åˆ é™¤çš„å…·ä½“å®ç°</h2><h3 id="åœºæ™¯ä¸€-æ–°æ—§é›†åˆä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ä½†ä½ç½®ä¸åŒæ—¶ï¼Œå¦‚ä½•ç§»åŠ¨èŠ‚ç‚¹"><a href="#åœºæ™¯ä¸€-æ–°æ—§é›†åˆä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ä½†ä½ç½®ä¸åŒæ—¶ï¼Œå¦‚ä½•ç§»åŠ¨èŠ‚ç‚¹" class="headerlink" title="åœºæ™¯ä¸€ æ–°æ—§é›†åˆä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ä½†ä½ç½®ä¸åŒæ—¶ï¼Œå¦‚ä½•ç§»åŠ¨èŠ‚ç‚¹"></a>åœºæ™¯ä¸€ æ–°æ—§é›†åˆä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ä½†ä½ç½®ä¸åŒæ—¶ï¼Œå¦‚ä½•ç§»åŠ¨èŠ‚ç‚¹</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">æ—§  <span class="selector-tag">a</span> <span class="selector-tag">b</span> c d</span><br><span class="line">æ–°  <span class="selector-tag">b</span> <span class="selector-tag">a</span> d c</span><br></pre></td></tr></table></figure>
<p>Reactå…ˆä»æ–°ç»„åˆä¸­å–å¾—bï¼Œç„¶ååˆ¤æ–­æ—§ä¸­æ˜¯å¦å­˜åœ¨ç›¸åŒèŠ‚ç‚¹bï¼Œå½“å‘ç°å­˜åœ¨èŠ‚ç‚¹båï¼Œå°±å»åˆ¤æ–­æ˜¯å¦ç§»åŠ¨b<br>æ¶‰åŠåˆ°ä¸¤ä¸ªå˜é‡ index å’ŒlastIndex</p>
<ul>
<li>index:båœ¨é›†åˆé‡Œä¸‹æ ‡ æ­¤æ—¶ index = 1</li>
<li>lastIndexï¼šç±»ä¼¼äºä¸€ä¸ªmapçš„ç´¢å¼•ï¼Œä¸€å¼€å§‹é»˜è®¤å€¼æ˜¯0ï¼Œå®ƒä¼šä¸mapä¸­çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒå®Œåï¼Œæ›´æ–°å½“å‰çš„å€¼ï¼ˆå–indexå’ŒlastIndexçš„è¾ƒå¤§æ•°ï¼‰</li>
</ul>
<h4 id="æ¯”è¾ƒè§„åˆ™ï¼š"><a href="#æ¯”è¾ƒè§„åˆ™ï¼š" class="headerlink" title="æ¯”è¾ƒè§„åˆ™ï¼š"></a>æ¯”è¾ƒè§„åˆ™ï¼š</h4><p>å¦‚æœ index &lt; lastIndex é‚£æ­¤å…ƒç´ å°±éœ€è¦ç§»åŠ¨<br>åœ¨æ—§ç»„åˆé‡Œå°†è¯¥å…ƒç´ ç§»åŠ¨åˆ°ä¸‹æ ‡ä¸ºlastIndexçš„ä½ç½®</p>
<p>å…·ä½“çš„è®¡ç®—è¿‡ç¨‹çœ‹ä¸‹å›¾</p>
<p><img src="/images/passive/diff2.jpeg" alt="jsworke"></p>
<h3 id="åœºæ™¯ä¸€-æ–°é›†åˆä¸­æœ‰æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œæ—§é›†åˆä¸­æœ‰åˆ é™¤çš„èŠ‚ç‚¹"><a href="#åœºæ™¯ä¸€-æ–°é›†åˆä¸­æœ‰æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œæ—§é›†åˆä¸­æœ‰åˆ é™¤çš„èŠ‚ç‚¹" class="headerlink" title="åœºæ™¯ä¸€ æ–°é›†åˆä¸­æœ‰æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œæ—§é›†åˆä¸­æœ‰åˆ é™¤çš„èŠ‚ç‚¹"></a>åœºæ™¯ä¸€ æ–°é›†åˆä¸­æœ‰æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œæ—§é›†åˆä¸­æœ‰åˆ é™¤çš„èŠ‚ç‚¹</h3><p>è§„åˆ™åŒä¸Š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">æ—§  <span class="selector-tag">a</span> <span class="selector-tag">b</span> c d</span><br><span class="line">æ–°  <span class="selector-tag">b</span> e c a</span><br></pre></td></tr></table></figure>
<p>æ¯”è¾ƒb æ­¤æ—¶ index = 1 lastindex = 0  1&gt;0 bä¸ç§»åŠ¨ æ›´æ–° lastindexä¸º1<br>å½“æ¯”è¾ƒåˆ°eçš„æ—¶å€™ï¼Œå‘ç°æ—§ç»„åˆä¸­ä¸å­˜åœ¨ï¼Œæ•…åœ¨æ—§ç»„åˆä¸‹æ ‡ä¸º1çš„ä½ç½® åˆ›å»ºEï¼Œæ›´æ–°lastIndex=1<br>â€¦<br>å¯¹æ¯”åˆ°a å› ä¸ºæ˜¯æœ€åä¸€ä¸ª æ‰€ä»¥ diffæ“ä½œç»“æŸ</p>
<p>æ–°ç»„åˆå¯¹æ¯”å®Œæˆå å†å»å¯¹æ—§é›†åˆéå† åˆ¤æ–­æ–°é›†åˆæ²¡æœ‰ï¼Œä½†æ—§é›†åˆæœ‰çš„å…ƒç´ ï¼ˆå¦‚dï¼‰ï¼Œåˆ é™¤dï¼Œdiffæ“ä½œç»“æŸ</p>
]]></content>
      <categories>
        <category>web</category>
      </categories>
  </entry>
  <entry>
    <title>Domæ“ä½œæˆæœ¬ æµè§ˆå™¨çš„é‡æ’å’Œé‡ç»˜</title>
    <url>/2018/05/16/dom%E6%93%8D%E4%BD%9C%E6%88%90%E6%9C%AC/</url>
    <content><![CDATA[<p>æ“ä½œDomçš„æˆæœ¬å¾ˆé«˜ ä¸è¦è½»æ˜“å»æ“ä½œDom è¿™å¥è¯ä»å¼€å§‹å…¥é—¨å°±å¬è¯´ï¼Œé‚£ä¹ˆè¿™é‡Œè¯´çš„æˆæœ¬æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ<br>ç”±æ­¤å¼•å‡ºä»Šå¤©çš„é—®é¢˜</p>
<p>é¦–å…ˆæˆ‘ä»¬è¦æ¸…æ¥šå‡ ä¸ªæ¦‚å¿µ</p>
<h3 id="ä»€ä¹ˆæ˜¯DOMï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯DOMï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯DOMï¼Ÿ"></a>ä»€ä¹ˆæ˜¯DOMï¼Ÿ</h3><ul>
<li>DOMå…¨ç§° Document Object Model æ–‡æ¡£å¯¹è±¡æ¨¡å‹</li>
<li>å®ƒæ˜¯ä¸ºHTMLï¼ˆXMLï¼‰æä¾›çš„API</li>
<li>HTMLæ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ HTMLåœ¨DOMæ¨¡å‹æ ‡å‡†ä¸­è¢«è§†ä¸ºå¯¹è±¡</li>
<li>DOMåªæä¾›ç¼–ç¨‹æ¥å£å´æ— æ³•å®é™…æ“ä½œHTMLé‡Œé¢çš„å†…å®¹ </li>
<li>åœ¨æµè§ˆå™¨ä¸­ å‰ç«¯å·¥ç¨‹å¸ˆå¯ä»¥é€šè¿‡è„šæœ¬è¯­è¨€ï¼ˆjsï¼‰é€šè¿‡DOMå»æ“ä½œHTMLå†…å®¹<br>ï¼ˆä¸åªjsèƒ½è°ƒç”¨DOMè¿™ä¸ªAPI Pythonä¹Ÿå¯ä»¥ï¼‰</li>
<li>psï¼šä¹Ÿå­˜åœ¨CSSOMï¼šCSS Object Model æµè§ˆå™¨å°†CSSä»£ç è§£ææˆæ ‘å½¢çš„æ•°æ®ç»“æ„ä¸DOMæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æ•°æ®æœºæ„</li>
</ul>
<h3 id="æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹"><a href="#æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹" class="headerlink" title="æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹"></a>æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹</h3><p>è®¨è®ºDOMæ“ä½œæˆæœ¬ é¦–å…ˆè¦äº†è§£ä¸‹è¯¥æˆæœ¬çš„æ¥æº é‚£ä¹ˆå°±ç¦»ä¸å¼€æµè§ˆå™¨æ¸²æŸ“<br>æµè§ˆå™¨æ¸²æŸ“å‰éœ€è¦å…ˆæ„å»ºDOMå’ŒCSSæ ‘ å› æ­¤æˆ‘ä»¬éœ€è¦å°½å¿«å°†HTMLå’ŒCSSéƒ½æä¾›ç»™æµè§ˆå™¨</p>
<p>è¿™é‡Œåªè®¨è®ºæµè§ˆå™¨æ‹¿åˆ°HTMLä¹‹åå¼€å§‹è§£æ æ¸²æŸ“ </p>
<font color="red">ä¹‹å‰çš„ä¸€äº›å¦å¼€ä¸€ç¯‡</font><br>1. è§£æHTML æ„å»ºDOMæ ‘ ï¼ˆè¿™é‡Œé‡åˆ°å¤–é“¾ ä¼šå‘èµ·è¯·æ±‚ï¼‰<br>2. è§£æCSS ç”ŸæˆCSSè§„åˆ™æ ‘<br>3. åˆå¹¶DOMæ ‘å’ŒCSSè§„åˆ™ ç”Ÿæˆrenderï¼ˆæ¸²æŸ“ï¼‰æ ‘<br>4. å¸ƒå±€renderæ ‘ï¼ˆLayout/reflowï¼‰è´Ÿè´£å„å…ƒç´ çš„å°ºå¯¸ï¼Œä½ç½®çš„è®¡ç®—<br>5. ç»˜åˆ¶renderæ ‘ï¼ˆpaintï¼‰ç»˜åˆ¶é¡µé¢åƒç´ ä¿¡æ¯<br>6. æµè§ˆå™¨ä¼šå°†å„å±‚çš„ä¿¡æ¯å‘é€ç»™GPU GPUå°†å„å±‚åˆæˆ(composite) æ˜¾ç¤ºåœ¨å±å¹•ä¸Š<br>##### æ„å»ºDOMæ ‘<br><font color="red">HTML æ ‡è®°è½¬æ¢æˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ (DOM)</font><br>DOMæ ‘æ„å»ºè¿‡ç¨‹ï¼šå½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½æ„å»ºå¥½åæ‰ä¼šå»æ„å»ºå½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹<br>##### æ„å»ºCSSOMæ ‘<br><font color="red">CSS æ ‡è®°è½¬æ¢æˆ CSS å¯¹è±¡æ¨¡å‹ (CSSOM)</font><br>åœ¨æœ€ç»ˆè®¡ç®—å„ä¸ª2èŠ‚ç‚¹çš„æ ·å¼æ—¶ æµè§ˆå™¨éƒ½ä¼šå…ˆä»è¯¥èŠ‚ç‚¹çš„æ™®éå±æ€§ï¼ˆæ¯”å¦‚å…¨å±€æ ·å¼ï¼‰å¼€å§‹  å†å»åº”ç”¨è¯¥èŠ‚ç‚¹çš„å…·ä½“å±æ€§<br><br>æ¯ä¸ªæµè§ˆå™¨éƒ½æœ‰è‡ªå·±çš„é»˜è®¤æ ·å¼è¡¨å› æ­¤å¾ˆå¤šæ—¶å€™è¿™é¢—CSSOMæ ‘åªæ˜¯å¯¹è¿™å¼ é»˜è®¤æ ·å¼è¡¨çš„éƒ¨åˆ†æ›¿æ¢<br><br>DOM å’ŒCSSOMéƒ½è¦ç»è¿‡<br><code>Bytesâ†’charactersâ†’tokensâ†’nodesâ†’objectmodel</code>è¿™ä¸ªè¿‡ç¨‹<br>DOMå’ŒCSSOMæ˜¯ç‹¬ç«‹çš„æ•°æ®ç»“æ„<br>æ­¤å¤„éœ€è¦ä¸€å¼ å›¾ç‰‡<br><br><br>##### ç”Ÿæˆrenderï¼ˆæ¸²æŸ“ï¼‰æ ‘ ç”±æ­¤ æµè§ˆå™¨ä¸­ä¼šè§£æå¹¶ç”Ÿæˆä¸¤ä¸ªå†…éƒ¨æ•°æ®ç»“æ„<br><em> Domæ ‘è¡¨ç¤ºé¡µé¢ç»“æ„
</em> DOMæ ‘å’ŒCSSOMåˆå¹¶ç”Ÿæˆrenderæ ‘ï¼ˆæ¸²æŸ“æ ‘ï¼‰ï¼Œæ¸²æŸ“æ ‘è¡¨ç¤ºDomèŠ‚ç‚¹åœ¨é¡µé¢ä¸­å¦‚ä½•æ˜¾ç¤ºï¼ˆå®½é«˜ ä½ç½®ç­‰ï¼‰<br><br><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åœ¨domæ ‘ä¸­æ¯ä¸€ä¸ªéœ€è¦æ˜¾ç¤ºçš„èŠ‚ç‚¹åœ¨æ¸²æŸ“æ ‘ç§è‡³å°‘å­˜åœ¨ä¸€ä¸ªå¯¹åº”çš„èŠ‚ç‚¹ æ¸²æŸ“æ ‘ä¸­çš„èŠ‚ç‚¹è¢«ç§°ä¹‹ä¸ºâ€œå¸§â€æˆ–è€…â€œç›’â€ ç¬¦åˆcssæ¨¡å‹çš„å®šä¹‰ ä¸€æ—¦Domæ ‘å’Œæ¸²æŸ“æ ‘æ„å»ºå®Œæˆ  æµè§ˆå™¨å°±å¼€å§‹ æ˜¾ç¤ºï¼ˆç»˜åˆ¶paintï¼‰é¡µé¢å…ƒç´ </span><br></pre></td></tr></table></figure><br><br>ç®€å•æè¿°ä¸‹renderçš„è¿‡ç¨‹<br><br><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">DOMæ ‘ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†å¯è§èŠ‚ç‚¹</span><br><span class="line">è®¾ç½®äº†ç±»ä¼¼ <span class="attribute">display</span>ï¼š<span class="attribute">none</span> ï¼ˆåˆ™è¯¥èŠ‚ç‚¹ä¸å¯è§ï¼‰ åœ¨renderè¿‡ç¨‹ä¸­æ˜¯è¢«è·³è¿‡çš„</span><br><span class="line"><span class="attribute">visibility</span>:hidden; <span class="attribute">opacity</span>:<span class="number">0</span> è¿™ç§ä»æ—§å æ®ç©ºé—´çš„èŠ‚ç‚¹ä¸ä¼šè¢«è·³è¿‡render  ä¿å­˜å„ä¸ªèŠ‚ç‚¹çš„æ ·å¼ä¿¡æ¯åŠå…¶ä½™èŠ‚ç‚¹çš„ä»å±å…³ç³»</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Layoutå¸ƒå±€</span><br><span class="line">æœ‰äº†å„ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯å±æ€§ ä½†ä¸çŸ¥é“å„ä¸ªèŠ‚ç‚¹çš„ç¡®åˆ‡ä½ç½®å’Œå¤§å° æ‰€ä»¥è¦é€šè¿‡å¸ƒå±€å°†æ ·å¼ä¿¡æ¯å’Œå±æ€§è½¬æ¢ä¸ºå®é™…å¯è§†çª—å£çš„ç›¸å¯¹å¤§å°å’Œä½ç½®</span><br><span class="line">ï¼ˆDOM æ ‘æ•è·æ–‡æ¡£æ ‡è®°çš„å±æ€§å’Œå…³ç³»ï¼Œä½†å¹¶æœªå‘Šè¯‰æˆ‘ä»¬å…ƒç´ åœ¨æ¸²æŸ“åå‘ˆç°çš„å¤–è§‚ã€‚é‚£æ˜¯ CSSOM çš„è´£ä»»ï¼‰</span><br></pre></td></tr></table></figure><br><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Paintç»˜åˆ¶</span><br><span class="line">æœ€ååªè¦å°†ç¡®å®šå¥½ä½ç½®å¤§å°çš„å„èŠ‚ç‚¹é€šè¿‡GPUæ¸²æŸ“åˆ°å±å¹•çš„å®é™…åƒç´ </span><br></pre></td></tr></table></figure><br><br>TIPSï¼š<br><br><em> åœ¨ä¸Šè¿°æ¸²æŸ“è¿‡ç¨‹ä¸­ å‰ä¸‰ç‚¹å¯èƒ½è¦å¤šæ¬¡æ‰§è¡Œ æ¯”å¦‚jsè„šæœ¬å»æ“ä½œDOM æ›´æ”¹CSSæ ·å¼ æµè§ˆå™¨åˆè¦é‡æ–°æ„å»ºDOM CSSOMæ ‘ é‡æ–°render é‡æ–°layout paint
</em> å› ä¸ºlayoutåœ¨paintä¹‹å‰ å› æ­¤æ¯æ¬¡layputé‡æ–°å¸ƒå±€ï¼ˆreflowå›æµï¼‰åéƒ½è¦é‡æ–°è§¦å‘paintæ¸²æŸ“ è¿™æ—¶åˆè¦å»æ¶ˆè€—GPU<br><em> paintä¸ä¸€å®šä¼šè§¦å‘layout æ¯”å¦‚æ”¹ä¸ªé¢œè‰²æ”¹ä¸ªèƒŒæ™¯ï¼ˆrepainté‡ç»˜ï¼‰
</em> å›¾ç‰‡ä¸‹è½½å®Œä¹Ÿä¼šé‡æ–°è§¦å‘Layoutå’Œpaint<br><br><br>##### ä½•æ—¶è§¦å‘reflowï¼ˆé‡æ’ï¼‰å’Œrepaintï¼ˆé‡ç»˜ï¼‰<br><br><br><font color="red">reflow(é‡æ’)ï¼š</font>å½“domæ ‘çš„å˜åŒ–å½±å“äº†å…ƒç´ çš„é›†åˆå±æ€§ =ã€‹ æ„å‘³ç€å…ƒç´ çš„å†…å®¹ï¼Œç»“æ„ ä½ç½®æˆ–è€…å°ºå¯¸å‘ç”Ÿäº†å˜åŒ–ï¼ŒåŒæ ·å…¶ä»–å…ƒç´ çš„é›†åˆå±æ€§å’Œä½ç½®ä¹Ÿä¼šå› æ­¤å—åˆ°å½±å“ï¼Œæµè§ˆå™¨ä¼šä½¿æ¸²æŸ“æ ‘ï¼ˆrenderæ ‘ï¼‰ä¸­å—åˆ°å½±å“çš„éƒ¨åˆ†å¤±æ•ˆ  éœ€è¦é‡æ–°è®¡ç®—æ ·å¼å’Œæ¸²æŸ“æ ‘ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé‡æ’ï¼ˆreflowï¼‰<br><br><font color="red">repaint(é‡ç»˜)ï¼š</font> æ„å‘³ç€å…ƒç´ å‘ç”Ÿçš„æ”¹å˜åªä½ å½±å“äº†èŠ‚ç‚¹çš„ä¸€äº›æ ·å¼ï¼ˆèƒŒæ™¯è‰² è¾¹æ¡†é¢œè‰² æ–‡å­—å…ƒç´ ç­‰ï¼‰åªéœ€è¦åº”ç”¨æ–°æ ·å¼ç»˜åˆ¶è¿™ä¸ªå…ƒç´ å°±å¯ä»¥äº† ï¼ˆå®Œæˆé‡æ’å æµè§ˆå™¨ä¼šé‡æ–°ç»˜åˆ¶å—å½±å“çš„éƒ¨åˆ†åˆ°å±å¹•ä¸­ è¿™ä¸ªè¿‡ç¨‹å«åšé‡ç»˜ï¼‰<br><br>å¹¶ä¸æ˜¯æ‰€æœ‰çš„domè¾©æŠ¤éƒ½ä¼šå½±å“å‡ ä½•å±æ€§ ä¾‹å¦‚  æ”¹å˜å…ƒç´ çš„èƒŒæ™¯è‰²ä¸ä¼šå½±å“ å®½å’Œé«˜ è¿™ç§æƒ…å†µä¸‹ åªä¼šå‘ç”Ÿä¸€æ¬¡é‡ç»˜ï¼ˆä¸éœ€è¦é‡æ’ï¼‰å› ä¸ºå…ƒç´ çš„å¸ƒå±€æ²¡æœ‰æ”¹å˜<br><br><font color="red">é‡æ’ä¸€å®šä¼šå¼•èµ·æµè§ˆå™¨çš„é‡ç»˜ é‡ç»˜åˆ™ä¸ä¸€å®šä¼´éšé‡æ’</font>

<font color="red">é‡æ’</font>çš„æˆæœ¬å¼€é”€è¦é«˜äº<font color="red">é‡ç»˜</font>ä¸€ä¸ªèŠ‚ç‚¹çš„é‡æ’å¾€å¾€å¯¼è‡´å­èŠ‚ç‚¹ä»¥åŠåŒçº§èŠ‚ç‚¹çš„é‡æ’<br><br><br><br>###### è§¦å‘é‡æ’çš„æƒ…å†µ<br><br>å½“é¡µé¢å¸ƒå±€çš„å‡ ä½•å±æ€§æ”¹å˜æ—¶å°±éœ€è¦é‡æ’ ä¸‹åˆ—æƒ…å†µä¼šå¯¼è‡´é‡æ’<br><br><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">é¡µé¢ç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼ˆåˆå§‹åŒ–ï¼‰</span><br><span class="line"></span><br><span class="line">DOMæ ‘å˜åŒ–ï¼ˆå¦‚ï¼šå¢åˆ èŠ‚ç‚¹ï¼‰</span><br><span class="line">å…ƒç´ ä½ç½®æ”¹å˜</span><br><span class="line">å…ƒç´ å°ºå¯¸æ”¹å˜ï¼ˆå¤–è¾¹è· å†…è¾¹è· è¾¹æ¡†åšåº¦ å®½åº¦ é«˜åº¦ç­‰ï¼‰</span><br><span class="line">Renderæ ‘å˜åŒ–ï¼ˆå¦‚ï¼š<span class="attribute">padding</span>æ”¹å˜ï¼‰</span><br><span class="line">æµè§ˆå™¨çª—å£<span class="attribute">resize</span></span><br><span class="line">è·å–å…ƒç´ çš„æŸäº›å±æ€§ï¼š</span><br><span class="line">å½“æ»šåŠ¨æ¡å‡ºç°æ—¶ï¼Œä¼šè§¦å‘æ•´ä¸ªé¡µé¢çš„é‡æ’</span><br></pre></td></tr></table></figure><br><br>ç”±äºæ¯æ¬¡é‡æ’éƒ½ä¼šäº§ç”Ÿè®¡ç®—æ¶ˆè€—ï¼Œå¤§å¤šæ•°æµè§ˆå™¨é€šè¿‡é˜Ÿåˆ—åŒ–ä¿®æ”¹å¹¶æ‰¹é‡æ‰§è¡Œæ¥ä¼˜åŒ–é‡æ’çš„è¿‡ç¨‹<br><br>ä½†æ˜¯  æˆ‘ä»¬ç»å¸¸ä¼šä¸çŸ¥ä¸è§‰å¼ºåˆ¶åˆ·æ–°é˜Ÿåˆ—å¹¶è¦æ±‚è®¡åˆ’ä»»åŠ¡ç«‹å³æ‰§è¡Œ<br>è·å–å¸ƒå±€ä¿¡æ¯çš„æ“ä½œä¼šåˆ°æœ€åé˜Ÿåˆ—åˆ·æ–°  æ¯”å¦‚<br><br><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">offsetTop , offsetLeft , offsetWidth , offsetHeight</span><br><span class="line"></span><br><span class="line"><span class="keyword">scrollTop </span>, <span class="keyword">scrollLeft </span>, <span class="keyword">scrollWidth </span>, <span class="keyword">scrollHeight</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">clientTop </span>, clientLeft , clientWidth , clientHeight</span><br><span class="line"></span><br><span class="line">getComputedStyle() ( currentStyle in IE )</span><br></pre></td></tr></table></figure><br><br>å½“è·å–ä»¥ä¸Šçš„å±æ€§å’Œæ–¹æ³•æ—¶ æµè§ˆå™¨ä¸ºäº†è·å–æœ€æ–°çš„å¸ƒå±€ä¿¡æ¯ ä¸å¾—ä¸ç«‹å³è§¦å‘é‡æ’ä»¥è¿”å›æ­£ç¡®çš„å€¼<br><br>###### æœ€å°åŒ–é‡ç»˜å’Œé‡æ’<br>é‡ç»˜å’Œé‡æ’ä»£ä»·å¾ˆæ˜‚è´µ å› æ­¤ä¸€ä¸ªå·çš„æé«˜ç¨‹åºå“åº”ç†Ÿè¯»çš„ç­–ç•¥å°±æ˜¯å‡å°‘æ­¤ç±»æ“ä½œçš„å‘ç”Ÿ<br><br>###### ä¼˜åŒ–æ–¹å¼<br><br>1. åˆå¹¶å¤šæ¬¡å¯¹æ ·å¼å±æ€§çš„æ“ä½œ<br><br><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">æ€è€ƒ</span><br><span class="line"><span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'mydiv'</span>);</span><br><span class="line">el.style.borderLeft = <span class="string">'1px'</span>;</span><br><span class="line">el.style.borderRight = <span class="string">'2px'</span>;</span><br><span class="line">el.style.padding = <span class="string">'5px'</span>;</span><br><span class="line"></span><br><span class="line">å³ä½¿æœ‰æµè§ˆå™¨æœ‰é‡æ’æœºåˆ¶ä¼˜åŒ– ä½†æœ€åçš„æƒ…å†µä¹Ÿæ˜¯è¿›è¡Œä¸‰æ¬¡é‡æ’</span><br><span class="line"></span><br><span class="line">ä¿®æ”¹å</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'mydiv'</span>);</span><br><span class="line">el.style.cssText = <span class="string">'border-left: 1px; border-right: 2px; padding: 5px;'</span>;</span><br><span class="line">æˆ–è€…</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'mydiv'</span>);</span><br><span class="line">el.className = <span class="string">'active'</span>;</span><br></pre></td></tr></table></figure><br><br>2. æ‰¹é‡ä¿®æ”¹dom<br>å½“éœ€è¦å¯¹domå…ƒç´ è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œæ—¶å€™ å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ­¥éª¤æ¥å‡å°‘é‡ç»˜å’Œé‡æ’çš„æ¬¡æ•°<br><br><font color="green"> <em> ä½¿å…ƒç´ è„±ç¦»æ–‡æœ¬æµ</em></font><br><font color="green">  æ“ä½œå…ƒç´ </font><br><font color="green"> * æ“ä½œå®Œæˆå å°†å…ƒç´ å¸¦å›æ–‡æ¡£ä¸­</font><br>è¿™æ ·å„¿ åªæœ‰ç¬¬ä¸€æ­¥å’Œç¬¬ä¸‰éƒ¨è§¦å‘ä¸¤æ¬¡é‡æ’<br><br>æœ‰ä¸‰ç§æ–¹å¼å¯ä»¥å®ç°ä¸Šé¢çš„æ­¥éª¤<br><br><br><font color="red"> 1.éšè—å…ƒç´ ï¼ˆdisplay:noneï¼‰æ“ä½œå…ƒç´  é‡æ–°å±•ç¤º</font>

<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> ul = document.getElementById('mylist');</span><br><span class="line">ul.<span class="built_in">style</span>.<span class="built_in">display</span> = 'none';</span><br><span class="line">appendDataToElement(ul, data);</span><br><span class="line">ul.<span class="built_in">style</span>.<span class="built_in">display</span> = '<span class="built_in">block</span>';</span><br></pre></td></tr></table></figure>
<font color="red"> 2.ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µï¼ˆdocument fragmentï¼‰åœ¨å½“å‰ DOM ä¹‹å¤–æ„å»ºä¸€ä¸ªå­æ ‘ï¼Œå†æŠŠå®ƒæ‹·è´å›æ–‡æ¡£<br></font>

<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">var</span> fragment = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line">appendDataToElement(fragment, data);</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">'mylist'</span>).appendChild(fragment);</span><br></pre></td></tr></table></figure>
<font color="red"> 3.å°†åŸå§‹å…ƒç´ æ‹·è´åˆ°ä¸€ä¸ªè„±ç¦»æ–‡æ¡£çš„èŠ‚ç‚¹ä¸­ï¼Œä¿®æ”¹å‰¯æœ¬ï¼Œå®Œæˆåå†æ›¿æ¢åŸå§‹å…ƒç´ <br></font>

<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="keyword">old</span> = document.getElementById(<span class="string">'mylist'</span>);</span><br><span class="line"><span class="keyword">var</span> clone = <span class="keyword">old</span>.cloneNode(<span class="keyword">true</span>);</span><br><span class="line">appendDataToElement(clone, data);</span><br><span class="line"><span class="keyword">old</span>.parentNode.replaceChild(clone, <span class="keyword">old</span>);</span><br></pre></td></tr></table></figure>
<p><strong>æ€»ç»“ï¼š</strong>æ¨èå°½å¯èƒ½çš„ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µï¼ˆç¬¬äºŒä¸ªæ–¹æ¡ˆï¼‰ï¼Œå› ä¸ºå®ƒä»¬æ‰€äº§ç”Ÿçš„ DOM éå†å’Œé‡æ’æ¬¡æ•°æœ€å°‘ã€‚å”¯ä¸€æ½œåœ¨çš„é—®é¢˜æ˜¯æ–‡æ¡£ç‰‡æ®µæœªè¢«å……åˆ†åˆ©ç”¨ï¼Œå¾ˆå¤šäººå¯èƒ½å¹¶ä¸ç†Ÿæ‚‰è¿™é¡¹æŠ€æœ¯ã€‚</p>
<ol start="3">
<li>ç¼“å­˜å¸ƒå±€ä¿¡æ¯</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æµè§ˆå™¨è·å–å…ƒç´ çš„offsetLeftç­‰å±æ€§å€¼æ—¶ä¼šå¯¼è‡´é‡æ’ å°†éœ€è¦è·å–çš„ä¿æŠ¤å±€ä¿¡æ¯çš„å±æ€§å€¼ èµ‹å€¼ç»™å˜é‡ ç„¶åå†æ“ä½œå˜é‡</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>å®šä½</li>
</ol>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">å°†éœ€è¦å¤šæ¬¡é‡æ’çš„å…ƒç´ ï¼Œ<span class="attribute">position</span> å±æ€§è®¾ç½®ä¸º absolute æˆ– fixedï¼Œè¿™æ ·å…ƒç´ å°±è„±ç¦»äº†æ–‡æ¡£æµï¼Œå®ƒçš„å˜åŒ–ä¸ä¼šå½±å“åˆ°å…¶ä»–å…ƒç´ ã€‚ä¾‹å¦‚æœ‰åŠ¨ç”»æ•ˆæœçš„å…ƒç´ å°±æœ€å¥½è®¾ç½®ä¸ºç»å¯¹å®šä½ã€‚</span><br></pre></td></tr></table></figure>
<font color="red">æ“ä½œDOMå…·ä½“çš„æˆæœ¬ï¼Œè¯´åˆ°åº•æ˜¯é€ æˆæµè§ˆå™¨é‡æ’å’Œé‡ç»˜ï¼Œä»è€Œæ¶ˆè€—GPUèµ„æº</font>


















<p>s</p>
]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±å…¥ç†è§£Flexbox</title>
    <url>/2019/03/14/flex/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿‡å»ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¸å¾—ä¸å¿å—<code>floatã€display:table</code>è¿™äº›å¸ƒå±€æ–¹å¼å¸¦æ¥çš„ç—›è‹¦ï¼Œä¸è¿‡ç°åœ¨æ˜¯æ—¶å€™å»æ‹¥æŠ±ä¸€ä¸ªæ›´ç®€æ´çš„åˆ¶ä½œæ™ºèƒ½å¸ƒå±€çš„ç°ä»£è¯­æ³• <code>Flexbox</code></p>
<h2 id="Flexboxæ˜¯ä»€ä¹ˆ"><a href="#Flexboxæ˜¯ä»€ä¹ˆ" class="headerlink" title="Flexboxæ˜¯ä»€ä¹ˆ"></a>Flexboxæ˜¯ä»€ä¹ˆ</h2><p>æ ¹æ®è§„èŒƒä¸­çš„æè¿°å¯çŸ¥é“ï¼Œ<code>Flexbox</code>æ¨¡å—æä¾›äº†ä¸€ä¸ªæœ‰æ•ˆçš„å¸ƒå±€æ–¹å¼ï¼Œå³ä½¿ä¸çŸ¥é“è§†çª—å¤§å°æˆ–è€…æœªçŸ¥å…ƒç´ æƒ…å†µä¹‹ä¸‹éƒ½å¯ä»¥æ™ºèƒ½çš„ï¼Œçµæ´»çš„è°ƒæ•´å’Œåˆ†é…å…ƒç´ å’Œç©ºé—´ä¸¤è€…ä¹‹é—´çš„å…³ç³»</p>
<a id="more"></a>
<h2 id="å¦‚ä½•å¼€å§‹ä½¿ç”¨Flexbox"><a href="#å¦‚ä½•å¼€å§‹ä½¿ç”¨Flexbox" class="headerlink" title="å¦‚ä½•å¼€å§‹ä½¿ç”¨Flexbox"></a>å¦‚ä½•å¼€å§‹ä½¿ç”¨Flexbox</h2><p>å¹¸è¿çš„æ˜¯ï¼Œå…¥é—¨è¶…çº§ç®€å•<br>ä½ è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å£°æ˜ä¸€ä¸ª<code>Flex</code>å®¹å™¨</p>
<p>å°±åƒè¿™æ ·å„¿ï¼Œå£°æ˜äº†<code>Flex</code>å®¹å™¨ä¹‹åï¼Œä¸€ä¸ª<code>Flexbox</code>æ ¼å¼åŒ–ä¸Šä¸‹æ–‡å°±ç«‹å³å¯åŠ¨äº†</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;ul <span class="class"><span class="keyword">class</span></span>=<span class="string">"oul"</span>&gt;</span><br><span class="line">  &lt;li&gt;<span class="number">1</span>&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">  &lt;li&gt;2&lt;/</span>li&gt;</span><br><span class="line">  &lt;li&gt;<span class="number">3</span>&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">&lt;/u</span>l&gt;</span><br></pre></td></tr></table></figure>
<p>æ­£å¸¸æƒ…å†µä¸‹divåœ¨CSSä¸­å‚ç›´å †æ ˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»ä¸Šåˆ°ä¸‹æ’åˆ—æ˜¾ç¤º</p>
<p>å›¾ä¸€<br><img src="/images/flex/flex2.png" alt="flex2"></p>
<p>å£°æ˜<code>Flexå®¹å™¨</code></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.oul</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å·²ç»æ˜¯ä¸€ä¸ªFlexboxæ ¼å¼åŒ–ä¸Šä¸‹æ–‡<br>å›¾äºŒ<br><img src="/images/flex/flex1.png" alt="flex1"></p>
<p><strong>å¾ˆç®€å• ä¸€è¡Œä»£ç å°±èƒ½çœ‹åˆ°å¸ƒå±€æ”¹å˜äº†å­å…ƒç´ å°±åƒä½ ä½¿ç”¨äº†floatä¸€æ ·æ˜¯æ°´å¹³æ’åˆ—çš„</strong></p>
<p>æ‹¿è¿™ä¸ªä¾‹å­æ¥è¯´æ­¤æ—¶<code>ul</code>è‡ªåŠ¨å˜æˆäº†<code>Flex</code>ï¼Œè€Œ <code>li</code>å˜æˆäº†<code>Flex</code>é¡¹ç›®</p>
<p>è®°ä½è¿™äº›åè¯ï¼Œå®ƒä»¬æ˜¯<code>Flexbox</code>æ¨¡å—çš„åŸºç¡€</p>
<h2 id="Flexå®¹å™¨å±æ€§"><a href="#Flexå®¹å™¨å±æ€§" class="headerlink" title="Flexå®¹å™¨å±æ€§"></a>Flexå®¹å™¨å±æ€§</h2><p><code>flex-direction || flex-wrap || flex-flow || justify-content || align-items || align-content</code><br>è§£é‡Šè¿™äº›å±æ€§ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€å¼ flexä¸–ç•Œæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ</p>
<p><img src="/images/flex/flex3.png" alt="flex3"></p>
<ul>
<li><code>Main-Axis</code>å°±æ˜¯æ°´å¹³æ–¹å‘ï¼Œä»å·¦åˆ°å³ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤æ–¹å‘</li>
<li><code>Cross-Axis</code>æ˜¯å‚ç›´æ–¹å‘ï¼Œä»ä¸Šå¾€ä¸‹</li>
</ul>
<h3 id="flex-direction"><a href="#flex-direction" class="headerlink" title="flex-direction"></a>flex-direction</h3><p>å±æ€§å€¼</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &#123; <span class="attribute">flex-direction</span>: row || column || row-reverse || column-reverse; &#125;</span><br></pre></td></tr></table></figure>
<p>é»˜è®¤å€¼æ˜¯<code>row</code>å®ƒè®©Flexé¡¹ç›®æ²¿ç€Main-Axisæ’åˆ—ï¼ˆä»å·¦å‘å³ï¼Œæ°´å¹³æ’åˆ—ï¼‰ è¿™ä¹Ÿè§£é‡Šäº†å›¾äºŒçš„æ•ˆæœ</p>
<h3 id="flex-wrap"><a href="#flex-wrap" class="headerlink" title="flex-wrap"></a>flex-wrap</h3><p>å±æ€§å€¼</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &#123; <span class="attribute">flex-wrap</span>: wrap || nowrap || wrap-reverse; &#125;</span><br><span class="line"></span><br><span class="line">*  <span class="selector-tag">nowrap</span>: <span class="selector-tag">Flex</span>å®¹å™¨å†…çš„<span class="selector-tag">Flex</span>é¡¹ç›®ä¸æ¢è¡Œæ’åˆ— ï¼ˆé»˜è®¤å€¼ï¼‰</span><br><span class="line">*  <span class="selector-tag">wrap</span>:æ¢è¡Œæ’åˆ— è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€è¡Œä¸èƒ½åŒ…å«æ‰€æœ‰åˆ—è¡¨é¡¹çš„é»˜è®¤å®½åº¦ï¼Œå®ƒä»¬å°±ä¼šå¤šè¡Œæ’åˆ—</span><br><span class="line">*  <span class="selector-tag">wrap-reverse</span>:åå‘æ¢è¡Œ</span><br></pre></td></tr></table></figure>
<h3 id="flex-flow"><a href="#flex-flow" class="headerlink" title="flex-flow"></a>flex-flow</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">flex-flow</span>æ˜¯<span class="selector-tag">flex-direction</span>å’Œ<span class="selector-tag">flex-wrap</span>ä¸¤ä¸ªå±æ€§çš„é€Ÿè®°å±æ€§</span><br></pre></td></tr></table></figure>
<p>è¯­æ³•<br><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &#123; <span class="attribute">flex-flow</span>: row wrap; &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a>justify-content</h3><p>æ¥ä¸‹æ¥æ„Ÿå—æ¥è‡ª<code>flex</code>å®¹å™¨çš„é­”æ³•</p>
<p>å®ƒä¸»è¦å®šä¹‰äº†Flexé¡¹ç›®åœ¨<code>Main-Axis</code>ä¸Šçš„å¯¹é½æ–¹å¼</p>
<p>å±æ€§å€¼</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &#123; <span class="attribute">justify-content</span>: flex-start || flex-end || center || space-between || space-around &#125;</span><br><span class="line">* <span class="selector-tag">flex-start</span> å…ƒç´ ä½äºå®¹å™¨çš„å¼€å¤´ã€‚å¼¹æ€§ç›’å­å…ƒç´ çš„ä¾§è½´ï¼ˆçºµè½´ï¼‰èµ·å§‹ä½ç½®çš„è¾¹ç•Œç´§é ä½è¯¥è¡Œçš„ä¾§è½´èµ·å§‹è¾¹ç•Œã€‚</span><br><span class="line">* <span class="selector-tag">flex-end</span> å…ƒç´ ä½äºå®¹å™¨çš„ç»“å°¾ï¼Œå¼¹æ€§ç›’å­å…ƒç´ çš„ä¾§è½´ï¼ˆçºµè½´ï¼‰èµ·å§‹ä½ç½®çš„è¾¹ç•Œç´§é ä½è¯¥è¡Œçš„ä¾§è½´ç»“æŸè¾¹ç•Œ</span><br><span class="line">* <span class="selector-tag">center</span>ï¼šå±…ä¸­å¯¹é½</span><br><span class="line">* <span class="selector-tag">space-between</span>ï¼šè®©é™¤äº†ç¬¬ä¸€ä¸ªå’Œæœ€ä¸€ä¸ª<span class="selector-tag">Flex</span>é¡¹ç›®çš„ä¸¤è€…é—´é—´è·ç›¸åŒï¼ˆä¸¤ç«¯å¯¹é½ï¼‰</span><br><span class="line">* <span class="selector-tag">space-around</span>ï¼šè®©æ¯ä¸ª<span class="selector-tag">Flex</span>é¡¹ç›®å…·æœ‰ç›¸åŒçš„ç©ºé—´</span><br></pre></td></tr></table></figure>
<p><strong>space-between</strong><br><img src="/images/flex/between.png" alt="between"><br><strong>space-around</strong></p>
<p>å’Œspace-betweenæœ‰ç‚¹ä¸åŒï¼Œç¬¬ä¸€ä¸ªFlexé¡¹ç›®å’Œæœ€åä¸€ä¸ªFlexé¡¹ç›®è·Main-Axiså¼€å§‹è¾¹ç¼˜å’Œç»“æŸè¾¹ç¼˜çš„çš„é—´è·æ˜¯å…¶ä»–ç›¸é‚»Flexé¡¹ç›®é—´è·çš„ä¸€åŠ<br><img src="/images/flex/around.png" alt="around"></p>
<h3 id="align-items"><a href="#align-items" class="headerlink" title="align-items"></a>align-items</h3><p>å®ƒä¸»è¦ç”¨æ¥æ§åˆ¶Flexé¡¹ç›®åœ¨ä¾§è½´ä¸Šçš„å¯¹é½æ–¹å¼</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">ul</span> &#123; <span class="attribute">align-items</span>: flex-start || flex-end || center || stretch || baseline &#125;</span><br><span class="line"></span><br><span class="line">* <span class="selector-tag">stretch</span> é»˜è®¤å€¼ è®©æ‰€æœ‰çš„<span class="selector-tag">Flex</span>é¡¹ç›®é«˜åº¦å’Œ<span class="selector-tag">Flex</span>å®¹å™¨é«˜åº¦ä¸€æ ·ã€‚</span><br><span class="line">* <span class="selector-tag">flex-start</span> å…ƒç´ ä½äºå®¹å™¨çš„å¼€å¤´ã€‚å¼¹æ€§ç›’å­å…ƒç´ çš„ä¾§è½´ï¼ˆçºµè½´ï¼‰èµ·å§‹ä½ç½®çš„è¾¹ç•Œç´§é ä½è¯¥è¡Œçš„ä¾§è½´èµ·å§‹è¾¹ç•Œã€‚</span><br><span class="line">* <span class="selector-tag">flex-end</span> å…ƒç´ ä½äºå®¹å™¨çš„ç»“å°¾ï¼Œå¼¹æ€§ç›’å­å…ƒç´ çš„ä¾§è½´ï¼ˆçºµè½´ï¼‰èµ·å§‹ä½ç½®çš„è¾¹ç•Œç´§é ä½è¯¥è¡Œçš„ä¾§è½´ç»“æŸè¾¹ç•Œ</span><br><span class="line">* <span class="selector-tag">center</span> å…ƒç´ ä½äºå®¹å™¨çš„ä¸­å¿ƒ</span><br><span class="line">* <span class="selector-tag">baseline</span> è®©æ‰€æœ‰<span class="selector-tag">Flex</span>é¡¹ç›®åœ¨<span class="selector-tag">Cross-Axis</span>ä¸Šæ²¿ç€ä»–ä»¬è‡ªå·±çš„åŸºçº¿å¯¹é½</span><br></pre></td></tr></table></figure>
<p><strong>baseline</strong><br>æ•ˆæœç±»ä¼¼<code>flex-start</code>ä½†ç•¥æœ‰ä¸åŒ<br>åŒºåˆ«å°±åœ¨äº<code>baseline</code><br><img src="/images/flex/base.png" alt="base"></p>
<h3 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a>align-content</h3><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">ul &#123; align-items: stretch|center|flex-start|flex-<span class="keyword">end</span>|<span class="literal">space</span>-<span class="keyword">between</span>|<span class="literal">space</span>-<span class="keyword">around</span>&#125;</span><br><span class="line"></span><br><span class="line">* stretch é»˜è®¤å€¼ å…ƒç´ è¢«æ‹‰ä¼¸ä»¥é€‚åº”å®¹å™¨</span><br><span class="line">* flex-start å…ƒç´ ä½äºå®¹å™¨çš„å¼€å¤´ã€‚å¼¹æ€§ç›’å­å…ƒç´ çš„ä¾§è½´ï¼ˆçºµè½´ï¼‰èµ·å§‹ä½ç½®çš„è¾¹ç•Œç´§é ä½è¯¥è¡Œçš„ä¾§è½´èµ·å§‹è¾¹ç•Œã€‚</span><br><span class="line">* flex-<span class="keyword">end</span> å…ƒç´ ä½äºå®¹å™¨çš„ç»“å°¾ï¼Œå¼¹æ€§ç›’å­å…ƒç´ çš„ä¾§è½´ï¼ˆçºµè½´ï¼‰èµ·å§‹ä½ç½®çš„è¾¹ç•Œç´§é ä½è¯¥è¡Œçš„ä¾§è½´ç»“æŸè¾¹ç•Œ</span><br><span class="line">* center å…ƒç´ ä½äºå®¹å™¨çš„ä¸­å¿ƒ</span><br><span class="line">* <span class="literal">space</span>-<span class="keyword">between</span>ï¼šè®©é™¤äº†ç¬¬ä¸€ä¸ªå’Œæœ€ä¸€ä¸ªFlexé¡¹ç›®çš„ä¸¤è€…é—´é—´è·ç›¸åŒï¼ˆä¸¤ç«¯å¯¹é½ï¼‰</span><br><span class="line">* <span class="literal">space</span>-<span class="keyword">around</span>ï¼šè®©æ¯ä¸ªFlexé¡¹ç›®å…·æœ‰ç›¸åŒçš„ç©ºé—´</span><br></pre></td></tr></table></figure>
<p><strong>stretch</strong><br><img src="/images/flex/align-content.png" alt="align-content"><br>flex-end<br><img src="/images/flex/ennd.png" alt="ennd"></p>
<p><strong>flex-start</strong></p>
<p><img src="/images/flex/align-content-start.png" alt="align-content-start"></p>
<p><strong>center</strong><br><img src="/images/flex/center.png" alt="cente"></p>
<h2 id="Flexé¡¹ç›®å±æ€§"><a href="#Flexé¡¹ç›®å±æ€§" class="headerlink" title="Flexé¡¹ç›®å±æ€§"></a>Flexé¡¹ç›®å±æ€§</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">order || flex-grow || flex-shrink || flex-basis</span><br></pre></td></tr></table></figure>
<h3 id="order"><a href="#order" class="headerlink" title="order"></a>order</h3><p>å…è®¸Flexé¡¹ç›®åœ¨ä¸€ä¸ªFlexå®¹å™¨ä¸­é‡æ–°æ’åºã€‚åŸºæœ¬ä¸Šï¼Œä½ å¯ä»¥æ”¹å˜Flexé¡¹ç›®çš„é¡ºåºï¼Œä»ä¸€ä¸ªä½ç½®ç§»åŠ¨åˆ°å¦ä¸€ä¸ªåœ°æ–¹è€Œä¸æ”¹å˜æºä»£ç ï¼Œæ‰€æœ‰Flexé¡¹ç›®çš„orderå€¼éƒ½æ˜¯0ï¼ŒFlexé¡¹ç›®ä¼šæ ¹æ®orderå€¼ä»ä½åˆ°é«˜é‡æ–°æ’åº</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.oul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span><br><span class="line">    <span class="attribute">order</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="comment">/*è®¾ç½®ä¸€ä¸ªæ¯”0æ›´å¤§çš„å€¼*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Flexé¡¹ç›®2ã€3ã€4çš„orderå€¼ä¸º0ã€‚ç°åœ¨Flexé¡¹ç›®1çš„orderå€¼ä¸º1</p>
<p><img src="/images/flex/order.png" alt="orde"></p>
<p>Flexé¡¹ç›®<code>2ã€3å’Œ4çš„order</code>å€¼éƒ½æ˜¯<code>0</code>ã€‚HTMLæºä»£ç ç§©åºå¹¶æ²¡æœ‰ä¿®æ”¹è¿‡ã€‚å¦‚æœç»™<code>Flex</code>é¡¹ç›®2çš„<code>order</code>è®¾ç½®ä¸º<code>2</code><br><img src="/images/flex/order2.png" alt="orde"></p>
<p>å¯è§ å®ƒä¹Ÿå¢åŠ å †æ ˆã€‚ç°åœ¨ä»£è¡¨<code>Flex</code>é¡¹ç›®çš„æœ€é«˜çš„<code>order</code>å€¼</p>
<p>å½“ä¸¤ä¸ªFlexé¡¹ç›®å…·æœ‰ç›¸åŒçš„orderå€¼å‘¢ï¼Ÿåœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼ŒæŠŠFlexé¡¹ç›®1å’Œ3è®¾ç½®ç›¸åŒçš„orderå€¼ã€‚<br><img src="/images/flex/order3.png" alt="orde"><br>ç°åœ¨ä»æ˜¯ä»ä½åˆ°é«˜æ’åˆ—ã€‚è¿™æ¬¡<code>Flex</code>é¡¹ç›®<code>3</code>æ’åœ¨<code>Flex</code>é¡¹ç›®<code>1</code>åé¢ï¼Œé‚£æ˜¯å› ä¸ºåœ¨<code>HTML</code>æ–‡æ¡£ä¸­<code>Flex</code>é¡¹ç›®<code>3</code>å‡ºç°åœ¨<code>Flex</code>é¡¹ç›®<code>1</code>åé¢ã€‚</p>
<p>å¦‚æœä¸¤ä¸ªä»¥ä¸‹<code>Flex</code>é¡¹ç›®æœ‰ç›¸åŒçš„<code>order</code>å€¼æ—¶ï¼Œ<code>Flex</code>é¡¹ç›®é‡æ–°æ’åºæ˜¯åŸºäº<code>HTML</code>æºæ–‡ä»¶çš„ä½ç½®è¿›è¡Œæ’åº</p>
<h3 id="flex-grow-å’Œ-flex-shrink"><a href="#flex-grow-å’Œ-flex-shrink" class="headerlink" title="flex-grow å’Œ flex-shrink"></a>flex-grow å’Œ flex-shrink</h3><ul>
<li>flex-grow ï¼šæ§åˆ¶<code>Flex</code>é¡¹ç›®åœ¨å®¹å™¨æœ‰å¤šä½™çš„ç©ºé—´å¦‚ä½•æ”¾å¤§ï¼ˆæ‰©å±•ï¼‰é»˜è®¤å€¼æ˜¯0 è¡¨ç¤ºå¼€å…³æ˜¯å…³é—­çš„ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex-grow</span>: &lt;number&gt;; <span class="comment">/* default 0 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/flow-grow.png" alt="flow-gro"><br>å±æ€§å€¼ä¸º1æ—¶<br><img src="/images/flex/flow-grow1.png" alt="flow-gro"></p>
<p>ç°åœ¨<code>Flex</code>é¡¹ç›®æ‰©å±•äº†ï¼Œå æ®äº†Flexå®¹å™¨æ‰€æœ‰å¯ç”¨ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´å¼€å…³æ‰“å¼€äº†ã€‚å¦‚æœä½ è¯•ç€è°ƒæ•´ä½ æµè§ˆå™¨çš„å¤§å°ï¼Œ<code>Flex</code>é¡¹ç›®ä¹Ÿä¼šç¼©å°ï¼Œä»¥é€‚åº”æ–°çš„å±å¹•å®½åº¦</p>
<p>å¦‚æœæ‰€æœ‰é¡¹ç›®çš„<code>flex-grow</code>å±æ€§éƒ½ä¸º<code>1</code>ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰<br>å¦‚æœä¸€ä¸ªé¡¹ç›®çš„<code>flex-grow</code>å±æ€§ä¸º<code>2</code>ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º<code>1</code>ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€</p>
<ul>
<li>flex-shrinkï¼šå±æ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º<code>1</code>ï¼ˆé»˜è®¤å¼€å¯ï¼‰ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°</li>
</ul>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex-shrink</span>: &lt;number&gt;; <span class="comment">/* default 1 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="flex-basis"><a href="#flex-basis" class="headerlink" title="flex-basis"></a>flex-basis</h3><p>å®ƒç”¨äºè®¾ç½®æˆ–æ£€ç´¢å¼¹æ€§ç›’ä¼¸ç¼©åŸºå‡†å€¼<br><code>æµè§ˆå™¨</code>æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ä¸€èˆ¬é…åˆ <code>flex-wrap</code>ä¸€èµ·ä½¿ç”¨ï¼Œflexå®¹å™¨æ ¹æ® <code>flex-basis</code> è®¡ç®—æ˜¯å¦éœ€è¦æ¢è¡Œ</p>
<p>ä¸€äº›ç‰¹æ€§</p>
<h4 id="1-å®ƒçš„å±æ€§å€¼å¯ä»¥æ˜¯é•¿åº¦å•ä½-em-rem-px-æˆ–ç™¾åˆ†æ¯”-ï¼Œç™¾åˆ†æ¯”æ˜¯æŒ‰ç…§çˆ¶å…ƒç´ çš„widthä¸ºæ ‡å‡†"><a href="#1-å®ƒçš„å±æ€§å€¼å¯ä»¥æ˜¯é•¿åº¦å•ä½-em-rem-px-æˆ–ç™¾åˆ†æ¯”-ï¼Œç™¾åˆ†æ¯”æ˜¯æŒ‰ç…§çˆ¶å…ƒç´ çš„widthä¸ºæ ‡å‡†" class="headerlink" title="1.å®ƒçš„å±æ€§å€¼å¯ä»¥æ˜¯é•¿åº¦å•ä½(em || rem || px)æˆ–ç™¾åˆ†æ¯”(%)ï¼Œç™¾åˆ†æ¯”æ˜¯æŒ‰ç…§çˆ¶å…ƒç´ çš„widthä¸ºæ ‡å‡†"></a>1.å®ƒçš„å±æ€§å€¼å¯ä»¥æ˜¯<strong>é•¿åº¦å•ä½(em || rem || px)</strong>æˆ–<strong>ç™¾åˆ†æ¯”(%)</strong>ï¼Œ<font color="red">ç™¾åˆ†æ¯”æ˜¯æŒ‰ç…§çˆ¶å…ƒç´ çš„widthä¸ºæ ‡å‡†</font></h4><h4 id="2-é»˜è®¤å€¼ä¸º-auto-MDN"><a href="#2-é»˜è®¤å€¼ä¸º-auto-MDN" class="headerlink" title="2.é»˜è®¤å€¼ä¸º auto  MDN"></a>2.é»˜è®¤å€¼ä¸º <font color="red">auto</font>  <a href="https://drafts.csswg.org/css-flexbox/#flexibility" target="_blank" rel="noopener">MDN</a></h4> <figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">å–å€¼ä¸º**<span class="attribute">auto</span>**æ—¶ï¼Œå®ƒçš„å€¼å°±ç­‰äºå½“å‰é¡¹çš„**<span class="attribute">width</span>**ï¼ˆæˆ–è€…é»˜è®¤çš„å¤§å°ï¼Œ<span class="attribute">width</span>æ²¡æœ‰è®¾ç½®çš„è¯ï¼‰" </span><br><span class="line"><span class="attribute">flex-basis</span>:auto<span class="string">" çš„å«ä¹‰æ˜¯ "</span>å‚ç…§æˆ‘çš„widthå’Œheightå±æ€§</span><br></pre></td></tr></table></figure>
<h4 id="å½“flex-itemæ²¡æœ‰è‡ªèº«å®½é«˜ï¼Œå…¶é»˜è®¤å¤§å°ç”±flex-basiså†³å®š"><a href="#å½“flex-itemæ²¡æœ‰è‡ªèº«å®½é«˜ï¼Œå…¶é»˜è®¤å¤§å°ç”±flex-basiså†³å®š" class="headerlink" title="å½“flex-itemæ²¡æœ‰è‡ªèº«å®½é«˜ï¼Œå…¶é»˜è®¤å¤§å°ç”±flex-basiså†³å®š"></a>å½“flex-itemæ²¡æœ‰è‡ªèº«å®½é«˜ï¼Œå…¶é»˜è®¤å¤§å°ç”±flex-basiså†³å®š</h4><p>å³ä¼˜å…ˆçº§ï¼š <font color="red">flex-basis &gt; width(éauto)</font></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.oul2-li</span>&#123;</span><br><span class="line">      <span class="attribute">flex-basis</span>: <span class="number">200px</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">10px</span>;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">4px</span>;</span><br><span class="line">      <span class="attribute">background</span>: red;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/shiliflex1.png" alt="shiliflex1"></p>
<h4 id="4-å½“å…ƒç´ å­˜åœ¨é»˜è®¤å®½é«˜ï¼ˆinputï¼‰"><a href="#4-å½“å…ƒç´ å­˜åœ¨é»˜è®¤å®½é«˜ï¼ˆinputï¼‰" class="headerlink" title="4.å½“å…ƒç´ å­˜åœ¨é»˜è®¤å®½é«˜ï¼ˆinputï¼‰"></a>4.å½“å…ƒç´ å­˜åœ¨é»˜è®¤å®½é«˜ï¼ˆ<font color="red">input</font>ï¼‰</h4><p>å¹¶ä¸”è®¾ç½®äº† <code>flex-basis</code>ï¼Œé‚£ä¹ˆå®ƒçš„åˆå§‹å¤§å°<code>ä»¥å›ºå®šå®½é«˜ä¸ºä¸‹é™</code>ï¼Œå¦‚æœ<code>flex-basis</code>è¶…è¿‡äº†å›ºå®šå®½é«˜ï¼Œé‚£ä¹ˆä»¥<code>flex-basis</code>è®¾ç½®å¤§å°ä¸ºå‡†ï¼Œå¦‚æœ<code>flex-basis</code>æ¯”å›ºå®šå®½é«˜å°ï¼Œé‚£ä¹ˆä»¥å›ºå®šå®½é«˜ä¸ºå‡†</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.Myinput</span> &#123;</span><br><span class="line">     <span class="attribute">background</span>: greenyellow;</span><br><span class="line">     <span class="attribute">flex-basis</span>: <span class="number">200px</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/gfdsdf.png" alt="gfdsdf"><br>å½“å°†<code>flex-basis</code>è®¾ç½®çš„æ¯”é»˜è®¤å®½åº¦å¤§</p>
<p><img src="/images/flex/swqs.png" alt="swqs"></p>
<p>å½“å°†<code>flex-basis</code>è®¾ç½®çš„æ¯”é»˜è®¤å®½åº¦å° 100<br><img src="/images/flex/jnjjjuuu.png" alt="jnjjjuuu"></p>
<h4 id="5-å½“å…ƒç´ å­˜åœ¨-min-width-height-æˆ–è€…-max-width-height"><a href="#5-å½“å…ƒç´ å­˜åœ¨-min-width-height-æˆ–è€…-max-width-height" class="headerlink" title="5.å½“å…ƒç´ å­˜åœ¨ min-width[height] æˆ–è€… max-width[height]"></a>5.å½“å…ƒç´ å­˜åœ¨ min-width[height] æˆ–è€… max-width[height]</h4><figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line">å¦‚æœ `flex-basis` çš„å€¼ å¤§äº `min-width[min-height]`ï¼Œ`flex-item content`çš„å€¼ä¸º `flex-basis`</span><br><span class="line">å¦‚æœ`flex-basis `çš„å€¼å°äº` min-width[min-height]` é‚£ä¹ˆ`flex-item content`ä»¥`min-width[min-height]`è®¡ç®—</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/jsjjsjsjjjsjsjs.png" alt="jsjjsjsjjjsjsjs"></p>
<h4 id="6-å…ƒç´ è®¾ç½®width-height-auto"><a href="#6-å…ƒç´ è®¾ç½®width-height-auto" class="headerlink" title="6.å…ƒç´ è®¾ç½®width[height]: auto;"></a>6.å…ƒç´ è®¾ç½®<code>width[height]: auto;</code></h4><p>CSSè§£æå™¨å¯¹æ¯”ä¸¤è€…çš„å€¼ï¼Œä¸¤è€…<strong>è°å¤§å–è°</strong>ä½œä¸º<code>item</code>çš„åŸºæœ¬å°ºå¯¸ï¼Œå¦‚æœä¸€ä¸ª<code>item</code>æ²¡æœ‰å†…å®¹ï¼Œflex-item åˆå§‹å¤§å°å°±ä¼šä»¥<code>flex-basis</code>æ¥å†³å®š<br>ä½†æ˜¯å¦‚æœ<code>item</code>æœ‰äº†å†…å®¹ï¼Œä¸”å†…å®¹æ’‘å¼€çš„å°ºå¯¸æ¯”<code>flex-basis</code>å¤§ï¼Œé‚£ä¹ˆ<code>flex-item</code>åˆå§‹å¤§å°å°±ä¼šä»¥<code>width[height]: auto;</code>æ¥å†³å®š<br><br>ä¼˜å…ˆçº§ï¼š<font color="red">width[height]: auto == flex-basis</font></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"> &lt;<span class="selector-tag">ul</span> class=<span class="string">"oul2"</span>&gt;</span><br><span class="line">      &lt;<span class="selector-tag">li</span> class=<span class="string">"li1"</span>&gt;<span class="number">666666666666666666666666666666666666666666666666666666666666666666666666666666666666</span>&lt;/li&gt;</span><br><span class="line">      &lt;<span class="selector-tag">li</span> class=<span class="string">"li2"</span>&gt;<span class="number">77777</span>&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    </span><br><span class="line">    .li1&#123;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">background</span>: greenyellow;</span><br><span class="line">    <span class="attribute">width</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line">.li2&#123;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">width</span>: auto;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.oul2&#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/uuxsuudhdusd.png" alt="uuxsuudhdusd"></p>
<h2 id="ç»å¯¹å’Œç›¸å¯¹Flexé¡¹ç›®"><a href="#ç»å¯¹å’Œç›¸å¯¹Flexé¡¹ç›®" class="headerlink" title="ç»å¯¹å’Œç›¸å¯¹Flexé¡¹ç›®"></a>ç»å¯¹å’Œç›¸å¯¹Flexé¡¹ç›®</h2><p>ç»å¯¹Flexé¡¹ç›®çš„å®½åº¦åªåŸºäº flex å±æ€§ï¼Œè€Œç›¸å¯¹Flexé¡¹ç›®çš„å®½åº¦åŸºäºå†…å®¹å¤§å°</p>
<p><strong>ç›¸å¯¹é¡¹ç›®</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.oul</span> &#123;</span><br><span class="line">     <span class="attribute">display</span>: flex;</span><br><span class="line">     <span class="comment">/*è§¦å‘å¼¹æ€§ç›’*/</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="selector-class">.oul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">     //flex-basis: auto;</span><br><span class="line">     <span class="selector-tag">flex</span>: <span class="selector-tag">auto</span>; <span class="comment">/*è®°ä½è¿™ä¸ flex: 1 1 auto; ç›¸åŒ*/</span></span><br><span class="line">     <span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>;</span><br><span class="line">     <span class="selector-tag">margin</span>: 2<span class="selector-tag">rem</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/xianngdui.png" alt="xianngdui"></p>
<p>Flexé¡¹ç›®çš„åˆå§‹å®½åº¦æ˜¯è¢«è‡ªåŠ¨è®¡ç®—çš„ï¼ˆ<code>flex-basis: auto</code>ï¼‰ï¼Œç„¶åä¼šä¼¸å±•ä»¥é€‚åº”å¯ç”¨ç©ºé—´ï¼ˆ<code>flex-grow: 1</code>ï¼‰</p>
<p>åƒè¿™æ · å½“<code>Flex</code>é¡¹ç›®å› ä¸ºè¢«è®¾ç½®ä¸º <code>flex-basis: auto</code>ï¼Œè€Œå¯¼è‡´å®½åº¦è¢«è‡ªåŠ¨è®¡ç®—æ—¶ï¼Œæ˜¯åŸºäº<code>Flex</code>é¡¹ç›®å†…åŒ…å«çš„å†…å®¹çš„å¤§å°è€Œè®¡ç®—çš„å°±æ˜¯ç›¸å¯¹é¡¹ç›®</p>
<p><strong>ç»å¯¹é¡¹ç›®</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.oul</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">     <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">     <span class="attribute">flex-shrink</span>: <span class="number">1</span>;</span><br><span class="line">     <span class="attribute">flex-basis</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="comment">/*ä¸ flex: 1 1 0 ç›¸åŒ*/</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">2px</span> solid red;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">2rem</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/flex/juedui.png" alt="juedui"></p>
<p><code>Flex</code>é¡¹ç›®çš„åˆå§‹å®½åº¦æ˜¯é›¶ï¼ˆ<code>flex-basis: 0</code>ï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬ä¼šä¼¸å±•ä»¥é€‚åº”å¯ç”¨ç©ºé—´ã€‚å½“æœ‰ä¸¤åˆ°å¤šä¸ª<code>Flex</code>é¡¹ç›®çš„ <code>flex-basis</code> å–å€¼ä¸º<code>0</code>æ—¶ï¼Œå®ƒä»¬ä¼šåŸºäº<code>flex-grow</code>å€¼å…±äº«å¯ç”¨ç©ºé—´</p>
<h3 id="flexç»„åˆå±æ€§"><a href="#flexç»„åˆå±æ€§" class="headerlink" title="flexç»„åˆå±æ€§"></a>flexç»„åˆå±æ€§</h3><p>flexæ˜¯<code>flex-growã€flex-shrinkå’Œflex-basis</code>ä¸‰ä¸ªå±æ€§çš„é€Ÿè®°ï¼ˆç®€å†™ï¼‰é¡ºåºç¼©å†™ä¸º GSB </p>
<h4 id="ä¸€äº›å–å€¼è§„å¾‹"><a href="#ä¸€äº›å–å€¼è§„å¾‹" class="headerlink" title="ä¸€äº›å–å€¼è§„å¾‹"></a>ä¸€äº›å–å€¼è§„å¾‹</h4><p><strong>å½“ flex å–å€¼ä¸ºä¸€ä¸ªéè´Ÿæ•°å­—ï¼Œåˆ™è¯¥æ•°å­—ä¸º flex-grow å€¼ï¼Œflex-shrink å– 1ï¼Œflex-basis å– 0%ï¼Œä¾‹å¦‚ï¼šflex: 1; ç›¸å½“äº</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">0%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>âš ï¸ <code>flex-basisçš„</code>é»˜è®¤å€¼ä¸º<code>auto</code>ï¼Œä¸ºä»€ä¹ˆæ­¤æ—¶æ˜¯<code>0%</code>ï¼Ÿ<br>å½“ä½ åˆ›å»ºä¸€ä¸ªflexboxä¸Šä¸‹æ–‡è€Œä¸ç»™flexé¡¹ç›®è®¾ç½®ä»»ä½•å±æ€§ï¼Œæ­¤æ—¶çš„é»˜è®¤å€¼<br><img src="/images/flex/wwwaaaa111.png" alt="wwwaaaa111"><br>æ­¤æ—¶å®ƒæ˜¯<font color="red">ç›¸å¯¹é¡¹ç›®</font><br>ä¸€æ—¦ä½ è®¾ç½®äº†<code>flex:1</code>ç®€å†™å±æ€§</p>
<p>å‚è€ƒMDNæ‰€è¯´<br><img src="/images/flex/flexjianxie.png" alt="flexjianxie"><br>æµè§ˆå™¨ä½¿å…¶å˜æˆäº†<font color="red">ç»å¯¹é¡¹ç›®</font></p>
<p><strong>flex: auto;</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">li</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-basis</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å½“ flex å–å€¼ä¸ºä¸€ä¸ªé•¿åº¦æˆ–ç™¾åˆ†æ¯”ï¼Œåˆ™è§†ä¸º flex-basis å€¼ï¼Œflex-grow å– 1ï¼Œflex-shrink å– 1ï¼Œæœ‰å¦‚ä¸‹ç­‰åŒæƒ…å†µï¼ˆæ³¨æ„ 0% æ˜¯ä¸€ä¸ªç™¾åˆ†æ¯”è€Œä¸æ˜¯ä¸€ä¸ªéè´Ÿæ•°å­—ï¼‰</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item-1</span> &#123;<span class="attribute">flex</span>: <span class="number">0%</span>;&#125;</span><br><span class="line"><span class="selector-class">.item-1</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">0%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item-2</span> &#123;<span class="attribute">flex</span>: <span class="number">24px</span>;&#125;</span><br><span class="line"><span class="selector-class">.item-1</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">24px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å½“ flex å–å€¼ä¸ºä¸¤ä¸ªéè´Ÿæ•°å­—ï¼Œåˆ™åˆ†åˆ«è§†ä¸º flex-grow å’Œ flex-shrink çš„å€¼ï¼Œflex-basis å– 0%ï¼Œå¦‚ä¸‹æ˜¯ç­‰åŒçš„ï¼š</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;<span class="attribute">flex</span>: <span class="number">2</span> <span class="number">3</span>;&#125;</span><br><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">0%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å½“ flex å–å€¼ä¸ºä¸€ä¸ªéè´Ÿæ•°å­—å’Œä¸€ä¸ªé•¿åº¦æˆ–ç™¾åˆ†æ¯”ï¼Œåˆ™åˆ†åˆ«è§†ä¸º flex-grow å’Œ flex-basis çš„å€¼ï¼Œflex-shrink å– 1ï¼Œå¦‚ä¸‹æ˜¯ç­‰åŒçš„ï¼š</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.item</span> &#123;<span class="attribute">flex</span>: <span class="number">2333</span> <span class="number">3222px</span>;&#125;</span><br><span class="line"><span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">2333</span>;</span><br><span class="line">    <span class="attribute">flex-shrink</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">flex-basis</span>: <span class="number">3222px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ·±å…¥flex"><a href="#æ·±å…¥flex" class="headerlink" title="æ·±å…¥flex"></a>æ·±å…¥flex</h2><p>åˆ°è¿™é‡Œ å…³äº<code>Flex</code>çš„åŸºç¡€çŸ¥è¯†å·²ç»ç»“æŸäº†,ä½ å¯ä»¥ç”¨å®ƒä»¬å¤„ç†å‡ ä¹ä»»ä½•é—®é¢˜<br>ä½†æ˜¯</p>
<font color="red">Flexboxæ˜¯å¦‚ä½•å¼¹æ€§çš„è®¡ç®—å­çº§é¡¹ç›®çš„å¤§å°çš„ï¼Œå®ƒæœ‰æ²¡æœ‰ä»€ä¹ˆè§„åˆ™ </font><br>ä»¤æˆ‘è´¹è§£<br><br>å¥½äº†ï¼Œå°ğŸŒ»è¯¾å ‚å¼€å§‹äº†<br><br>flexæ˜¯åº”ç”¨åœ¨Xè½´å’ŒYè½´ä¸Šçš„<br>æ¯ä¸€æ ¹è½´éƒ½åŒ…æ‹¬ä¸‰ä¸ªä¸œè¥¿ <code>ç»´åº¦ã€æ–¹å‘ã€å°ºå¯¸</code><br><br><em> ç»´åº¦ï¼šå­å…ƒç´ æ¨ªç€æ’(Xè½´)è¿˜æ˜¯ç«–ç€æ’(Yè½´)
</em> æ–¹å‘ï¼šå­å…ƒç´ çš„é¡ºåº(é¡ºåºè¿˜æ˜¯é€†åº)<br><em> å°ºå¯¸ï¼šå³çˆ¶å…ƒç´ çš„<code>width</code>ï¼Œå­å…ƒç´ åœ¨å½“å‰è½´æ–¹å‘æ‰€å çš„ä½ç½®çš„æ€»å’Œ<br><br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæ¥è‡ªW3Cè§„èŒƒï¼‰<br><br><img src="/images/flex/w3c.png" alt="w3"><br><br>## FFC(flex formatting context)<br>Flexbox å¸ƒå±€æ–°å®šä¹‰äº†æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œç±»ä¼¼ BFCï¼ˆblock formatting contextï¼‰<br>å®šä¹‰äº†<code>display: flex;</code> æˆ– <code>display: inline-flex</code>çš„å…ƒç´ ï¼Œå’Œ<code>BFC</code>ä¸€æ ·ï¼Œä¸ä¼šè¢«æµ®åŠ¨çš„å…ƒç´ é®ç›–ï¼Œä¸ä¼šå‚ç›´å¤–è¾¹è·åå¡Œç­‰ç­‰<br><br>## ä¸BFCçš„ç»†å¾®åŒºåˆ«

</em> vertical-align å¯¹ Flexbox ä¸­çš„å­å…ƒç´  æ˜¯æ²¡æœ‰æ•ˆæœçš„<br><em> float å’Œ clear å±æ€§å¯¹ Flexbox ä¸­çš„å­å…ƒç´ æ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œä¹Ÿä¸ä¼šä½¿å­å…ƒç´ è„±ç¦»æ–‡æ¡£æµ(ä½†æ˜¯å¯¹Flexbox æ˜¯æœ‰æ•ˆæœçš„ï¼)
</em> Flexbox ä¸‹çš„å­å…ƒç´ ä¸ä¼šç»§æ‰¿çˆ¶çº§å®¹å™¨çš„å®½<br><br>## flex itemï¼ˆflex å­å…ƒç´ ï¼‰<br>CSSè§£æå™¨ä¼šæŠŠ å®šä¹‰äº† <code>display: flex;</code> å’Œ <code>display: inline-flex;</code> çš„ <code>Flexbox</code>ä¸‹çš„å­å…ƒç´ å¤–éƒ¨è£…è¿›ä¸€ä¸ªçœ‹ä¸è§çš„ç›’å­é‡Œï¼Œæˆ‘ä»¬é€šè¿‡æ’åˆ—è¿™äº›ç›’å­æ¥è¾¾åˆ°æ’åºã€å¸ƒå±€ã€ ä¼¸ç¼©çš„ç›®çš„<br><br>### flex-item-size æ˜¯å¦‚ä½•è®¡ç®—çš„<br>å­å…ƒç´ çš„å°ºå¯¸ä¸ºä¸»è½´æ–¹å‘ä¸Šå…ƒç´ çš„çš„è‡ªèº«å®½åº¦ å†åŠ ä¸Šè‡ªèº«çš„<code>margin ã€ border å’Œ padding</code><br><br>W3Cè§„èŒƒä¸­ä»‹ç»äº†  <code>flex-item content</code> çš„è®¡ç®—è§„åˆ™<br><br>### éšè—å±æ€§å¯¹ items-size çš„å½±å“<br><br>é’ˆå¯¹ <code>display: none; visibility: hidden; visibility: collapse; transform: scale;</code>è¿›è¡Œæµ‹è¯•<br><br>ç»“è®º<br><em> å¦‚æœè®¾ç½®äº† <code>visibility: hidden; | visibility: collapse; | transform: scale;</code>çš„<code>flex-item content</code>ä¾ç„¶è¢«ç®—è¿›ä¸»è½´å°ºå¯¸ï¼ŒCSS è§£æå™¨ä¾ç„¶å°†å¯ç”¨ç©ºé—´åˆ†é…ç»™ä»–ä»¬
</em> å¦‚æœè®¾ç½®äº†<code>display: none;</code> CSSè§£æå™¨ä¸ä¼šå¯¹è¯¥<code>item</code>çš„ç©ºé—´è¿›è¡Œè®¡ç®—<br><br>### å…³äºposition: absolute å¯¹itemå½±å“<br><br><code>position: absolute</code>ä¹Ÿæ˜¯é€‚ç”¨ <code>Flexbox</code> ä¸­çš„å­å…ƒç´ çš„ï¼Œå¹¶ä¸”ï¼Œè®¾ç½®äº†<code>position: absolute</code>å±æ€§çš„å­å…ƒç´ ï¼Œä¹Ÿä¼šå—åˆ° <code>Flexbox</code> æ’åˆ—çš„å½±å“<br><br><br>absolute çš„å­å…ƒç´ é‡å åœ¨äº†ä¸€èµ·ï¼Œä½†æ˜¯ä¾ç„¶ä¼šå—åˆ° <code>align-items: center;</code>çš„å½±å“è€Œå±…ä¸­<br><br><img src="/images/flex/jjjjjdsd.png" alt="jjjjjdsd"><br><br>å¹¶ä¸”æ ¹æ®ä¸€ç³»åˆ—çš„å®éªŒå¾—çŸ¥<br><br><code>flexbox</code> ä¸‹è®¾ç½®äº†<code>absolute</code>ï¼š<br><br><em> flexbox æµä¸‹é¢çš„ <code>justify-content</code> å’Œ <code>align-items</code>
</em> <code>item</code>çš„ <code>topã€leftã€rightã€bottom</code><br><em> <code>margin</code>è‡ªå§‹è‡³ç»ˆéƒ½ä¼šå½±å“<code>item</code>çš„ä½ç½®
</em> è„±ç¦»äº†æ–‡æ¡£æµçš„ <code>item</code> ä¸ä¼šå½±å“æ­£å¸¸çš„<code>flex</code> å¸ƒå±€<br><br><strong>å°ç»“</strong><br><code>justify-contentã€align-items</code> å’Œ <code>topã€leftã€rightã€bottom</code>éƒ½æ˜¯ä½ç½®å±æ€§ ä¸” <code>topã€leftã€rightã€bottom</code>çš„å€¼ä¼šè¦†ç›– <code>justify-contentã€align-items</code>çš„å€¼<br><br><code>margin</code>çš„ä¼˜å…ˆçº§æ˜¯å’Œ <code>topã€leftã€rightã€bottom</code> ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>margin å’Œ topã€leftã€rightã€bottom</code>æ‰€è®¾ç½®çš„å€¼ä¼š<strong>åŒæ—¶ç”Ÿæ•ˆ</strong><br><br><br>## flex-basisã€flex-growã€flex-shrink ä»¥åŠç›¸åº”çš„è®¡ç®—<br><br>è¿™ä¸‰ä¸ªå±æ€§åªæœ‰çˆ¶çº§å…ƒç´ è®¾ç½®äº† <code>display: flex | inline-flex;</code> æ‰ä¼šç”Ÿæ•ˆï¼Œå¹¶ä¸”åªé’ˆå¯¹ä¸»è½´æ–¹å‘ç”Ÿæ•ˆ<br><br><em> å¦‚æœ ä¸»è½´æ˜¯æ°´å¹³çš„ï¼Œå³ <code>flex-direction: row</code>; é‚£ä¹ˆ <code>flex-basisã€flex-growã€flex-shrink</code>æ§åˆ¶çš„å°±æ˜¯å•ä¸ª<code>item</code>çš„å®½åº¦
</em> å¦‚æœ ä¸»è½´æ˜¯å‚ç›´çš„ï¼Œå³ <code>flex-direction: column</code>; é‚£ä¹ˆ <code>flex-basisã€flex-growã€flex-shrink</code> æ§åˆ¶çš„å°±æ˜¯å•ä¸ªitemçš„é«˜åº¦<br><br>â€”â€”-<br><br><br>é‚£ä¹ˆæ‰€æœ‰<code>items</code>éƒ½ä¼šåœ¨ä¸»è½´æ–¹å‘ä¸Šçš„ä¸€æ¡çº¿ä¸Šæ’åˆ—ï¼Œ<code>CSSè§£æå™¨</code>ä¼šè®¡ç®—<code>items</code>åœ¨ä¸»è½´æ–¹å‘ä¸Šæ‰€å çš„ç©ºé—´ ç›¸å¯¹äº<code>Flexbox</code>åœ¨ä¸»è½´æ–¹å‘çš„æ‰€å çš„ç©ºé—´è¿›è¡Œæ¯”è¾ƒè®¡ç®—<br><br><em> å¦‚æœ <code>items</code> æ‰€å çš„ç©ºé—´æ˜¯å°äº<code>Flexbox</code>çš„ é‚£ä¹ˆè¯´æ˜<code>Flexbox</code> è¿˜æ²¡æœ‰å¡«æ»¡ï¼Œ<code>CSSè§£æå™¨</code>å°±ä¼šè®¡ç®—è¿˜æœ‰å¤šå°‘ç©ºé—´æ²¡æœ‰å¡«æ»¡ï¼Œæ ¹æ®æ¯ä¸€ä¸ª<code>item</code>æ‰€è®¾ç½®çš„<code>flex-grow</code> è®¾ç½®çš„å€¼ï¼Œå°†è¿™äº›ç©ºé—´åˆ†é…æŒ‰æ¯”ä¾‹åˆ†é…ç»™æ¯ä¸€ä¸ª<code>item</code><br><br><img src="/images/flex/wwwqwq.png" alt="wwwqwq">

</em> å¦‚æœ <code>items</code> æ‰€å çš„ç©ºé—´æ˜¯å¤§äº<code>Flexbox</code>çš„ é‚£ä¹ˆè¯´æ˜<code>Flexbox</code> è¢«å¡«æ»¡äº†ï¼Œ<code>CSSè§£æå™¨</code>å°±ä¼šè®¡ç®—è¶…å‡ºäº†å¤šå°‘ç©ºé—´ï¼Œæ ¹æ®æ¯ä¸€ä¸ª<code>item</code>æ‰€è®¾ç½®çš„<code>flex-shrink</code>è®¾ç½®çš„å€¼ï¼Œå°†è¿™äº›ç©ºé—´åˆ†é…æŒ‰æ¯”ä¾‹ç¼©å°æ¯ä¸€ä¸ª<code>item</code><br> <img src="/images/flex/fukeyongkongjian.png" alt="fukeyongkongjian"><br><br><br>### è¶…å‡ºçš„ç©ºé—´æ˜¯å¦‚ä½•è®¡ç®—çš„<br><br><strong><code>flow-grow</code>çš„è®¡ç®—æµç¨‹</strong><br><br><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">å¯ç”¨ç©ºé—´ = å°†flexbox-content - æ¯ä¸ª<span class="built_in">item</span>-sizeçš„æ€»å’Œ</span><br></pre></td></tr></table></figure><br><br>å°†å…ƒç´ è®¾ç½®çš„<code>flow-grow</code>å€¼åŠ èµ·æ¥è®¾ç½®ä¸º <code>growSize</code><br><code>å•ä½åˆ†é…ç©ºé—´ = å¯ç”¨ç©ºé—´/growSize</code><br>ç„¶åçœŸæ­£åˆ†é…çš„æ—¶å€™æ ¹æ®è‡ªå·±çš„æ¯”ä¾‹è®¡ç®—å¢åŠ çš„å€¼<br><code>åº”è¯¥å¢åŠ çš„å€¼ = è‡ªå·±çš„growå€¼ *  å•ä½åˆ†é…ç©ºé—´</code><br><br><img src="/images/flex/growfencdc.png" alt="growfencd"><br><br><br><strong><code>flow-shrink</code>çš„è®¡ç®—æµç¨‹</strong><br><br>å®ƒçš„æµç¨‹ä¸<code>flow-grow</code>çš„è®¡ç®—æµç¨‹<font color="red">ä¸åŒ</font>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">shrinkæ¯”ä¾‹ = flex-shrink * item-size / ä¹‹å‰çš„æ€»å’Œ</span><br><span class="line"></span><br><span class="line">åº”è¯¥ç¼©å‡çš„å€¼ï¼šè¶…å‡ºçš„ç©ºé—´ <span class="selector-tag">-</span> <span class="selector-tag">shrink</span>æ¯”ä¾‹ * <span class="selector-tag">item-size</span></span><br></pre></td></tr></table></figure>
<p>å¦‚å›¾æ‰€ç¤º</p>
<p><img src="/images/flex/shrinksw.png" alt="shrinks"></p>
<p><strong>max-width[height] æƒ…å†µä¸‹ flex-grow çš„è®¡ç®—æµç¨‹</strong></p>
<p>ç”±äºå¯èƒ½å­˜åœ¨æŸä¸€ä¸ªæˆ–å¤šä¸ª<code>item</code> è®¾ç½®äº†æœ‰<code>max-width[height]</code>ã€‚æ‰€ä»¥ï¼ŒCSSå¼•æ“ä¼šå…ˆè¿›è¡Œä¸€æ¬¡åˆ†é…ï¼Œåˆ†é…åï¼Œç»Ÿè®¡é‚£äº›æœ‰<code>max-width[height]çš„items</code>, åˆ†é…åæ˜¯å¦æœ‰è¶…å‡ºçš„å‰©ä½™ç©ºé—´ï¼Œç„¶åå¯¹è¿™äº›å‰©ä½™ç©ºé—´å†åˆ†é…ç»™é‚£äº›æ²¡æœ‰è®¾ç½®<code>max-width[height]</code>çš„<code>item</code></p>
<p><img src="/images/flex/sandjandjnsjdwednjsedf.png" alt="sandjandjnsjdwednjsedf"></p>
<p><strong>min-width[height] æƒ…å†µä¸‹ flex-shrink</strong></p>
<p>ç”±äºå¯èƒ½å­˜åœ¨æŸä¸€ä¸ªæˆ–å¤šä¸ªitem è®¾ç½®äº†æœ‰<code>min-width[height]</code>ã€‚æ‰€ä»¥ï¼Œ<code>CSSå¼•æ“</code>ä¼šå…ˆè¿›è¡Œä¸€æ¬¡ <code>shrink</code>ï¼Œ <code>shrink</code>åï¼Œç»Ÿè®¡é‚£äº›æœ‰<code>min-width[height]</code>çš„<code>items</code>, <code>shrink</code>åæ˜¯å¦æœ‰çš„å‰©ä½™çš„æœª<code>shrink</code>ç©ºé—´ï¼Œç„¶åå¯¹è¿™äº›å‰©ä½™ç©ºé—´å†åˆ†é…ç»™é‚£äº›æ²¡æœ‰è®¾ç½®<code>min-width[height]</code>çš„<code>item</code></p>
<p><img src="/images/flex/iiisjindndnjsndjsdnxjksndj.png" alt="iiisjindndnjsndjsdnxjksndj"></p>
<h2 id="Flexboxçš„æµè§ˆå™¨æ”¯æŒ"><a href="#Flexboxçš„æµè§ˆå™¨æ”¯æŒ" class="headerlink" title="Flexboxçš„æµè§ˆå™¨æ”¯æŒ"></a>Flexboxçš„æµè§ˆå™¨æ”¯æŒ</h2><p>è®©æˆ‘ä»¬æ±‚åŠ©äº <a href="https://caniuse.com/#search=flex" target="_blank" rel="noopener">caniuse</a></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ·±å…¥ç†è§£Flex è¿˜æ˜¯æŒºä¸å®¹æ˜“çš„ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.w3cplus.com/css3/understanding-flexbox-everything-you-need-to-know.html" target="_blank" rel="noopener">ç†è§£flexboxï¼Œä½ éœ€è¦çŸ¥é“çš„ä¸€åˆ‡</a><br><a href="https://www.w3cplus.com/css3/flexbox-adventures.html" target="_blank" rel="noopener">æ¢ç´¢Flexbox</a><br><a href="https://www.w3cplus.com/css3/flexbox-layout-and-calculation.html?from=groupmessage" target="_blank" rel="noopener">ç†è§£flex</a></p>
]]></content>
      <categories>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>flex</tag>
      </tags>
  </entry>
  <entry>
    <title>jså†·çŸ¥è¯†</title>
    <url>/2018/01/16/javascript%E5%86%B7%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<!-- <blockquote class="blockquote-center">blah blah blah</blockquote> -->
<ol>
<li><p><strong>å»é™¤input[type=â€™numberâ€™]æ—¶çš„å³ä¾§ä¸Šä¸‹ç®­å¤´</strong></p>
<p>   /<em>åœ¨chromeä¸‹ï¼š</em>/</p>
<pre><code>input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button{
    -webkit-appearance: none !important;
    margin: 0;
    padding-left:5px;
}

/*Firefoxä¸‹ï¼š*/
input[type=&quot;number&quot;]{-moz-appearance:textfield;}
</code></pre></li>
</ol>
<ol start="2">
<li><p><strong>åˆ¤æ–­å°æ•°ä¸èƒ½å¤§äºä¸¤ä½</strong></p>
<pre><code>var hopePriceLength = hopePrice.toString().split(&quot;.&quot;)[1].length;
  if(hopePriceLength&gt;2){
      notify(&apos;è¯·è¾“å…¥æ­£æ•°ï¼Œæœ€å¤šä¸¤ä½å°æ•°&apos;,&apos;error&apos;);
      $(`#${mid}jp-hope-price`).focus();
      return false;
  }
</code></pre></li>
</ol>
<a id="more"></a>
<p>3.<strong>å»æ‰iosæ‰‹æœºä¸Štapæ—¶çš„é»‘è‰²èƒŒæ™¯</strong></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">a</span>,<span class="selector-tag">img</span>,<span class="selector-tag">button</span>,<span class="selector-tag">input</span>,textarea</span><br><span class="line">&#123;-webkit-tap-highlight-<span class="attribute">color</span>:rgba(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>.å¦å¤–ï¼Œå¦‚ä½•å»æ‰<span class="selector-tag">textarea</span>,inputçš„é»˜è®¤æ ·å¼ï¼š</span><br><span class="line"><span class="selector-tag">input</span>,textarea&#123;-webkit-appearance:<span class="attribute">none</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>4.<strong>åˆ¤æ–­æ•°æ®çš„ç±»å‹</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> isType = <span class="function"><span class="keyword">function</span>(<span class="params"> type </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>)</span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call( obj ) === <span class="string">'[object '</span>+ type +<span class="string">']'</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> isString = isType( <span class="string">'String'</span> );</span><br><span class="line"> <span class="keyword">var</span> isArray = isType( <span class="string">'Array'</span> );</span><br><span class="line"> <span class="keyword">var</span> isNumber = isType( <span class="string">'Number'</span> );</span><br><span class="line"><span class="built_in">console</span>.log( isArray( [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ] ) );</span><br></pre></td></tr></table></figure>
<p>4.<strong>HTML5å»é™¤input [type=search] çš„é»˜è®¤è¾¹æ¡†å’Œåˆ é™¤æŒ‰é’®</strong></p>
<p> x-webkit-speech  å±æ€§ï¼šåœ¨GOOGLEæµè§ˆå™¨ä¸Š  è¿˜ä¼šæ˜¾ç¤ºä¸€ä¸ªå°è¯ç­’<br> autocomplete=â€offâ€  å±æ€§  å…³é—­æµè§ˆå™¨è‡ªåŠ¨è®°å½•ä¹‹å‰è¾“å…¥çš„å€¼</p>
<p>webkitå†…æ ¸æµè§ˆå™¨é‡Œ input æ¡†ç±»å‹å¦‚æœæ˜¯ type=â€searchâ€<br>é‚£ä¹ˆå°†ä¼šæœ‰è¾¹æ¡†é—®é¢˜ï¼Œborder:0px ä¹Ÿä¸èƒ½èµ·åˆ°ä½œç”¨ï¼›</p>
<p>è§£å†³æ–¹æ¡ˆ</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type="search"]</span>&#123;<span class="attribute">-webkit-appearance</span>:none;&#125;</span><br></pre></td></tr></table></figure>
<p>ç§»é™¤ é‡ç½®é»˜è®¤çš„Webkitå¼•æ“ä¸‹çš„Inputæ ·å¼</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=search]</span> &#123;</span><br><span class="line"><span class="attribute">-webkit-appearance</span>: textfield;</span><br><span class="line"><span class="attribute">-webkit-box-sizing</span>: content-box;</span><br><span class="line"><span class="attribute">font-family</span>: inherit;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-webkit-search-decoration</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-webkit-search-cancel-button</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.ç¦æ­¢ioså’Œandroidç”¨æˆ·é€‰ä¸­æ–‡å­—</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">css</span>&#123;<span class="attribute">-webkit-touch-callout</span>: none&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>issue</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½ ä¸çŸ¥é“çš„JSç³»åˆ—-ç»†è¯´JSç»§æ‰¿</title>
    <url>/2019/03/15/jsIInheritance/</url>
    <content><![CDATA[<p>é¢å‘å¯¹è±¡è¯­è¨€æ”¯æŒä¸¤ç§ç»§æ‰¿æ–¹å¼ï¼šæ¥å£ç»§æ‰¿ï¼ˆåªç»§æ‰¿æ–¹æ³•ç­¾åï¼‰å’Œå®ç°ç»§æ‰¿ï¼ˆç»§æ‰¿å®é™…çš„æ–¹æ³•ï¼‰ç”±äºå‡½æ•°æ²¡æœ‰ç­¾åï¼ŒECMAScriptåªæ”¯æŒå®ç°ç»§æ‰¿ï¼Œè€Œå®ç°ç»§æ‰¿ä¸»è¦æ˜¯ä¾é åŸå‹é“¾å®ç°çš„</p>
<p>ä¸‹é¢å°±å½“ä¸‹å‡ ç§ç»§æ‰¿æ–¹å¼åšä¸€ä¸ªå¯¹æ¯”å‚è€ƒ<br><a id="more"></a></p>
<h2 id="åŸå‹é“¾ç»§æ‰¿"><a href="#åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="åŸå‹é“¾ç»§æ‰¿"></a>åŸå‹é“¾ç»§æ‰¿</h2><p><font color="red">æ ¸å¿ƒæ€æƒ³ï¼š</font>åˆ©ç”¨åŸå‹è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å±æ€§å’Œæ–¹æ³•ï¼ˆå°†çˆ¶ç±»çš„å®ä¾‹ä½œä¸ºå­ç±»çš„åŸå‹ï¼‰</p>
<hr>
<h3 id="ä¸¾ä¸ªğŸŒ°"><a href="#ä¸¾ä¸ªğŸŒ°" class="headerlink" title="ä¸¾ä¸ªğŸŒ°"></a>ä¸¾ä¸ªğŸŒ°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = <span class="string">'yishu'</span>;</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.age = <span class="number">25</span>;</span><br><span class="line">&#125; </span><br><span class="line"> <span class="comment">//åŸå‹é“¾ç»§æ‰¿</span></span><br><span class="line"> SubType.prototype = <span class="keyword">new</span> SuperType();</span><br><span class="line"></span><br><span class="line"> SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.age</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">var</span> instance = <span class="keyword">new</span> SubType(); <span class="comment">//åŸå‹é“¾ç»§æ‰¿</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'age'</span>,instance.age) <span class="comment">// 25</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'name'</span>,instance.name) <span class="comment">//yishu</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'sayName'</span>,instance.sayName()) <span class="comment">//yishu</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'sayAge'</span>,instance.sayAge()) <span class="comment">//25</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">' instance.toString()'</span>, instance.toString()) <span class="comment">//[object Object]</span></span><br></pre></td></tr></table></figure>
<hr>
<h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul>
<li>çº¯ç²¹çš„ç»§æ‰¿å…³ç³»ï¼Œå®ä¾‹æ˜¯å­ç±»çš„å®ä¾‹ï¼Œä¹Ÿæ˜¯çˆ¶ç±»çš„å®ä¾‹</li>
<li>çˆ¶ç±»æ–°å¢åŸå‹æ–¹æ³•/åŸå‹å±æ€§ï¼Œå­ç±»éƒ½èƒ½è®¿é—®åˆ°</li>
<li>ç®€å• æ˜“äºå®ç°</li>
</ul>
<h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><ul>
<li>æ— æ³•å®ç°å¤šç»§æ‰¿</li>
<li>åˆ›å»ºå­ç±»å‹çš„å®ä¾‹æ—¶ï¼Œä¸èƒ½å‘è¶…ç±»å‹çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å‚æ•°</li>
<li><strong>åŒ…å«å¼•ç”¨ç±»å‹å€¼çš„åŸå‹ä¼šè¢«æ‰€æœ‰çš„å®ä¾‹å…±äº«</strong>ï¼Œé€šè¿‡åŸå‹æ¥å®ç°ç»§æ‰¿çš„æ—¶å€™ï¼ŒåŸå‹å®é™…ä¸Šä¼šå˜æˆå¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹ï¼Œäºæ˜¯åŸæ¥çš„å®ä¾‹å±æ€§ä¹Ÿå°±å˜æˆäº†ç°åœ¨çš„åŸå‹å±æ€§äº†(<font color="red">æ¥è‡ªåŸå‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§è¢«æ‰€æœ‰å®ä¾‹å…±äº«</font>)</li>
<li>æƒ³è¦ä¸ºå­ç±»æ·»åŠ å±æ€§æˆ–æ–¹æ³• åªèƒ½åœ¨<code>new SubType()</code>ä¹‹å</li>
</ul>
<hr>
<p>æ¨èæŒ‡æ•°ï¼šâ¤ï¸ ï¼ˆ3ï¼Œ4é—®é¢˜æ¯”è¾ƒè‡´å‘½ï¼‰</p>
<h2 id="å€Ÿç”¨æ„é€ å‡½æ•°"><a href="#å€Ÿç”¨æ„é€ å‡½æ•°" class="headerlink" title="å€Ÿç”¨æ„é€ å‡½æ•°"></a>å€Ÿç”¨æ„é€ å‡½æ•°</h2><p><font color="red">æ ¸å¿ƒæ€æƒ³ï¼š</font>ä½¿ç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°æ¥å¢å¼ºå­ç±»å®ä¾‹ï¼Œç›¸å½“äºå¤åˆ¶çˆ¶ç±»çš„å®ä¾‹å±æ€§ç»™å­ç±»ï¼ˆæ²¡ç”¨åˆ°åŸå‹ï¼‰ ï¼ˆ<strong>ä¸æ¶‰åŠåˆ°åŸå‹</strong>ï¼‰</p>
<p><font color="red">æŠ€æœ¯åŸç†ï¼š</font><br>åœ¨å­ç±»å‹æ„é€ å‡½æ•°çš„å†…éƒ¨è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°</p>
<p><strong>æ’æ’­:</strong>å‡½æ•°åªä¸è¿‡æ˜¯åœ¨ç‰¹å®šç¯å¢ƒä¸­æ‰§è¡Œä»£ç çš„å¯¹è±¡ï¼Œå› æ­¤ ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨<code>apply</code>æˆ–è€…<code>call</code>æ–¹æ³•ä¹Ÿå¯ä»¥åœ¨å°†æ¥æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°</p>
<p>ä¸¾ä¸ªğŸŒ°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">this</span>.colors = [<span class="string">'red'</span>,<span class="string">'blue'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">SuperType.call(<span class="keyword">this</span>) <span class="comment">//ç»§æ‰¿äº†SuperType</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType();</span><br><span class="line">instance1.colors.push(<span class="string">'black'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors) <span class="comment">//["red", "blue", "black"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType();</span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors) Â <span class="comment">//["red", "blue"]</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>è§£å†³å®ä¾‹å…±äº«é—®é¢˜</li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line">è¿™æ ·å„¿ä¼šåœ¨`SubType`å¯¹è±¡ä¸Šæ‰§è¡Œ`SuperType`å‡½æ•°ä¸­å®šä¹‰çš„æ‰€æœ‰å¯¹è±¡åˆå§‹åŒ–ä»£ç ï¼Œ`SubType`çš„æ¯ä¸ªå®ä¾‹å°±éƒ½ä¼šå…·æœ‰è‡ªå·±`colors`å±æ€§çš„å‰¯æœ¬äº†</span><br></pre></td></tr></table></figure>
<ul>
<li>è§£å†³ä¼ é€’å‚æ•°çš„é—®é¢˜</li>
</ul>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span><span class="params">(name)</span></span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name= name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span><span class="params">(name,age)</span></span>&#123;</span><br><span class="line">SuperType.call(<span class="keyword">this</span>,name) <span class="comment">//ç»§æ‰¿äº†SuperType åŒæ—¶ä¼ é€’äº†å‚æ•°</span></span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> SubType(<span class="string">'yishu'</span>,<span class="number">18</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯ä»¥å®ç°å¤šç»§æ‰¿ï¼ˆcallå¤šä¸ªçˆ¶ç±»å¯¹è±¡ï¼‰</li>
</ul>
<h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>åªèƒ½ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œä¸èƒ½ç»§æ‰¿åŸå‹å±æ€§å’Œæ–¹æ³•</li>
<li>æ— æ³•å®ç°å‡½æ•°å¤ç”¨ï¼Œæ¯ä¸ªå­ç±»éƒ½æœ‰çˆ¶ç±»å®ä¾‹å‡½æ•°çš„å‰¯æœ¬ï¼Œå½±å“æ€§èƒ½</li>
</ul>
<hr>
<p>æ¨èæŒ‡æ•°ï¼šâ¤ï¸â¤ï¸ï¼ˆç¼ºç‚¹2æ¯”è¾ƒè‡´å‘½ï¼‰</p>
<h2 id="ç»„åˆç»§æ‰¿ï¼ˆæœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ï¼‰"><a href="#ç»„åˆç»§æ‰¿ï¼ˆæœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ï¼‰" class="headerlink" title="ç»„åˆç»§æ‰¿ï¼ˆæœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ï¼‰"></a>ç»„åˆç»§æ‰¿ï¼ˆæœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ï¼‰</h2><p><font color="red">æ ¸å¿ƒæ€æƒ³ï¼š</font>å°†åŸå‹é“¾å’Œæ„é€ å‡½æ•°çš„æŠ€æœ¯ç»„åˆåˆ°ä¸€èµ· ä»è€Œå‘æŒ¥äºŒè€…ä¹‹é•¿</p>
<p><font color="red">æŠ€æœ¯åŸç†ï¼š</font><br>ä½¿ç”¨åŸå‹é“¾å®ç°å¯¹åŸå‹å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿<br>ä½¿ç”¨æ„é€ å‡½æ•°æ¥å®ç°å¯¹å®ä¾‹å±æ€§çš„ç»§æ‰¿<br>è¿™æ ·èƒ½å®ç°<strong>åœ¨åŸå‹ä¸Šå®šä¹‰æ–¹æ³•å®ç°äº†å‡½æ•°çš„æœç”¨åˆèƒ½ä¿è¯æ¯ä¸ªå®ä¾‹æœ‰å®ƒè‡ªå·±çš„å±æ€§</strong></p>
<h3 id="ä¸¾ä¸ªğŸŒ°-1"><a href="#ä¸¾ä¸ªğŸŒ°-1" class="headerlink" title="ä¸¾ä¸ªğŸŒ°"></a>ä¸¾ä¸ªğŸŒ°</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.colors = [<span class="string">'red'</span>,<span class="string">'blue'</span>,<span class="string">'green'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span> (<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">  SuperType.call(<span class="keyword">this</span>,name); <span class="comment">//ç»§æ‰¿å®ä¾‹å±æ€§ ï¼ˆç¬¬äºŒæ¬¡è°ƒç”¨SuperType()ï¼‰</span></span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"> SubType.prototype = <span class="keyword">new</span> SuperType(); <span class="comment">//ç»§æ‰¿åŸå‹å±æ€§å’Œæ–¹æ³•ï¼ˆç¬¬ä¸€æ¬¡è°ƒç”¨SuperType()ï¼‰</span></span><br><span class="line"> SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType(<span class="string">'yishu'</span>,<span class="number">25</span>);</span><br><span class="line">instance1.colors.push(<span class="string">'yellow'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance1.colors'</span>,instance1.colors); <span class="comment">// ["red", "blue", "green", "yellow"]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance1.name'</span>,instance1.sayName()); <span class="comment">//yishu</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance1.age'</span>,instance1.sayAge());<span class="comment">//25</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType(<span class="string">'Grei'</span>,<span class="number">29</span>);</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="string">'instance2.colors'</span>,instance2.colors); <span class="comment">//["red", "blue", "green"]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance2.name'</span>,instance2.sayName());<span class="comment">//Grei</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance2.age'</span>,instance2.sayAge());<span class="comment">//29</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>å¯ä»¥ç»§æ‰¿å®ä¾‹å±æ€§/æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç»§æ‰¿åŸå‹å±æ€§/æ–¹æ³•</li>
<li>ä¸å­˜åœ¨å¼•ç”¨å±æ€§å…±äº«é—®é¢˜</li>
<li>å¯ä¼ å‚</li>
<li>å‡½æ•°å¯å¤ç”¨</li>
</ul>
<h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>è°ƒç”¨äº†ä¸¤æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œç”Ÿæˆäº†ä¸¤ä»½å®ä¾‹ï¼ˆå­ç±»å®ä¾‹å°†å­ç±»åŸå‹ä¸Šçš„é‚£ä»½å±è”½äº†ï¼‰</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">å…·ä½“çš„è¿‡ç¨‹</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ <span class="keyword">SubType</span>.prototype ä¼šå¾—åˆ°ä¸¤ä¸ªå±æ€§  nameå’Œcolors  ä»–ä»¬éƒ½æ¥è‡ªäº SuperType ä½†æ˜¯ç°åœ¨ä½äº <span class="keyword">SubType</span>çš„åŸå‹ä¸­ å½“è°ƒç”¨<span class="keyword">SubType</span>æ„é€ å‡½æ•°æ—¶ åˆä¼šè°ƒç”¨ä¸€æ¬¡</span><br><span class="line">SuperTypeçš„æ„é€ å‡½æ•° è¿™ä¸€æ¬¡åˆåœ¨æ–°å¯¹è±¡<span class="keyword">SubType</span>ä¸Šåˆ›å»ºäº†å®ä¾‹å±æ€§ nameå’Œcolors  äºæ˜¯è¿™ä¸¤ä¸ªå±æ€§å±è”½äº†åŸå‹ä¸­åŒåå±æ€§</span><br></pre></td></tr></table></figure>
<hr>
<p>æ¨èæŒ‡æ•°ï¼šâ¤ï¸â¤ï¸â¤ï¸â¤ï¸ï¼ˆä»…ä»…å¤šæ¶ˆè€—äº†ä¸€ç‚¹å†…å­˜ï¼‰</p>
<h2 id="åŸå‹å¼ç»§æ‰¿"><a href="#åŸå‹å¼ç»§æ‰¿" class="headerlink" title="åŸå‹å¼ç»§æ‰¿"></a>åŸå‹å¼ç»§æ‰¿</h2><p><font color="red">æ ¸å¿ƒåŸç†ï¼š</font>å€ŸåŠ©åŸå‹å¯ä»¥åŸºäºå·²æœ‰çš„å¯¹è±¡åˆ›å»ºæ–°çš„å¯¹è±¡ åŒæ—¶è¿˜ä¸å¿…å› æ­¤åˆ›å»ºè‡ªå®šä¹‰ç±»å‹</p>
<p><strong>ES5ä»¥å‰</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ObjectCreate</span>(<span class="params">o</span>)</span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125; <span class="comment">//åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ€§çš„æ„é€ å‡½æ•°</span></span><br><span class="line">  F.prototype = o;<span class="comment">//å°†ä¼ å…¥çš„å¯¹è±¡å½“ä½œè¿™ä¸ªæ„é€ å‡½æ•°çš„åŸå‹</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F(); <span class="comment">//è¿”å›è¿™ä¸ªä¸´æ—¶ç±»å‹çš„æ–°å®ä¾‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ObjectCreate æ–¹æ³•æœ¬è´¨ä¸Šå¯¹ä¼ å…¥å…¶ä¸­çš„å¯¹è±¡æ‰§è¡Œäº†ä¸€æ¬¡æµ…å¤åˆ¶</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name:<span class="string">'yishu'</span>,</span><br><span class="line">  friends:[<span class="string">'xiaohong'</span>,<span class="string">'xiaoming'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance1 = ObjectCreate(person);</span><br><span class="line">instance1.age = <span class="number">45</span>;</span><br><span class="line">instance1.friends.push(<span class="string">'xiaolan'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance1'</span>,instance1.age); <span class="comment">//45</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance1'</span>,instance1.friends);<span class="comment">//Â ["xiaohong", "xiaoming", "xiaolan"]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'person.friends'</span>,person.friends)<span class="comment">//["xiaohong", "xiaoming", "xiaolan"]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'person.age'</span>,person.age)<span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = ObjectCreate(person);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance2'</span>,instance2.age); <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'instance2'</span>,instance2.friends);<span class="comment">//["xiaohong", "xiaoming", "xiaolan"]</span></span><br></pre></td></tr></table></figure>
<p><strong>ES5ä»¥å</strong></p>
<p>é€šè¿‡æ–°å¢ <code>Object.create(obj1ï¼Œobj2)</code>è§„èŒƒåŒ–äº†åŸå‹å¼ç»§æ‰¿</p>
<ul>
<li>obj1ï¼šç”¨åšæ–°å¯¹è±¡åŸå‹çš„å¯¹è±¡</li>
<li>obj2ï¼ˆå¯é€‰ï¼‰ä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±æ€§çš„å¯¹è±¡ åœ¨ä¼ å…¥ä¸€ä¸ªå‚æ•°çš„æƒ…å†µä¸‹ä¸<code>ObjectCreate</code>å‡½æ•°åŠŸèƒ½ç›¸åŒ</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name:<span class="string">'yishu'</span>,</span><br><span class="line">  friends:[<span class="string">'xiaohong'</span>,<span class="string">'xiaoming'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> otherPerson = <span class="built_in">Object</span>.create(person);</span><br><span class="line"></span><br><span class="line">otherPerson.name=<span class="string">'maying'</span>;</span><br><span class="line">otherPerson.friends.push(<span class="string">'wqs'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'otherPerson'</span>,otherPerson.name) <span class="comment">// maying</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'otherPerson'</span>,otherPerson.friends) <span class="comment">//Â ["xiaohong", "xiaoming", "wqs"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> otherPerson1 = <span class="built_in">Object</span>.create(person,&#123;<span class="attr">name</span>:&#123;<span class="attr">value</span>:<span class="string">'dsdd'</span>&#125;&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'otherPerson1'</span>,otherPerson1.name) <span class="comment">//dsdd</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'otherPerson1'</span>,otherPerson1.friends)<span class="comment">//Â ["xiaohong", "xiaoming", "wqs"]</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="ç¼ºç‚¹-3"><a href="#ç¼ºç‚¹-3" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>ä¸æ˜¯ç±»å¼ç»§æ‰¿ï¼Œè€Œæ˜¯åŸå‹å¼åŸºç¡€ï¼Œç¼ºå°‘äº†ç±»çš„æ¦‚å¿µ</li>
<li>å¯¹äºå¼•ç”¨ç±»å‹å€¼çš„å±æ€§ä¾ç„¶æ˜¯ å…±äº«çŠ¶æ€çš„ï¼Œè¿™ç›¸å½“äºåˆ›å»ºäº†ä¸¤ä¸ªpersonçš„å‰¯æœ¬</li>
</ul>
<h2 id="å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ï¼ˆæœ€ç†æƒ³çš„ç»§æ‰¿èŒƒå¼ï¼‰"><a href="#å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ï¼ˆæœ€ç†æƒ³çš„ç»§æ‰¿èŒƒå¼ï¼‰" class="headerlink" title="å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ï¼ˆæœ€ç†æƒ³çš„ç»§æ‰¿èŒƒå¼ï¼‰"></a>å¯„ç”Ÿå¼ç»„åˆç»§æ‰¿ï¼ˆæœ€ç†æƒ³çš„ç»§æ‰¿èŒƒå¼ï¼‰</h2><p><font color="red">æ ¸å¿ƒåŸç†ï¼š</font><br>å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§<br>é€šè¿‡åŸå‹é“¾çš„<strong>æ··æˆå½¢å¼</strong>æ¥ç»§æ‰¿æ–¹æ³•</p>
<p><font color="red">æŠ€æœ¯åŸç†ï¼š</font> ä¸å¿…ä¸ºäº†æŒ‡å®šå­ç±»å‹çš„åŸå‹è€Œè°ƒç”¨è¶…ç±»å‹çš„æ„é€ å‡½æ•° æˆ‘ä»¬æ‰€éœ€è¦çš„æ— éå°±æ˜¯è¶…ç±»å‹åŸå‹çš„ä¸€ä¸ªå‰¯æœ¬è€Œå·²ï¼ˆä½¿ç”¨å¯„ç”Ÿå¼æ¥ç»§æ‰¿è¶…ç±»å‹çš„åŸå‹ ç„¶åå†å°†ç»“æœæŒ‡å®šç»™å­ç±»å‹çš„åŸå‹ ï¼‰</p>
<p>ä¸¾ä¸ªğŸŒ°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">inhertPrototype</span>(<span class="params">SubType, SuperType</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> prototype = <span class="built_in">Object</span>.create(SuperType.prototype); <span class="comment">//åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">  prototype.constructor = SubType; <span class="comment">//å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡å¹¶æ›¿æ¢äº†å‡½æ•°é»˜è®¤çš„.prototypeå¯¹è±¡å¼•ç”¨,é‚£ä¹ˆæ–°å¯¹è±¡ä¸ä¼šè‡ªåŠ¨è·å¾—.constructorå±æ€§</span></span><br><span class="line">  SubType.prototype = prototype;<span class="comment">//æŒ‡å®šå¯¹è±¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.colors = [<span class="string">'red'</span>,<span class="string">'blue'</span>,<span class="string">'green'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SuperType.prototype.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">  SuperType.call(<span class="keyword">this</span>, name);<span class="comment">//ç¬¬äºŒæ¬¡è°ƒç”¨SuperType()</span></span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inhertPrototype(SubType, SuperType);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SubType.prototype.sayAge = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(<span class="keyword">this</span>.age);         </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dd = <span class="keyword">new</span> SubType(<span class="string">'yishu'</span>,<span class="number">22</span>);</span><br><span class="line">dd.colors.push(<span class="string">'gold'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'dd'</span>,dd.colors);  <span class="comment">//["red", "blue", "green", "gold"]</span></span><br><span class="line">dd.sayAge(); <span class="comment">//22</span></span><br><span class="line">dd.sayName(); <span class="comment">//yishu</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cc = <span class="keyword">new</span> SubType(<span class="string">'xiaogou'</span>,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'cc'</span>,cc.colors); [<span class="string">"red"</span>, <span class="string">"blue"</span>, <span class="string">"green"</span>]</span><br><span class="line">cc.sayAge(); <span class="comment">//10</span></span><br><span class="line">cc.sayName();<span class="comment">//xiaogou</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¼˜ç‚¹-3"><a href="#ä¼˜ç‚¹-3" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>å®Œç¾</p>
<ul>
<li>å®ƒåªè°ƒç”¨äº†ä¸€æ¬¡æ„é€ å‡½æ•° é¿å…äº†åœ¨SubType.prototypeä¸Šåˆ›å»ºä¸å¿…è¦çš„å±æ€§ ä¸æ­¤åŒæ—¶ åŸå‹é“¾è¿˜èƒ½ä¿æŒä¸å˜<h3 id="ç¼ºç‚¹-4"><a href="#ç¼ºç‚¹-4" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3></li>
<li>å®ç°ä¸å¦‚ç»„åˆå¼ç»§æ‰¿ç®€å•</li>
</ul>
<hr>
<p>æ¨èæŒ‡æ•°ï¼šâ¤ï¸â¤ï¸â¤ï¸â¤ï¸ï¼ˆå¤æ‚åº¦æ‰£æ‰ä¸€é¢—å¿ƒï¼‰</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ECMAscriptæ”¯æŒé¢å‘å¯¹è±¡ç¼–ç¨‹ ä½†æ˜¯ä¸ä½¿ç”¨ç±»æˆ–è€…æ¥å£ å¯¹è±¡å¯ä»¥åœ¨ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ›å»ºæˆ–å¢å¼º å› æ­¤å…·æœ‰åŠ¨æ€æ€§è€Œéä¸¥æ ¼å®šä¹‰çš„å®ä½“ åœ¨æ²¡æœ‰ç±»çš„æƒ…å†µä¸‹ å¯ä»¥é‡‡ç”¨ä¸‹åˆ—æ¨¡å¼åˆ›å»ºå¯¹è±¡</p>
<ul>
<li>å·¥å‚æ¨¡å¼</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨ç®€å•çš„å‡½æ•°åˆ›å»ºå¯¹è±¡ ä¸ºå¯¹è±¡å¤©å‡å±æ€§å’Œæ–¹æ³• ç„¶åè¿”å›å¯¹è±¡è¢«æ„é€ å‡½æ•°æ¨¡å¼å–ä»£</span><br></pre></td></tr></table></figure>
<ul>
<li>æ„é€ å‡½æ•°æ¨¡å¼</li>
</ul>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰å¼•ç”¨ç±»å‹ </span><br><span class="line">å¯ä»¥åƒåˆ›å»ºå†…ç½®å¯¹è±¡å®ä¾‹ä¸€æ ·ä½¿ç”¨<span class="keyword">new</span><span class="type"></span></span><br><span class="line"><span class="type"></span></span><br><span class="line"><span class="type"></span>ç¼ºç‚¹ï¼šæˆå‘˜æ— æ³•å¤ç”¨ åŒ…æ‹¬å‡½æ•°</span><br></pre></td></tr></table></figure>
<ul>
<li>åŸå‹æ¨¡å¼</li>
</ul>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨æ„é€ å‡½æ•°çš„proto<span class="keyword">type</span>å±æ€§æ¥æŒ‡å®šé‚£äº›åº”è¯¥å…±äº«çš„å±æ€§å’Œæ–¹æ³•</span><br><span class="line"></span><br><span class="line">ç»„åˆä½¿ç”¨ æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼ åˆ†åˆ«å®šä¹‰å±æ€§å’Œæ–¹æ³•</span><br></pre></td></tr></table></figure>
<p>jsä¸»è¦é€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ åŸå‹é“¾çš„æ„å»ºæ˜¯é€šè¿‡<strong>å°†ä¸€ä¸ªç±»å‹çš„å®ä¾‹å¤åˆ¶ç»™å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„åŸå‹</strong>å®ç°çš„ï¼Œè¿™æ ·å­ç±»å‹å°±èƒ½è®¿é—®åˆ°è¶…ç±»å‹æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³• è¿™ä¸€ç‚¹ä¸åŸºäºç±»çš„ç»§æ‰¿å¾ˆç›¸ä¼¼ã€‚</p>
<p>åŸå‹é“¾çš„é—®é¢˜æ˜¯<strong>å¯¹è±¡å®ä¾‹å…±äº«æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•</strong> å› æ­¤ä¸é€‚åˆå•ç‹¬ä½¿ç”¨<br>è§£å†³è¿™ä¸ªé—®é¢˜çš„æŠ€æœ¯æ˜¯å€ŸåŠ©æ„é€ å‡½æ•° ï¼ˆåœ¨å­ç±»å‹æ„é€ å‡½æ•°ä¸­çš„å†…éƒ¨è°ƒç”¨è¶…ç±»å‹çš„æ„é€ å‡½æ•°ï¼‰ è¿™æ ·å°±èƒ½åšåˆ°æ¯ä¸ªå®ä¾‹å…·æœ‰è‡ªå·±çš„å±æ€§ åŒæ—¶è¿˜èƒ½ä¿è¯åªä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼æ¥å®šä¹‰ç±»å‹</p>
<p>ä½¿ç”¨æœ€å¤šçš„ç»§æ‰¿æ¨¡å¼æ˜¯<strong>ç»„åˆç»§æ‰¿</strong><br>é€šè¿‡åŸå‹é“¾ç»§æ‰¿å…±äº«çš„å±æ€§å’Œæ–¹æ³•<br>è€Œé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿å®ä¾‹å±æ€§</p>
<p>è¿˜æœ‰å…¶ä»–ç»§æ‰¿æ¨¡å¼</p>
<ul>
<li>åŸå‹å¼ç»§æ‰¿</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¯ä»¥åœ¨ä¸å¿…é¢„å…ˆå®šä¹‰æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹å®ç°ç»§æ‰¿ æœ¬è´¨æ˜¯æ‰§è¡Œå¯¹ç»™å®šå¯¹è±¡çš„æµ…å¤åˆ¶ è€Œå¤åˆ¶çš„å‰¯æœ¬è¿˜å¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„åŠ å¼º æ”¹é€ </span><br></pre></td></tr></table></figure>
<ul>
<li>å¯„ç”Ÿå¼ç»§æ‰¿</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¸ åŸå‹å¼ç»§æ‰¿ç›¸ä¼¼</span><br></pre></td></tr></table></figure>
<ul>
<li>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é›†å¯„ç”Ÿå¼ç»§æ‰¿å’Œç»„åˆç»§æ‰¿çš„ä¼˜ç‚¹ä¸ä¸€èº«</span><br><span class="line">æ˜¯å®ç°åŸºäºç±»å‹ç»§æ‰¿çš„æœ€æœ‰æ•ˆçš„æ–¹å¼</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>JavaScript é«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰</p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
  </entry>
  <entry>
    <title>jsæ¨¡å—åŒ–ç¼–ç¨‹ç³»åˆ—ï¼ˆä¸€ï¼‰</title>
    <url>/2017/04/23/js%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B%E7%B3%BB%E5%88%97%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<ol>
<li>åŸå§‹å†™æ³•</li>
</ol>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">m1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">m2</span><span class="params">()</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p> ç¼ºç‚¹ï¼šæ±¡æŸ“äº†å…¨å±€å˜é‡ï¼Œå®¹æ˜“ä¸å…¶å®ƒæ¨¡å—å‘ç”Ÿå‘½åå†²çªï¼Œè€Œä¸”æ¨¡å—ä¹‹é—´çœ‹ä¸å‡ºç›´æ¥å…³ç³»</p>
<ol start="2">
<li>å¯¹è±¡å†™æ³•</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> moudle = <span class="keyword">new</span> <span class="built_in">Object</span>(&#123;</span><br><span class="line"> _count = <span class="number">0</span>;</span><br><span class="line"> m1:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line"> m2:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç¼ºç‚¹ï¼šä¼šæš´éœ²æ‰€æœ‰æ¨¡å—æˆå‘˜ï¼Œå†…éƒ¨çŠ¶æ€å¯ä»¥è¢«å¤–éƒ¨æ”¹å†™</p>
<ol start="3">
<li>ç«‹å³æ‰§è¡Œå‡½æ•°çš„å†™æ³•(è¾¾åˆ°ä¸æš´éœ²ç§æœ‰æˆå‘˜çš„ç›®çš„)</li>
</ol>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> moudle1 = (<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> m1 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> m2 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">         m1:m1,</span><br><span class="line">         m2:m2</span><br><span class="line">       &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p> moudle1å°±æ˜¯javascriptæ¨¡å—çš„åŸºæœ¬å†™æ³•</p>
<ol start="4">
<li>æ”¾å¤§æ¨¡å¼<br>èƒŒæ™¯ï¼šå¦‚æœä¸€ä¸ªæ¨¡å—å¾ˆå¤§å¿…é¡»åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œæˆ–è€…ä¸€ä¸ªæ¨¡å—éœ€è¦ç»§æ‰¿å¦å¤–ä¸€ä¸ªæ¨¡å—æ—¶</li>
</ol>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> moudle1 = (<span class="function"><span class="keyword">function</span><span class="params">(mod)</span></span>&#123;</span><br><span class="line">   mod.m3 = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">   <span class="comment">//...</span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> mod;</span><br><span class="line">  &#125;)(moudle1);</span><br></pre></td></tr></table></figure>
<p>  ä¸Šé¢çš„ä»£ç ä¸º moudle1 æ·»åŠ äº†ä¸€ä¸ªæ–°æ–¹æ³•m3ï¼Œç„¶åè¿”å›æ–°çš„moudle1æ¨¡å—</p>
<ol start="5">
<li>å®½æ”¾å¤§æ¨¡å¼<br>èƒŒæ™¯ï¼šåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œæ¨¡å—çš„å„ä¸ªéƒ¨åˆ†éƒ½æ˜¯ä»ç½‘ä¸Šè·å–çš„ï¼Œæœ‰æ—¶å€™æ— æ³•çŸ¥é“å“ªä¸ªéƒ¨åˆ†ä¼šå…ˆåŠ è½½ï¼Œå¦‚æœå•çº¯é‡‡ç”¨æ”¾å¤§æ¨¡å¼ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œçš„ éƒ¨åˆ†æœ‰å¯èƒ½åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨çš„ç©ºå¯¹è±¡</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> moudle1 = (<span class="function"><span class="keyword">function</span>(<span class="params">mod</span>)</span>&#123;</span><br><span class="line">  mod.m3 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> mod;</span><br><span class="line"> &#125;)(<span class="built_in">window</span>.moudle1 || &#123;&#125;);</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>è¾“å…¥å…¨å±€å˜é‡<br>èƒŒæ™¯ï¼šä¿æŒæ¨¡å—ç‹¬ç«‹æ€§ï¼Œå†…éƒ¨æœ€å¥½ä¸è¦ä¸ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ç›´æ¥äº¤äº’</li>
</ol>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> moudle1 = (<span class="function"><span class="keyword">function</span><span class="params">($,YAHOO)</span></span>&#123;</span><br><span class="line">      <span class="comment">//...</span></span><br><span class="line">  &#125;)(jQuery, YAHOO);</span><br></pre></td></tr></table></figure>
<p>  ä¿æŒç‹¬ç«‹çš„åŒæ—¶ï¼Œæ¨¡å—çš„ä¾èµ–å…³ç³»å˜çš„æ›´æ˜æ˜¾</p>
<ol start="7">
<li>æ¨¡å—çš„è§„èŒƒ<br>CommonJSå’ŒAMD<br>CommonJSï¼šnodejsçš„æ¨¡å—ç³»ç»Ÿï¼Œæ˜¯å‚ç…§ CommonJS è§„èŒƒå®ç°çš„ï¼Œåœ¨CommonJSä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€æ–¹æ³• require()ï¼Œç”¨äºåŠ è½½æ¨¡å—</li>
</ol>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">eg:</span><br><span class="line">var <span class="built_in">math</span> = <span class="built_in">require</span>(<span class="string">'math'</span>);</span><br><span class="line">  è°ƒç”¨<span class="built_in">math</span>æ¨¡å—æä¾›çš„æ–¹æ³•ï¼š</span><br><span class="line">  <span class="built_in">math</span>.add(<span class="number">2</span>,<span class="number">3</span>); // <span class="number">5</span></span><br></pre></td></tr></table></figure>
<ol start="8">
<li>æµè§ˆå™¨ç¯å¢ƒ<br>å±€é™ä½¿CommonJSè§„èŒƒä¸é€‚ç”¨äºæµè§ˆå™¨ç¯å¢ƒ</li>
</ol>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> math = require(<span class="string">'math'</span>);</span><br><span class="line">math.<span class="keyword">add</span>(<span class="number">2</span>,<span class="number">3</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<p>  åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œç¬¬äºŒè¡Œåœ¨ç¬¬ä¸€è¡Œä¹‹åè¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»å¾—ç­‰åˆ°mathæ¨¡å—åŠ è½½å®Œæˆï¼Œå¦‚æœåŠ è½½æ—¶é—´å¾ˆé•¿ï¼Œæ•´ä¸ªåº”ç”¨éƒ½ä¼šåœåœ¨é‚£é‡Œç­‰ï¼Œå¯¹äºæœåŠ¡å™¨ç«¯æ¥è¯´ï¼Œæ‰€æœ‰æ¨¡å—éƒ½æ”¾åœ¨æœ¬åœ°ç¡¬ç›˜ï¼Œå¯ä»¥åŒæ­¥åŠ è½½å®Œæˆï¼Œç­‰å¾…æ—¶é—´å°±æ˜¯ç¡¬ç›˜çš„è¯»å–æ—¶é—´ï¼Œä½†æ˜¯å¯¹äºæµè§ˆå™¨ï¼Œè¿™å°±æ˜¯è‡´å‘½çš„é—®é¢˜ï¼Œå–å†³äºç½‘é€Ÿï¼Œ<br>  æ‰€ä»¥ï¼Œæµè§ˆå™¨ç«¯çš„æ¨¡å—ä¸èƒ½é‡‡ç”¨åŒæ­¥åŠ è½½ï¼Œè¦é‡‡ç”¨<strong>å¼‚æ­¥åŠ è½½</strong></p>
<ol start="9">
<li>AMD<br>â€˜å¼‚æ­¥æ¨¡å—å®šä¹‰â€™ï¼Œé‡‡ç”¨å¼‚æ­¥æ–¹å¼åŠ è½½æ¨¡å—ï¼Œæ‰€æœ‰ä¾èµ–è¿™ä¸ªæ¨¡å—çš„è¯­å¥ï¼Œéƒ½å®šä¹‰åœ¨ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œç­‰åˆ°åŠ è½½å®Œæˆä¹‹åï¼Œå›è°ƒå‡½æ•°æ‰æ‰§è¡Œ<br>AMDä¹Ÿé‡‡ç”¨require()è¯­å¥åŠ è½½æ¨¡å—ï¼Œä¸åŒäºCommonJSï¼Œå®ƒè¦æ±‚ä¸¤ä¸ªå‚æ•°
ã€€</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="built_in">module</span>], callback)</span><br><span class="line"><span class="built_in">require</span>([<span class="string">'math'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">math</span>) </span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€math.add(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">ã€€ã€€&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>jsæ¨¡å—åŒ–ç¼–ç¨‹ç³»åˆ—ï¼ˆäºŒï¼‰</title>
    <url>/2017/04/24/js%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B%E7%B3%BB%E5%88%97%EF%BC%88%E4%BA%8C%EF%BC%89require.js/</url>
    <content><![CDATA[<p><strong>require.js</strong></p>
<p>å‡ºç°èƒŒæ™¯ï¼šæ‰€æœ‰çš„javascriptä»£ç éƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä»£ç è¶Šæ¥è¶Šå¤šæ—¶å¿…é¡»åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œä¾æ¬¡åŠ è½½ï¼Œé—®é¢˜ï¼šåŠ è½½jsçš„æ—¶å€™æµè§ˆå™¨åœæ­¢æ¸²æŸ“ï¼ŒåŠ è½½æ–‡ä»¶è¶Šå¤šï¼Œç½‘é¡µçš„å“åº”æ—¶é—´å°±è¶Šé•¿ï¼Œç”±äºjsä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œå› æ­¤å¿…é¡»ä¸¥æ ¼ä¿è¯åŠ è½½é¡ºåºï¼Œå½“ä¾èµ–å…³ç³»å˜çš„å¤æ‚æ—¶ï¼Œä»£ç çš„ç¼–å†™å’Œç»´æŠ¤éƒ½ä¼šå˜çš„å¼‚å¸¸å›°éš¾</p>
<ol>
<li>åŠ è½½require.js</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">"js/require.js"</span> defer <span class="keyword">async</span>=<span class="string">'true'</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="keyword">async</span>   è¡¨æ˜è¿™ä¸ªæ–‡ä»¶éœ€è¦å¼‚æ­¥åŠ è½½</span><br><span class="line">åœ¨<span class="built_in">require</span>.jsçš„åŸºç¡€ä¸ŠåŠ è½½è‡ªå·±çš„ main.js</span><br><span class="line">&lt;script src=<span class="string">"require.js"</span> data-main=<span class="string">"js/main"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">ata-main:æŒ‡å®šç¨‹åºçš„ä¸»æ¨¡å—ï¼Œè¿™ä¸ªäººé—´ä¼šç¬¬ä¸€ä¸ªè¢«<span class="built_in">require</span>.jsåŠ è½½ï¼Œç”±äº<span class="built_in">require</span>.jsé»˜è®¤çš„æ–‡ä»¶åç¼€åæ˜¯jsï¼Œæ‰€ä»¥å¯ä»¥æŠŠmain.js ç®€å†™æˆmain</span><br><span class="line"></span><br><span class="line"><span class="comment">//main.js</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'moduleA'</span>, <span class="string">'moduleB'</span>, <span class="string">'moduleC'</span>],   <span class="function"><span class="keyword">function</span> (<span class="params">moduleA, moduleB, moduleC</span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">// some code here</span></span><br><span class="line">ã€€ã€€&#125;)<span class="string">``</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æ¨¡å—çš„åŠ è½½<br>å½“åŠ è½½ä¸åŒè·¯å¾„ä¸‹çš„æ¨¡å—å¯ä»¥ä½¿ç”¨ require.config()å¯ä»¥å¯¹æ¨¡å—çš„åŠ è½½è¿›è¡Œè‡ªå®šä¹‰ï¼Œ require.config()å°±å†™åœ¨ä¸»æ¨¡å—(main.js)çš„å¤´éƒ¨ï¼Œå‚æ•°å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„pathå±æ€§æŒ‡å®šå„ä¸ªæ¨¡å—çš„åŠ è½½è·¯å¾„</li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">ã€€ã€€<span class="selector-tag">require</span><span class="selector-class">.config</span>(&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="attribute">paths</span>: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"jquery"</span>: <span class="string">"lib/jquery.min"</span>,</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"underscore"</span>: <span class="string">"lib/underscore.min"</span>,</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"backbone"</span>: <span class="string">"lib/backbone.min"</span></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;);</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€å¦ä¸€ç§å½¢å¼</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€ã€€<span class="selector-tag">require</span><span class="selector-class">.config</span>(&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="attribute">baseUrl</span>: <span class="string">"js/lib"</span>,</span><br><span class="line">ã€€ã€€ã€€ã€€paths: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"jquery"</span>: <span class="string">"jquery.min"</span>,</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"underscore"</span>: <span class="string">"underscore.min"</span>,</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"backbone"</span>: <span class="string">"backbone.min"</span></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;);</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€å†æˆ–è€…</span><br><span class="line">ã€€ã€€ã€€<span class="selector-tag">require</span><span class="selector-class">.config</span>(&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="attribute">paths</span>: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">"jquery"</span>: <span class="string">"https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min"</span></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;);</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>AMDæ¨¡å—çš„å†™æ³•<br>require.js åŠ è½½çš„æ¨¡å—é‡‡ç”¨AMDè§„èŒƒ<br>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯æ¨¡å—å¿…é¡»é‡‡ç”¨ç‰¹å®šçš„define()å‡½æ•°æ¥å®šä¹‰ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—ä¸ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å®šä¹‰åœ¨defineå‡½æ•°ä¸­</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//math.js å®šä¹‰äº†ä¸€ä¸ªmathæ¨¡å—</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">return</span> x+y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line"> add:add</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">åŠ è½½æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line">ã€€ã€€<span class="built_in">require</span>([<span class="string">'math'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">math</span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€alert(math.add(<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">ã€€ã€€&#125;);</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€å¦‚æœè¿™ä¸ªæ¨¡å—è¿˜ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆé‚£ä¹ˆdefine()å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡æ˜è¯¥æ¨¡å—çš„ä¾èµ–æ€§ã€‚</span><br><span class="line">ã€€ã€€ã€€define([<span class="string">'myLib'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">myLib</span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€myLib.doSomething();</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="keyword">return</span> &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€foo : foo</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;;</span><br><span class="line">ã€€ã€€&#125;);</span><br><span class="line">ã€€ã€€å½“<span class="built_in">require</span>()å‡½æ•°åŠ è½½ä¸Šé¢è¿™ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šå…ˆåŠ è½½myLib.jsæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>AMDæ¨¡å—çš„å†™æ³•<br>åŠ è½½éè§„èŒƒçš„æ¨¡å—<br>ç†è®ºä¸Š require.jsåŠ è½½çš„æ¨¡å—ï¼Œå¿…é¡»æ˜¯æŒ‰ç…§AMDè§„èŒƒã€ç”¨define()å‡½æ•°å®šä¹‰çš„æ¨¡å—<br>åŠ è½½éè§„èŒƒæ¨¡å—ï¼Œå¿…é¡»å…ˆç”¨require.config()æ–¹æ³•å®šä¹‰å®ƒä»¬çš„ä¸€äº›ç‰¹å¾</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">egï¼šåŠ è½½éAMDè§„èŒƒæ¨¡å— underscoreï¼Œbackbone</span><br><span class="line">ã€€ã€€require.config(&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€shim: &#123;</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">'underscore'</span>:&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span class="keyword">exports</span>: <span class="string">'_'</span></span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€&#125;,</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="string">'backbone'</span>: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€deps: [<span class="string">'underscore'</span>, <span class="string">'jquery'</span>],</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span class="keyword">exports</span>: <span class="string">'Backbone'</span></span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;);</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€shimå±æ€§ï¼šä¸“é—¨ç”¨æ¥é…ç½®ä¸å…¼å®¹çš„æ¨¡å—ã€‚å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªæ¨¡å—è¦å®šä¹‰</span><br><span class="line">ã€€ã€€ï¼ˆ<span class="number">1</span>ï¼‰<span class="keyword">exports</span>å€¼ï¼ˆè¾“å‡ºçš„å˜é‡åï¼‰ï¼Œè¡¨æ˜è¿™ä¸ªæ¨¡å—å¤–éƒ¨è°ƒç”¨æ—¶çš„åç§°ï¼›</span><br><span class="line">ã€€ã€€ï¼ˆ<span class="number">2</span>ï¼‰depsæ•°ç»„ï¼Œè¡¨æ˜è¯¥æ¨¡å—çš„ä¾èµ–æ€§ã€‚</span><br><span class="line">ã€€ã€€</span><br><span class="line">ã€€ã€€egï¼š</span><br><span class="line">ã€€ã€€   jQueryçš„æ’ä»¶å¯ä»¥è¿™æ ·å®šä¹‰ï¼š</span><br><span class="line">ã€€ã€€ã€€ã€€shim: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="string">'jquery.scroll'</span>: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€deps: [<span class="string">'jquery'</span>],</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="keyword">exports</span>: <span class="string">'jQuery.fn.scroll'</span></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li><p>requireæ’ä»¶<br>domreadyæ’ä»¶ï¼Œå¯ä»¥è®©å›è°ƒå‡½æ•°åœ¨é¡µé¢DOMç»“æ„åŠ è½½å®Œæˆåå†è¿è¡Œã€‚</p>
<p>ã€€</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">'domready!'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">doc</span>)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">// called once the DOM is ready</span></span><br><span class="line">ã€€ã€€&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>textå’Œimageæ’ä»¶ï¼Œåˆ™æ˜¯å…è®¸require.jsåŠ è½½æ–‡æœ¬å’Œå›¾ç‰‡æ–‡ä»¶ã€‚</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">define([</span><br><span class="line">ã€€ã€€ã€€ã€€'text!review.txt',</span><br><span class="line">ã€€ã€€ã€€ã€€'image!cat.jpg'</span><br><span class="line">ã€€ã€€ã€€ã€€],</span><br><span class="line"></span><br><span class="line">ã€€ã€€ã€€ã€€function(<span class="name">review</span>,cat)&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€console.log(<span class="name">review</span>)<span class="comment">;</span></span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€document.body.appendChild(<span class="name">cat</span>)<span class="comment">;</span></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;</span><br><span class="line">ã€€ã€€)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>ç±»ä¼¼çš„æ’ä»¶è¿˜æœ‰jsonå’Œmdownï¼Œç”¨äºåŠ è½½jsonæ–‡ä»¶å’Œmarkdownæ–‡ä»¶</p>
]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>jsé¢å‘å¯¹è±¡</title>
    <url>/2017/04/21/js%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    <content><![CDATA[<p><strong>å·¥å‚æ¨¡å¼</strong><br>è§£å†³äº†é‡å¤å®ä¾‹åŒ–çš„é—®é¢˜</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createObject</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">obj.name= name;</span><br><span class="line">obj.age = age;</span><br><span class="line">obj.run = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="keyword">this</span>.age + <span class="string">'è¿è¡Œä¸­'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> box1 = createObjectï¼ˆâ€˜leeâ€™,<span class="number">100</span>ï¼‰</span><br><span class="line"><span class="keyword">var</span> box2 = createObjectï¼ˆâ€˜jackâ€™,<span class="number">200</span>ï¼‰</span><br></pre></td></tr></table></figure>
<p>å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ï¼š<br>æ— æ³•åŒºåˆ†å®ä¾‹æ˜¯å“ªä¸ªå¯¹è±¡çš„å®ä¾‹</p>
<p><strong>æ„é€ å‡½æ•°æ¨¡å¼</strong></p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Box</span><span class="params">(name,age)</span></span>&#123;</span><br><span class="line"> <span class="keyword">this</span>.name= name;</span><br><span class="line"> <span class="keyword">this</span>.age = age;</span><br><span class="line"> <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="keyword">this</span>.age + <span class="string">'è¿è¡Œä¸­'</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> box3 = <span class="keyword">new</span> Boxï¼ˆâ€˜leeâ€™,<span class="number">100</span>ï¼‰</span><br><span class="line"><span class="keyword">var</span> box4 = <span class="keyword">new</span> Boxï¼ˆâ€˜jackâ€™,<span class="number">200</span>ï¼‰</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½•è¯†åˆ«äº†å¯¹è±¡ï¼Ÿ<br>æ„é€ å‡½æ•°æ²¡æœ‰new Objectï¼Œä½†æ˜¯å®ƒåå°å›è‡ªåŠ¨var obj = new Object();<br>thisæŒ‡çš„å°±æ˜¯obj<br>æ²¡æœ‰è¿”å›å€¼</p>
<p>console.log(box4 instanceof Box)</p>
<p><strong>å¯¹è±¡å†’å……</strong><br>æŠŠoå†’å……æˆboxå¯¹è±¡</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span>  o = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">Box.call(o,<span class="string">'Lee'</span>,<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<p><strong>åŸå‹</strong></p>
<p>prototypeåŸå‹å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Box</span><span class="params">()</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p> è¿™é‡Œå¦‚æœæœ‰å±æ€§æˆ–è€…æ–¹æ³• å«åšå®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">Box<span class="selector-class">.prototypr</span><span class="selector-class">.name</span> åŸå‹å±æ€§</span><br><span class="line">Box<span class="selector-class">.prototypr</span><span class="selector-class">.run</span>=function()&#123;&#125; åŸå‹æ–¹æ³•</span><br></pre></td></tr></table></figure>
<p><strong><em>proto</em>ï¼š</strong> å®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å±æ€§constructor</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">var</span> box1 = new Box()</span><br><span class="line">box1<span class="selector-class">.constructor</span> æŒ‡å‘æ„é€ å‡½æ•°</span><br><span class="line">box1._proto_æŒ‡å‘åŸå‹å¯¹è±¡</span><br></pre></td></tr></table></figure>
<p>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å®ä¾‹æ˜¯ä¸æ˜¯æŒ‡å‘äº†å¯¹è±¡çš„åŸå‹å¯¹è±¡ï¼Œå®ä¾‹åŒ–ä¹‹åæ˜¯è‡ªåŠ¨æŒ‡å‘çš„</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="type">Box</span>.proto<span class="keyword">type</span>.isPrototypeOf(box1)</span><br></pre></td></tr></table></figure>
<p><strong>ä»€ä¹ˆå«é—­åŒ…ï¼Ÿ æœ‰ä»€ä¹ˆç”¨</strong></p>
<p>é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå‡½æ•°ï¼Œå¸¸è§çš„å½¢å¼æ˜¯åœ¨<font face="STCAIYUN" color="red" size="4">æŸä¸ªä½œç”¨åŸŸä¸­å®šä¹‰çš„å‡½æ•°</font></p>
<p>é—­åŒ…çš„ä½œç”¨åŸŸé“¾åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š</p>
<ol>
<li>å‡½æ•°æœ¬èº«ä½œç”¨åŸŸ</li>
<li>é—­åŒ…å®šä¹‰çš„ä½œç”¨åŸŸ</li>
<li>å…¨å±€ä½œç”¨åŸŸ</li>
</ol>
<p><font face="STCAIYUN" color="green" size="4">é—­åŒ…çš„å¸¸è§ç”¨é€”ï¼Ÿ</font></p>
<ol>
<li>è¯»å–å‡½æ•°å†…éƒ¨çš„å˜é‡</li>
<li>å°†å˜é‡å§‹ç»ˆä¿æŒåœ¨å†…å­˜ä¸­</li>
<li>æ¨¡æ‹Ÿé¢å‘å¯¹è±¡çš„ä»£ç é£æ ¼</li>
</ol>
<p><strong>åŒ¿åæ‰§è¡Œå‡½æ•°</strong></p>
<p>ä¸åŠ <strong>var</strong>å…³é”®å­— é»˜è®¤å›å‘—æ·»åŠ åˆ°å…¨å±€å¯¹è±¡çš„å±æ€§ä¸­å»ï¼Œç±»ä¼¼çš„ä¸´æ—¶å˜é‡çš„å±æ€§åŠ å…¥å…¨å±€å¯¹è±¡æœ‰å¾ˆå¤šåå¤„<br>æ¯”å¦‚ï¼š<br>åˆ«çš„å‡½æ•°å¯èƒ½è¯¯ç”¨è¿™äº›å˜é‡ é€ æˆå…¨å±€å˜é‡è¿‡äºåºå¤§ï¼Œå½±å“è®¿é—®é€Ÿåº¦ï¼ˆå› ä¸ºå˜é‡çš„å–å€¼æ˜¯éœ€è¦ä»åœ†å½¢é“¾ä¸Šéå†çš„ï¼‰</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> datamodel = &#123;    </span><br><span class="line">    table : [],    </span><br><span class="line">    tree : &#123;&#125;    </span><br><span class="line">&#125;;    </span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span><span class="params">(dm)</span></span>&#123;    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dm.table.rows; i++)&#123;    </span><br><span class="line">       <span class="keyword">var</span> row = dm.table.rows[i];    </span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; row.cells; i++)&#123;    </span><br><span class="line">           drawCell(i, j);    </span><br><span class="line">       &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="comment">//build dm.tree      </span></span><br><span class="line">&#125;)(datamodel);  </span><br><span class="line"></span><br><span class="line">åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åçš„å‡½æ•°å¹¶ç«‹å³æ‰§è¡Œå®ƒï¼Œç”±äºå¤–éƒ¨æ— æ³•å¼•ç”¨å®ƒå†…éƒ¨çš„å˜é‡ï¼Œå› æ­¤åœ¨æ‰§è¡Œä¹‹åå¾ˆå¿«å°±ä¼šè¢«é‡Šæ”¾ ä¸ä¼šæ±¡æŸ“å…¨å±€å¯¹è±¡</span><br></pre></td></tr></table></figure>
<p><strong>ç¼“å­˜</strong></p>
<p>è®¾æƒ³æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤„ç†è¿‡ç¨‹å¾ˆè€—æ—¶çš„å‡½æ•°å¯¹è±¡ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œ<br>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å°†è®¡ç®—å‡ºæ¥çš„å€¼å­˜å‚¨èµ·æ¥ï¼Œå½“è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œé¦–å…ˆåœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™è¿›è¡Œè®¡ç®—ï¼Œç„¶åæ›´æ–°ç¼“å­˜å¹¶è¿”å›å€¼ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œç›´æ¥è¿”å›æŸ¥æ‰¾åˆ°çš„å€¼å³å¯ã€‚é—­åŒ…æ­£æ˜¯å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå®ƒä¸ä¼šé‡Šæ”¾å¤–éƒ¨çš„å¼•ç”¨ï¼Œä»è€Œå‡½æ•°å†…éƒ¨çš„å€¼å¯ä»¥å¾—ä»¥ä¿ç•™ã€‚</p>
<p><strong>å®ç°å°è£…</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;    </span><br><span class="line">    <span class="comment">//å˜é‡ä½œç”¨åŸŸä¸ºå‡½æ•°å†…éƒ¨ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®    </span></span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">"default"</span>;       </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;    </span><br><span class="line">       getName : <span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;    </span><br><span class="line">           <span class="keyword">return</span> name;    </span><br><span class="line">       &#125;,    </span><br><span class="line">       setName : <span class="function"><span class="keyword">function</span><span class="params">(newName)</span></span>&#123;    </span><br><span class="line">           name = newName;    </span><br><span class="line">       &#125;    </span><br><span class="line">    &#125;    </span><br><span class="line">&#125;();    </span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(person.name);<span class="comment">//ç›´æ¥è®¿é—®ï¼Œç»“æœä¸ºundefined    </span></span><br><span class="line"><span class="keyword">print</span>(person.getName());    </span><br><span class="line">person.setName(<span class="string">"abruzzi"</span>);    </span><br><span class="line"><span class="keyword">print</span>(person.getName());</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>Javascript è®¾è®¡æ¨¡å¼ç³»åˆ—</title>
    <url>/2018/01/16/js%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<h2 id="é¢å‘å¯¹è±¡çš„-Javascript"><a href="#é¢å‘å¯¹è±¡çš„-Javascript" class="headerlink" title="é¢å‘å¯¹è±¡çš„ Javascript"></a>é¢å‘å¯¹è±¡çš„ Javascript</h2><p>ä¸åŒäºä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„ç±»å¼ç»§æ‰¿ jsé€šè¿‡ <strong>åŸå‹å§”æ‰˜</strong> çš„æ–¹å¼å®ç°å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿</p>
<p>ç¼–ç¨‹è¯­è¨€åˆ†ä¸º ï¼š<br><strong>é™æ€ç±»å‹è¯­è¨€</strong>ï¼šç¼–è¯‘æ—¶å·²ç¡®å®šå˜é‡çš„ç±»å‹<br>  ä¼˜ç‚¹ï¼šåœ¨ç¼–è¯‘æ—¶å°±èƒ½å‘ç°ç±»å‹ä¸åŒ¹é…çš„é”™è¯¯ï¼Œç¼–è¯‘å™¨å¯ä»¥é’ˆå¯¹ä¸åŒçš„æ•°æ®ç±»å‹å¯¹ç¨‹åºåšä¸€äº›ä¼˜åŒ–å·¥ä½œ æé«˜ç¨‹åºä¹‹å¿ƒé€Ÿåº¦<br>  ç¼ºç‚¹ï¼šç¨‹åºå‘˜ä¾ç…§å¥‘çº¦æ¥ç¼–å†™ç¨‹åº<br><strong>åŠ¨æ€ç±»å‹è¯­è¨€</strong>ï¼šè¦åˆ°ç¨‹åºè¿è¡Œçš„æ—¶å€™ å¾…å˜é‡è¢«èµ‹äºˆæŸä¸ªå€¼ä¹‹å æ‰ä¼šå…·æœ‰æŸç§ç±»å‹<br>  ä¼˜ç‚¹ï¼šä»£ç æ•°é‡å°‘<br>  ç¼ºç‚¹ï¼šç¨‹åºåœ¨è¿è¡ŒæœŸé—´æœ‰å¯èƒ½å‘ç”Ÿè·Ÿç±»å‹ç›¸å…³çš„é”™è¯¯</p>
<p>  Javascript æ˜¯ä¸€é—¨å…¸å‹çš„åŠ¨æ€ç±»å‹è¯­è¨€</p>
<p>  å¤šæ€ï¼šç»™ä¸åŒçš„å¯¹è±¡å‘é€åŒä¸€æ¡æ¶ˆæ¯çš„æ—¶å€™ è¿™äº›å¯¹è±¡ä¼šæ ¹æ®è¿™ä¸ªæ¶ˆæ¯åˆ†åˆ«ç»™å‡ºä¸åŒçš„åé¦ˆ</p>
<p> å¤šæ€ï¼š<br> å¤šç§å½¢æ€ åœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œæ¥å£çš„å¤šç§ä¸åŒçš„å®ç°æ–¹å¼å³ä¸ºå¤šæ€<br> å¤šæ€æŒ‡åŒä¸€ä¸ªå®ä½“åŒæ—¶å…·æœ‰å¤šç§å½¢å¼<br> æ€æƒ³ï¼šæŠŠåšä»€ä¹ˆ å’Œ è°å»åš åˆ†å¼€<br> åŒä¸€ä¸ªå‡½æ•° ä¼ å…¥ä¸åŒçš„å‚æ•° å¯ä»¥å®ç°ä¸åŒçš„ç»“æœ</p>
<p> jsçš„å¤šæ€æ˜¯ä¸ç”Ÿä¿±æ¥çš„<br> å®ƒä½œä¸ºä¸€é—¨åŠ¨æ€ç±»å‹è¯­è¨€ ä»–åœ¨ç¼–è¯‘æ—¶æ²¡æœ‰ç±»å‹æ£€æŸ¥çš„ç±»å‹</p>
<p> å¤šæ€çš„å¥½å¤„ï¼šä½ ä¸å¿…å†å‘å¯¹è±¡è¯¢é—®â€˜ä½ æ˜¯ä»€ä¹ˆç±»å‹â€™è€Œåæ ¹æ®å¾—åˆ°çš„ç­”æ¡ˆ  è°ƒç”¨å¯¹è±¡çš„æŸä¸ªè¡Œä¸º ä½ åªç®¡è°ƒç”¨è¯¥è¡Œä¸ºå°±æ˜¯äº†</p>
<p> æœ€æ ¹æœ¬çš„ä½œç”¨å°±æ˜¯é€šè¿‡æŠŠè¿‡ç¨‹è¯çš„æ¡ä»¶åˆ†æ”¯è¯­å¥è½¬åŒ–ä¸ºå¯¹è±¡çš„å¤šæ€æ€§  ä»è€Œæ¶ˆé™¤è¿™äº›æ¡ä»¶åˆ†æ”¯è¯­å¥</p>
<p> é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¼˜ç‚¹<br> å°†è¡Œä¸ºåˆ†å¸ƒåœ¨å„ä¸ªå¯¹è±¡ä¸­ï¼Œå¹¶ä¸”è®©è¿™äº›å¯¹è±¡å„è‡ªè´Ÿè´£è‡ªå·±çš„è¡Œä¸º</p>
<p> å½“æˆ‘ä»¬å¯¹ä¸€äº›å‡½æ•°å‘å‡º è°ƒç”¨çš„æŒ‡ä»¤æ—¶ è¿™äº›å‡½æ•°ä¼šè¿”å›ä¸åŒçš„ç»“æœ<br> è¿™ä¹Ÿæ˜¯å¤šæ€çš„ä¸€äº›ä½“ç°</p>
<p> å°è£…ï¼šå°è£…çš„ç›®çš„æ˜¯å°†ä¿¡æ¯éšè—  </p>
<p> å°è£…æ•°æ®<br> å°è£…å®ç°<br> å°è£…ç±»å‹<br> å°è£…å˜åŒ–<br>         æŠŠç³»ç»Ÿä¸­ä¸å˜çš„å’Œå˜çš„åˆ†ç¦»å¼€ åªæ›¿æ¢å˜åŒ–çš„ å¦‚æœå˜åŒ–çš„ä¹Ÿæ˜¯å°è£…å¥½çš„ å°±å¥½æ›¿æ¢å¤šäº† ä¿è¯ç¨‹åºçš„ç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§</p>
<p> éšè—æ•°æ® éšè—å®ç°ç»†èŠ‚ è®¾è®¡ç»†èŠ‚ä»¥åŠéšè—å¯¹è±¡çš„ç±»å‹<br> å…¶ä»–å¯¹è±¡æˆ–è€…ç”¨æˆ·ä¸å…³å¿ƒä»–çš„å…·ä½“å®ç° å°è£…ä½¿å¯¹è±¡ä¹‹å‰çš„è€¦åˆå˜å¾—æ¾æ•£ å¯¹è±¡ä¹‹é—´åªæš´éœ²APiæ¥å£æ¥é€šä¿¡</p>
<h2 id="åŸå‹æ¨¡å¼å’ŒåŸºäºåŸå‹ç»§æ‰¿çš„Javascript-å¯¹è±¡ç³»ç»Ÿ"><a href="#åŸå‹æ¨¡å¼å’ŒåŸºäºåŸå‹ç»§æ‰¿çš„Javascript-å¯¹è±¡ç³»ç»Ÿ" class="headerlink" title="åŸå‹æ¨¡å¼å’ŒåŸºäºåŸå‹ç»§æ‰¿çš„Javascript å¯¹è±¡ç³»ç»Ÿ"></a><strong>åŸå‹æ¨¡å¼å’ŒåŸºäºåŸå‹ç»§æ‰¿çš„Javascript å¯¹è±¡ç³»ç»Ÿ</strong></h2><h5 id="ä½¿ç”¨å…‹éš†çš„åŸå‹æ¨¡å¼"><a href="#ä½¿ç”¨å…‹éš†çš„åŸå‹æ¨¡å¼" class="headerlink" title="ä½¿ç”¨å…‹éš†çš„åŸå‹æ¨¡å¼"></a>ä½¿ç”¨å…‹éš†çš„åŸå‹æ¨¡å¼</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Plane = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.blood=<span class="number">100</span>;</span><br><span class="line">	<span class="keyword">this</span>.ss = <span class="number">11</span>;</span><br><span class="line">	<span class="keyword">this</span>.tt =<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> plane = <span class="keyword">new</span> Plane();  </span><br><span class="line"></span><br><span class="line">	<span class="built_in">Object</span>.create = <span class="built_in">Object</span>.create ||<span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</span><br><span class="line">		 F.prototype= value;</span><br><span class="line">		 <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> clonePlane = <span class="built_in">Object</span>.create(plane)</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'clonePlane'</span>,clonePlane)</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'clonePlane'</span>,clonePlane.blood)  <span class="number">100</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'clonePlane'</span>,clonePlane.ss)  <span class="number">11</span></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'clonePlane'</span>,clonePlane.tt) <span class="number">2</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h5 id="javascriptçš„åŸå‹ç»§æ‰¿"><a href="#javascriptçš„åŸå‹ç»§æ‰¿" class="headerlink" title="javascriptçš„åŸå‹ç»§æ‰¿"></a>javascriptçš„åŸå‹ç»§æ‰¿</h5><p>æ‰€æœ‰çš„jså¯¹è±¡éƒ½æ˜¯ä»æŸä¸ªå¯¹è±¡ä¸Šå…‹éš†è€Œæ¥çš„</p>
<p> åŸå‹ç¼–ç¨‹èŒƒç¨‹çš„è§„åˆ™</p>
<ol>
<li><p>æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å¯¹è±¡</p>
<p>javascriptæ ¹å¯¹è±¡æ˜¯ <code>Object.prototype</code>ç©ºå¯¹è±¡</p>
</li>
</ol>
<pre><code><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;&#125;;</span><br></pre></td></tr></table></figure>
</code></pre><ol start="2">
<li>è¦å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ ä¸æ˜¯é€šè¿‡å®ä¾‹åŒ–ç±» è€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ä½œä¸ºä¸€ä¸ªåŸå‹å¹¶å…‹éš†ä»–</li>
</ol>
<p>å½“æˆ‘ä»¬è°ƒç”¨ <code>var obj1 = new Object();</code> å¼•æ“å†…éƒ¨ä¼šä»<code>Object.prototype</code>å…‹éš†ä¸€ä¸ªå¯¹è±¡å‡ºæ¥</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.name =name</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">'maying'</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">console</span>.log(p.name)</span><br><span class="line">	<span class="built_in">console</span>.log(p.getName())</span><br></pre></td></tr></table></figure>
<p>jsæ²¡æœ‰ç±»çš„æ¦‚å¿µ ä½†æ˜¯ä¸ºä»€ä¹ˆè¿˜è°ƒç”¨äº† <code>new Person(&#39;maying&#39;);</code></p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">åœ¨è¿™é‡ŒPerson å¹¶ä¸æ˜¯ç±» è€Œæ˜¯å‡½æ•°æ„é€ å™¨</span><br><span class="line">Javascriptçš„å‡½æ•°æ—¢å¯ä»¥ä½œä¸ºæ™®é€šå‡½æ•°è¢«è°ƒç”¨ ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°æ„é€ å™¨è¢«è°ƒç”¨</span><br><span class="line">å½“ä½¿ç”¨ <span class="keyword">new</span> <span class="type"></span>è¿ç®—ç¬¦æ¥è°ƒç”¨å‡½æ•°æ—¶ æ­¤æ—¶çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªæ„é€ å™¨</span><br><span class="line"></span><br><span class="line">ç”¨<span class="keyword">new</span><span class="type"></span>è¿ç®—ç¬¦æ¥åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ å®é™…ä¸Šä¹Ÿæ˜¯å…ˆå…‹éš† Object.prototype å¯¹è±¡</span><br></pre></td></tr></table></figure>
<p><strong>æŠ›å‡ºé—®é¢˜ï¼šjsé€šè¿‡ Object.prototypeå¾—åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡ ä½†å®é™…ä¸Šå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½çœŸæ­£çš„å…‹éš†äº†ä¸€ä¸ªå¯¹è±¡</strong></p>
<ol start="3">
<li>å¯¹è±¡ä¼šè®°ä½ä»–çš„åŸå‹</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">å°±javascript çœŸæ­£å®ç°æ¥è¯´å¹¶ä¸èƒ½è¯´å¯¹è±¡æœ‰åŸå‹ è€Œåªèƒ½è¯´æ˜¯å¯¹è±¡çš„æ„é€ å™¨æœ‰åŸå‹ å¯¹äºå¯¹è±¡æŠŠè¯·æ±‚å§”æ‰˜ç»™å®ƒè‡ªå·±çš„åŸå‹ æ›´å¥½çš„è¯´æ³•æ˜¯å¯¹è±¡æŠŠè¯·æ±‚å§”æ‰˜ç»™å®ƒçš„æ„é€ å™¨çš„åŸå‹ã€‚</span><br><span class="line"> é‚£ä¹ˆå¯¹è±¡æ˜¯å¦‚ä½•å§”æ‰˜ç»™å®ƒçš„æ„é€ å™¨çš„åŸå‹å‘¢</span><br><span class="line"></span><br><span class="line"> å¯¹è±¡é€šè¿‡ _proto_çš„éšè—å±æ€§æŒ‡å‘ &#123;Constructor&#125;.prototype</span><br><span class="line"></span><br><span class="line"> _proto_å°±æ˜¯è·Ÿæ„é€ å™¨çš„åŸå‹è”ç³»èµ·æ¥çš„çº½å¸¦</span><br><span class="line"></span><br><span class="line"> jsçš„å¯¹è±¡æœ€åˆéƒ½æ˜¯ç”±object.prototypeåˆ›å»ºçš„ ä½†æ˜¯å¯¹è±¡æ„é€ å™¨çš„åŸå‹å¹¶ä¸å±€é™äºobject.prototypeä¸Š äºŒæ˜¯å¯ä»¥åŠ¨æ€æŒ‡å®šå…¶ä»–å¯¹è±¡</span><br><span class="line"></span><br><span class="line"> åº”ç”¨</span><br><span class="line"> å½“å¯¹è±¡aéœ€è¦å€Ÿç”¨å¯¹è±¡bçš„èƒ½åŠ›æ—¶ å¯ä»¥æœ‰é€‰æ‹©æ€§çš„æŠŠå¯¹è±¡açš„æ„é€ å™¨çš„åŸå‹æŒ‡å‘å¯¹è±¡b ä»è€Œè¾¾åˆ°ç»§æ‰¿çš„æ•ˆæœ</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> A = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	 	<span class="keyword">this</span>.name=<span class="string">"buyiyang"</span></span><br><span class="line">	 &#125;</span><br><span class="line"></span><br><span class="line">	 A.prototype = &#123;</span><br><span class="line">	 	<span class="keyword">constructor</span>: A, //æ‰‹åŠ¨æŒ‡å®š ä¸æŒ‡å®šçš„è¯   console.log(A.prototype.<span class="keyword">constructor</span>)=object()</span><br><span class="line">	 	name:'maying'</span><br><span class="line">	 &#125;</span><br><span class="line"></span><br><span class="line"> var B = function()&#123;&#125;</span><br><span class="line"> B.prototype = <span class="keyword">new</span> A()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> a = <span class="keyword">new</span> A();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'a'</span>,a.name)</span><br><span class="line">  <span class="built_in">console</span>.log(A.prototype.constructor)  </span><br><span class="line"></span><br><span class="line">  <span class="comment">//  function()&#123;</span></span><br><span class="line">	 <span class="comment">// 	this.name="buyiyang"</span></span><br><span class="line">	 <span class="comment">// &#125;</span></span><br><span class="line">  <span class="built_in">console</span>.log(a.__proto__)    <span class="comment">// &#123;name: "maying",  constructor: Æ’&#125;</span></span><br><span class="line">  <span class="built_in">console</span>.log(A.prototype)  <span class="comment">// &#123;name: "maying", constructor: Æ’&#125;</span></span><br><span class="line"></span><br><span class="line">åŸå‹é“¾å¹¶ä¸æ˜¯æ— é™é•¿çš„</span><br><span class="line"></span><br><span class="line">å½“è¯·æ±‚è¾¾åˆ° A.prototypeï¼Œå¹¶ä¸”åœ¨ A.prototype ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ° address å±æ€§çš„æ—¶å€™ï¼Œ è¯·æ±‚ä¼šè¢«ä¼ é€’ç»™ A.prototype çš„æ„é€ å™¨åŸå‹ <span class="built_in">Object</span>.prototypeï¼Œæ˜¾ç„¶ <span class="built_in">Object</span>.prototype ä¸­ä¹Ÿæ²¡æœ‰ address å±æ€§ï¼Œä½† <span class="built_in">Object</span>.prototype çš„åŸå‹æ˜¯ <span class="literal">null</span>ï¼Œè¯´æ˜è¿™æ—¶å€™åŸå‹é“¾çš„åé¢å·²ç»æ²¡æœ‰åˆ«çš„èŠ‚ç‚¹äº†ã€‚ æ‰€ä»¥è¯¥æ¬¡è¯·æ±‚å°±åˆ°æ­¤æ‰“ä½ï¼Œa.address è¿”å› <span class="literal">undefined</span>ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡ <span class="built_in">Object</span>.create(<span class="literal">null</span>) å¯ä»¥åˆ›å»ºå‡ºæ²¡æœ‰åŸå‹çš„å¯¹è±¡</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">é€šè¿‡<span class="type">ES6</span> <span class="class"><span class="keyword">class</span> <span class="title">åˆ›å»ºå¯¹è±¡</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">	 <span class="title">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">	 	constructor(name)&#123;</span><br><span class="line">	 		<span class="keyword">this</span>.name = name</span><br><span class="line">	 	&#125;</span><br><span class="line">	 	getName()&#123;</span><br><span class="line">		 		<span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">		 	&#125;</span><br><span class="line">	 &#125;</span><br><span class="line">	 <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">	 	constructor(name)&#123;</span><br><span class="line">	 		<span class="comment">// console.log('this',this)</span></span><br><span class="line">	 		console.log(<span class="symbol">'supe</span>r',<span class="keyword">super</span>()) <span class="comment">//ä¸è°ƒç”¨ super() å°±æ²¡æœ‰ç»‘å®šthis super()åªèƒ½è°ƒç”¨ä¸€æ¬¡</span></span><br><span class="line">	 		<span class="comment">// Dog &#123;name: undefined&#125;</span></span><br><span class="line">	 		console.log(<span class="symbol">'thi</span>s',<span class="keyword">this</span>) <span class="comment">// Dog &#123;name: undefined&#125;</span></span><br><span class="line">	 		console.log(<span class="symbol">'nam</span>e',name)</span><br><span class="line">	 		<span class="comment">// super(name)</span></span><br><span class="line">	 	&#125;</span><br><span class="line">	 	speak()&#123;</span><br><span class="line">	 		<span class="keyword">return</span> <span class="symbol">'woo</span>f'</span><br><span class="line">	 	&#125;</span><br><span class="line">	 &#125;</span><br><span class="line">	 <span class="keyword">var</span> dog = <span class="keyword">new</span> <span class="type">Dog</span>(<span class="symbol">'scam</span>p')</span><br><span class="line"></span><br><span class="line">     console.log(dog.getName()+'----say-----'+dog.speak()) <span class="comment">//undefined----say-----woof</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>å¦‚æœå¯¹è±¡æ— æ³•å“åº”æŸä¸ªè¯·æ±‚ å®ƒä¼šæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™è‡ªå·±çš„åŸå‹</li>
</ol>
<h2 id="this-call-apply"><a href="#this-call-apply" class="headerlink" title="this call apply"></a><strong>this call apply</strong></h2><p><strong>this</strong><br>jsçš„thisæ€»æ˜¯æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ åœ¨è¿è¡Œæ—¶åŸºäºå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒåŠ¨æ€ç»‘å®šçš„ è€Œéå‡½æ•°è¢«å£°æ˜æ—¶çš„ç¯å¢ƒ</p>
<p>thisçš„æŒ‡å‘å¯ä»¥åˆ†ä¸ºä¸‹é¢å››ç§</p>
<p>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>æŒ‡å‘å½“å‰å¯¹è±¡</span><br></pre></td></tr></table></figure>
<p>ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>æŒ‡å‘<span class="built_in">window</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.name=<span class="string">'maying'</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span>  <span class="keyword">this</span>.name</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">console</span>.log(getName()) <span class="comment">//maying</span></span><br><span class="line"></span><br><span class="line">	æˆ–è€…</span><br><span class="line"></span><br><span class="line">		<span class="built_in">window</span>.name=<span class="string">'maying'</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> myObject = &#123;</span><br><span class="line">		name:<span class="string">'stven'</span>,</span><br><span class="line">		getName :<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="built_in">console</span>.log(<span class="string">'this'</span>,<span class="keyword">this</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> a = myObject.getName;</span><br><span class="line">	  <span class="built_in">console</span>.log(a()) <span class="comment">//maying æ­¤æ—¶ç”¨å¦å¤–ä¸€ä¸ªå˜é‡aæ¥å¼•ç”¨myObject.getName å¹¶ä¸”è°ƒç”¨ a() æ—¶ æ­¤æ—¶æ˜¯æ™®é€šå‡½æ•°çš„è°ƒç”¨å‡½æ•° thisæ˜¯æŒ‡å‘å…¨å±€çš„</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">console</span>.log(myObject.getName()) <span class="comment">// stven  getNameæ˜¯ä½œä¸ºå¯¹è±¡çš„å±æ€§è¢«è°ƒç”¨çš„ æ­¤æ—¶çš„thisæŒ‡å‘ myObject</span></span><br><span class="line"></span><br><span class="line">	åœ¨ES5 çš„ strictæ¨¡å¼ä¸‹ <span class="keyword">this</span>å·²ç»è¢«è§„å®šä¸ºä¸ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡ è€Œæ˜¯<span class="literal">undefined</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123; <span class="string">"use strict"</span></span><br><span class="line">    alert ( <span class="keyword">this</span> );</span><br><span class="line">    func();</span><br></pre></td></tr></table></figure>
<p>æ„é€ å™¨è°ƒç”¨<br>å½“ä½¿ç”¨newè¿ç®—ç¬¦è°ƒç”¨å‡½æ•°æ—¶ è¯¥å‡½æ•°æ€»ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡<br>é€šå¸¸æƒ…å†µä¸‹ æ„é€ å™¨é‡Œçš„thiså°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡<br>å¦‚æœ æ„é€ å™¨æ˜¾ç¤ºè¿”å›äº†ä¸€ä¸ªobjectç±»å‹çš„å¯¹è±¡ é‚£ä¹ˆæ­¤æ¬¡å…ƒç®—ç»“æœæœ€ç»ˆä¼šè¿”å›è¿™ä¸ªå¯¹è±¡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> Preson = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	 	<span class="keyword">this</span>.name=<span class="string">'maying'</span></span><br><span class="line">	 	<span class="keyword">return</span> &#123;</span><br><span class="line">	 		name:<span class="string">'anne'</span></span><br><span class="line">	 	&#125;</span><br><span class="line"></span><br><span class="line">	 &#125;</span><br><span class="line"></span><br><span class="line">	   <span class="keyword">var</span> p =<span class="keyword">new</span> Preson()</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'p'</span>,p.name)  <span class="comment">//anne</span></span><br><span class="line"></span><br><span class="line">     å¦‚æœä¸æ˜¾ç¤ºè¿”å›æ•°æ®ä¼šè¿™è¿”å›ä¸€ä¸ªéå¯¹è±¡çš„ç±»å‹ æ„é€ å™¨é‡Œçš„<span class="keyword">this</span>å°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡</span><br><span class="line"></span><br><span class="line">     	 <span class="keyword">var</span> Preson = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	 	<span class="keyword">this</span>.name=<span class="string">'maying'</span></span><br><span class="line">	 	<span class="keyword">return</span> <span class="string">'swe'</span>	 	</span><br><span class="line">	 &#125;</span><br><span class="line">	  <span class="keyword">var</span> p =<span class="keyword">new</span> Preson()</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'p'</span>,p.name)  <span class="comment">//maying</span></span><br></pre></td></tr></table></figure>
<p><code>Function.prototype.call</code> æˆ–è€… <code>Function.prototype.apply</code>è°ƒç”¨</p>
<p> ä½œç”¨ï¼šå¯ä»¥åŠ¨æ€åœ°æ”¹å˜ä¼ å…¥å‡½æ•°çš„this<br> ES3ç»™FunctionåŸå‹å®šä¹‰çš„ä¸¤ä¸ªæ–¹æ³•<br> call å’ŒapplyåŒºåˆ«åªæ˜¯åœ¨ä¼ é€’å‚æ•°çš„ä¸åŒ</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="function"><span class="keyword">func</span> = <span class="title">function</span><span class="params">( a, b, <span class="built_in">c</span> )</span></span>&#123;</span><br><span class="line">alert ( [ a, b, <span class="built_in">c</span> ] ); <span class="comment">// è¾“å‡º [ 1, 2, 3 ]</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">func</span>.<span class="title">apply</span><span class="params">( null, [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ] )</span></span>;</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå‡½æ•°ä½“å†…thisçš„æŒ‡å‘ ä¼ nullæ—¶ æŒ‡å‘ é»˜è®¤çš„å®¿ä¸»å¯¹è±¡ æµè§ˆå™¨é»˜è®¤window</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼š æ•°ç»„æˆ–è€…ç±»æ•°ç»„ applyæ–¹æ³•æŠŠè¿™ä¸ªé›†åˆä¸­çš„å…ƒç´ ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="function"><span class="keyword">func</span> = <span class="title">function</span><span class="params">( a, b, <span class="built_in">c</span> )</span></span>&#123;</span><br><span class="line">alert ( [ a, b, <span class="built_in">c</span> ] ); <span class="comment">// è¾“å‡º [ 1, 2, 3 ]</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">func</span>.<span class="title">call</span><span class="params">( null, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> )</span></span>;</span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå‡½æ•°ä½“å†…thisçš„æŒ‡å‘</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼šç¬¬äºŒä¸ªå‚æ•°å¼€å§‹å¾€åï¼Œæ¯ä¸ªå‚æ•°è¢«ä¾æ¬¡ä¼ å…¥å‡½æ•°</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">		name:<span class="string">'maying'</span>,</span><br><span class="line">		getInfo :<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">		name:<span class="string">'anne'</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	  <span class="built_in">console</span>.log(<span class="string">'obj1'</span>,obj1.getInfo()) <span class="comment">//maying</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'obj2'</span>,obj1.getInfo.call(obj2)) <span class="comment">//anne æ­¤åˆ»getInfoå‡½æ•°ä½“å†…çš„thisæŒ‡å‘obj2å¯¹è±¡</span></span><br><span class="line">    ç›¸å½“äº</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">		name:<span class="string">'maying'</span>,</span><br><span class="line">		getInfo :<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> obj2.name</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">Math</span>.max.apply( <span class="literal">null</span>, [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span> ] ) <span class="comment">// è¾“å‡º:5</span></span><br></pre></td></tr></table></figure>
<p><code>Function.prototype.bind()</code><br> ç”¨æ¥æŒ‡å®šå‡½æ•°å†…éƒ¨çš„thisæŒ‡å‘</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">     <span class="comment">// jsåŸç”Ÿæ¨¡æ‹Ÿ Function.prototype.bind å‡½æ•°å®ç°</span></span><br><span class="line"> Function.prototype.bind =  function(context)&#123;</span><br><span class="line"> 	  <span class="keyword">var</span> self = <span class="keyword">this</span> <span class="comment">//thiså½“å‰æŒ‡å‘ funå‡½æ•°</span></span><br><span class="line"> 	  console.log(<span class="string">'self'</span>,self)</span><br><span class="line"> 	  <span class="keyword">return</span> function()&#123;</span><br><span class="line"> 	 	<span class="keyword">return</span> self.apply(context,arguments)</span><br><span class="line"> 	 	<span class="comment">// å°†funå‡½æ•°å†…éƒ¨çš„thisæŒ‡å‘obj</span></span><br><span class="line"> 	 	<span class="comment">// ç›¸å½“äº function()&#123;</span></span><br><span class="line">				<span class="comment">//  console.log('obj1.name',obj1.name)</span></span><br><span class="line">				<span class="comment">// &#125;</span></span><br><span class="line"> 	  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">	name:<span class="string">'maxiaoyin'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="function"><span class="keyword">fun</span> = <span class="title">function</span><span class="params">()</span></span>&#123;</span><br><span class="line"> console.log(<span class="string">'this.name'</span>,<span class="keyword">this</span>.name)</span><br><span class="line">&#125;.bind(obj1)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">fun</span><span class="params">()</span></span>; <span class="comment">//maxiaoyin</span></span><br></pre></td></tr></table></figure>
<p>å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•å®ç°ç»§æ‰¿</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">     	<span class="keyword">this</span>.name=<span class="string">'maying'</span></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     	A.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>)</span><br><span class="line">     	<span class="keyword">this</span>.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     		<span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">     	&#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">var</span> b = <span class="keyword">new</span> B();</span><br><span class="line"></span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'b'</span>,b.getName()) <span class="comment">//maying</span></span><br></pre></td></tr></table></figure>
<p>æƒ³å¾€ arguments ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ </p>
<figure class="highlight scheme"><table><tr><td class="code"><pre><span class="line"> (<span class="name">function</span> abc ()&#123;</span><br><span class="line"> 		// arguments.push(<span class="symbol">'1</span>') å› ä¸ºargumentsä¸æ˜¯æ•°ç»„ æ²¡åŠæ³•æ‰§è¡Œæ•°ç»„æœ‰çš„pushæ–¹æ³•</span><br><span class="line"> 	    // [].push.call(<span class="name">arguments</span>,<span class="symbol">'1</span>') æˆ–è€…</span><br><span class="line"> 	    Array.prototype.push.call(<span class="name">arguments</span>,<span class="symbol">'7</span>')</span><br><span class="line">     	console.log(<span class="symbol">'arguments</span>',arguments)</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   å†æ“ä½œ arguments æ—¶å€™ æˆ‘ä»¬é€šå¸¸ä¼šå€Ÿç”¨</span><br><span class="line">Array.prototypeçš„å„ç§æ–¹æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Array.prototype.push å®é™…ä¸Šæ˜¯å±æ€§å¤åˆ¶çš„è¿‡ç¨‹</span><br><span class="line"> å¯ä»¥æ¨æ–­ æˆ‘ä»¬å¯ä»¥æŠŠ**ä»»æ„**çš„å¯¹è±¡ ä¼ å…¥  Array.prototype.push</span><br><span class="line"></span><br><span class="line"> è¿™ä¸ªä»»æ„çš„é™åˆ¶</span><br><span class="line"> å¯¹è±¡æœ¬èº«å¯ä»¥å­˜å–ä¹¦é¦™</span><br><span class="line"> å¯¹è±¡çš„lengthå¯è¯»å†™</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> var a= &#123;&#125;</span><br><span class="line"> Array.prototype.push.call(<span class="name">a</span>,<span class="symbol">'first</span>')</span><br><span class="line"> console.log(<span class="name">a</span>) //&#123;<span class="number">0</span>: <span class="string">"first"</span>, length: <span class="number">1</span>&#125;</span><br><span class="line"> console.log(<span class="name">a</span> instanceof Object) //true</span><br><span class="line"> console.log(<span class="name">a</span>[<span class="name">0</span>]) // å¹¶éæ•°ç»„çš„ç”¨æ³• first</span><br></pre></td></tr></table></figure>
<h3 id="é—­åŒ…å’Œé«˜é˜¶å‡½æ•°"><a href="#é—­åŒ…å’Œé«˜é˜¶å‡½æ•°" class="headerlink" title="é—­åŒ…å’Œé«˜é˜¶å‡½æ•°"></a>é—­<strong>åŒ…å’Œé«˜é˜¶å‡½æ•°</strong></h3><p>jsçš„å‡½æ•°ä½œç”¨åŸŸ å°±åƒä¸€å±‚åŠé€æ˜çš„ç»ç’ƒ ä»é‡Œé¢å¯ä»¥çœ‹åˆ°å¤–é¢ ä»å¤–é¢ä¸èƒ½çœ‹åˆ°é‡Œé¢<br>å˜é‡çš„æœç´¢æ˜¯ä»å†…å¾€å¤–è€Œä¸æ˜¯ä»å¤–å¾€å†…çš„</p>
<p>å¸¦æœ‰varå…³é”®å­—çš„å±€éƒ¨å˜é‡ ä¼šéšç€å‡½æ•°è°ƒç”¨çš„ç»“æŸè€Œé”€æ¯</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜</span><br><span class="line">	  &lt;div&gt;<span class="number">1</span>&lt;/div&gt;</span><br><span class="line">	  &lt;div&gt;<span class="number">2</span>&lt;/div&gt;</span><br><span class="line">	  &lt;div&gt;<span class="number">3</span>&lt;/div&gt;</span><br><span class="line">	  &lt;div&gt;<span class="number">4</span>&lt;/div&gt;</span><br><span class="line">	  &lt;div&gt;<span class="number">5</span>&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">	var nodes = document.getElementsByTagName( <span class="string">'div'</span> );</span><br><span class="line">	<span class="keyword">for</span> ( var <span class="built_in">i</span> = <span class="number">0</span>, len = nodes.<span class="built_in">length</span>; <span class="built_in">i</span> &lt; len; <span class="built_in">i</span>++ )&#123;</span><br><span class="line"></span><br><span class="line">			 nodes[ <span class="built_in">i</span> ].onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></span><br><span class="line"></span><br><span class="line">				alert ( <span class="built_in">i</span> );</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">ç»“æœæ˜¯æ¯æ¬¡éƒ½æ˜¯<span class="number">5</span></span><br><span class="line">åŸå› æ˜¯ï¼š divçš„clickæ˜¯è¢«å¼‚æ­¥è§¦å‘çš„ å½“<span class="keyword">for</span>å¾ªç¯è¢«è§¦å‘çš„æ—¶å€™ <span class="keyword">for</span>å¾ªç¯æ—©å·²ç»ç»“æŸ æ­¤æ—¶<span class="built_in">i</span>å˜é‡çš„å€¼å·²ç»æ˜¯<span class="number">5</span>äº† è¿™ä¸ªæ—¶å€™ clickäº‹ä»¶çš„å‡½æ•°é¡ºç€ä½œç”¨åŸŸé“¾å‘ä¸Šæ‰¾å˜é‡<span class="built_in">i</span>çš„æ—¶å€™ æ‰¾åˆ°çš„å§‹ç»ˆæ˜¯<span class="number">5</span></span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹å¼</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> ( var <span class="built_in">i</span> = <span class="number">0</span>, len = nodes.<span class="built_in">length</span>; <span class="built_in">i</span> &lt; len; <span class="built_in">i</span>++ )&#123;</span><br><span class="line">            (<span class="function"><span class="keyword">function</span><span class="params">(i)</span>&#123;</span></span><br><span class="line">            	       console.<span class="built_in">log</span>(<span class="string">'i'</span>,<span class="built_in">i</span>)</span><br><span class="line">	            	   nodes[ <span class="built_in">i</span> ].onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;</span></span><br><span class="line">					   alert ( <span class="built_in">i</span> );</span><br><span class="line">			       &#125;</span><br><span class="line">            &#125;)(<span class="built_in">i</span>)</span><br><span class="line">	&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>é—­åŒ…çš„ä½œç”¨</strong></p>
<ol>
<li>å°è£…å˜é‡<br>é—­åŒ…å¯ä»¥æŠŠä¸€äº›ä¸éœ€è¦æš´æ¼åœ¨å…¨å±€çš„å˜é‡å°è£…æˆç§æœ‰å˜é‡</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">æ”¹é€ ä¹‹å‰</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cache = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.join.call( <span class="built_in">arguments</span>, <span class="string">','</span> );</span><br><span class="line"></span><br><span class="line">		 <span class="keyword">if</span> ( cache[ args ] )&#123;</span><br><span class="line">		   <span class="keyword">return</span> cache[ args ];</span><br><span class="line">		  &#125;</span><br><span class="line">       <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="built_in">arguments</span>.length; i &lt; l; i++ )&#123;</span><br><span class="line"></span><br><span class="line">		    a = a * <span class="built_in">arguments</span>[i];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> cache[ args ] = a;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">alert ( mult( <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> ) );</span><br><span class="line">alert ( mult( <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> ) );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ”¹é€ åŸç†ï¼šå¦‚æœå¤§å‡½æ•°é‡Œé¢åˆå¯ä»¥å¤ç”¨çš„å°å‡½æ•° å¯ä»¥æç‚¼å‡ºæ¥ ä½†æ˜¯è¿™äº›å°å‡½æ•°ä¸éœ€è¦åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨çš„è¯æœ€å¥½ç”¨é—­åŒ…å°é—­èµ·æ¥</span><br><span class="line">æ”¹é€ ä¹‹å</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> mult = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">          <span class="keyword">var</span> cache=&#123;&#125;</span><br><span class="line"></span><br><span class="line">	 	  <span class="keyword">var</span> calculate = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			    	<span class="keyword">var</span> a =<span class="number">1</span>;</span><br><span class="line">			    	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>;i&lt;<span class="built_in">arguments</span>.length; i++)&#123;</span><br><span class="line">			    		a = a *<span class="built_in">arguments</span>[i];</span><br><span class="line">			    	 &#125;   </span><br><span class="line">		            <span class="keyword">return</span> a;</span><br><span class="line">	 	  &#125;</span><br><span class="line"></span><br><span class="line">	 	  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	 	  	     <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>,<span class="string">','</span>)</span><br><span class="line">		         <span class="comment">// å¦‚æœå­˜åœ¨çš„è¯</span></span><br><span class="line">			 	 <span class="keyword">if</span>(cache[args])&#123;</span><br><span class="line">			 		 	<span class="keyword">return</span>  cache[args]</span><br><span class="line">			 	  &#125;</span><br><span class="line">			 	  <span class="keyword">return</span> cache[args] = 	calculate.apply(<span class="built_in">window</span>,<span class="built_in">arguments</span>)    </span><br><span class="line"> &#125;&#125;)();</span><br><span class="line"> <span class="built_in">console</span>.log(mult(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<p>2.å»¶ç»­å±€éƒ¨å˜é‡çš„å¯¿å‘½</p>
<p><strong>é—­åŒ…å’Œé¢å‘å¯¹è±¡çš„è®¾è®¡</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// ç”¨é—­åŒ…å®ç°ä¸€ä¸ªé¢å‘å¯¹è±¡ç³»ç»Ÿ</span></span><br><span class="line"> <span class="keyword">var</span> extent = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> 	  <span class="keyword">var</span> value = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            call: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                   value++;</span><br><span class="line">                   <span class="built_in">console</span>.log( value );</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">// é¢å‘å¯¹è±¡çš„å†™æ³•</span></span><br><span class="line"></span><br><span class="line">     <span class="keyword">var</span> extend = &#123;</span><br><span class="line">     	<span class="keyword">this</span>.value = <span class="number">0</span>;</span><br><span class="line">     	<span class="keyword">this</span>.call = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     		<span class="keyword">this</span>.value ++;</span><br><span class="line">     		<span class="built_in">console</span>.log(<span class="string">'this.value'</span>,<span class="keyword">this</span>.value)</span><br><span class="line">     	&#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Extend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.value = <span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line">Extend.prototype.call=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.value ++;</span><br><span class="line">     		<span class="built_in">console</span>.log(<span class="string">'this.value'</span>,<span class="keyword">this</span>.value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é«˜é˜¶å‡½æ•°</strong><br>æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€<br>å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°è¢«ä¼ é€’<br>å‡½æ•°å¯ä»¥ä½œä¸ºè¿”å›å€¼è¾“å‡º</p>
<p>åˆ¤æ–­æ•°æ®çš„ç±»å‹</p>
<p>Object.prototype.toString.call<br>å¯¹è±¡çš„åŸç”Ÿæ‰©å±•å‡½æ•° æ›´ç²¾ç¡®çš„åŒºåˆ†æ•°æ®ç±»å‹</p>
<p>15.2.4.2 Object.prototype.toString()<br>åœ¨toStringæ–¹æ³•è¢«è°ƒç”¨æ—¶,ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œæ­¥éª¤:</p>
<ol>
<li><p>è·å–thiså¯¹è±¡çš„[[Class]]å±æ€§çš„å€¼ã€‚</p>
</li>
<li><p>è®¡ç®—å‡ºä¸‰ä¸ªå­—ç¬¦ä¸²â€[object â€œ, ç¬¬ä¸€æ­¥çš„æ“ä½œç»“æœResult(1), ä»¥åŠ â€œ]â€è¿æ¥åçš„æ–°å­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>è¿”å›ç¬¬äºŒæ­¥çš„æ“ä½œç»“æœResult(2)ã€‚<br>[[Class]]æ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§,æ‰€æœ‰çš„å¯¹è±¡(åŸç”Ÿå¯¹è±¡å’Œå®¿ä¸»å¯¹è±¡)éƒ½æ‹¥æœ‰è¯¥å±æ€§.åœ¨è§„èŒƒä¸­,[[Class]]æ˜¯è¿™ä¹ˆå®šä¹‰çš„:<br>å†…éƒ¨å±æ€§ æè¿°<br>[[Class]] ä¸€ä¸ªå­—ç¬¦ä¸²å€¼,è¡¨æ˜äº†è¯¥å¯¹è±¡çš„ç±»å‹ã€‚<br>å…¶è¿‡ç¨‹ç®€å•è¯´æ¥å°±æ˜¯ï¼š1ã€è·å–å¯¹è±¡çš„ç±»åï¼ˆå¯¹è±¡ç±»å‹ï¼‰ã€‚2ã€ç„¶åå°†[objectã€è·å–çš„ç±»åã€]ç»„åˆå¹¶è¿”å›ã€‚</p>
</li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"> <span class="selector-tag">Object</span><span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>( <span class="selector-attr">[1,2,3]</span> )</span><br><span class="line">"<span class="selector-attr">[object Array]</span>"</span><br></pre></td></tr></table></figure>
<p><strong>åˆ¤æ–­æ•°æ®çš„ç±»å‹</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> isType = <span class="function"><span class="keyword">function</span>(<span class="params"> type </span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>)</span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="built_in">Object</span>.prototype.toString.call( obj ) === <span class="string">'[object '</span>+ type +<span class="string">']'</span>;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isString = isType( <span class="string">'String'</span> );</span><br><span class="line"> <span class="keyword">var</span> isArray = isType( <span class="string">'Array'</span> );</span><br><span class="line"> <span class="keyword">var</span> isNumber = isType( <span class="string">'Number'</span> );</span><br><span class="line"><span class="built_in">console</span>.log( isArray( [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ] ) );</span><br></pre></td></tr></table></figure>
<p>é«˜é˜¶å‡½æ•°å®ç°AOP<br>ï¼ˆAOPï¼‰é¢å‘åˆ‡é¢ç¼–ç¨‹ ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸€äº›è·Ÿæ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„ä»£ç æŠ½ç¦»å‡ºæ¥</p>
<p>å‡½æ•°èŠ‚æµ</p>
<p>å‡½æ•°è¢«é¢‘ç¹è°ƒç”¨çš„åœºæ™¯<br>window.onresize äº‹ä»¶<br>mousemove äº‹ä»¶<br>å›¾ç‰‡æˆ–è€…è§†é¢‘çš„ä¸Šä¼ è¿›åº¦</p>
<p>å‡½æ•°èŠ‚æµçš„åŸç†</p>
<p> setTimeout æ¥å®Œæˆè¿™ä»¶äº‹æƒ…</p>
<p> åˆ†æ—¶å‡½æ•°<br> æƒ°æ€§åŠ è½½å‡½æ•°</p>
<h2 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title=" è®¾è®¡æ¨¡å¼"></a><strong> è®¾è®¡æ¨¡å¼</strong></h2><h5 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h5><p>å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®ä»–çš„å…¨å±€è®¿é—®ç‚¹</p>
<h6 id="å®ç°å•ä¾‹æ¨¡å¼"><a href="#å®ç°å•ä¾‹æ¨¡å¼" class="headerlink" title="å®ç°å•ä¾‹æ¨¡å¼"></a>å®ç°å•ä¾‹æ¨¡å¼</h6><p> åŸç†ï¼š ç”¨ä¸€ä¸ªå¯¹è±¡æ¥è¡¨ç¤ºå½“å‰æ˜¯å¦å·²ç»ä¸ºè¿™ä¸ªç±»åˆ›å»ºè¿‡å¯¹è±¡ï¼Œå¦‚æœæ˜¯ åˆ™åœ¨ä¸‹ä¸€æ¬¡è·å–è¯¥ç±»çš„å®ä¾‹çš„æ—¶ ç›´æ¥è¿”å›ä¹‹å‰åˆ›å»ºçš„å¯¹è±¡</p>
<figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">  var Singleton = function(name)&#123;</span><br><span class="line">  	this.name=name,</span><br><span class="line">  	this.create = null;</span><br><span class="line">  &#125;</span><br><span class="line">Singleton.prototype.sayName = function()&#123;</span><br><span class="line">  console.log(this.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var sayFn = function(name)&#123;</span><br><span class="line">	if(!this.create)&#123;</span><br><span class="line">		this.create =<span class="built_in"> new </span>Singleton(name)</span><br><span class="line">	&#125;</span><br><span class="line">   <span class="built_in"> return </span>this.create</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var a = sayFn('maxiaoying').sayName(); //maxiaoying</span><br><span class="line">var b = sayFn('lujing').sayName() //maxiaoying</span><br><span class="line">console.log(a ===b).  //true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¦ä¸€ç§é—­åŒ…çš„å®ç°æ–¹å¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var Sngal = function(name)&#123;</span><br><span class="line">	this.name=name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Sngal.prototype.sayname =function()&#123;</span><br><span class="line">     consoel.log('this.name',this.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// var getName= function()&#123;</span><br><span class="line">// 	var<span class="built_in"> instance </span>= null;</span><br><span class="line">// <span class="built_in">	return </span>function(name)&#123;</span><br><span class="line">// 		if(!instance)&#123;</span><br><span class="line">// 		<span class="built_in">	instance </span>=<span class="built_in"> new </span>Sngal(name)</span><br><span class="line">// 		&#125;</span><br><span class="line">// 	<span class="built_in">	return </span> instance</span><br><span class="line">// 	&#125;</span><br><span class="line">// &#125;(name);</span><br><span class="line"></span><br><span class="line">// æˆ–è€…</span><br><span class="line"></span><br><span class="line">var getName= function()&#123;</span><br><span class="line">	var<span class="built_in"> instance </span>= null;</span><br><span class="line"><span class="built_in">	return </span>function(name)&#123;</span><br><span class="line">		if(!instance)&#123;</span><br><span class="line">		<span class="built_in">	instance </span>=<span class="built_in"> new </span>Sngal(name)</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">	return </span> instance</span><br><span class="line">	&#125;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">å…ˆè®©getName è‡ªæ‰§è¡Œæ‰èƒ½å¾—åˆ°  ç„¶åæ¥æ”¶å‚æ•° ç†è§£é—­åŒ…</span><br><span class="line">	-------------------------------------</span><br><span class="line">return function(name)&#123;</span><br><span class="line">		if(!instance)&#123;</span><br><span class="line">		<span class="built_in">	instance </span>=<span class="built_in"> new </span>Sngal(name)</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="built_in">	return </span> instance</span><br><span class="line">	&#125;</span><br><span class="line">	-------------------------------------</span><br><span class="line">var a = getName('maxiaogiou');</span><br><span class="line">console.log('a',a)</span><br><span class="line">var b = getName('xiaoxioamao');</span><br><span class="line">console.log('b',b)</span><br><span class="line">console.log('a ===b',a===b)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>js</tag>
        <tag>design_mode</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨¡æ‹Ÿå®ç°JSçš„newæ“ä½œç¬¦</title>
    <url>/2019/03/13/new/</url>
    <content><![CDATA[<p><code>JS</code>ä¸­ <code>new</code>å…³é”®å­—ç”¨æ¥å®ä¾‹åŒ–æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒèƒŒååˆ°åº•åšäº†ä»€ä¹ˆ,èƒ½å¦è¢«æ¨¡æ‹Ÿå®ç°<br>ç­”æ¡ˆæ˜¯è‚¯å®šçš„</p>
<h2 id="newå…³é”®å­—åšäº†ä»€ä¹ˆ"><a href="#newå…³é”®å­—åšäº†ä»€ä¹ˆ" class="headerlink" title="newå…³é”®å­—åšäº†ä»€ä¹ˆ"></a>newå…³é”®å­—åšäº†ä»€ä¹ˆ</h2><p>ä½ ä¸€å®šä»åˆ«çš„æ–‡ç« æˆ–è€…åœ¨å®é™…å¼€å‘ä¸­æ„Ÿå—åˆ°<code>new</code>çš„å¦™å¤„ï¼Œä¸é”™,æ€»ç»“ä¸‹æ¥å®ƒä¸»è¦æ”¯æŒäº†å››ä¸ªåŠŸèƒ½</p>
<a id="more"></a>
<ol>
<li>åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡</li>
<li>è¿™ä¸ªå¯¹è±¡ä¼šè¢«æ‰§è¡Œ[[prototype]]ï¼ˆä¹Ÿå°±æ˜¯<strong>proto</strong>ï¼‰é“¾æ¥</li>
<li>ç”Ÿæˆçš„æ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„this</li>
<li>é€šè¿‡<code>new</code>åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡å°†æœ€ç»ˆè¢«æ¥æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„prototypeå¯¹è±¡ä¸Š</li>
<li>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹Object(åŒ…å«Functoin, Array, Date, RegExg, Error)ï¼Œé‚£ä¹ˆnewè¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°çš„å¯¹è±¡</li>
</ol>
<h2 id="æ¨¡æ‹Ÿå®ç°new"><a href="#æ¨¡æ‹Ÿå®ç°new" class="headerlink" title="æ¨¡æ‹Ÿå®ç°new"></a>æ¨¡æ‹Ÿå®ç°new</h2><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newOperator</span></span>(ctor)&#123;</span><br><span class="line">    <span class="keyword">if</span>(typeof ctor !== <span class="string">'function'</span>)&#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="string">'newOperator function the first param must be a function'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ES6 new.target æ˜¯æŒ‡å‘æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">new</span><span class="type">Operator</span>.target = ctor;</span><br><span class="line">    <span class="comment">// 1.åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œ</span></span><br><span class="line">    <span class="comment">// 2.å¹¶ä¸”æ‰§è¡Œ[[Prototype]]é“¾æ¥</span></span><br><span class="line">    <span class="comment">// 4.é€šè¿‡`new`åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡å°†æœ€ç»ˆè¢«`[[Prototype]]`é“¾æ¥åˆ°è¿™ä¸ªå‡½æ•°çš„`prototype`å¯¹è±¡ä¸Šã€‚</span></span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">new</span><span class="type">Obj</span> = Object.create(ctor.prototype);</span><br><span class="line">    <span class="comment">// ES5 argumentsè½¬æˆæ•°ç»„ å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ES6 [...arguments], Aarry.from(arguments);</span></span><br><span class="line">    <span class="comment">// é™¤å»ctoræ„é€ å‡½æ•°çš„å…¶ä½™å‚æ•°</span></span><br><span class="line">    <span class="keyword">var</span> argsArr = [].slice.call(arguments, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 3.ç”Ÿæˆçš„æ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„`this`ã€‚</span></span><br><span class="line">    <span class="comment">// è·å–åˆ°ctorå‡½æ•°è¿”å›ç»“æœ</span></span><br><span class="line">    <span class="keyword">var</span> ctorReturnResult = ctor.apply(<span class="keyword">new</span><span class="type">Obj</span>, argsArr);</span><br><span class="line">    <span class="comment">// å°ç»“4 ä¸­è¿™äº›ç±»å‹ä¸­åˆå¹¶èµ·æ¥åªæœ‰Objectå’ŒFunctionä¸¤ç§ç±»å‹ typeof null ä¹Ÿæ˜¯'object'æ‰€ä»¥è¦ä¸ç­‰äºnullï¼Œæ’é™¤null</span></span><br><span class="line">    <span class="keyword">var</span> isObject = typeof ctorReturnResult === <span class="string">'object'</span> &amp;&amp; ctorReturnResult !== <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> isFunction = typeof ctorReturnResult === <span class="string">'function'</span>;</span><br><span class="line">    <span class="keyword">if</span>(isObject || isFunction)&#123;</span><br><span class="line">        <span class="keyword">return</span> ctorReturnResult;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 5.å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹`Object`(åŒ…å«`Functoin`, `Array`, `Date`, `RegExg`, `Error`)ï¼Œé‚£ä¹ˆ`new`è¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span><span class="type">Obj</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å®ä¾‹éªŒè¯"><a href="#å®ä¾‹éªŒè¯" class="headerlink" title="å®ä¾‹éªŒè¯"></a>å®ä¾‹éªŒè¯</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="comment">// this.doSth();</span></span><br><span class="line">    <span class="comment">// return Error();</span></span><br><span class="line">&#125;</span><br><span class="line">Student.prototype.doSth = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> student1 = newOperator(Student, <span class="string">'è½©è¾•'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="keyword">var</span> student2 = newOperator(Student, <span class="string">'Rowboat'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="comment">// var student1 = new Student('è½©è¾•');</span></span><br><span class="line"><span class="comment">// var student2 = new Student('Rowboat');</span></span><br><span class="line"><span class="built_in">console</span>.log(student1, student1.doSth()); <span class="comment">// &#123;name: 'è½©è¾•'&#125; 'è½©è¾•'</span></span><br><span class="line"><span class="built_in">console</span>.log(student2, student2.doSth()); <span class="comment">// &#123;name: 'Rowboat'&#125; 'Rowboat'</span></span><br><span class="line"></span><br><span class="line">student1.__proto__ === Student.prototype; <span class="comment">// true</span></span><br><span class="line">student2.__proto__ === Student.prototype; <span class="comment">// true</span></span><br><span class="line"><span class="comment">// __proto__ æ˜¯æµè§ˆå™¨å®ç°çš„æŸ¥çœ‹åŸå‹æ–¹æ¡ˆã€‚</span></span><br><span class="line"><span class="comment">// ç”¨ES5 åˆ™æ˜¯ï¼š</span></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(student1) === Student.prototype; <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(student2) === Student.prototype; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>æ¨¡æ‹Ÿ<code>new</code>æœ€å¤§çš„åŠŸè‡£å½“å±äº<code>Object.create()</code>è¿™ä¸ªES5æä¾›çš„API</p>
<p><code>Object.create(proto, [propertiesObject])</code>æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥æä¾›æ–°åˆ›å»ºçš„å¯¹è±¡çš„<code>__proto__</code> å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸è¿‡ç¬¬äºŒä¸ªå¯é€‰å‚æ•°æ˜¯å±æ€§æè¿°ç¬¦ï¼ˆä¸å¸¸ç”¨ï¼Œé»˜è®¤æ˜¯<code>undefined</code>ï¼‰</p>
<p>å¯¹äºä¸æ”¯æŒES5çš„æµè§ˆå™¨ï¼ŒMDNä¸Šæä¾›äº†ployfillæ–¹æ¡ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Object</span>.create !== <span class="string">"function"</span>) &#123;</span><br><span class="line">    <span class="built_in">Object</span>.create = <span class="function"><span class="keyword">function</span> (<span class="params">proto, propertiesObject</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> proto !== <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> proto !== <span class="string">'function'</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Object prototype may only be an Object: '</span> + proto);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (proto === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument."</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> propertiesObject != <span class="string">'undefined'</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"This browser's implementation of Object.create is a shim and doesn't support a second argument."</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">        F.prototype = proto;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>##æ€»ç»“</p>
<p>æ¨¡æ‹Ÿnewæ´å‡€ç‰ˆ</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å»é™¤äº†æ³¨é‡Š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newOperator</span></span>(ctor)&#123;</span><br><span class="line">    <span class="keyword">if</span>(typeof ctor !== <span class="string">'function'</span>)&#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="string">'newOperator function the first param must be a function'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span><span class="type">Operator</span>.target = ctor;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">new</span><span class="type">Obj</span> = Object.create(ctor.prototype);</span><br><span class="line">    <span class="keyword">var</span> argsArr = [].slice.call(arguments, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> ctorReturnResult = ctor.apply(<span class="keyword">new</span><span class="type">Obj</span>, argsArr);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> isObject = typeof ctorReturnResult === <span class="string">'object'</span> &amp;&amp; ctorReturnResult !== <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> isFunction = typeof ctorReturnResult === <span class="string">'function'</span>;</span><br><span class="line">    <span class="keyword">if</span>(isObject || isFunction)&#123;</span><br><span class="line">        <span class="keyword">return</span> ctorReturnResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span><span class="type">Obj</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>Node.jså®æˆ˜-æŠ€æœ¯é¢„ç ”</title>
    <url>/2020/03/23/node/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»¥ä¸€ç§è¦å¼€å‘Node.jså®æˆ˜é¡¹ç›®ä¸ºæœ€ç»ˆç›®æ ‡<br>è¿›è¡Œä¸€ç³»åˆ—çš„æŠ€æœ¯é¢„ç ”è¿‡ç¨‹</p>
<p>æœ‰ç‰¹ç‚¹ï¼Œæœ‰é’ˆå¯¹æ€§ï¼Œæœ‰ç›®æ ‡</p>
<p>åŸ¹å…»Nodeé¢†åŸŸçš„å…¨å±€è§‚</p>
<h1 id="1-å…³äºNodejs"><a href="#1-å…³äºNodejs" class="headerlink" title="1 å…³äºNodejs"></a>1 å…³äºNodejs</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯Node-js"><a href="#1-1-ä»€ä¹ˆæ˜¯Node-js" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Node.js"></a>1.1 ä»€ä¹ˆæ˜¯Node.js</h2><p>å®˜ç½‘çš„è¯ï¼š</p>
<ul>
<li>Node.jsæ˜¯åŸºäºChromeV8æ‰§è¡Œå¼•æ“çš„JSè¿è¡Œæ—¶ç¯å¢ƒ</li>
<li>Node.jsä½¿ç”¨äº†ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ï¼Œéé˜»å¡å¼I/Oçš„æ¨¡å‹ï¼Œä½¿å…¶è½»é‡åˆé«˜æ•ˆ</li>
</ul>
<p>æ¯ä¸€ä¸ªå­—å…¶å®éƒ½çœ‹å¾—æ‡‚ï¼Œèšåˆåˆ°ä¸€èµ·å°±æœ‰ç‚¹æ‡µäº†</p>
<p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1584894283204&amp;di=6e87b25c91207a1929250f11285d3a2c&amp;imgtype=0&amp;src=http%3A%2F%2Fimg2.biaoqingjia.com%2Fbiaoqing%2F201608%2Fa70d12bb1f409850857c8d930cf2d6d1.gif" alt="image"></p>
<p>æˆ‘ä»¬å…ˆä¸æ¥è¯´nodejsæ˜¯ä»€ä¹ˆï¼Œå…ˆæ ¹æ®ä»¥å¾€çš„ç»éªŒæŠ›å‡ºé—®é¢˜</p>
<h3 id="1-1-1-åœ¨Node-jsé‡Œè¿è¡ŒJsè·Ÿåœ¨Chromeè¿è¡ŒJsæœ‰å•¥ä¸åŒï¼Ÿ"><a href="#1-1-1-åœ¨Node-jsé‡Œè¿è¡ŒJsè·Ÿåœ¨Chromeè¿è¡ŒJsæœ‰å•¥ä¸åŒï¼Ÿ" class="headerlink" title="1.1.1 åœ¨Node.jsé‡Œè¿è¡ŒJsè·Ÿåœ¨Chromeè¿è¡ŒJsæœ‰å•¥ä¸åŒï¼Ÿ"></a>1.1.1 åœ¨Node.jsé‡Œè¿è¡ŒJsè·Ÿåœ¨Chromeè¿è¡ŒJsæœ‰å•¥ä¸åŒï¼Ÿ</h3><p>å·²çŸ¥Chromeæµè§ˆå™¨ç”¨çš„æ˜¯åŒæ ·çš„Javascriptå¼•æ“å’Œæ¨¡å‹</p>
<blockquote>
<p>å…¶å®ï¼Œåœ¨Node.jsé‡Œå†™Jså’Œåœ¨Chromeé‡Œå†™Jsï¼Œ<font color="red">å‡ ä¹ä¸€æ ·</font></p>
</blockquote>
<p>æ™ƒçœ¼çš„<font color="red">å‡ ä¹ä¸€æ ·</font> é‚£å°±æ˜¯æœ‰ä¸ä¸€æ ·çš„åœ°æ–¹å‘—ï¼</p>
<ul>
<li>Nodejsæ²¡æœ‰æµè§ˆå™¨APIï¼Œå³(Document,windowç­‰)</li>
<li>ç›¸åº”çš„ï¼Œä¹Ÿå¢åŠ äº†å®ƒä¸“å±çš„APIï¼Œæ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿï¼Œè¿›ç¨‹.</li>
</ul>
<p>æœ‰äº†è¿™äº›å·®åˆ«ï¼Œå…¶å®å°±ä¸éš¾ç†è§£äº†</p>
<h4 id="å¯¹äºå¼€å‘è€…æ¥è¯´"><a href="#å¯¹äºå¼€å‘è€…æ¥è¯´" class="headerlink" title="å¯¹äºå¼€å‘è€…æ¥è¯´"></a>å¯¹äºå¼€å‘è€…æ¥è¯´</h4><ul>
<li>ä½ åœ¨chromeé‡Œå†™js<strong>æ§åˆ¶æµè§ˆå™¨</strong></li>
<li>Node.jsè®©ä½ ç”¨ç±»ä¼¼çš„æ–¹å¼ï¼Œ<strong>æ§åˆ¶æ•´ä¸ªè®¡ç®—æœº</strong></li>
</ul>
<p>Node.jsçš„çœŸè°›ï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹æŠ½è±¡çš„é‡Šä¹‰ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨ä¸æ–­æ·±å…¥çš„è¿‡ç¨‹ä¸­æ…¢æ…¢ç†è§£ï½</p>
<a id="more"></a>
<h2 id="1-2-Node-jså¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ"><a href="#1-2-Node-jså¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.2 Node.jså¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ"></a>1.2 Node.jså¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ</h2><h3 id="1-2-1-æä¾›WebæœåŠ¡"><a href="#1-2-1-æä¾›WebæœåŠ¡" class="headerlink" title="1.2.1 æä¾›WebæœåŠ¡"></a>1.2.1 æä¾›WebæœåŠ¡</h3><ul>
<li>æœç´¢å¼•æ“ä¼˜åŒ– + é¦–å±é€Ÿåº¦ä¼˜åŒ– = æœåŠ¡ç«¯æ¸²æŸ“</li>
<li>æœåŠ¡ç«¯æ¸²æŸ“ + å‰åç«¯åŒæ„ = Node.js</li>
</ul>
<h3 id="1-2-2-æ„å»ºå·¥ä½œæµ"><a href="#1-2-2-æ„å»ºå·¥ä½œæµ" class="headerlink" title="1.2.2 æ„å»ºå·¥ä½œæµ"></a>1.2.2 æ„å»ºå·¥ä½œæµ</h3><p>åœ¨<code>gulp webpack</code>ä¹‹é—´ï¼Œå‰ç«¯æ˜¯å¦‚ä½•åšæ„å»ºå·¥å…·å‘¢ï¼Ÿ</p>
<p>å¯èƒ½ç”¨java,rubyç­‰</p>
<p>ä½†</p>
<ul>
<li>æ„å»ºå·¥å…·ä¸ä¼šæ°¸è¿œä¸å‡ºé—®é¢˜</li>
<li>æ„å»ºå·¥å…·ä¸ä¼šæ°¸è¿œæ»¡è¶³éœ€æ±‚</li>
</ul>
<p>å‰ç«¯åŒå­¦å¾ˆéš¾å¯¹è¿™äº›å·¥å…·è¿›è¡Œä¿®æ”¹æˆ–è€…å‡çº§</p>
<p>æ‰€ä»¥</p>
<blockquote>
<p>ç”¨Node.jsåšjsçš„æ„å»ºå·¥å…·ï¼Œæ˜¯æœ€ä¿é™©çš„é€‰æ‹©</p>
</blockquote>
<h3 id="1-2-3-å¼€å‘å·¥å…·"><a href="#1-2-3-å¼€å‘å·¥å…·" class="headerlink" title="1.2.3 å¼€å‘å·¥å…·"></a>1.2.3 å¼€å‘å·¥å…·</h3><p>VScode</p>
<p>åœ¨nodejsçš„åŸºç¡€ä¸Šå°è£…äº†chromeçš„å†…æ ¸ï¼Œä½¿nodejså…·æœ‰æ§åˆ¶è®¡ç®—æœºå¾—åˆ°èƒ½åŠ›</p>
<h3 id="1-2-3-å¯æ‰©å±•æ€§è¾ƒå¼ºå¤§çš„æ²™ç›’æ¸¸æˆ"><a href="#1-2-3-å¯æ‰©å±•æ€§è¾ƒå¼ºå¤§çš„æ²™ç›’æ¸¸æˆ" class="headerlink" title="1.2.3 å¯æ‰©å±•æ€§è¾ƒå¼ºå¤§çš„æ²™ç›’æ¸¸æˆ"></a>1.2.3 å¯æ‰©å±•æ€§è¾ƒå¼ºå¤§çš„æ²™ç›’æ¸¸æˆ</h3><p>éœ€è¦ç»™ä½¿ç”¨è€…è‡ªå®šä¹‰æ¨¡å—çš„èƒ½åŠ›</p>
<p>ä½¿ç”¨Nodejsåšå¤æ‚çš„æœ¬åœ°åº”ç”¨</p>
<ul>
<li>å¯ä»¥åˆ©ç”¨jså¤§çš„çµæ´»æ€§å®ç°å¤–éƒ¨æ‰©å±•</li>
<li>Jsåºå¤§çš„çš„å¼€å‘è€…åŸºæ•°è®©ä»–ä»¬çš„çµæ´»æ€§å¾—åˆ°åˆ©ç”¨</li>
</ul>
<h3 id="1-2-4-å®¢æˆ·ç«¯åº”ç”¨"><a href="#1-2-4-å®¢æˆ·ç«¯åº”ç”¨" class="headerlink" title="1.2.4 å®¢æˆ·ç«¯åº”ç”¨"></a>1.2.4 å®¢æˆ·ç«¯åº”ç”¨</h3><p>åœ¨å·²æœ‰ç½‘ç«™çš„åŸºç¡€ä¸Šéœ€è¦å¼€å‘æ–°çš„å®¢æˆ·ç«¯åº”ç”¨<br>ä½¿ç”¨Node.jså®¢æˆ·ç«¯æŠ€æœ¯å®ç°ï¼Œå¯ä»¥æœ€å¤§é™åº¦çš„å¤ç”¨ç°æœ‰å·¥ç¨‹</p>
<h1 id="2-Node-js-åˆæ¢"><a href="#2-Node-js-åˆæ¢" class="headerlink" title="2 Node.js åˆæ¢"></a>2 Node.js åˆæ¢</h1><h2 id="2-1-å®ç°å‰ªåˆ€çŸ³å¤´å¸ƒ"><a href="#2-1-å®ç°å‰ªåˆ€çŸ³å¤´å¸ƒ" class="headerlink" title="2.1 å®ç°å‰ªåˆ€çŸ³å¤´å¸ƒ"></a>2.1 å®ç°å‰ªåˆ€çŸ³å¤´å¸ƒ</h2><ul>
<li>nodeè¿è¡Œæ–¹å¼æ¸¸æˆ</li>
<li>å…¨å±€å˜é‡</li>
</ul>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line">var <span class="attr">playerAction</span> = process.argv[process.argv.length - <span class="number">1</span>];</span><br><span class="line">console.log(<span class="string">"playerAction"</span>, playerAction);</span><br><span class="line"></span><br><span class="line">var <span class="attr">random1</span> = Math.random() * <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (random1 &lt; <span class="number">1</span>) &#123;</span><br><span class="line">  var <span class="attr">computerAction</span> = <span class="string">"rock"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (random1 &gt; <span class="number">2</span>) &#123;</span><br><span class="line">  var <span class="attr">computerAction</span> = <span class="string">"scissor"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  var <span class="attr">computerAction</span> = <span class="string">"paper"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="attr">computerAction</span> === playerAction) &#123;</span><br><span class="line">  console.log(<span class="string">"å¹³å±€"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">  (<span class="attr">computerAction</span> === <span class="string">"rock"</span> &amp;&amp; <span class="attr">playerAction</span> === <span class="string">"paper"</span>) ||</span><br><span class="line">  (<span class="attr">computerAction</span> === <span class="string">"scissor"</span> &amp;&amp; <span class="attr">playerAction</span> === <span class="string">"rock"</span>) ||</span><br><span class="line">  (<span class="attr">computerAction</span> === <span class="string">"paper"</span> &amp;&amp; <span class="attr">playerAction</span> === <span class="string">"scissor"</span>)</span><br><span class="line">) &#123;</span><br><span class="line">  console.log(<span class="string">"ä½ èµ¢äº†ï¼"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  console.log(<span class="string">"ä½ è¾“äº†ï¼"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-1-ä½¿ç”¨Node-jsæ¨¡å—è§„èŒƒæ”¹é€ æ¸¸æˆ"><a href="#2-1-ä½¿ç”¨Node-jsæ¨¡å—è§„èŒƒæ”¹é€ æ¸¸æˆ" class="headerlink" title="2.1 ä½¿ç”¨Node.jsæ¨¡å—è§„èŒƒæ”¹é€ æ¸¸æˆ"></a>2.1 ä½¿ç”¨Node.jsæ¨¡å—è§„èŒƒæ”¹é€ æ¸¸æˆ</h2><h3 id="2-1-1-å¦‚ä½•åŠ è½½js"><a href="#2-1-1-å¦‚ä½•åŠ è½½js" class="headerlink" title="2.1.1 å¦‚ä½•åŠ è½½js"></a>2.1.1 å¦‚ä½•åŠ è½½js</h3><p>æµè§ˆå™¨ç«¯</p>
<ul>
<li>ä½¿ç”¨<code>&lt;script/&gt;</code>æ ‡ç­¾</li>
<li>è„šæœ¬å˜å¤šæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç®¡ç†åŠ è½½é¡ºåº</li>
<li>ä¸åŒè„šæœ¬ä¹‹é—´çš„é€»è¾‘è°ƒç”¨éœ€è¦å…¨å±€å˜é‡</li>
</ul>
<p>Nodeç«¯</p>
<ul>
<li>æ²¡æœ‰htmlæ–‡ä»¶ï¼Œæ— æ³•ä½¿ç”¨<code>&lt;script/&gt;</code>æ ‡ç­¾</li>
</ul>
<p><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=45975645,3909583844&amp;fm=11&amp;gp=0.jpg" alt="image"></p>
<p>æ‰€ä»¥Node.js è¦é‡æ–°å»æä¸€ä¸ªæ¨¡å—ç®¡ç†æœºåˆ¶æ¥ç®¡ç†jsçš„åŠ è½½ï¼Œå°±æ˜¯ç°åœ¨æˆ‘ä»¬ç†Ÿæ‚‰çš„<font color="red">CommonJSè§„èŒƒ</font></p>
<h3 id="2-1-2-é‡æ„å‰ªåˆ€çŸ³å¤´å¸ƒæ¸¸æˆ"><a href="#2-1-2-é‡æ„å‰ªåˆ€çŸ³å¤´å¸ƒæ¸¸æˆ" class="headerlink" title="2.1.2 é‡æ„å‰ªåˆ€çŸ³å¤´å¸ƒæ¸¸æˆ"></a>2.1.2 é‡æ„å‰ªåˆ€çŸ³å¤´å¸ƒæ¸¸æˆ</h3><p>games.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">playerAction</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ([<span class="string">"rock"</span>, <span class="string">"scissor"</span>, <span class="string">"paper"</span>].indexOf(playerAction) == <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"invalid playerAction"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è®¡ç®—ç”µè„‘å‡ºçš„ä¸œè¥¿</span></span><br><span class="line">  <span class="keyword">var</span> computerAction;</span><br><span class="line">  <span class="keyword">var</span> random = <span class="built_in">Math</span>.random() * <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> (random &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    computerAction = <span class="string">"rock"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ç”µè„‘å‡ºäº†çŸ³å¤´"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (random &gt; <span class="number">2</span>) &#123;</span><br><span class="line">    computerAction = <span class="string">"scissor"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ç”µè„‘å‡ºäº†å‰ªåˆ€"</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    computerAction = <span class="string">"paper"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ç”µè„‘å‡ºäº†å¸ƒ"</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (computerAction == playerAction) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"å¹³å±€"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">    (computerAction == <span class="string">"rock"</span> &amp;&amp; playerAction == <span class="string">"scissor"</span>) ||</span><br><span class="line">    (computerAction == <span class="string">"scissor"</span> &amp;&amp; playerAction == <span class="string">"paper"</span>) ||</span><br><span class="line">    (computerAction == <span class="string">"paper"</span> &amp;&amp; playerAction == <span class="string">"rock"</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ä½ è¾“äº†"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"ä½ èµ¢äº†"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">const game = require(<span class="string">"./game.js"</span>);</span><br><span class="line"></span><br><span class="line">var winCount = <span class="number">0</span>;</span><br><span class="line"><span class="regexp">//</span> è·å–è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥</span><br><span class="line">process.stdin.on(<span class="string">"data"</span>, buffer =&gt; &#123;</span><br><span class="line">  <span class="regexp">//</span> å›è°ƒçš„æ˜¯bufferï¼Œéœ€è¦å¤„ç†æˆstring</span><br><span class="line">  const action = buffer.toString().trim();</span><br><span class="line">  const result = game(action);</span><br><span class="line">  <span class="keyword">if</span> (result == <span class="number">1</span>) &#123;</span><br><span class="line">    winCount++;</span><br><span class="line">    <span class="keyword">if</span> (winCount == <span class="number">3</span>) &#123;</span><br><span class="line">      console.log(<span class="string">"æˆ‘ä¸ç©å„¿äº†ï¼å“¼ï¼"</span>);</span><br><span class="line">      process.<span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="3-Nodeå†…ç½®æ¨¡å—"><a href="#3-Nodeå†…ç½®æ¨¡å—" class="headerlink" title="3 Nodeå†…ç½®æ¨¡å—"></a>3 Nodeå†…ç½®æ¨¡å—</h1><p><a href="http://nodejs.cn/api/" target="_blank" rel="noopener">å†…ç½®æ¨¡å—åˆé›†</a></p>
<h2 id="3-1-Node-jsç³»ç»Ÿæ¶æ„å›¾"><a href="#3-1-Node-jsç³»ç»Ÿæ¶æ„å›¾" class="headerlink" title="3.1 Node.jsç³»ç»Ÿæ¶æ„å›¾"></a>3.1 Node.jsç³»ç»Ÿæ¶æ„å›¾</h2><p><img src="http://cdn.anruence.com/node-system-1.png" alt="image"></p>
<h2 id="3-2-ç†è§£Node-jsç²¾é«“"><a href="#3-2-ç†è§£Node-jsç²¾é«“" class="headerlink" title="3.2 ç†è§£Node.jsç²¾é«“"></a>3.2 ç†è§£Node.jsç²¾é«“</h2><blockquote>
<p>Node.jsæ˜¯åŸºäºChromeV8æ‰§è¡Œå¼•æ“çš„JSè¿è¡Œæ—¶ç¯å¢ƒ</p>
</blockquote>
<p><font color="red">ChromeV8æ‰§è¡Œå¼•æ“çš„JSè¿è¡Œæ—¶ç¯å¢ƒ</font>ï¼šæ¶æ„å›¾çš„å·¦ä¾§éƒ¨åˆ†å°±æ˜¯å…¶ä½“ç°</p>
<ul>
<li>application ä»£è¡¨ä½ å†™çš„nodejsçš„ä»£ç </li>
<li>é€šè¿‡V8å¼•æ“æ¥æ¥è¿è¡Œï¼Œé‡Œé¢ä¼šæ¶‰åŠåˆ°ä¸€äº›å…³äºæ“ä½œç³»ç»Ÿè°ƒç”¨ï¼Œè¿™éƒ¨åˆ†å°±ç”±V8å¼•æ“å¸®ä½ è½¬å‘åˆ°æ“ä½œç³»ç»Ÿå±‚é¢</li>
<li>ä»æ“ä½œç³»ç»Ÿå±‚é¢å¾—åˆ°è¿”å›ç»“æœä¹‹åå†é€šè¿‡V8å¼•æ“è¿”å›åˆ°Jsé‡Œå»</li>
</ul>
<ol>
<li>ä»Jsåˆ°V8å†åˆ°æ“ä½œç³»ç»Ÿçš„èƒ½åŠ›ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯é€šè¿‡Node.jsçš„å†…ç½®æ¨¡å—æ¥æä¾›çš„</li>
<li>è¿˜æœ‰ä¸€äº›æ•°æ®æ˜¯ä»æ“ä½œç³»ç»Ÿåº•å±‚é€šçŸ¥åˆ°æˆ‘ä»¬çš„Node.jså±‚</li>
</ol>
<p>ç¤ºä¾‹</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å°†è¿›ç¨‹è®¾ç½®ä¸ºé•¿æœŸå­˜åœ¨å¹¶ä¸”ç›‘å¬ç”¨æˆ·çš„è¾“å…¥</span></span><br><span class="line">process.stdin.<span class="keyword">on</span>('data',<span class="keyword">e</span>=&gt;&#123;</span><br><span class="line">  <span class="keyword">const</span> playerAction = <span class="keyword">e</span>.<span class="keyword">toString</span>().<span class="built_in">trim</span>();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ä¾èµ–çš„æ˜¯Nodeçš„å†…ç½®æ¨¡å—</p>
<ul>
<li>EventEmitter</li>
</ul>
<p>processå®é™…ä¸Šæ˜¯EventEmitterçš„å®ä¾‹ï¼Œç»§æ‰¿äº†EventEmitterä½¿å…¶å…·å¤‡äº†å‘ä¸ŠæŠ›äº‹ä»¶çš„èƒ½åŠ›</p>
<p>å¼•å‡º</p>
<h2 id="3-3-EventEmitter"><a href="#3-3-EventEmitter" class="headerlink" title="3.3 EventEmitter"></a>3.3 EventEmitter</h2><h3 id="3-3-1-è§£å†³äº†ä»€ä¹ˆé—®é¢˜"><a href="#3-3-1-è§£å†³äº†ä»€ä¹ˆé—®é¢˜" class="headerlink" title="3.3.1 è§£å†³äº†ä»€ä¹ˆé—®é¢˜"></a>3.3.1 è§£å†³äº†ä»€ä¹ˆé—®é¢˜</h3><ul>
<li>è§£å†³ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„é€šä¿¡é—®é¢˜<ul>
<li>å‡½æ•°è°ƒç”¨</li>
<li>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆäº‹ä»¶æ”¶å‘æ¨¡å¼ï¼‰- æŠ›äº‹ä»¶<ul>
<li>addEventListener</li>
<li>removeEventListener</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-3-2-æ™®é€šè°ƒç”¨åº”ç”¨åœºæ™¯"><a href="#3-3-2-æ™®é€šè°ƒç”¨åº”ç”¨åœºæ™¯" class="headerlink" title="3.3.2 æ™®é€šè°ƒç”¨åº”ç”¨åœºæ™¯"></a>3.3.2 æ™®é€šè°ƒç”¨åº”ç”¨åœºæ™¯</h3><ul>
<li>è€æ¿é€šçŸ¥ç§˜ä¹¦</li>
<li>è¯´æ˜¯é€šçŸ¥ï¼Œä½†æ˜¯ç›´æ¥è°ƒç”¨æ¯”è¾ƒåˆé€‚<h3 id="3-3-3-è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#3-3-3-è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="3.3.3 è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯"></a>3.3.3 è§‚å¯Ÿè€…æ¨¡å¼åº”ç”¨åœºæ™¯</h3></li>
<li>é€šçŸ¥æ¶ˆæ¯çš„äººå¹¶ä¸çŸ¥é“è¢«é€šçŸ¥è€…çš„å­˜åœ¨ï¼ˆæå®¢æ—¶é—´å¹¶ä¸çŸ¥é“æˆ‘çš„å­˜åœ¨ï¼‰</li>
<li>æ²¡æœ‰äººæ¥æ”¶äº‹ä»¶ï¼Œå®ƒè¿˜èƒ½ç»§ç»­ä¸‹å»ï¼ˆä»Šå¤©æ²¡æœ‰æ¥æ”¶åˆ°Geekä¸Šæ–°è¯¾çš„æ¶ˆæ¯ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯å¯ä»¥ä¸Šæ–°è¯¾ï¼‰</li>
</ul>
<p>lib.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geektime</span> <span class="keyword">extends</span> <span class="title">EventEmitter</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>()&#123;</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.emit(<span class="string">'newlesson'</span>,&#123;<span class="attr">price</span>:<span class="built_in">Math</span>.random()* <span class="number">100</span>&#125;) <span class="comment">//è§¦å‘äº‹ä»¶</span></span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> geektime = <span class="keyword">new</span> Geektime;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = geektime</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">const geektime = <span class="built_in">require</span>(<span class="string">'./lib.js'</span>)</span><br><span class="line">geektime.addListener(<span class="string">'newlesson'</span>,<span class="function"><span class="params">(res)</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(res.price &lt; <span class="number">50</span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'buy!å½“å‰ä»·æ ¼ä¸º---'</span>,res)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="4-Nodejséé˜»å¡I-OåŠå¼‚æ­¥ç¼–ç¨‹"><a href="#4-Nodejséé˜»å¡I-OåŠå¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="4 Nodejséé˜»å¡I/OåŠå¼‚æ­¥ç¼–ç¨‹"></a>4 Nodejséé˜»å¡I/OåŠå¼‚æ­¥ç¼–ç¨‹</h1><p>å€¼å¾—æ‹¿å‡ºæ¥å•ç‹¬è¯´ï¼Œ<a href="http://maying.ink/2019/03/19/promise/">æˆ³æ­¤ä¸€è§ˆ</a></p>
<h1 id="5-å®ç°ç½‘é¡µç‰ˆçŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"><a href="#5-å®ç°ç½‘é¡µç‰ˆçŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ" class="headerlink" title="5 å®ç°ç½‘é¡µç‰ˆçŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"></a>5 å®ç°ç½‘é¡µç‰ˆçŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ</h1><p>æŠ€æœ¯å‰ç½®</p>
<h2 id="5-1-ä»€ä¹ˆæ˜¯HTTPæœåŠ¡"><a href="#5-1-ä»€ä¹ˆæ˜¯HTTPæœåŠ¡" class="headerlink" title="5.1 ä»€ä¹ˆæ˜¯HTTPæœåŠ¡"></a>5.1 ä»€ä¹ˆæ˜¯HTTPæœåŠ¡</h2><p>ä¸€ä¸ªç½‘é¡µè¯·æ±‚ï¼ŒåŒ…å«ä¸¤æ¬¡HTTPåŒ…äº¤æ¢</p>
<ul>
<li>æµè§ˆå™¨å‘HTTPæœåŠ¡å™¨å‘é€è¯·æ±‚HTTPåŒ…</li>
<li>HTTPæœåŠ¡å™¨å‘æµè§ˆå™¨è¿”å›HTTPåŒ…</li>
</ul>
<h2 id="5-2-HTTPæœåŠ¡è¦åšä»€ä¹ˆäº‹æƒ…"><a href="#5-2-HTTPæœåŠ¡è¦åšä»€ä¹ˆäº‹æƒ…" class="headerlink" title="5.2 HTTPæœåŠ¡è¦åšä»€ä¹ˆäº‹æƒ…"></a>5.2 HTTPæœåŠ¡è¦åšä»€ä¹ˆäº‹æƒ…</h2><ul>
<li>è§£æè¿›æ¥çš„HTTPè¯·æ±‚æŠ¥æ–‡</li>
<li>è¿”å›å¯¹åº”çš„HTTPè¿”å›æŠ¥æ–‡ </li>
</ul>
<h2 id="5-3-å®ç°ä¸€ä¸ªç®€å•çš„HTTPæœåŠ¡å™¨"><a href="#5-3-å®ç°ä¸€ä¸ªç®€å•çš„HTTPæœåŠ¡å™¨" class="headerlink" title="5.3 å®ç°ä¸€ä¸ªç®€å•çš„HTTPæœåŠ¡å™¨"></a>5.3 å®ç°ä¸€ä¸ªç®€å•çš„HTTPæœåŠ¡å™¨</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">http</span><br><span class="line">.createServer(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>);</span><br><span class="line">    res.end(<span class="string">'hello'</span>)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">.listen(<span class="number">8888</span>)</span><br></pre></td></tr></table></figure>
<h2 id="5-4-serverç«¯åŠ è½½æ¨¡ç‰ˆ"><a href="#5-4-serverç«¯åŠ è½½æ¨¡ç‰ˆ" class="headerlink" title="5.4 serverç«¯åŠ è½½æ¨¡ç‰ˆ"></a>5.4 serverç«¯åŠ è½½æ¨¡ç‰ˆ</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line">http</span><br><span class="line">.createServer(<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>);</span><br><span class="line">    res.end(<span class="string">'hello'</span>)</span><br><span class="line">    fs.createReadStream(__dirname + <span class="string">'/index.html'</span>)</span><br><span class="line">    .pipe(res)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">.listen(<span class="number">8888</span>)</span><br></pre></td></tr></table></figure>
<h3 id="5-5-æ¸¸æˆé€»è¾‘"><a href="#5-5-æ¸¸æˆé€»è¾‘" class="headerlink" title="5.5 æ¸¸æˆé€»è¾‘"></a>5.5 æ¸¸æˆé€»è¾‘</h3><p>index.js  <a href="https://github.com/maying2020/nodejs-in-action/tree/master/http/nodeNative" target="_blank" rel="noopener">æºç ç‚¹å‡»</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">"url"</span>);</span><br><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">"queryString"</span>);</span><br><span class="line"><span class="keyword">const</span> game = <span class="built_in">require</span>(<span class="string">"./game.js"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> playerLastAction = <span class="literal">null</span>; <span class="comment">//ç©å®¶ä¸Šæ¬¡å‡ºçš„</span></span><br><span class="line"><span class="keyword">let</span> playerWon = <span class="number">0</span>; <span class="comment">//ç©å®¶èµ¢å¾—æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">let</span> sameCount = <span class="number">0</span>; <span class="comment">//ç»Ÿè®¡ç›¸åŒæ“ä½œç»Ÿè®¡æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line">http</span><br><span class="line">  .createServer(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡å†…ç½®æ¨¡å—urlï¼Œè½¬æ¢å‘é€åˆ°è¯¥httpæœåŠ¡ä¸Šçš„httpè¯·æ±‚åŒ…çš„urlï¼Œ</span></span><br><span class="line">    <span class="comment">// å°†å…¶åˆ†å‰²æˆ åè®®(protocol)://åŸŸå(host):ç«¯å£(port)/è·¯å¾„å(pathname)?è¯·æ±‚å‚æ•°(query)</span></span><br><span class="line">    <span class="keyword">const</span> parsedUrl = url.parse(req.url);</span><br><span class="line">    <span class="keyword">if</span> (parsedUrl.pathname == <span class="string">"/game"</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> query = querystring.parse(parsedUrl.query);</span><br><span class="line">      <span class="comment">// ç©å®¶å‡ºçš„</span></span><br><span class="line">      <span class="keyword">const</span> playerAction = query.action;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// éœ€æ±‚2:å¦‚æœç©å®¶èµ¢äº†ä¸‰æ¬¡æˆ–è€…ç©å®¶ä½œå¼Šï¼Œåˆ™ç”µè„‘ä¸ç»™ä»–ç©äº†</span></span><br><span class="line">      <span class="keyword">if</span> (playerWon &gt;= <span class="number">3</span> || sameCount == <span class="number">9</span>) &#123;</span><br><span class="line">        res.writeHead(<span class="number">500</span>);</span><br><span class="line">        res.end(<span class="string">"æˆ‘å†ä¹Ÿä¸å’Œä½ ç©äº†ï¼"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// éœ€æ±‚1:å¦‚æœç©å®¶æ“ä½œè¿ç»­ä¸‰æ¬¡ç›¸åŒï¼Œè§†ä¸ºç©å®¶ä½œå¼Š</span></span><br><span class="line">      <span class="keyword">if</span> (playerLastAction &amp; (playerLastAction == playerAction)) &#123;</span><br><span class="line">        sameCount++;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        sameCount++;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      playerLastAction = playerAction;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (sameCount &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">        res.writeHead(<span class="number">400</span>);</span><br><span class="line">        res.end(<span class="string">"ä½ ä½œå¼Š"</span>);</span><br><span class="line">        <span class="comment">// å°†sameCountè®¾ç½®ä¸º9</span></span><br><span class="line">        sameCount = <span class="number">9</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// æ‰§è¡Œæ¸¸æˆé€»è¾‘</span></span><br><span class="line">      <span class="keyword">var</span> gameResult = game(playerAction);</span><br><span class="line">      res.writeHead(<span class="number">200</span>);</span><br><span class="line">      <span class="keyword">if</span> (gameResult == <span class="number">0</span>) &#123;</span><br><span class="line">        res.end(<span class="string">"å¹³å±€ï¼"</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (gameResult == <span class="number">1</span>) &#123;</span><br><span class="line">        res.end(<span class="string">"ä½ èµ¢äº†ï¼"</span>);</span><br><span class="line">        <span class="comment">// ç©å®¶èƒœåˆ©æ¬¡æ•°ç»Ÿè®¡+1</span></span><br><span class="line">        playerWon++;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.end(<span class="string">"ä½ è¾“äº†ï¼"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœè¯·æ±‚urlæ˜¯æµè§ˆå™¨iconï¼Œæ¯”å¦‚ http://localhost:3000/favicon.icoçš„æƒ…å†µ</span></span><br><span class="line">    <span class="comment">// å°±è¿”å›ä¸€ä¸ª200å°±å¥½äº†</span></span><br><span class="line">    <span class="keyword">if</span> (parsedUrl.pathname == <span class="string">"/favicon.ico"</span>) &#123;</span><br><span class="line">      res.writeHead(<span class="number">200</span>);</span><br><span class="line">      res.end();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœè®¿é—®çš„æ˜¯æ ¹è·¯å¾„ï¼Œå°±æŠŠæ¸¸æˆé¡µé¢è¯»å‡ºæ¥è¿”å›å‡ºå»</span></span><br><span class="line">    <span class="keyword">if</span> (parsedUrl.pathname == <span class="string">"/"</span>) &#123;</span><br><span class="line">      fs.createReadStream(__dirname + <span class="string">"/index.html"</span>).pipe(res);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .listen(<span class="number">6001</span>);</span><br></pre></td></tr></table></figure>
<h1 id="6-ä½¿ç”¨expressä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"><a href="#6-ä½¿ç”¨expressä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ" class="headerlink" title="6 ä½¿ç”¨expressä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"></a>6 ä½¿ç”¨expressä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ</h1><h2 id="6-1-äº†è§£express"><a href="#6-1-äº†è§£express" class="headerlink" title="6.1 äº†è§£express"></a>6.1 äº†è§£express</h2><p>è¦äº†è§£ä¸€ä¸ªæ¡†æ¶ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ </p>
<ol>
<li>äº†è§£å®ƒçš„å…³é”®åŠŸèƒ½</li>
<li>æ¨å¯¼å‡ºå®ƒè¦è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆ</li>
</ol>
<p>æ ¸å¿ƒåŠŸèƒ½</p>
<ul>
<li>è·¯ç”±</li>
<li>request/response ç®€åŒ–<ul>
<li>request:pathnameã€queryç­‰</li>
<li>response:send()ã€json()ã€jsonp()ç­‰</li>
</ul>
</li>
<li>ä¸­é—´ä»¶<ul>
<li>æ›´å¥½åœ°ç»„ç»‡æµç¨‹ä»£ç </li>
<li>å¼‚æ­¥ä¼šæ‰“ç ´Expressçš„æ´‹è‘±æ¨¡å‹</li>
</ul>
</li>
</ul>
<h2 id="6-2-æ¸¸æˆé€»è¾‘"><a href="#6-2-æ¸¸æˆé€»è¾‘" class="headerlink" title="6.2 æ¸¸æˆé€»è¾‘"></a>6.2 æ¸¸æˆé€»è¾‘</h2><p>index.js <a href="https://github.com/maying2020/nodejs-in-action/tree/master/http/express" target="_blank" rel="noopener">æºç ç‚¹å‡»</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">const</span> game = <span class="built_in">require</span>(<span class="string">"./game"</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">"express"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç©å®¶èƒœåˆ©æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡3ï¼Œåˆ™åç»­å¾€è¯¥æœåŠ¡å™¨çš„è¯·æ±‚éƒ½è¿”å›500</span></span><br><span class="line"><span class="keyword">var</span> playerWinCount = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// ç©å®¶çš„ä¸Šä¸€æ¬¡æ¸¸æˆåŠ¨ä½œ</span></span><br><span class="line"><span class="keyword">var</span> lastPlayerAction = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// ç©å®¶è¿ç»­å‡ºåŒä¸€ä¸ªåŠ¨ä½œçš„æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">var</span> sameCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡app.getè®¾å®š /favicon.ico è·¯å¾„çš„è·¯ç”±</span></span><br><span class="line"><span class="comment">// .get ä»£è¡¨è¯·æ±‚ method æ˜¯ getï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç”¨ postã€delete ç­‰ã€‚è¿™ä¸ªèƒ½åŠ›å¾ˆé€‚åˆç”¨äºåˆ›å»º rest æœåŠ¡</span></span><br><span class="line">app.get(<span class="string">"/favicon.ico"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ä¸€å¥ status(200) ä»£æ›¿ writeHead(200); end();</span></span><br><span class="line">  response.status(<span class="number">200</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾å®š /game è·¯å¾„çš„è·¯ç”±</span></span><br><span class="line">app.get(</span><br><span class="line">  <span class="string">"/game"</span>,</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">request, response, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (playerWinCount &gt;= <span class="number">3</span> || sameCount == <span class="number">9</span>) &#123;</span><br><span class="line">      response.status(<span class="number">500</span>);</span><br><span class="line">      response.send(<span class="string">"æˆ‘ä¸ä¼šå†ç©äº†ï¼"</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡nextæ‰§è¡Œåç»­ä¸­é—´ä»¶</span></span><br><span class="line">    next();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“åç»­ä¸­é—´ä»¶æ‰§è¡Œå®Œä¹‹åï¼Œä¼šæ‰§è¡Œåˆ°è¿™ä¸ªä½ç½®</span></span><br><span class="line">    <span class="keyword">if</span> (response.playerWon) &#123;</span><br><span class="line">      playerWinCount++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">request, response, next</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// expressè‡ªåŠ¨å¸®æˆ‘ä»¬æŠŠqueryå¤„ç†å¥½æŒ‚åœ¨requestä¸Š</span></span><br><span class="line">    <span class="keyword">const</span> query = request.query;</span><br><span class="line">    <span class="keyword">const</span> playerAction = query.action;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!playerAction) &#123;</span><br><span class="line">      response.status(<span class="number">400</span>);</span><br><span class="line">      response.send();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lastPlayerAction == playerAction) &#123;</span><br><span class="line">      sameCount++;</span><br><span class="line">      <span class="keyword">if</span> (sameCount &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">        response.status(<span class="number">400</span>);</span><br><span class="line">        response.send(<span class="string">"ä½ ä½œå¼Šï¼æˆ‘å†ä¹Ÿä¸ç©äº†"</span>);</span><br><span class="line">        sameCount = <span class="number">9</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      sameCount = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    lastPlayerAction = playerAction;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŠŠç”¨æˆ·æ“ä½œæŒ‚åœ¨responseä¸Šä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class="line">    response.playerAction = playerAction;</span><br><span class="line">    next();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params">req, response</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> playerAction = response.playerAction;</span><br><span class="line">    <span class="keyword">const</span> result = game(playerAction);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœè¿™é‡Œæ‰§è¡ŒsetTimeoutï¼Œä¼šå¯¼è‡´å‰é¢çš„æ´‹è‘±æ¨¡å‹å¤±æ•ˆ</span></span><br><span class="line">    <span class="comment">// å› ä¸ºplayerWonä¸æ˜¯åœ¨ä¸­é—´ä»¶æ‰§è¡Œæµç¨‹æ‰€å±çš„é‚£ä¸ªäº‹ä»¶å¾ªç¯é‡Œèµ‹å€¼çš„</span></span><br><span class="line">    <span class="comment">// setTimeout(()=&gt; &#123;</span></span><br><span class="line">    response.status(<span class="number">200</span>);</span><br><span class="line">    <span class="keyword">if</span> (result == <span class="number">0</span>) &#123;</span><br><span class="line">      response.send(<span class="string">"å¹³å±€"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result == <span class="number">-1</span>) &#123;</span><br><span class="line">      response.send(<span class="string">"ä½ è¾“äº†"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      response.send(<span class="string">"ä½ èµ¢äº†"</span>);</span><br><span class="line">      response.playerWon = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// &#125;, 500)</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">"/"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// sendæ¥å£ä¼šåˆ¤æ–­ä½ ä¼ å…¥çš„å€¼çš„ç±»å‹ï¼Œæ–‡æœ¬çš„è¯åˆ™ä¼šå¤„ç†ä¸ºtext/html</span></span><br><span class="line">  <span class="comment">// Bufferçš„è¯åˆ™ä¼šå¤„ç†ä¸ºä¸‹è½½</span></span><br><span class="line">  response.send(fs.readFileSync(__dirname + <span class="string">"/index.html"</span>, <span class="string">"utf-8"</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">6001</span>);</span><br></pre></td></tr></table></figure>
<h1 id="7-ä½¿ç”¨koaä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"><a href="#7-ä½¿ç”¨koaä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ" class="headerlink" title="7 ä½¿ç”¨koaä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"></a>7 ä½¿ç”¨koaä¼˜åŒ–çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ</h1><h2 id="7-1-äº†è§£koa"><a href="#7-1-äº†è§£koa" class="headerlink" title="7.1 äº†è§£koa"></a>7.1 äº†è§£koa</h2><p>æ ¸å¿ƒåŠŸèƒ½:</p>
<ul>
<li>æ¯” Express æ›´æè‡´çš„ request/response ç®€åŒ–<ul>
<li>ctx.status=200</li>
<li>ctx.body=â€™helloworldâ€™</li>
</ul>
</li>
<li>ä½¿ç”¨ async function å®ç°çš„ä¸­é—´ä»¶<ul>
<li>æœ‰â€œæš‚åœæ‰§è¡Œâ€çš„èƒ½åŠ›</li>
<li>åœ¨å¼‚æ­¥çš„æƒ…å†µä¸‹ä¹Ÿç¬¦åˆæ´‹è‘±æ¨¡å‹</li>
</ul>
</li>
<li>ç²¾ç®€å†…æ ¸ï¼Œæ‰€æœ‰é¢å¤–åŠŸèƒ½éƒ½ç§»åˆ°ä¸­é—´ä»¶é‡Œå®ç°</li>
</ul>
<h2 id="7-2-Express-vs-Koa"><a href="#7-2-Express-vs-Koa" class="headerlink" title="7.2 Express vs Koa"></a>7.2 Express vs Koa</h2><ul>
<li>Express é—¨æ§›æ›´ä½ï¼ŒKoa æ›´å¼ºå¤§ä¼˜é›…ã€‚</li>
<li>Express å°è£…æ›´å¤šä¸œè¥¿ï¼Œå¼€å‘æ›´å¿«é€Ÿï¼ŒKoa å¯å®šåˆ¶å‹æ›´é«˜</li>
</ul>
<h2 id="7-3-å­°â€œä¼˜â€å­°â€œåŠ£â€"><a href="#7-3-å­°â€œä¼˜â€å­°â€œåŠ£â€" class="headerlink" title="7.3 å­°â€œä¼˜â€å­°â€œåŠ£â€"></a>7.3 å­°â€œä¼˜â€å­°â€œåŠ£â€</h2><ul>
<li>æ¡†æ¶ä¹‹é—´å…¶å®æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†</li>
<li>ä¸åŒçš„æ¡†æ¶æœ‰ä¸åŒçš„é€‚ç”¨åœºæ™¯</li>
</ul>
<h2 id="7-4-æ¸¸æˆé€»è¾‘"><a href="#7-4-æ¸¸æˆé€»è¾‘" class="headerlink" title="7.4 æ¸¸æˆé€»è¾‘"></a>7.4 æ¸¸æˆé€»è¾‘</h2><p>index.js <a href="https://github.com/maying2020/nodejs-in-action/tree/master/http/koa" target="_blank" rel="noopener">æºç ç‚¹å‡»</a></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"><span class="keyword">const</span> game = <span class="built_in">require</span>(<span class="string">"./game"</span>);</span><br><span class="line"><span class="keyword">const</span> koa = <span class="built_in">require</span>(<span class="string">"koa"</span>);</span><br><span class="line"><span class="keyword">const</span> mount = <span class="built_in">require</span>(<span class="string">"koa-mount"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç©å®¶èƒœåˆ©æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡3ï¼Œåˆ™åç»­å¾€è¯¥æœåŠ¡å™¨çš„è¯·æ±‚éƒ½è¿”å›500</span></span><br><span class="line"><span class="keyword">var</span> playerWinCount = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// ç©å®¶çš„ä¸Šä¸€æ¬¡æ¸¸æˆåŠ¨ä½œ</span></span><br><span class="line"><span class="keyword">var</span> lastPlayerAction = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// ç©å®¶è¿ç»­å‡ºåŒä¸€ä¸ªåŠ¨ä½œçš„æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">var</span> sameCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> koa();</span><br><span class="line"></span><br><span class="line">app.use(</span><br><span class="line">  mount(<span class="string">"/favicon.ico"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">ctx</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// koaæ¯”expressåšäº†æ›´æè‡´çš„responseå¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="comment">// å› ä¸ºkoaä½¿ç”¨å¼‚æ­¥å‡½æ•°ä½œä¸ºä¸­é—´ä»¶çš„å®ç°æ–¹å¼</span></span><br><span class="line">    <span class="comment">// æ‰€ä»¥koaå¯ä»¥åœ¨ç­‰å¾…æ‰€æœ‰ä¸­é—´ä»¶æ‰§è¡Œå®Œæ¯•ä¹‹åå†ç»Ÿä¸€å¤„ç†è¿”å›å€¼ï¼Œå› æ­¤å¯ä»¥ç”¨èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    ctx.status = <span class="number">200</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> gameKoa = <span class="keyword">new</span> koa();</span><br><span class="line">app.use(mount(<span class="string">"/game"</span>, gameKoa));</span><br><span class="line">gameKoa.use(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">ctx, next</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (playerWinCount &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">    ctx.status = <span class="number">500</span>;</span><br><span class="line">    ctx.body = <span class="string">"æˆ‘ä¸ä¼šå†ç©äº†ï¼"</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨await å…³é”®å­—ç­‰å¾…åç»­ä¸­é—´ä»¶æ‰§è¡Œå®Œæˆ</span></span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°±èƒ½è·å¾—ä¸€ä¸ªå‡†ç¡®çš„æ´‹è‘±æ¨¡å‹æ•ˆæœ</span></span><br><span class="line">  <span class="keyword">if</span> (ctx.playerWon) &#123;</span><br><span class="line">    playerWinCount++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">gameKoa.use(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">ctx, next</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> query = ctx.query;</span><br><span class="line">  <span class="keyword">const</span> playerAction = query.action;</span><br><span class="line">  <span class="keyword">if</span> (!playerAction) &#123;</span><br><span class="line">    ctx.status = <span class="number">400</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (sameCount == <span class="number">9</span>) &#123;</span><br><span class="line">    ctx.status = <span class="number">500</span>;</span><br><span class="line">    ctx.body = <span class="string">"æˆ‘ä¸ä¼šå†ç©äº†ï¼"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (lastPlayerAction == playerAction) &#123;</span><br><span class="line">    sameCount++;</span><br><span class="line">    <span class="keyword">if</span> (sameCount &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">      ctx.status = <span class="number">400</span>;</span><br><span class="line">      ctx.body = <span class="string">"ä½ ä½œå¼Šï¼æˆ‘å†ä¹Ÿä¸ç©äº†"</span>;</span><br><span class="line">      sameCount = <span class="number">9</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    sameCount = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  lastPlayerAction = playerAction;</span><br><span class="line">  ctx.playerAction = playerAction;</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line">gameKoa.use(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params">ctx, next</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> playerAction = ctx.playerAction;</span><br><span class="line">  <span class="keyword">const</span> result = game(playerAction);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹äºä¸€å®šéœ€è¦åœ¨è¯·æ±‚ä¸»æµç¨‹é‡Œå®Œæˆçš„æ“ä½œï¼Œä¸€å®šè¦ä½¿ç”¨awaitè¿›è¡Œç­‰å¾…</span></span><br><span class="line">  <span class="comment">// å¦åˆ™koaå°±ä¼šåœ¨å½“å‰äº‹ä»¶å¾ªç¯å°±æŠŠhttp responseè¿”å›å‡ºå»äº†</span></span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      ctx.status = <span class="number">200</span>;</span><br><span class="line">      <span class="keyword">if</span> (result == <span class="number">0</span>) &#123;</span><br><span class="line">        ctx.body = <span class="string">"å¹³å±€"</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result == <span class="number">-1</span>) &#123;</span><br><span class="line">        ctx.body = <span class="string">"ä½ è¾“äº†"</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ctx.body = <span class="string">"ä½ èµ¢äº†"</span>;</span><br><span class="line">        ctx.playerWon = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      resolve();</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(</span><br><span class="line">  mount(<span class="string">"/"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">ctx</span>) </span>&#123;</span><br><span class="line">    ctx.body = fs.readFileSync(__dirname + <span class="string">"/index.html"</span>, <span class="string">"utf-8"</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line">app.listen(<span class="number">6001</span>);</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>Node.jsç³»åˆ—(ä¸€)ä¹‹å®‰è£…</title>
    <url>/2017/04/13/nodeJs%E7%B3%BB%E5%88%97%E4%B8%80/</url>
    <content><![CDATA[<h2 id="nodeç®€ä»‹"><a href="#nodeç®€ä»‹" class="headerlink" title="nodeç®€ä»‹"></a>nodeç®€ä»‹</h2><p>nodeæ˜¯javascriptè¯­è¨€çš„æœåŠ¡å™¨è¿è¡Œç¯å¢ƒ<br>æ‰€è°“çš„è¿è¡Œç¯å¢ƒæœ‰ä¸¤å±‚æ„æ€ï¼š</p>
<ol>
<li>javascriptè¯­è¨€é€šè¿‡nodeåœ¨æœåŠ¡å™¨è¿è¡Œï¼Œåœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œnodeæ˜¯<strong>javascriprtçš„è™šæ‹Ÿæœº</strong><br>2.nodeæä¾›å¤§é‡çš„å·¥å…·åº“ï¼Œä½¿å¾—javascriptè¯­è¨€ä¸æ“ä½œç³»ç»Ÿäº’åŠ¨ï¼ˆæ¯”å¦‚è¯»å†™æ–‡ä»¶ï¼Œæ–°å»ºå­è¿›ç¨‹ï¼‰ï¼Œåœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œnodeåˆæ˜¯<strong>javascripçš„å·¥å…·åº“</strong><br>Nodeå†…éƒ¨é‡‡ç”¨<a href="http://baike.baidu.com/link?url=1kFBYYp0gB7_P6YD0d1s3sqF64zK41APPhCywsEG9qTKgguFTwwYPZTohqZzd82j" target="_blank" rel="noopener">Googleå…¬å¸çš„V8å¼•æ“</a>ï¼Œä½œä¸ºJavaScriptè¯­è¨€è§£é‡Šå™¨ï¼›é€šè¿‡è‡ªè¡Œå¼€å‘çš„libuvåº“ï¼Œè°ƒç”¨æ“ä½œç³»ç»Ÿèµ„æºã€‚<h2 id="ä»€ä¹ˆæ˜¯Google-V8-JavaScriptå¼•æ“"><a href="#ä»€ä¹ˆæ˜¯Google-V8-JavaScriptå¼•æ“" class="headerlink" title="ä»€ä¹ˆæ˜¯Google V8 JavaScriptå¼•æ“"></a>ä»€ä¹ˆæ˜¯Google V8 JavaScriptå¼•æ“</h2>V8æ˜¯ä¸€ä¸ªç”±ä¸¹éº¦Googleå¼€å‘çš„å¼€æºJavaScriptå¼•æ“ï¼ŒV8å°±æ˜¯chromeæµè§ˆå™¨ç”¨çš„jsè§£é‡Šå¼•æ“ï¼Œä¸»è¦æ˜¯Cç¼–å†™çš„<br>V8åœ¨æ‰§è¡Œä¹‹å‰å°†JavaScriptç¼–è¯‘æˆäº†æœºå™¨ç ï¼Œè€Œéä½å…ƒç»„ç æˆ–æ˜¯ç›´è¯‘å®ƒï¼Œä»¥æ­¤æå‡æ•ˆèƒ½ã€‚æ›´è¿›ä¸€æ­¥ï¼Œæœ‰äº†è¿™äº›åŠŸèƒ½ï¼ŒJavaScriptç¨‹åºä¸V8å¼•æ“çš„é€Ÿåº¦åª²ç¾äºŒè¿›åˆ¶ç¼–è¯‘ã€‚[4]<h2 id="å®‰è£…ç›¸å…³"><a href="#å®‰è£…ç›¸å…³" class="headerlink" title="å®‰è£…ç›¸å…³"></a>å®‰è£…ç›¸å…³</h2>è®¿é—®å®˜æ–¹ç½‘ç«™nodejs.org<br>å®‰è£…å®ŒæˆæŸ¥çœ‹nodeç‰ˆæœ¬</li>
</ol>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">node</span> <span class="title">--version</span></span><br><span class="line"> æˆ–è€…</span><br><span class="line">$ <span class="keyword">node</span> <span class="title">-v</span></span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/node1-1.png" alt="wunai"></p>
<p>æ›´æ–°nodeç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡node.jsçš„næ¨¡å—å®Œæˆï¼Œ<br>æ›´æ–°ä¸ºæœ€æ–°å‘å¸ƒçš„ç¨³å®šç‰ˆã€‚</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>sudo npm install n -g</span><br><span class="line"><span class="variable">$ </span>sudo n stable</span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/node1-2.png" alt="node-1-2"></p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">$ sudo n <span class="number">0.10</span><span class="number">.21</span></span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…ç‰ˆæœ¬ç®¡ç†å·¥å…·nvm"><a href="#å®‰è£…ç‰ˆæœ¬ç®¡ç†å·¥å…·nvm" class="headerlink" title="å®‰è£…ç‰ˆæœ¬ç®¡ç†å·¥å…·nvm"></a>å®‰è£…ç‰ˆæœ¬ç®¡ç†å·¥å…·nvm</h3><p>å¦‚æœæƒ³åœ¨åŒä¸€å°æœºå™¨åŒæ—¶å®‰è£…å¤šä¸ªç‰ˆæœ¬çš„nodeï¼Œå°±éœ€è¦ç”¨åˆ°å—¯æœ¬ç®¡ç†å·¥å…·nvmï¼Œnvmå…¨ç§°<strong>Node Version Manager</strong>ï¼Œå®ƒä¸nçš„å®ç°æ–¹å¼ä¸åŒï¼Œå…¶æ˜¯é€šè¿‡shellè„šæœ¬å®ç°çš„ã€‚</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>git clone <span class="symbol">https:</span>/<span class="regexp">/github.com/creationix</span><span class="regexp">/nvm.git ~/</span>.nvm</span><br><span class="line"><span class="variable">$ </span>source ~<span class="regexp">/.nvm/nvm</span>.sh</span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/node1-3.png" alt="node-1-3"></p>
<h6 id="å®‰è£…æœ€æ–°ç‰ˆæœ¬"><a href="#å®‰è£…æœ€æ–°ç‰ˆæœ¬" class="headerlink" title="å®‰è£…æœ€æ–°ç‰ˆæœ¬"></a>å®‰è£…æœ€æ–°ç‰ˆæœ¬</h6><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">$ nvm install <span class="keyword">node</span><span class="title"></span></span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/node1-4.png" alt="node-1-4"></p>
<h6 id="å®‰è£…æŒ‡å®šç‰ˆæœ¬"><a href="#å®‰è£…æŒ‡å®šç‰ˆæœ¬" class="headerlink" title="å®‰è£…æŒ‡å®šç‰ˆæœ¬"></a>å®‰è£…æŒ‡å®šç‰ˆæœ¬</h6><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">$ nvm install <span class="number">0.12</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>
<p>######ä½¿ç”¨å·²å®‰è£…çš„æœ€æ–°ç‰ˆæœ¬</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">$ nvm use <span class="keyword">node</span><span class="title"></span></span><br></pre></td></tr></table></figure>
<h6 id="ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node"><a href="#ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node" class="headerlink" title="ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node"></a>ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node</h6><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>nvm <span class="keyword">use</span> <span class="number">0</span>.<span class="number">12</span></span><br></pre></td></tr></table></figure>
<h6 id="æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬"><a href="#æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬"></a>æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬</h6><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>nvm ls</span><br></pre></td></tr></table></figure>
<p><img src="http://oucjferwh.bkt.clouddn.com/node1-5.png" alt="node-1-5"></p>
<h6 id="é€€å‡ºå·²ç»æ¿€æ´»çš„nvmï¼Œä½¿ç”¨deactivateå‘½ä»¤ã€‚"><a href="#é€€å‡ºå·²ç»æ¿€æ´»çš„nvmï¼Œä½¿ç”¨deactivateå‘½ä»¤ã€‚" class="headerlink" title="é€€å‡ºå·²ç»æ¿€æ´»çš„nvmï¼Œä½¿ç”¨deactivateå‘½ä»¤ã€‚"></a>é€€å‡ºå·²ç»æ¿€æ´»çš„nvmï¼Œä½¿ç”¨deactivateå‘½ä»¤ã€‚</h6><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>nvm deactivate</span><br></pre></td></tr></table></figure>
<p>######å¸è½½nvm</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">rm -rf ~<span class="string">/.nvm</span></span><br></pre></td></tr></table></figure>
<p>######æŸ¥çœ‹nvmå¸®åŠ©</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nvm -h</span></span><br></pre></td></tr></table></figure>
<p>è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£<br><a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">https://github.com/creationix/nvm</a></p>
]]></content>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>addEventListener ä¸­çš„ passive ç”¨æ³•</title>
    <url>/2018/12/21/passive/</url>
    <content><![CDATA[<h2 id="å¼•å‡ºé—®é¢˜"><a href="#å¼•å‡ºé—®é¢˜" class="headerlink" title="å¼•å‡ºé—®é¢˜"></a>å¼•å‡ºé—®é¢˜</h2><p>ä¸€ä¸ªå¾ˆç®€å•çš„éœ€æ±‚ é¡µé¢æœ‰ä¸€å¼ å°å›¾ ç‚¹å‡»æ˜¯ä¸ªswiperå®ç°çš„å›¾é›† åŒæ—¶æœ‰ä¸€ä¸ªç°è‰²çš„è’™å±‚ è’™å±‚åº•éƒ¨é¡µé¢ä¸å¯æ»‘åŠ¨ å…³é—­è’™å±‚ é¡µé¢å¯æ¢å¤æ­£å¸¸</p>
<p>å®ç°æ–¹å¼</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bodyScroll</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    event.preventDefault();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_switchTag</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (type === <span class="string">'on'</span>) &#123;</span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'touchmove'</span>, bodyScroll);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">window</span>.removeEventListener(<span class="string">'touchmove'</span>, bodyScroll);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_switchTag(on) é¡µé¢ä¸å¯æ»‘åŠ¨</span><br><span class="line">_switchTag(off) é¡µé¢æ¢å¤æ»‘åŠ¨</span><br></pre></td></tr></table></figure>
<p>ç§»åŠ¨ç«¯çš„æ•ˆæœå¦‚ä¸‹<br>android<br><img src="/images/passive/passive1.gif" alt="jsworke"></p>
<p>ios<br><img src="/images/passive/iOSqian.gif" alt="jsworke"></p>
<p>æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ— æ•ˆ ç›´åˆ°æˆ‘åœ¨æ¨¡æ‹Ÿå™¨ä¸Šçœ‹åˆ°äº†</p>
<p><img src="/images/passive/webqian.gif" alt="jsworke"></p>
<p>å•Šå“¦ æŠ¥é”™äº†ğŸ¦¢</p>
<p><font color="red">Unable to preventDefault inside passive event listener due to target being treated as passive</font><br>æ¥è‡ª google çš„è§£é‡Š <a href="https://developers.google.com/web/updates/2017/01/scrolling-intervention" target="_blank" rel="noopener">https://developers.google.com/web/updates/2017/01/scrolling-intervention</a></p>
<p>å¤§æ¦‚çš„æ„æ€æ˜¯è¯´</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">ç”±äºæµè§ˆå™¨å¿…é¡»è¦åœ¨æ‰§è¡Œäº‹ä»¶å¤„ç†å‡½æ•°ä¹‹åï¼Œæ‰èƒ½çŸ¥é“æœ‰æ²¡æœ‰è°ƒç”¨è¿‡ preventDefault() ï¼Œè¿™å°±å¯¼è‡´äº†æµè§ˆå™¨ä¸èƒ½åŠæ—¶å“åº”æ»šåŠ¨ï¼Œç•¥æœ‰å»¶è¿Ÿã€‚</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥ä¸ºäº†è®©é¡µé¢æ»šåŠ¨çš„æ•ˆæœå¦‚ä¸èˆ¬é¡ºæ»‘ï¼Œä» chrome56 å¼€å§‹ï¼Œåœ¨ windowã€document å’Œ body ä¸Šæ³¨å†Œçš„ touchstart å’Œ touchmove äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä¼šé»˜è®¤ä¸ºæ˜¯ passive: <span class="literal">true</span>ã€‚æµè§ˆå™¨å¿½ç•¥ preventDefault() å°±å¯ä»¥ç¬¬ä¸€æ—¶é—´æ»šåŠ¨äº†ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¾‹ï¼š</span><br><span class="line">wnidow.addEventListener(<span class="string">'touchmove'</span>, <span class="function"><span class="keyword">func</span>) æ•ˆæœå’Œä¸‹é¢ä¸€å¥ä¸€æ ·</span></span><br><span class="line">wnidow.addEventListener(<span class="string">'touchmove'</span>, <span class="function"><span class="keyword">func</span>, &#123; <span class="title">passive</span>: <span class="title">true</span> &#125;)</span></span><br></pre></td></tr></table></figure>
<p>è¿™å°±å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">å¦‚æœåœ¨ä»¥ä¸Šè¿™ 3 ä¸ªå…ƒç´ çš„ <span class="selector-tag">touchstart</span> å’Œ <span class="selector-tag">touchmove</span> äº‹ä»¶å¤„ç†å‡½æ•°ä¸­è°ƒç”¨ <span class="selector-tag">e</span><span class="selector-class">.preventDefault</span>() ï¼Œä¼šè¢«æµè§ˆå™¨å¿½ç•¥æ‰ï¼Œå¹¶ä¸ä¼šé˜»æ­¢é»˜è®¤è¡Œä¸º</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥å‡ºç°äº†ä»¥ä¸Šè§†é¢‘ä¸­é—®é¢˜</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ å³ä¸è¦è®©æµè§ˆå™¨å¿½ç•¥æ‰e.preventDefault()ï¼Ÿ</p>
<ol>
<li>window.addEventListener(â€˜touchmoveâ€™, func, { passive: false })</li>
</ol>
<p>è®¾ç½®passive: falseä¹‹åçš„ç»“æœ<br>android<br><img src="/images/passive/androdhou.gif" alt="jsworke"><br>ios<br><img src="/images/passive/iOShou.gif" alt="jsworke"><br>æµè§ˆå™¨<br><img src="/images/passive/webhou.gif" alt="jsworke"><br>é—®é¢˜å®Œç¾è§£å†³</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">ä½ çœ‹åˆ°è¿™é‡Œå¯ä»¥ç»“æŸäº† å¦‚æœä½ è¿˜æƒ³å†äº†è§£ä¸€ç‚¹ç‚¹</span><br><span class="line">ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡</span><br><span class="line"></span><br><span class="line">#### ä½ å¯èƒ½ä¸çŸ¥é“çš„<span class="keyword">addEventListener</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">å¾ˆä¹…ä¹‹å‰addEventListenerçš„å‚æ•°æ˜¯è¿™æ ·å„¿çš„</span></span><br><span class="line"><span class="keyword">`addEventListener(type, </span>listener, useCapture)`</span><br><span class="line"></span><br><span class="line">åæ¥ä¹Ÿå°±æ˜¯æ§åˆ¶ç›‘å¬å™¨æ˜¯åœ¨æ•è·é˜¶æ®µæ‰§è¡Œè¿˜æ˜¯åœ¨å†’æ³¡é˜¶æ®µæ‰§è¡Œçš„ useCapture å‚æ•°ï¼Œå˜æˆäº†å¯é€‰å‚æ•°</span><br><span class="line">`<span class="keyword">addEventListener(type, </span>listener [,useCapture])`</span><br><span class="line"></span><br><span class="line">å†åæ¥ DOM è§„èŒƒåšäº†ä¿®è®¢<span class="keyword">addEventListener() </span>çš„ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ˜¯ä¸ªå¯¹è±¡å€¼äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸‰ä¸ªå‚æ•°ç°åœ¨å¯ä»¥æ˜¯ä¸¤ç§ç±»å‹çš„å€¼äº† å˜æˆè¿™æ ·å„¿å¼å„¿çš„</span><br></pre></td></tr></table></figure>
<p>addEventListener(type, listener[, useCapture ])<br>addEventListener(type, listener[, options ])<br><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">æ‰©å±•æ–°çš„é€‰é¡¹ï¼Œä»è€Œè‡ªå®šä¹‰æ›´å¤šçš„è¡Œä¸ºï¼Œç›®å‰è§„èŒƒä¸­ <span class="keyword">options</span> å¯¹è±¡å¯ç”¨çš„å±æ€§æœ‰ä¸‰ä¸ªï¼š</span><br></pre></td></tr></table></figure></p>
<p>addEventListener(type, listener, {<br>    capture: false, ç­‰ä»·äº useCapture é»˜è®¤å€¼false<br>    passive: false, æ˜¯å¦è®©é˜»æ­¢é»˜è®¤äº‹ä»¶å¤±æ•ˆ true:å¤±æ•ˆ falseï¼šä¸å¤±æ•ˆ<br>    once: false //è¡¨æ˜è¯¥ç›‘å¬å™¨æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ‰§è¡Œä¸€æ¬¡åå°±è¢«è‡ªåŠ¨ removeEventListener æ‰ï¼Œè¿˜æ²¡æœ‰æµè§ˆå™¨å®ç°å®ƒ é»˜è®¤å€¼false<br>})<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">è¿˜æƒ³å†è¯´ä¸€ç‚¹ é‚£æˆ‘è®¾ç½®äº† passiveçš„äº‹ä»¶ è¿™ä¹ˆç§»é™¤å‘¢ è¿™é‡Œç»™å‡ºäº†æ–¹æ³•</span><br></pre></td></tr></table></figure></p>
<p>ä½ å¯ä»¥ç›´æ¥çœç•¥ç¬¬ä¸‰ä¸ªå‚æ•°<br>window.removeEventListener(â€˜touchmoveâ€™, func)</p>
<p>å¦‚æœæ·»åŠ äº† ç¬¬ä¸€ä¸ªå‚æ•° capture å¯ä»¥è¿™æ ·ç§»é™¤</p>
<p>window.removeEventListener(â€˜touchmoveâ€™, func, true)<br>window.removeEventListener(â€˜touchmoveâ€™, func, {capture :true})</p>
<h3 id="ä¸ºä»€ä¹ˆä¼šæœ‰-passiveè¿™ä¸ªæ¦‚å¿µ"><a href="#ä¸ºä»€ä¹ˆä¼šæœ‰-passiveè¿™ä¸ªæ¦‚å¿µ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæœ‰ passiveè¿™ä¸ªæ¦‚å¿µ"></a>ä¸ºä»€ä¹ˆä¼šæœ‰ passiveè¿™ä¸ªæ¦‚å¿µ</h3><p>åƒè¿™æ ·å„¿çš„ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"touchstart"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    ... <span class="comment">// æµè§ˆå™¨ä¸çŸ¥é“è¿™é‡Œä¼šä¸ä¼šæœ‰ e.preventDefault()</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç”±äº touchstart äº‹ä»¶å¯¹è±¡çš„ cancelable å±æ€§ä¸º trueï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„é»˜è®¤è¡Œä¸ºå¯ä»¥è¢«ç›‘å¬å™¨é€šè¿‡ preventDefault() æ–¹æ³•é˜»æ­¢ï¼Œé‚£å®ƒçš„é»˜è®¤è¡Œä¸ºæ˜¯ä»€ä¹ˆå‘¢ï¼Œé€šå¸¸æ¥è¯´å°±æ˜¯æ»šåŠ¨å½“å‰é¡µé¢ï¼ˆè¿˜å¯èƒ½æ˜¯ç¼©æ”¾é¡µé¢ï¼‰ï¼Œå¦‚æœå®ƒçš„é»˜è®¤è¡Œä¸ºè¢«é˜»æ­¢äº†ï¼Œé¡µé¢å°±å¿…é¡»é™æ­¢ä¸åŠ¨ã€‚ä½†æµè§ˆå™¨æ— æ³•é¢„å…ˆçŸ¥é“ä¸€ä¸ªç›‘å¬å™¨ä¼šä¸ä¼šè°ƒç”¨ preventDefault()ï¼Œå®ƒèƒ½åšçš„åªæœ‰ç­‰ç›‘å¬å™¨æ‰§è¡Œå®Œåå†å»æ‰§è¡Œé»˜è®¤è¡Œä¸ºï¼Œè€Œç›‘å¬å™¨æ‰§è¡Œæ˜¯è¦è€—æ—¶çš„ï¼Œæœ‰äº›ç”šè‡³è€—æ—¶å¾ˆæ˜æ˜¾ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´é¡µé¢å¡é¡¿ã€‚è§†é¢‘é‡Œä¹Ÿè¯´äº†ï¼Œå³ä¾¿ç›‘å¬å™¨æ˜¯ä¸ªç©ºå‡½æ•°ï¼Œä¹Ÿä¼šäº§ç”Ÿä¸€å®šçš„å¡é¡¿ï¼Œæ¯•ç«Ÿç©ºå‡½æ•°çš„æ‰§è¡Œä¹Ÿä¼šè€—æ—¶ã€‚</p>
<p>æœ‰ 80% çš„æ»šåŠ¨äº‹ä»¶ç›‘å¬å™¨æ˜¯ä¸ä¼šé˜»æ­¢é»˜è®¤è¡Œä¸ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ˜¯ç™½ç­‰äº†ã€‚æ‰€ä»¥ï¼Œpassive ç›‘å¬å™¨è¯ç”Ÿäº†ï¼Œpassive çš„æ„æ€æ˜¯â€œé¡ºä»çš„â€ï¼Œè¡¨ç¤ºå®ƒä¸ä¼šå¯¹äº‹ä»¶çš„é»˜è®¤è¡Œä¸ºè¯´ noï¼Œæµè§ˆå™¨çŸ¥é“äº†ä¸€ä¸ªç›‘å¬å™¨æ˜¯ passive çš„ï¼Œå®ƒå°±å¯ä»¥åœ¨ä¸¤ä¸ªçº¿ç¨‹é‡ŒåŒæ—¶æ‰§è¡Œç›‘å¬å™¨ä¸­çš„ JavaScript ä»£ç å’Œæµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºäº†</p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
  </entry>
  <entry>
    <title>å¼‚æ­¥ç¼–ç¨‹æ–¹æ¡ˆçš„æ¼”è¿›</title>
    <url>/2019/03/19/promise/</url>
    <content><![CDATA[<p>ç¨‹åºä¸­<strong>ç°åœ¨è¿è¡Œçš„éƒ¨åˆ†</strong>å’Œ<strong>å°†æ¥è¿è¡Œçš„éƒ¨åˆ†</strong>å°±æ˜¯<strong>å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒ</strong></p>
<p>å¼‚æ­¥ç¼–ç¨‹çš„æ¼”è¿›å¤§è‡´åˆ†ä»¥ä¸‹å‡ ä¸ªæ—¶æœŸ</p>
<ul>
<li>å›è°ƒå‡½æ•°æ—¶æœŸ</li>
<li>promiseæ—¶æœŸ</li>
<li>ç”Ÿæˆå™¨(ES6) + promiseæ—¶æœŸ</li>
<li>async/awaitæ—¶æœŸ(ES7)</li>
</ul>
<a id="more"></a>
<h1 id="ä½ å¿…é¡»è¦çŸ¥é“çš„åŸºæœ¬æ¦‚å¿µ"><a href="#ä½ å¿…é¡»è¦çŸ¥é“çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ä½ å¿…é¡»è¦çŸ¥é“çš„åŸºæœ¬æ¦‚å¿µ"></a>ä½ å¿…é¡»è¦çŸ¥é“çš„åŸºæœ¬æ¦‚å¿µ</h1><h2 id="å¼‚æ­¥ã€å¹¶è¡Œï¼Œå¹¶å‘çš„åŒºåˆ«"><a href="#å¼‚æ­¥ã€å¹¶è¡Œï¼Œå¹¶å‘çš„åŒºåˆ«" class="headerlink" title="å¼‚æ­¥ã€å¹¶è¡Œï¼Œå¹¶å‘çš„åŒºåˆ«"></a>å¼‚æ­¥ã€å¹¶è¡Œï¼Œå¹¶å‘çš„åŒºåˆ«</h2><ul>
<li>å¼‚æ­¥ï¼šæ˜¯å…³äºç°åœ¨å’Œå°†æ¥çš„äº‹ä»¶é—´éš™</li>
<li>å¹¶è¡Œï¼šæ˜¯å…³äºåŒæ—¶å®Œæˆå¤šä¸ªä»»åŠ¡çš„æ¦‚å¿µ</li>
<li>å¹¶å‘ï¼šæ˜¯æŒ‡åˆ†åˆ«ç”±ä»»åŠ¡aå’Œä»»åŠ¡b åœ¨ä¸€æ®µæ—¶é—´å†…é€šè¿‡ä»»åŠ¡é—´çš„åˆ‡æ¢å®Œæˆäº†è¿™ä¸¤ä¸ªä»»åŠ¡ï¼Œ<strong>å•çº¿ç¨‹äº‹ä»¶å¾ªç¯æ˜¯å¹¶å‘çš„ä¸€ç§å½¢å¼</strong></li>
</ul>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line">å¹¶å‘æ˜¯æŒ‡ä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶éšç€æ—¶é—´å‘å±•äº¤æ›¿æ‰§è¡Œï¼Œä»¥è‡³äºä»æ›´é«˜çš„å±‚æ¬¡ä¸Šçœ‹æ˜¯åŒæ—¶åœ¨è¿è¡Œï¼ˆå°½ç®¡åœ¨ä»»æ„æ—¶åˆ»åªå¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line">å®é™…çš„å¹¶å‘åœºæ™¯</span><br><span class="line">æ¯”å¦‚ç¤¾äº¤ç½‘ç«™ï¼Œéšç€ç”¨æˆ·å‘ä¸‹æ»šåŠ¨åˆ—è¡¨åŠ è½½æ›´å¤šèµ„æº ï¼ˆä¸€è¾¹è§¦å‘ajaxä¸€è¾¹å“åº”æ•°æ®ï¼‰..</span><br></pre></td></tr></table></figure>
<h2 id="jsé‡Œçš„å®Œæ•´è¿è¡Œç‰¹æ€§"><a href="#jsé‡Œçš„å®Œæ•´è¿è¡Œç‰¹æ€§" class="headerlink" title="jsé‡Œçš„å®Œæ•´è¿è¡Œç‰¹æ€§"></a>jsé‡Œçš„å®Œæ•´è¿è¡Œç‰¹æ€§</h2><p>jsä»ä¸è·¨çº¿ç¨‹å…±äº«æ•°æ®ï¼Œå¹¶ä¸”ç”±äºjså•çº¿ç¨‹çš„ç‰¹æ€§ï¼Œå‡½æ•°å—å„¿ä¸­çš„ä»£ç å…·æœ‰å®Œæ•´è¿è¡Œæœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦<code>foo()</code>å¼€å§‹è¿è¡Œï¼Œå®ƒçš„æ‰€æœ‰ä»£ç éƒ½ä¼šåœ¨<code>bar()</code>ä¸­çš„ä»»æ„ä»£ç è¿è¡Œä¹‹å‰å®Œæˆ</p>
<h2 id="äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ä¸ä»»åŠ¡é˜Ÿåˆ—çš„åŒºåˆ«"><a href="#äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ä¸ä»»åŠ¡é˜Ÿåˆ—çš„åŒºåˆ«" class="headerlink" title="äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ä¸ä»»åŠ¡é˜Ÿåˆ—çš„åŒºåˆ«"></a>äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ä¸ä»»åŠ¡é˜Ÿåˆ—çš„åŒºåˆ«</h2><p>ES6ä¸­ï¼Œæœ‰ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—çš„æ¦‚å¿µï¼Œå®ƒæ˜¯æŒ‚è½½åœ¨äº‹ä»¶å¾ªç¯é˜Ÿåˆ—çš„æ¯ä¸ª<code>tick</code>ä¹‹åçš„ä¸€ä¸ªé˜Ÿåˆ—</p>
<p>jså¼•æ“è¿è¡Œåœ¨å®¿ä¸»ç¯å¢ƒä¸­ï¼ˆæµè§ˆå™¨ï¼Œnodeç«¯ç­‰ï¼‰ï¼Œè¿™äº›ç¯å¢ƒéƒ½æœ‰çº¿ç¨‹çš„æ¦‚å¿µï¼Œä»–ä»¬éƒ½æä¾›äº†ä¸€ç§æœºåˆ¶æ¥å¤„ç†ç¨‹åºä¸­å¤šä¸ªå—å„¿çš„æ‰§è¡Œï¼Œä¸”æ‰§è¡Œæ¯å—å„¿æ—¶è°ƒç”¨jså¼•æ“ï¼Œè¿™ç§æœºåˆ¶è¢«ç§°ä¹‹ä¸º<strong>äº‹ä»¶å¾ªç¯</strong></p>
<p>ä¸€æ—¦æœ‰äº‹ä»¶éœ€è¦è¿è¡Œï¼Œäº‹ä»¶å¾ªç¯å°±ä¼šè¿è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—æ¸…ç©ºï¼Œäº‹ä»¶å¾ªç¯çš„æ¯ä¸€è½®ç§°ä¸ºä¸€ä¸ªtickï¼Œç”¨æˆ·äº¤äº’ IOå’Œå®šæ—¶å™¨ä¼šå‘äº‹ä»¶é˜Ÿåˆ—ä¸­åŠ å…¥äº‹ä»¶ï¼Œä»»æ„æ—¶åˆ»ï¼Œä¸€æ¬¡åªèƒ½ä»é˜Ÿåˆ—ä¸­å¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼Œæ‰§è¡Œäº‹ä»¶çš„æ—¶å€™ï¼Œå¯èƒ½ç›´æ¥æˆ–è€…é—´æ¥åœ°å¼•å‘ä¸€ä¸ªæˆ–è€…å¤šä¸ªåç»­äº‹ä»¶</p>
<p>ä¸€ä¸ªæ¯”è¾ƒå½¢è±¡çš„æ¯”å–»</p>
<ul>
<li>äº‹ä»¶å¾ªç¯é˜Ÿåˆ—ï¼šç±»ä¼¼äºä¸€ä¸ªæ¸¸ä¹åœºæ¸¸æˆï¼Œç©è¿‡äº†ä¸€ä¸ªæ¸¸æˆä¹‹åï¼Œä½ éœ€è¦é‡æ–°åˆ°é˜Ÿå°¾æ’é˜Ÿæ‰èƒ½å†ç©ä¸€æ¬¡</li>
<li>ä»»åŠ¡é˜Ÿåˆ—ï¼šç©è¿‡äº†æ¸¸æˆä¹‹åï¼Œæ’é˜Ÿæ¥ç€ç©</li>
</ul>
<h1 id="ç¬¬ä¸€é˜¶æ®µ-å›è°ƒå‡½æ•°æ—¶æœŸ"><a href="#ç¬¬ä¸€é˜¶æ®µ-å›è°ƒå‡½æ•°æ—¶æœŸ" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µ(å›è°ƒå‡½æ•°æ—¶æœŸ)"></a>ç¬¬ä¸€é˜¶æ®µ(å›è°ƒå‡½æ•°æ—¶æœŸ)</h1><p>ä»»ä½•æ—¶å€™ï¼Œåªè¦æŠŠä¸€æ®µä»£ç åŒ…è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æŒ‡å®šå®ƒåœ¨å“åº”æŸä¸ªäº‹ä»¶æ—¶æ‰§è¡Œï¼Œä½ å°±æ˜¯åœ¨ä»£ç ä¸­åˆ›å»ºäº†ä¸€ä¸ªå°†æ¥æ‰§è¡Œçš„å—å„¿ï¼Œä¹Ÿç”±æ­¤åœ¨è¿™ä¸ªç¨‹åºä¸­å¼•å…¥äº†å¼‚æ­¥æœºåˆ¶ã€‚</p>
<h2 id="å›è°ƒå®ç°å¼‚æ­¥çš„ç‰¹æ€§"><a href="#å›è°ƒå®ç°å¼‚æ­¥çš„ç‰¹æ€§" class="headerlink" title="å›è°ƒå®ç°å¼‚æ­¥çš„ç‰¹æ€§"></a>å›è°ƒå®ç°å¼‚æ­¥çš„ç‰¹æ€§</h2><ul>
<li>å›è°ƒå‡½æ•°æ˜¯<code>js</code>å¼‚æ­¥çš„åŸºæœ¬å•å…ƒï¼Œä½†æ˜¯éšç€jsè¶Šæ¥è¶Šæˆç†Ÿï¼Œå¯¹äºå¼‚æ­¥ç¼–ç¨‹çš„å‘å±•ï¼Œå›è°ƒå·²ç»ä¸å¤Ÿç”¨äº†ä»¥è‡³äºäº§ç”Ÿå¯æ€•çš„<strong>å›è°ƒåœ°ç‹±</strong>ï¼ŒåµŒå¥—å‡½æ•°å­˜åœ¨è€¦åˆæ€§ï¼Œä¸€å¤§æœ‰æ‰€æ”¹åŠ¨å°±ä¼šç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œè€Œä¸”åµŒå¥—è¿‡å¤šå¯¼è‡´é”™è¯¯éš¾ä»¥å¤„ç†</li>
<li>å›è°ƒè¡¨è¾¾å¼‚æ­¥æµç¨‹çš„æ–¹å¼æ˜¯éçº¿æ€§çš„ï¼Œéé¡ºåºçš„ï¼Œè¿™ä½¿å¾—æ­£ç¡®æ¨ç†è¿™æ ·å„¿çš„ä»£ç éš¾åº¦å¾ˆå¤§ï¼Œéš¾ä»¥ç†è§£ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´åŒæ­¥æ›´é¡ºåºæ›´é˜»å¡çš„æ–¹å¼æ¥è¡¨è¾¾å¼‚æ­¥ï¼Œå°±åƒæˆ‘ä»¬çš„å¤§è„‘ä¸€æ ·ã€‚</li>
<li>å›è°ƒä¼šå—åˆ°<strong>æ§åˆ¶åè½¬</strong>çš„å½±å“ï¼Œå› ä¸ºå›è°ƒå‡½æ•°ä¸­æŠŠæ§åˆ¶æƒäº¤ç»™ç¬¬ä¸‰æ–¹æ¯”å¦‚<code>ajax()</code>ï¼Œä¼šé€ æˆä¸€ç³»åˆ—éº»çƒ¦çš„<strong>ä¿¡ä»»é—®é¢˜</strong> </li>
</ul>
<font color="red">å¯èƒ½äº§ç”Ÿçš„ä¿¡ä»»é—®é¢˜</font>

<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1. </span>è°ƒç”¨å›è°ƒè¿‡æ—©</span><br><span class="line"><span class="bullet">2. </span>è°ƒç”¨å›è°ƒè¿‡æ™šï¼ˆæˆ–è€…ä¸è¢«è°ƒç”¨ï¼‰</span><br><span class="line"><span class="bullet">3. </span>è°ƒç”¨å›è°ƒæ¬¡æ•°è¿‡å¤šæˆ–è€…è¿‡å°‘</span><br><span class="line"><span class="bullet">4. </span>æœªèƒ½ä¼ é€’æ‰€éœ€çš„ç¯å¢ƒå’Œå‚æ•°</span><br><span class="line"><span class="bullet">5. </span>åæ‰å¯èƒ½å‡ºç°çš„é”™è¯¯å’Œå¼‚å¸¸</span><br></pre></td></tr></table></figure>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€šç”¨çš„æ–¹æ¡ˆæ¥è§£å†³è¿™äº›ä¿¡ä»»é—®é¢˜ï¼Œä¸ç®¡æˆ‘ä»¬åˆ›å»ºå¤šå°‘å›è°ƒï¼Œè¿™ä¸€æ–¹æ¡ˆéƒ½å¯ä»¥å¤ç”¨ï¼Œä¸”æ²¡æœ‰é‡å¤ä»£ç çš„å¼€é”€ å¼•å‡ºäº†<strong>Promise</strong></p>
<h1 id="ç¬¬äºŒé˜¶æ®µ-Promiseæ—¶æœŸ"><a href="#ç¬¬äºŒé˜¶æ®µ-Promiseæ—¶æœŸ" class="headerlink" title="ç¬¬äºŒé˜¶æ®µ(Promiseæ—¶æœŸ)"></a>ç¬¬äºŒé˜¶æ®µ(Promiseæ—¶æœŸ)</h1><p>ç›´åˆ°<code>ES6 Promise</code>çš„å¼•å…¥JSæ‰çœŸæ­£æœ‰å†…å»ºçš„å¼‚æ­¥æ¦‚å¿µ</p>
<p>æˆ‘ä»¬å¼€ç¯‡å°±äº†è§£åˆ°äº† å¼‚æ­¥ç¼–ç¨‹åˆ†ç°åœ¨è¿è¡Œéƒ¨åˆ† å’Œå°†æ¥è¿è¡Œéƒ¨åˆ†çš„æ¦‚å¿µ</p>
<ul>
<li>å›è°ƒå‡½æ•°çš„æ¨¡å¼æ˜¯å…³äº<strong>å¦‚ä½•å¤„ç†å°†æ¥å€¼</strong></li>
<li><code>Promise</code> æ˜¯æŠŠç°åœ¨å’Œå°†æ¥å½’ä¸€åŒ–äº† æŠŠä»–ä»¬éƒ½å˜æˆäº†å°†æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ å®ƒæŠŠæ‰€æœ‰çš„æ“ä½œéƒ½å˜æˆäº†å¼‚æ­¥çš„</li>
</ul>
<h2 id="Promiseçš„ç‰¹ç‚¹"><a href="#Promiseçš„ç‰¹ç‚¹" class="headerlink" title="Promiseçš„ç‰¹ç‚¹"></a>Promiseçš„ç‰¹ç‚¹</h2><ul>
<li>æˆ‘ä»¬é€šè¿‡æŸç§æ–¹å¼åœ¨å‡½æ•°å®Œæˆæ—¶å€™å¾—åˆ°é€šçŸ¥ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç»§ç»­ä¸‹ä¸€æ­¥</li>
<li>ç±»ä¼¼äºäº‹ä»¶è®¢é˜… æˆ‘ä»¬ä¸éœ€è¦å…³æ³¨è°è®¢é˜…äº†è¿™äº›äº‹ä»¶ï¼Œå®ç°äº†å…³æ³¨ç‚¹åˆ†ç¦»</li>
<li>Promise å°è£…äº†ä¾èµ–æ—¶é—´çš„çŠ¶æ€-å®ƒç­‰å¾…åº•å±‚å€¼çš„å®Œæˆæˆ–è€…æ‹’ç» æ‰€ä»¥promiseæœ¬èº«æ˜¯ä¸æ—¶é—´æ— å…³çš„</li>
<li>å®ƒå¯ä»¥æŒ‰ç…§å¯é¢„æµ‹çš„æ–¹å¼ç»„åˆ è€Œä¸ç”¨å…³å¿ƒåº•å±‚ä»£ç å¦‚ä½•ç»“æŸ</li>
<li>ä¸€æ—¦ <code>promise</code>å†³è®®ï¼Œå®ƒå°±æ°¸è¿œä¿æŒåœ¨è¿™ä¸ªçŠ¶æ€</li>
<li>promiseæ˜¯ä¸€ç§å°è£…å’Œç»„åˆæœªæ¥å€¼çš„æ˜“äºå¤ç”¨çš„æœºåˆ¶</li>
</ul>
<h2 id="PromiseåŸºæœ¬ç”¨æ³•"><a href="#PromiseåŸºæœ¬ç”¨æ³•" class="headerlink" title="PromiseåŸºæœ¬ç”¨æ³•"></a>PromiseåŸºæœ¬ç”¨æ³•</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line"> <span class="comment">//resolve()ç”¨äºå®Œæˆ</span></span><br><span class="line"> <span class="comment">//reject() ç”¨äºæ‹’ç»</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"> ä»–æœ‰ä¸‰ä¸ªçŠ¶æ€ </span><br><span class="line"> pending,fulfilledï¼Œrejected </span><br><span class="line"> </span><br><span class="line"> ä¸¤ä¸ªè¿‡ç¨‹</span><br><span class="line"> </span><br><span class="line"> pending -&gt; fulfilled</span><br><span class="line"> pending -&gt; rejected</span><br><span class="line"> </span><br><span class="line">resolveï¼šä¼šå°†ä¼ å…¥çš„çœŸæ­£çš„promiseç›´æ¥è¿”å›ï¼Œå¯¹ä¼ å…¥çš„thenableä¼šå±•å¼€,å¦‚æœè¿™ä¸ªthenableå±•å¼€æ˜¯ä¸€ä¸ªæ‹’ç»çŠ¶æ€ï¼Œé‚£ä¹ˆä»promise.resolve()è¿”å›çš„promiseå®é™…ä¸Šå°±æ˜¯è¿™åŒä¸€ä¸ªæ‹’ç»çŠ¶æ€</span><br><span class="line">æ‰€ä»¥resolveå®é™…ä¸Šçš„ç»“æœå¯èƒ½æ˜¯å®Œæˆæˆ–æ‹’ç»</span><br><span class="line"></span><br><span class="line">rejected ï¼šæ‹’ç»çŠ¶æ€</span><br></pre></td></tr></table></figure>
<p>å®ä¾‹çš„è°ƒç”¨</p>
<figure class="highlight scilab"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">promise.<span class="keyword">then</span>(resolveFn,rejectFn)</span><br><span class="line">å¦‚ä¸‹ï¼š</span><br><span class="line">promise.<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">(value)</span> &#123;</span></span><br><span class="line">  <span class="comment">// success</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span><span class="params">(error)</span> &#123;</span></span><br><span class="line">  <span class="comment">// failure</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•ç¡®å®šæŸä¸ªå€¼æ˜¯ä¸æ˜¯çœŸæ­£çš„promiseï¼ˆæˆ–è€…è¯´thenableï¼‰"><a href="#å¦‚ä½•ç¡®å®šæŸä¸ªå€¼æ˜¯ä¸æ˜¯çœŸæ­£çš„promiseï¼ˆæˆ–è€…è¯´thenableï¼‰" class="headerlink" title="å¦‚ä½•ç¡®å®šæŸä¸ªå€¼æ˜¯ä¸æ˜¯çœŸæ­£çš„promiseï¼ˆæˆ–è€…è¯´thenableï¼‰"></a>å¦‚ä½•ç¡®å®šæŸä¸ªå€¼æ˜¯ä¸æ˜¯çœŸæ­£çš„promiseï¼ˆæˆ–è€…è¯´thenableï¼‰</h3><p>åˆ©ç”¨é¸­å­æ¨¡å‹<br>å¦‚æœä¸€ä¸ªå‡½æ•°æˆ–å¯¹è±¡å…·æœ‰.then()æ–¹æ³•ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ ·å„¿çš„å€¼å°±æ˜¯<code>Promise</code>ä¸€è‡´çš„<code>thenable</code></p>
<p>æ‰€ä»¥ä¸è¦ç»™å‡½æ•°æˆ–è€…å¯¹è±¡æ·»åŠ <code>.then</code><br>æ–¹æ³•ï¼Œå¦åˆ™è¿™ä¸ªå€¼å°±ä¼šè¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ª<code>thenable</code> å¯¼è‡´éš¾ä»¥è¿½è¸ªçš„<code>bug</code></p>
<p>æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“äºŸå¾…è§£å†³çš„é—®é¢˜ï¼ŒæŠŠå›è°ƒçš„ç¼ºé™·è§£å†³äº†ï¼Œå¦åˆ™å¼•å…¥<code>Promise</code>æ²¡æœ‰ä»»ä½•æ„ä¹‰</p>
<h2 id="è§£å†³æ§åˆ¶åè½¬é—®é¢˜"><a href="#è§£å†³æ§åˆ¶åè½¬é—®é¢˜" class="headerlink" title="è§£å†³æ§åˆ¶åè½¬é—®é¢˜"></a>è§£å†³æ§åˆ¶åè½¬é—®é¢˜</h2><p>ä¹‹å‰ æˆ‘ä»¬ç”¨å›è°ƒå‡½æ•°å°è£…ç¨‹åºä¸­çš„ä»£ç ï¼Œç„¶åå°†å…¶äº¤ç»™ç¬¬ä¸‰æ–¹ç­‰ï¼ˆæ¯”å¦‚ajaxï¼‰ï¼Œæ¥ç€æœŸå¾…å…¶èƒ½è°ƒç”¨å›è°ƒå®ç°åŠŸèƒ½<br>ç°åœ¨æˆ‘ä»¬è¦èƒ½å¤ŸæŠŠæ§åˆ¶åè½¬å†åè½¬å›æ¥<br>æˆ‘ä»¬å¸Œæœ›ç¬¬ä¸‰æ–¹<strong>ç»™æˆ‘ä»¬æä¾›å…¶ä»»åŠ¡ä½•æ—¶ç»“æŸçš„èƒ½åŠ›</strong>ï¼Œç„¶åç”±æˆ‘ä»¬è‡ªå·±çš„ä»£ç æ¥å†³å®šä¸‹ä¸€æ­¥åšä»€ä¹ˆ</p>
<font color="red">è€å®è¯´ ç»å¤§å¤šæ•°JS/DOMæ–°å¢çš„å¼‚æ­¥APIéƒ½æ˜¯åŸºäºPromiseæ„å»ºçš„</font><br>## è§£å†³ä¿¡ä»»é—®é¢˜<br>### promiseè§£å†³è°ƒç”¨è¿‡æ—©<br>å¯¹ä¸€ä¸ª<code>promise</code>è°ƒç”¨thençš„æ—¶å€™ï¼Œå³ä½¿è¿™ä¸ª<code>promise</code>å·²ç»å†³è®®ï¼Œæä¾›ç»™<code>then()</code>çš„å›è°ƒæ€»ä¼šè¢«å¼‚æ­¥è°ƒç”¨<br>### promiseè§£å†³è°ƒç”¨è¿‡æ™š<br><code>promise</code>å¯¹è±¡åˆ›å»º<code>resolve</code>æˆ–è€…<code>reject</code>æ—¶ï¼Œè¿™ä¸ªpromiseçš„thenæ³¨å†Œçš„è§‚å¯Ÿå›è°ƒå°±ä¼šè¢«è‡ªåŠ¨è°ƒåº¦ï¼Œå¯ä»¥ç¡®ä¿¡ï¼Œè¿™äº›è¢«è°ƒåº¦çš„å›è°ƒåœ¨ä¸‹ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶ç‚¹ä¸Šä¾æ¬¡è¢«ç«‹å³è°ƒç”¨ï¼Œè¿™äº›å›è°ƒä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½æ— æ³•å½±å“æˆ–å»¶è¯¯å¯¹å…¶ä»–å›è°ƒçš„è°ƒç”¨ï¼Œè¿™æ˜¯promiseçš„è¿ä½œæ–¹å¼<br>### å›è°ƒæœªè°ƒç”¨<br>æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼ˆç”šè‡³æ˜¯jsé”™è¯¯ï¼‰èƒ½é˜»æ­¢promiseå‘ä½ é€šçŸ¥ä»–çš„å†³è®®ï¼Œpromiseåœ¨å†³è®®æ—¶æ€»æ˜¯ä¼šè°ƒç”¨å…¶ä¸­ä¸€ä¸ª<br><br>å¦‚æœpromiseæœ¬èº«æ°¸è¿œä¸è¢«å†³è®®ã€‚promiseä¹Ÿæä¾›äº†è§£å†³æ–¹æ¡ˆ<br><br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">ç”¨äºä¸€ä¸ªè¶…æ—¶çš„promise</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeoutpromise</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> promise(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line"> setTimeout(functiion()&#123;</span><br><span class="line">  reject(<span class="string">'timeout'</span>)</span><br><span class="line"> &#125;,delay)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>### è°ƒç”¨æ¬¡æ•°è¿‡å¤šæˆ–è¿‡å°‘<br>promiseå®šä¹‰æ–¹å¼ä½¿å¾—å®ƒåªèƒ½è¢«å†³è®®ä¸€æ¬¡<br>å¦‚æœè¯•å›¾è°ƒç”¨å¤šæ¬¡æˆ–è€…resolveå’Œrejectéƒ½è°ƒç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªpromiseåªæ¥å—ç¬¬ä¸€ä¸ªå†³è®®ï¼Œå¹¶é»˜é»˜çš„å¿½ç•¥ä»»ä½•åç»­è°ƒç”¨<br>å½“ç„¶äº†ï¼Œå¦‚æœä½ æŠŠåŒä¸€ä¸ªå›è°ƒæ³¨å†Œäº†ä¸æ­¢ä¸€æ¬¡(p.then(f);p.then(f))é‚£ä¹ˆå®ƒè¢«è°ƒç”¨çš„æ¬¡æ•°å°±ä¼šå’Œæ³¨å†Œæ¬¡æ•°ç›¸ç­‰<br><br>### æœªèƒ½ä¼ é€’å‚æ•°/ç¯å¢ƒå€¼<br>promiseè‡³å¤šåªèƒ½æœ‰ä¸€ä¸ªå†³è®®å€¼ï¼ˆå®Œæˆæˆ–æ‹’ç»ï¼‰<br>å¦‚æœä½¿ç”¨å¤šä¸ªå‚æ•°è°ƒç”¨resolveæˆ–è€…reject ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹åçš„æ‰€æœ‰å‚æ•°éƒ½ä¼šé»˜é»˜å¿½ç•¥<br><br>å¦‚æœè¦ä¼ é€’å¤šä¸ªå€¼ï¼Œå°±å¿…é¡»æŠŠä»–ä»¬å°è£…åœ¨å•ä¸ªå€¼ä¸­ä¼ é€’ æ¯”å¦‚ä¸€ä¸ªæ•°ç»„æˆ–è€…å¯¹è±¡<br><br>### åæ‰é”™è¯¯æˆ–è€…å¼‚å¸¸<br>å¦‚æœåœ¨<code>Promise</code>çš„åˆ›å»ºè¿‡ç¨‹ä¸­æˆ–è€…æŸ¥çœ‹å†³è®®ç»“æœè¿‡ç¨‹ä¸­çš„ä»»ä½•æ—¶é—´ç‚¹ä¸Šå‡ºç°äº†jsçš„å¼‚å¸¸é”™è¯¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸å°±ä¼šè¢«æ•æ‰ï¼Œå¹¶ä¸”ä¼šä½¿è¿™ä¸ª<code>Promise</code>æ‹’ç»<code>reject</code><br><br>promiseç”šè‡³æŠŠjsçš„å¼‚å¸¸ä¹Ÿå˜æˆäº†å¼‚æ­¥è¡Œä¸ºï¼Œè¿›è€Œæå¤§é™ä½äº†é™æ€æ¡ä»¶å‡ºç°çš„å¯èƒ½<br><br>ä½†æ˜¯å¦‚æœpromiseå®Œæˆåçš„å›è°ƒä¸­å‡ºç°äº†jså¼‚å¸¸<br><br>å› ä¸ºp.then()æœ¬èº«è¿”å›äº†å¦å¤–ä¸€ä¸ªpromise æ­£æ˜¯è¿™ä¸ªpromise(ä¸‹ä¸€ä¸ªpromise)å°†ä¼šå› TypeErrorå¼‚å¸¸è€Œè¢«æ‹’ç»<br><br><font color="red">æ³¨æ„ï¼šä¸ºä»€ä¹ˆå®ƒä¸æ˜¯ç®€å•çš„è°ƒç”¨æˆ‘ä»¬çš„é”™è¯¯å¤„ç†å‡½æ•°å‘¢ï¼Ÿ</font><br>å¦‚æœè¿™æ ·å„¿çš„è¯å°±è¿èƒŒäº†promiseçš„åŸºæœ¬åŸåˆ™ï¼špromiseä¸€æ—¦å†³è®®å°±ä¸å¯æ”¹å˜<br>ä¹Ÿä¼šé€ æˆæœ‰äº›å›è°ƒä¼šè°ƒç”¨ï¼Œæœ‰äº›å›è°ƒä¸ä¼šè°ƒç”¨æƒ…å†µä¼šéå¸¸ä¸é€æ˜<br><br>### æ˜¯å¯ä¿¡ä»»çš„Promise<br><br><strong>promiseå¹¶æ²¡æœ‰å®Œå…¨æ‘†è„±å›è°ƒï¼Œä»–ä»¬åªæ˜¯æ”¹å˜äº†ä¼ é€’å›è°ƒçš„ä½ç½®</strong><br><br><em> å¦‚æœä½ å‘<code>promise.resolve()</code>ä¼ é€’ä¸€ä¸ª<code>épromise</code> å°±ä¼šå¾—åˆ°ç”¨è¿™ä¸ªå€¼å¡«å……çš„Promise

</em> å¦‚æœä½ å‘promise.resolve()ä¼ é€’ä¸€ä¸ªçœŸæ­£çš„promise å°±ä¼šè¿”å›åŒä¸€ä¸ªpromise<br><br><em> <code>promise.resolve()</code>å¯ä»¥æ¥å—ä»»ä½•<code>thenable</code>ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªçœŸæ­£çš„Promise æ˜¯ä¸€ä¸ªå¯ä¿¡ä»»çš„å€¼ï¼Œå¦‚æœä½ ä¼ å…¥çš„å·²ç»æ˜¯çœŸçš„Promise é‚£ä¹ˆå°±æ›´å€¼å¾—ä¿¡ä»»äº†
</em> å¯¹äºç”¨promise.resolve()ä¸ºæ‰€æœ‰å‡½æ•°çš„è¿”å›å€¼ï¼ˆä¸ç®¡æ˜¯ä¸æ˜¯thenableï¼‰éƒ½å°è£…ä¸€å±‚ï¼Œè¿™æ ·å„¿åšå¾ˆå®¹æ˜“æŠŠå‡½æ•°è°ƒç”¨è§„èŒƒä¸ºå®šä¹‰è‰¯å¥½çš„å¼‚æ­¥ä»»åŠ¡<br><br><em> <code>Promise</code>è¿™ç§æ¨¡å¼é€šè¿‡å¯ä¿¡ä»»çš„è¯­ä¹‰æŠŠå›è°ƒå½“å‚æ•°ä¼ é€’ï¼Œä½¿å¾—è¿™ç§è¡Œä¸ºæ›´åŠ å¯é åˆç†ï¼Œé€šè¿‡æŠŠå›è°ƒçš„æ§åˆ¶åè½¬å›æ¥ï¼Œæˆ‘ä»¬æŠŠæ§åˆ¶æƒæ”¾åœ¨äº†ä¸€ä¸ªå¯ä¿¡ä»»çš„ç³»ç»Ÿï¼Œè¿™ç§ç³»ç»Ÿçš„è®¾è®¡ç›®çš„å°±æ˜¯ä¸ºäº†ä½¿å¾—å¼‚æ­¥ç¼–ç æ›´æ¸…æ™°<br><br><br>â€”â€”-<br>ä»¥ä¸Š promiseè§£å†³äº†å›è°ƒå‡½æ•°çš„è‡´å‘½é—®é¢˜<br>æ¥ä¸‹æ¥ æˆ‘ä»¬å°†å±•ç¤ºåŸºäºpromiseçš„é“¾å¼æµä½œç”¨<br><br><br>## Promiseçš„é“¾å¼æµ<br>Promiseå¹¶ä¸æ˜¯ä¸€ä¸ªå•æ­¥éµå¾ª<code>this-then-that</code>æ“ä½œçš„æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªPromiseé“¾æ¥åœ¨ä¸€èµ·è¡¨ç¤ºä¸€ç³»åˆ—å¼‚æ­¥æ­¥éª¤<br><br>è¿™ç§æ–¹å¼å®ç°çš„æœ‰ä»¥ä¸‹ç‰¹æ€§

</em> æ¯æ¬¡ä½ å¯¹promiseè°ƒç”¨then()å®ƒä¼šåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°çš„promise,æˆ‘ä»¬å¯ä»¥å°†å…¶é“¾æ¥èµ·æ¥<br><em> ä¸ç®¡ä»then()è°ƒç”¨çš„å®Œæˆå›è°ƒï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰è¿”å›çš„å€¼æ˜¯ä»€ä¹ˆï¼Œä»–éƒ½ä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸ºè¢«é“¾æ¥promiseï¼ˆç¬¬ä¸€ç‚¹ä¸­çš„ï¼‰çš„å®Œæˆ
</em> è°ƒç”¨promiseçš„then()ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„promiseä»è°ƒç”¨è¿”å›<br><em> åœ¨å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°å†…éƒ¨ï¼Œå¦‚æœè¿”å›ä¸€ä¸ªå€¼æˆ–è€…æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚æ–°è¿”å›çš„promiseï¼ˆå¯é“¾æ¥çš„ï¼‰å°±ç›¸åº”çš„å†³è®®
</em> å¦‚æœè¿”å›æˆ–æ‹’ç»å¤„ç†å‡½æ•°è¿”å›ä¸€ä¸ªpromise,å®ƒå°†ä¼šè¢«å±•å¼€ï¼Œè¿™æ ·å„¿ä¸€æ¥ï¼Œä¸ç®¡å®ƒçš„å†³è®®å€¼æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šæˆä¸ºå½“å‰then()è¿”å›çš„é“¾æ¥promiseçš„å†³è®®å€¼<br><br>å¦‚ä¸‹<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve(<span class="number">21</span>);</span><br><span class="line"> p.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(v * <span class="number">2</span>)  <span class="comment">//42</span></span><br><span class="line">  <span class="keyword">return</span> v + <span class="number">2</span> <span class="comment">// ***</span></span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'ceshi'</span>,v) <span class="comment">//23</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>ç¬¬ä¸€ä¸ªthenå°±æ˜¯å¼‚æ­¥åºåˆ—çš„ç¬¬ä¸€æ­¥<br><br>ç¬¬äºŒä¸ªthenæ˜¯ç¬¬äºŒæ­¥,<strong>åªè¦ä¿è¯æŠŠå…ˆå‰çš„then(..)è¿åˆ°è‡ªåŠ¨åˆ›å»ºçš„æ¯ä¸€ä¸ªpromiseå³å¯</strong><br><br>åœ¨è¿™ä¸ªdemo ä¸­ æˆ‘ä»¬ç”¨äº†ç«‹å³è¿”å›çš„returnè¯­å¥<br><br>ä½†æ˜¯æˆ‘ä»¬å¦‚æœéœ€è¦æ­¥éª¤äºŒç­‰å¾…æ­¥éª¤ä¸€å¼‚æ­¥æ¥å®Œæˆä¸€äº›äº‹æƒ…æ€ä¹ˆåŠï¼Ÿ<br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³è¦ä½¿promiseåºåˆ—çœŸæ­£èƒ½å¤Ÿåœ¨æ¯ä¸€æ­¥æœ‰å¼‚æ­¥èƒ½åŠ›ï¼Ÿ<br><br><br><figure class="highlight mercury"><table><tr><td class="code"><pre><span class="line">æˆ‘ä»¬å¯ä»¥ç»™<span class="keyword">promise</span>.resolve()ä¼ é€’éï¼ˆæœ€ç»ˆå€¼ï¼‰å³ **çœŸæ­£çš„<span class="keyword">promise</span>æˆ–thenable**ï¼ŒPromiseä¼šç›´æ¥è¿”å›çœŸæ­£çš„<span class="keyword">promise</span> æˆ–å±•å¼€æ¥æ”¶åˆ°çš„thenableå€¼ï¼Œå¹¶åœ¨æŒç»­å±•å¼€`thanable`çš„åŒæ—¶é€’å½’å‰è¿›</span><br></pre></td></tr></table></figure><br><br>å¦‚ä¸‹<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve(<span class="number">21</span>);</span><br><span class="line"> p.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    resolve(v*<span class="number">2</span>) <span class="comment">//42</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(v) <span class="comment">//42</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>æˆ‘ä»¬æŠŠ42å°è£…åˆ°äº†è¿”å›çš„promiseä¸­ï¼Œä½†æ˜¯å®ƒä»ç„¶ä¼šè¢«å±•å¼€å¹¶æœ€ç»ˆæˆä¸ºé“¾æ¥çš„promiseçš„å†³è®®ï¼Œå› æ­¤ç¬¬äºŒä¸ª.thenå‡½æ•°ä¸­çš„åˆ°çš„ä»ç„¶æ˜¯42<br><br>æ­¤æ—¶ï¼Œå¦‚æœå‘å°è£…çš„promiseä¸­å¼•å…¥å¼‚æ­¥ï¼Œä»ç„¶ä¼šæ­£å¸¸å·¥ä½œ<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve(<span class="number">21</span>);</span><br><span class="line"> p.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      resolve(v*<span class="number">2</span>)</span><br><span class="line">    &#125;,<span class="number">200</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(v) <span class="comment">//42</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>å®Œç¾ æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ç³»åˆ—ä¸ªå¼‚æ­¥æ­¥éª¤<br><br>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œä¸€æ­¥ä¸€æ­¥ä¼ é€’çš„å€¼æ˜¯å¯é€‰çš„ï¼Œä¸ä¼ çš„è¯å°±æ˜¯éšå¼è¿”å›<code>undefined</code>å¹¶ä¸”è¿™äº›<code>Promise</code>ä»ç„¶ä¼šä»¥åŒæ ·çš„æ–¹å¼é“¾æ¥åˆ°ä¸€èµ· æ¯ä¸€ä¸ª<code>Promise</code>çš„å†³è®®å°±æˆäº†ç»§ç»­ä¸‹ä¸€ä¸ªæ­¥éª¤çš„ä¿¡å·<br><br>### å­˜åœ¨é»˜è®¤çš„resolveå’Œrejectå›è°ƒ<br>é»˜è®¤çš„reject<br><br>å¦‚æœä½ è°ƒç”¨.then()å‡½æ•°å¹¶ä¸”åªä¼ å…¥ä¸€ä¸ªå®Œæˆå¤„ç†å‡½æ•°ï¼Œä¸€ä¸ªé»˜è®¤æ‹’ç»å¤„ç†å‡½æ•°å°±ä¼šé¡¶æ›¿ä¸Šæ¥ï¼Œé»˜è®¤æ‹’ç»å¤„ç†å‡½æ•°åªæ˜¯æŠŠé”™è¯¯é‡æ–°æŠ›å‡ºï¼Œè¿™ä½¿å¾—é”™è¯¯å¯ä»¥ç»§ç»­æ²¿ç€Promiseé“¾ä¼ æ’­ä¸‹å»ï¼Œç›´åˆ°é‡åˆ°æ˜¾å¼å®šä¹‰çš„æ‹’ç»å¤„ç†å‡½æ•°<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">  reject(<span class="string">'ooPs'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = p.then(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">fulfilled</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//ä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//é»˜è®¤çš„æ‹’ç»å¤„ç†å‡½æ•° å½“ä½ æ²¡æœ‰ä¼ æ—¶</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">err</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> err;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><br><br>é»˜è®¤çš„reject<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = p.then(</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">v</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//ä¸ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//é»˜è®¤çš„æ‹’ç»å¤„ç†å‡½æ•° å½“ä½ æ²¡æœ‰ä¼ æ—¶</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">err</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//..</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'ss'</span>,v) <span class="comment">//2</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>é»˜è®¤çš„å®Œæˆå¤„ç†å‡½æ•°åªæ˜¯æŠŠæ¥å—åˆ°çš„ä»»ä½•ä¼ å…¥å€¼ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ­¥éª¤çš„<code>promise</code>è€Œå·²<br><br><br>## å…³äºé”™è¯¯å¤„ç†<br><br>### ä¹‹å‰åŒæ­¥çš„é”™è¯¯å¤„ç†<br><br>â€”â€”-<br><br>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨try catchå¤„ç†å¼‚å¸¸<br>ä½†æ˜¯å®ƒåªèƒ½æ˜¯åŒæ­¥çš„ï¼Œ<strong>æ— æ³•ç”¨äºå¼‚æ­¥ä»£ç æ¨¡å¼</strong><br>å³ä½¿ä½ åœ¨å¼‚æ­¥ä»£ç  æ¯”å¦‚setTimeoutä¸­è°ç”¨try catch ä»ç„¶æ˜¯æœ‰é—®é¢˜çš„ï¼Œä»–ä»¬é‡‡ç”¨error-firstå›è°ƒé£æ ¼ï¼Œæ— æ³•å¾ˆå¥½çš„ç»„åˆï¼Œå¤šçº§error-firstå›è°ƒäº¤ç»‡ï¼Œå¯¼è‡´äº†å›è°ƒåœ°ç‹±çš„é£é™©<br><br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(cb)</span></span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> x = baz.bar();</span><br><span class="line">      cb(<span class="literal">null</span>,x)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(err)&#123;</span><br><span class="line">      cb(err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">åªæœ‰åœ¨ baz.bar()è°ƒç”¨ä¼šåŒæ­¥åœ°ç«‹å³æˆåŠŸæˆ–å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œçš„<span class="keyword">try</span> <span class="keyword">catch</span>æ‰èƒ½å·¥ä½œ</span><br></pre></td></tr></table></figure><br><br>### promiseçš„é”™è¯¯å¤„ç† å¢åŠ  .catch(..)æ–¹æ³•<br>.catch(..)ä¼šåˆ›å»ºå¹¶è¿”å›æ–°çš„promiseï¼Œè¿™ä¸ªpromiseå¯ç”¨äºå®ç°promiseé“¾å¼æµç¨‹æ§åˆ¶<br>å®ƒæ²¡æœ‰é‡‡ç”¨error-firstå›è°ƒè®¾è®¡é£æ ¼ï¼Œè€Œæ˜¯ä½¿ç”¨äº†åˆ†ç¦»å›è°ƒé£æ ¼<br><code>ä¸€ä¸ªå›è°ƒç”¨äºå®Œæˆæƒ…å†µ
ä¸€ä¸ªå›è°ƒç”¨äºæ‹’ç»æƒ…å†µ</code><br><br>æˆ‘ä»¬äº†è§£åˆ° åœ¨å®Œæˆæˆ–æ‹’ç»å¤„ç†å‡½æ•°å†…éƒ¨ï¼Œå¦‚æœè¿”å›ä¸€ä¸ªå€¼æˆ–è€…æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚æ–°è¿”å›çš„promiseï¼ˆå¯é“¾æ¥çš„ï¼‰å°±ç›¸åº”çš„å†³è®®ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ æ²¡æœ‰æ•æ‰<code>.then</code>çš„å¼‚å¸¸ï¼Œå®ƒå‡å®šä½ æƒ³è¦promiseçŠ¶æ€åæ‰æ‰€æœ‰çš„é”™è¯¯ï¼Œå¦‚æœä½ å¿˜è®°æŸ¥çœ‹è¿™ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªé”™è¯¯å°±ä¼šé»˜é»˜åœ°åœ¨æš—å¤„å‡‹é›¶<br><br>æ‰€ä»¥ä¸ºäº†é¿å…è¢«å¿½ç•¥çš„é”™è¯¯ï¼Œ<code>promise</code>é“¾çš„æœ€ä½³å®è·µå°±æ˜¯æœ€åæ€»ä»¥ä¸€ä¸ª<code>catch</code>ç»“æŸ<br><br>è¯¸å¦‚<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve(<span class="number">42</span>);</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span> <span class="title">fulfilled</span>(<span class="params">msg</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(msg.toLowerCase())</span><br><span class="line">&#125;)</span><br><span class="line">.catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ•è·é”™è¯¯'</span>,error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>è¿™æ ·å„¿å¯ä»¥æˆåŠŸçš„æ•è·é”™è¯¯<br><br>ä½†æ˜¯ <code>reject()</code>å‡½æ•°çš„ä»»ä½•å¼‚å¸¸éƒ½ä¼šè¢«ä½œä¸ºä¸€ä¸ªå…¨å±€æœªå¤„ç†çš„é”™è¯¯æŠ›å‡º<br>## Promiseå…¶ä»–çš„API<br><br>### Promise.done(..)<br>æ ‡ç¤ºpromiseé“¾çš„ç»“æŸ<br>done()ä¸ä¼šåˆ›å»ºå’Œè¿”å›promise<br><br>### Promise.all([])<br>åœ¨å¼‚æ­¥åºåˆ—ä¸­ï¼Œä»»æ„æ—¶åˆ»éƒ½åªèƒ½æœ‰ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ­£åœ¨æ‰§è¡Œ<br>ä½†æ˜¯æˆ‘ä»¬å¦‚æœæƒ³è¦åŒæ—¶æ‰§è¡Œä¸¤ä¸ªæˆ–æ›´å¤šæ­¥éª¤ï¼ˆâ€œå¹¶è¡Œæ‰§è¡Œâ€ï¼‰çš„æ—¶å€™ï¼Œ<code>Promise.all([])</code>çš„é­…åŠ›å°±ä½“ç°å‡ºæ¥<br>äº†<br><br>Promise.all([]) æ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œå€¼å¯ä»¥æ˜¯ï¼ˆpromiseï¼Œthenableï¼Œç”šè‡³æ˜¯ç«‹å³å€¼ï¼‰ï¼Œåˆ—è¡¨é‡Œçš„æ¯ä¸ªå€¼éƒ½è¦ç»è¿‡Promise.resolve()è¿‡æ»¤ï¼Œä»¥ç¡®ä¿è¦ç­‰å¾…çš„æ˜¯ä¸€ä¸ªçœŸæ­£çš„promiseï¼Œ<br>ä»è¿”å›çš„promiseæ•°æ®ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸ä¼ å…¥çš„é¡ºåºä¸€è‡´<br><br>å¦‚æœè¿”å›çš„ä¸»promiseåœ¨ä¸”ä»…åœ¨æ‰€æœ‰æˆå‘˜promiseéƒ½å®Œæˆåæ‰ä¼šå®Œæˆ å¦‚æœæœ‰çƒ­å’Œä¸€ä¸ªè¢«æ‹’ç»ï¼Œä¸»promiseå°±ä¼šç«‹å³è¢«æ‹’ç»ï¼Œå¹¶ä¸¢å¼ƒæ¥è‡ªå…¶ä»–æ‰€æœ‰promiseçš„ç»“æœ<br><br>æ‰€ä»¥ è¦ä¸ºæ¯ä¸ªpromiseå…³è”ä¸€ä¸ªé”™è¯¯å¤„ç†å‡½æ•°<br><br>ä¼ å…¥ç©ºæ•°ç»„æ—¶ï¼Œå®ƒä¼šç«‹å³å®Œæˆ<br><br>### Promise.race([])<br>ä¸promise.allç±»ä¼¼<br>å®ƒä¸€æ—¦æœ‰äººé»‘ä¸€ä¸ªpromiseå†³è®®ä¸ºå®Œæˆï¼Œpromise.raceå°±ä¼šå®Œæˆï¼Œä¸€æ—¦æœ‰ä»»ä½•ä¸€ä¸ªpromiseå†³è®®ä¸ºæ‹’ç»ï¼Œå®ƒå°±ä¼šæ‹’ç»<br><br>å®ƒçš„å®Œæˆå€¼æ˜¯å•ä¸ªæ¶ˆæ¯ï¼Œå¹¶ä¸åƒpromise.allé‚£æ ·å„¿æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä»–çš„promiseä¼šè¢«ä¸¢å¼ƒæˆ–è€…å¿½ç•¥<br><br>ä¸¤è€…éƒ½ä¼šåˆ›å»ºä¸€ä¸ªpromiseä½œä¸ºä»–ä»¬çš„è¿”å›å€¼ï¼Œè¿™ä¸ªpromiseçš„å†³è®®å®Œå…¨ç”±ä¼ å…¥çš„promiseæ•°ç»„æ§åˆ¶<br><br>ä¼ å…¥ç©ºæ•°ç»„æ—¶ï¼Œå®ƒä¼šæŒ‚ä½ï¼Œä¸”æ°¸è¿œä¸ä¼šå†³è®®<br><br>### Promise.finally()<br><br>ä»è¡Œä¸ºçš„è§’åº¦ä¸Š æœ‰äº›å¼€å‘è€…æå‡ºï¼Œpromiseéœ€è¦ä¸€ä¸ª<code>finally()</code>çš„å›è°ƒæ³¨å†Œï¼Œè¿™ä¸ªå›è°ƒåœ¨<code>promise</code>å†³è®®åæ€»æ˜¯ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”å…è®¸ä½ æ‰§è¡Œä»»ä½•å¿…è¦çš„æ¸…ç†å·¥ä½œ<br><br>å¦‚ä¸‹<br><br><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">var p = Promise.resolve(<span class="number">42</span>);</span><br><span class="line">p.<span class="keyword">then</span>(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;)</span><br><span class="line">.<span class="keyword">finally</span>(cleanup)</span><br><span class="line">.<span class="keyword">then</span>(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;)</span><br><span class="line">.<span class="keyword">finally</span>(cleanup)</span><br></pre></td></tr></table></figure><br><br>finallyä¼šåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°çš„promiseä»¥æ”¯æŒé“¾æ¥ç»§ç»­<br><br><br><br>### new Promise(..)æ„é€ å™¨<br><br>æ„é€ å™¨ Promiseå¿…é¡»å’Œnewä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”å¿…é¡»æä¾›ä¸€ä¸ªå‡½æ•°å›è°ƒï¼Œè¿™ä¸ªå›è°ƒæ˜¯åŒæ­¥çš„ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶åˆ°ä¸¤ä¸ªå‡½æ•°å›è°ƒï¼Œç”¨ä»¥æ”¯æŒpromiseçš„å†³è®®<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br>#### åˆ›å»ºä¸¤ç§å†³è®®çš„å¿«æ·æ–¹å¼<br><br>1. Promise.resolve //ç”¨äºåˆ›å»ºä¸€ä¸ªå·²å®Œæˆçš„promise<br>2. Promise.reject //ç”¨äºæ‹’ç»è¿™ä¸ªpromise<br><br>ä»¥ä¸‹æ˜¯ç­‰ä»·çš„<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">reject(<span class="string">'oop'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.reject(<span class="string">'oop'</span>)</span><br></pre></td></tr></table></figure><br><br>##promiseçš„å±€é™æ€§<br><br><em> é¡ºåºé”™è¯¯å¤„ç†<br><br><figure class="highlight mercury"><table><tr><td class="code"><pre><span class="line">ä»–ä»¬é“¾æ¥çš„æ–¹å¼ <span class="keyword">promise</span>é“¾ä¸­çš„é”™è¯¯å®¹æ˜“è¢«æ— æ„ä¸­å¿½ç•¥æ‰</span><br></pre></td></tr></table></figure>

</em> å•ä¸€å€¼<br><br><figure class="highlight mercury"><table><tr><td class="code"><pre><span class="line"><span class="keyword">promise</span>åªèƒ½æœ‰ä¸€ä¸ªå®Œæˆå€¼æˆ–ä¸€ä¸ªæ‹’ç»ç†ç”± å¯¹äºå¤æ‚çš„åœºæ™¯ä¿¡æ¯æœ‰ç‚¹å±€é™</span><br></pre></td></tr></table></figure><br><br><em>  å•å†³è®®
</em> æ— æ³•å–æ¶ˆçš„promise<br><br><figure class="highlight mercury"><table><tr><td class="code"><pre><span class="line">ä¸€æ—¦åˆ›å»ºäº†ä¸€ä¸ª<span class="keyword">promise</span>å¹¶ä¸ºå…¶æ³¨å†Œäº†å®Œæˆå’Œæ‹’ç»å¤„ç†å‡½æ•°ï¼Œå¦‚æœå‡ºç°æŸç§æƒ…å†µä½¿å¾—è¿™ä¸ªä»»åŠ¡æ‚¬è€Œæœªå†³çš„è¯ ä½ ä¹Ÿæ²¡æœ‰åŠæ³•ä»å¤–éƒ¨åœæ­¢å®ƒçš„è¿›ç¨‹</span><br></pre></td></tr></table></figure><br><br><em> promiseæ€§èƒ½<br><br><figure class="highlight mercury"><table><tr><td class="code"><pre><span class="line">æ›´å¤šçš„å·¥ä½œæ›´å¤šçš„ä¿æŠ¤ <span class="keyword">promise</span>ä¸å›è°ƒç›¸æ¯” ä¼šæ…¢ä¸€ç‚¹</span><br><span class="line">ä½†æ˜¯ä½œä¸ºäº¤æ¢ä½ å¾—åˆ°çš„æ˜¯å¤§é‡å†…å»ºçš„å¯ä¿¡ä»»æ€§</span><br></pre></td></tr></table></figure><br><br>## å°ç»“
</em> promiseéå¸¸å¥½ ä»–ä»¬è§£å†³äº†æˆ‘ä»¬å› åªç”¨å›è°ƒçš„ä»£ç è€Œå¤‡å—å›°æ‰°çš„æ§åˆ¶åè½¬çš„é—®é¢˜<br><em> å®ƒå¹¶æ²¡æœ‰æ‘’å¼ƒå›è°ƒï¼Œåªæ˜¯æŠŠå›è°ƒçš„å®‰æ’è½¬äº¤ç»™äº†ä¸€ä¸ªä½äºæˆ‘ä¹ˆå’Œå…¶ä»–å·¥å…·ä¹‹é—´çš„å¯ä¿¡ä»»çš„ä¸­ä»‹æœºåˆ¶

</em> promiseä¹Ÿå¼€å§‹æä¾›ï¼ˆå°½ç®¡ä¸å®Œç¾ï¼‰ä»¥é¡ºåºçš„æ–¹å¼è¡¨è¾¾å¼‚æ­¥æµçš„ä¸€ä¸ªæ›´å¥½çš„åŠæ³•ï¼Œè¿™æœ‰åŠ©äºæˆ‘ä»¬çš„å¤§è„‘æ›´å¥½çš„å‡ ä¹æ˜¯å’Œç»´æŠ¤å¼‚æ­¥jsä»£ç <br><br><br>â€”â€”-<br><br>#ç¬¬äºŒé˜¶æ®µ(ç”Ÿæˆå™¨ Generatoræ—¶æœŸ)<br><br>å…ˆæ¥å›é¡¾ä¸€ä¸‹ å›è°ƒè¡¨è¾¾å¼‚æ­¥æ§åˆ¶æµç¨‹çš„ä¸¤ä¸ªå…³é”®ç¼ºé™·<br><br>1. åŸºäºå›è°ƒçš„å¼‚æ­¥ä¸ç¬¦åˆå¤§è„‘å¯¹ä»»åŠ¡æ­¥éª¤çš„è§„åˆ’æ–¹å¼<br>2. ç”±äºæ§åˆ¶åè½¬å›è°ƒå¹¶ä¸æ˜¯å¯ä¿¡ä»»çš„<br><br>ç„¶åæˆ‘ä»¬ç”¨<code>Promise</code>è§£å†³äº†å¦‚ä½•æŠŠå›è°ƒçš„æ§åˆ¶åè½¬ åè½¬å›æ¥,æ¢å¤äº†å¯ä¿¡ä»»æ€§<br>ä½†æ˜¯å®ƒä¸ä¼šæš‚åœ<br>ç°åœ¨æˆ‘ä»¬å¯»æ±‚ä¸€ç§é¡ºåºï¼Œçœ‹ä¼¼åŒæ­¥çš„å¼‚æ­¥æµç¨‹æ§åˆ¶è¡¨è¾¾è¿™ä¸ª(.then()é’±åµŒå¥—å¤šäº†ä¹Ÿå—ä¸äº†)ï¼Œå¼•å‡ºäº†<font color="red">ES6 ç”Ÿæˆå™¨</font>çš„æ¦‚å¿µ<br><br>Generatoræœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ<br>å®ƒä¼šåˆ›å»ºå‡ºä¸€ä¸ªè¿­ä»£å™¨<br>Generator å‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚<br>è°ƒç”¨ Generator å‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯éå†å™¨å¯¹è±¡ï¼ˆIterator Objectï¼‰<br><br>å®ƒæ‰“ç ´äº†å®Œæ•´æ‰§è¡Œ æˆ‘ä»¬ä¸å†ä¾èµ–<strong>ä¸€ä¸ªå‡½æ•°ä¸€æ—¦å¼€å§‹æ‰§è¡Œï¼Œå°±ä¼šè¿è¡Œåˆ°ç»“æŸï¼ŒæœŸé—´ä¸ä¼šæœ‰å…¶ä»–ä»£ç èƒ½å¤Ÿæ‰“ç ´å®ƒå¹¶æ’å…¥å…¶é—´</strong>çš„å‡å®š<br><br>ES6ä¸­æŒ‡å®šæš‚åœç‚¹çš„è¯­æ³•æ˜¯<code>yield</code> è¿™æ ·ç¤¼è²Œçš„è¡¨è¾¾äº†ä¸€ç§åˆä½œå¼çš„æ§åˆ¶æ”¾å¼ƒ<br><br>å¦‚ä¸‹<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  x++;</span><br><span class="line">  <span class="keyword">yield</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'x:'</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  x++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> it = foo(); <span class="comment">//æ„å»ºäº†ä¸€ä¸ªè¿­ä»£å™¨ å¹¶æ²¡æœ‰æ‰§è¡Œfoo</span></span><br><span class="line">it.next(); <span class="comment">//å¯åŠ¨ç”Ÿæˆå™¨ *foo å¹¶è¿è¡Œäº†ç¬¬ä¸€è¡Œçš„ x++  *fooåœ¨yieldå¤„æš‚åœ</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'sws'</span>,x) <span class="comment">//2</span></span><br><span class="line">bar();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'äºŒ'</span>,x) <span class="comment">//3</span></span><br><span class="line">it.next(); <span class="comment">//æœ€åä»æš‚åœå¤„æ¢å¤äº†ç”Ÿæˆå™¨ *fooçš„æ‰§è¡Œ è¿è¡Œäº†  console.log('x:',x); //3</span></span><br></pre></td></tr></table></figure><br><br>ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œå¯ä»¥ä¸€æ¬¡æˆ–è€…å¤šæ¬¡çš„å¯åŠ¨å’Œåœæ­¢ æ„å»ºç”Ÿæˆå™¨æ˜¯ä½œä¸ºå¼‚æ­¥æµç¨‹æ§åˆ¶çš„ä»£ç æ¨¡å¼çš„åŸºç¡€æ„ä»¶ä¹‹ä¸€<br><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° æˆ‘ä»¬åœ¨æš‚åœä¹‹ååšäº†æˆ‘ä»¬æƒ³åšçš„æ“ä½œ è¿˜æ‰§è¡Œäº†æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•°<code>bar</code><br><br><br>### ç”Ÿæˆå™¨çš„è¾“å…¥å’Œè¾“å‡º<br><code>var it = foo();</code> è¿™è¡Œåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼ŒæŠŠå®ƒèµ‹ç»™äº†å˜é‡itï¼Œç”¨äºæ§åˆ¶ç”Ÿæˆå™¨ï¼Œå®ƒæ˜¯ç‰¹æ®Šçš„å‡½æ•°ï¼Œä¹Ÿå…·æœ‰å‡½æ•°çš„ç‰¹è´¨ï¼Œå¯ä»¥ä¼ é€’å‚æ•°<br><code>it.next()</code> æŒ‡å®šç”Ÿæˆå™¨ä»å½“å‰ä½ç½®å¼€å§‹ç»§ç»­è¿è¡Œï¼Œåœåœ¨ä¸‹ä¸€ä¸ª<code>yield</code>å¤„æˆ–è€…ç›´åˆ°ç”Ÿæˆå™¨ç»“æŸï¼Œå®ƒè°ƒç”¨çš„ç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªvalueå±æ€§ï¼ŒæŒæœ‰ä»<code>*foo</code>è¿”å›çš„å€¼ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¹Ÿå°±æ˜¯è¯´<code>yield</code>ä¼šå¯¼è‡´ç”Ÿæˆå™¨åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘é€å‡ºä¸€ä¸ªå€¼(ç±»ä¼¼<code>return</code>)<br><br>å¦‚ä¸‹<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> it = foo(<span class="number">6</span>,<span class="number">7</span>); </span><br><span class="line"><span class="keyword">var</span> obj = it.next(); </span><br><span class="line"><span class="built_in">console</span>.log(obj) <span class="comment">//&#123;value: 42, done: true&#125;</span></span><br></pre></td></tr></table></figure><br><br>### è¿­ä»£æ¶ˆæ¯ä¼ é€’<br><br>é€šè¿‡<code>yield</code>å’Œ<code>next</code>å®ç°çš„å†…å»ºæ¶ˆæ¯è¾“å…¥è¾“å‡ºèƒ½åŠ›<br><br><code>next()</code>è°ƒç”¨è¦æ¯”<code>yield</code>è¯­å¥å¤šä¸€ä¸ª<br>å› ä¸ºç¬¬ä¸€ä¸ª<code>next()</code>æ€»æ˜¯å¯åŠ¨ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå¹¶è¿è¡Œåˆ°ç¬¬ä¸€ä¸ª<code>yield</code>å¤„ï¼Œæ‰§è¡Œç¬¬ä¸€æ¬¡<code>next</code>æ—¶å€™ï¼Œä¼ é€’å‚æ•°å€¼ä¼šè¢«å¿½ç•¥<br><br><br>ç¬¬ä¸€ä¸ªyieldåŸºæœ¬ä¸Šæ˜¯æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ<br>è°æ¥å›ç­”è¿™ä¸€ä¸ªé—®é¢˜ æ˜¾ç„¶ç¬¬ä¸€ä¸ªnextå·²ç»æ‰§è¡Œï¼Œå› æ­¤ç”±ç¬¬äºŒä¸ªnextè°ƒç”¨å›ç­”ç¬¬ä¸€ä¸ªyieldæå‡ºçš„è¿™ä¸ªé—®é¢˜<br><br>ä»è¿­ä»£å™¨çš„è§’åº¦çœ‹é—®é¢˜<br><br>æ¶ˆæ¯æ˜¯åŒå‘ä¼ é€’çš„ nextä¹Ÿå¯ä»¥å‘æš‚åœçš„yieldè¡¨è¾¾å¼å‘é€å€¼ yieldä½œä¸ºä¸€ä¸ªè¡¨è¾¾å¼å¯ä»¥å‘å‡ºæ¶ˆæ¯å“åº”nextçš„è°ƒç”¨<br><br>è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­èƒ½å¸®åŠ©ä½ ç†è§£generatorçš„æ‰§è¡Œ<br><br><figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">//<span class="built_in">yield</span>åŸºæœ¬ä¸Šå°±æ˜¯æå‡ºäº†ä¸ªé—®é¢˜ æˆ‘çš„å€¼ç­‰äºä»€ä¹ˆ ç„¶åç”±ä¸‹ä¸€ä¸ª<span class="built_in">next</span>()ä¼ é€’çš„å‚æ•°å›ç­”</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span><span class="params">(x)</span></span>&#123;</span><br><span class="line">  let y = <span class="number">2</span> *(<span class="built_in">yield</span>(x+<span class="number">1</span>));</span><br><span class="line">  let z = <span class="built_in">yield</span>(y/<span class="number">3</span>);</span><br><span class="line">  <span class="keyword">return</span> x + y + z </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">let it = foo(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(it.<span class="built_in">next</span>()) //&#123;value: <span class="number">6</span>, done: <span class="literal">false</span>&#125;</span><br><span class="line">console.<span class="built_in">log</span>(it.<span class="built_in">next</span>(<span class="number">12</span>)) //&#123;value: <span class="number">8</span>, done: <span class="literal">false</span>&#125;</span><br><span class="line">console.<span class="built_in">log</span>(it.<span class="built_in">next</span>(<span class="number">13</span>)) //&#123;value: <span class="number">42</span>, done: <span class="literal">true</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">è§£æ</span><br><span class="line">generatorå‡½æ•°è°ƒç”¨å’Œæ™®é€šå‡½æ•°ä¸åŒ å®ƒä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œç¬¬ä¸€æ¬¡<span class="built_in">next</span>æ—¶å€™ï¼Œä¼ é€’å‚æ•°å€¼ä¼šè¢«å¿½ç•¥ï¼Œå¹¶ä¸”å‡½æ•°æš‚åœåœ¨<span class="built_in">yield</span>(x+<span class="number">1</span>)å¤„ æ‰€ä»¥è¿”å› <span class="number">5</span>+<span class="number">1</span></span><br><span class="line">æ‰§è¡Œç¬¬äºŒæ¬¡<span class="built_in">next</span>æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ç­‰äºä¸Šä¸€ä¸ª<span class="built_in">yield</span>çš„è¿”å›å€¼ å¦‚æœä½ ä¸ä¼ å‚ï¼Œ<span class="built_in">yield</span>æ°¸è¿œè¿”å›undefinedï¼Œæ­¤æ—¶  let y = <span class="number">2</span> * <span class="number">12</span> = <span class="number">24</span>ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªzæ˜¯<span class="number">24</span>/<span class="number">3</span> =<span class="number">8</span></span><br><span class="line">å½“æ‰§è¡Œç¬¬ä¸‰æ¬¡<span class="built_in">next</span>æ—¶ ä¼ é€’çš„å‚æ•°ä¼šä¼ é€’ç»™zï¼Œæ‰€ä»¥z=<span class="number">13</span> x = <span class="number">5</span> y = <span class="number">24</span> ç›¸åŠ ç­‰äº<span class="number">42</span></span><br><span class="line">*/</span><br></pre></td></tr></table></figure><br><br><strong>å¤šä¸ªè¿­ä»£å™¨</strong><br>æ¯æ¬¡æ„å»ºä¸€ä¸ªè¿­ä»£å™¨å®é™…ä¸Šå°±æ˜¯éšå¼æ„å»ºç”Ÿæˆå™¨çš„ä¸€ä¸ªå®ä¾‹ é€šè¿‡è¿™ä¸ªè¿­ä»£å™¨æ§åˆ¶çš„æ˜¯è¿™ä¸ªç”Ÿæˆå™¨çš„å®ä¾‹<br><br>åŒä¸€ä¸ªç”Ÿæˆå™¨çš„å¤šä¸ªå®ä¾‹å¯ä»¥åŒæ—¶è¿è¡Œå®ƒä»¬ç”šè‡³å¯ä»¥å½¼æ­¤äº¤äº’<br><br><br>#### ç”Ÿäº§è€…ä¸è¿­ä»£å™¨<br>å‡è®¾ä½ è¦äº§ç”Ÿä¸€ç³»åˆ—å€¼ï¼Œå…¶ä¸­æ¯ä¸ªå€¼éƒ½ä¸å‰é¢ä¸€ä¸ªæœ‰ç‰¹å®šçš„å…³ç³»  éœ€è¦ä¸€ä¸ªæœ‰çŠ¶æ€çš„ç”Ÿäº§è€…èƒ½å¤Ÿè®°ä½å…¶ç”Ÿæˆçš„æœ€åä¸€ä¸ªå€¼<br>åœ¨æ­¤ä¹‹å‰ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°é—­åŒ…æ¥å®ç°<br><br>è¿­ä»£å™¨æ˜¯ä¸€ä¸ªå®šä¹‰è‰¯å¥½çš„æ¥å£ï¼Œç”¨äºä»ä¸€ä¸ªç”Ÿäº§è€…ä¸€æ­¥æ­¥å¾—åˆ°ä¸€ç³»åˆ—å€¼ï¼Œjsè¿­ä»£å™¨çš„æ¥å£ä¸å¤šæ•°è¯­è¨€ç±»ä¼¼ï¼Œå°±æ˜¯æ¯æ¬¡æƒ³è¦ä»ç”Ÿäº§è€…å¾—åˆ°ä¸‹ä¸€ä¸ªå€¼çš„æ—¶å€™è°ƒç”¨next()<br>nextè°ƒç”¨è¿”å›ä¸€ä¸ªå¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§<br><br><figure class="highlight ocaml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">done</span>æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ è¡¨ç¤ºè¿­ä»£å™¨çš„å®ŒæˆçŠ¶æ€</span><br><span class="line"><span class="keyword">value</span>ä¸­æ”¾ç½®è¿­ä»£å€¼</span><br></pre></td></tr></table></figure><br><br>#### åŒæ­¥é”™è¯¯å¤„ç†<br>ç±»ä¼¼<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> text = <span class="keyword">yield</span> foo(<span class="number">11</span>,<span class="number">31</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(text)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(err)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>ç”Ÿæˆå™¨<code>yield</code>æš‚åœçš„ç‰¹æ€§æ„å‘³ç€æˆ‘ä»¬ä¸ä»…èƒ½ä»å¼‚æ­¥å‡½æ•°è°ƒç”¨çš„åˆ°çœ‹ä¼¼åŒæ­¥çš„è¿”å›å€¼ï¼Œè¿˜å¯ä»¥åŒæ­¥æ•è·æ¥è‡ªè¿™äº›å¼‚æ­¥å‡½æ•°è°ƒç”¨çš„é”™è¯¯ å®ƒä½¿å¾—ç”Ÿæˆå™¨èƒ½å¤Ÿæ•è·é”™è¯¯æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è¿›æ­¥<br><br># ç¬¬å››é˜¶æ®µï¼ˆasync/awaitæ—¶æœŸ ES7ï¼‰<br>ES6ä¸­æœ€å®Œç¾çš„æ—¶é—´å°±æ˜¯ç”Ÿæˆå™¨ï¼ˆçœ‹ä¼¼åŒæ­¥çš„ä»£ç ï¼‰å’Œpromiseï¼ˆå¯ä¿¡ä»»å¯ç»„åˆï¼‰çš„ç»“åˆ<br><br>æˆ‘ä»¬ä¸å†<code>yield</code>å‡º<code>Promise</code>è€Œæ˜¯ç”¨<code>await</code>ç­‰å¾…å®ƒå†³è®®<br>å®ƒå…¶å®å°±æ˜¯æŠŠå‰é¢çš„ç»éªŒå†™è¿›è§„èŒƒ<br><br><br>## ES7çš„esyncå‡½æ•°å¯¹äºES6çš„generatorå‡½æ•°çš„æ”¹è¿›ä½“ç°äº†å“ªäº›æ–¹é¢<br><br><em> å†…ç½®æ‰§è¡Œå™¨<br><br><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">generatorå‡½æ•°çš„æ‰§è¡Œå¿…é¡»ä¾èµ–äºæ‰§è¡Œå™¨ï¼Œè€Œ<span class="keyword">async</span>å‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´<span class="keyword">async</span>å‡½æ•°çš„æ‰§è¡Œï¼Œä¸æ™®é€šå‡½æ•°ä¸€æ¨¡ä¸€æ ·ï¼Œåªéœ€è¦ä¸€è¡Œ</span><br><span class="line">asyncReadFile();</span><br><span class="line"></span><br><span class="line">åƒè¿™æ · ç›´æ¥è°ƒç”¨å‡½æ•° å°±å¯ä»¥ç›´æ¥å¾—å‡ºç»“æœ ä¸åƒgeneratorå‡½æ•°ï¼Œéœ€è¦è°ƒç”¨nextæ–¹æ³•æˆ–è€…coæ¨¡å— æ‰èƒ½çœŸæ­£æ‰§è¡Œå¾—åˆ°æœ€åçš„ç»“æœ</span><br></pre></td></tr></table></figure>

</em> æ›´å¥½çš„è¯­ä¹‰<br><br><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span>å’Œ<span class="keyword">await</span>æ¯”èµ· * å’Œ <span class="keyword">yield</span> è¯­ä¹‰æ›´æ¸…æ¥šäº†<span class="keyword">async</span>è¡¨ç¤ºå‡½æ•°æœ‰å¼‚æ­¥æ“ä½œï¼Œ<span class="keyword">await</span>è¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…çš„ç»“æœ</span><br></pre></td></tr></table></figure><br><br><em> æ›´å¹¿çš„é€‚ç”¨æ€§<br><br><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">coæ¨¡å—è§„å®š <span class="keyword">yield</span>å‘½ä»¤åé¢åªèƒ½æ˜¯thunkå‡½æ•°æˆ–è€…promiseå¯¹è±¡ï¼Œè€Œ<span class="keyword">async</span>å‡½æ•°çš„<span class="keyword">await</span>åé¢ å¯ä»¥æ˜¯promiseå¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ï¼Œå¸ƒå°”ç­‰ä½†è¿™ç­‰åŒäºåŒæ­¥æ“ä½œï¼‰</span><br></pre></td></tr></table></figure>

</em> è¿”å›å€¼æ˜¯promise<br><br><figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span>å‡½æ•°è¿”å›çš„æ˜¯promiseå¯¹è±¡ï¼Œè¿™æ¯”generatorå‡½æ•°çš„è¿”å›å€¼æ˜¯ <span class="keyword">Iterator</span>å¯¹è±¡æ–¹ä¾¿å¤šäº†ï¼Œä½ å¯ä»¥ç”¨<span class="keyword">then</span>æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œ</span><br><span class="line"></span><br><span class="line">è¿›ä¸€æ­¥è¯´ <span class="keyword">async</span>å‡½æ•°å¯ä»¥çœ‹ä½œæ˜¯å¤šä¸ªå¼‚æ­¥æ“ä½œåŒ…è£…æˆçš„ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œè€Œ<span class="keyword">await</span>å‘½ä»¤å°±æ˜¯å†…éƒ¨<span class="keyword">then</span>å‘½ä»¤çš„è¯­æ³•ç³–</span><br></pre></td></tr></table></figure><br><br>## ç‰¹ç‚¹<br><br><em> ä¸€ä¸ªå‡½æ•°å¦‚æœåŠ ä¸Šasyncé‚£ä¹ˆå®ƒå°±ä¼šè¿”å›promise
</em> async å°±æ˜¯å°†å‡½æ•°è¿”å›å€¼ä½¿ç”¨ Promise.resolve()åŒ…è£¹äº†ä¸‹ï¼Œå’Œthenä¸­å¤„ç†è¿”å›å€¼ä¸€æ ·<br><em> awaitæ˜¯å¼‚æ­¥æ“ä½œï¼Œå®ƒå†…éƒ¨å®ç°äº†generator,å¦‚æœåæ¥çš„è¡¨è¾¾å¼ä¸è¿”å›promiseçš„è¯ï¼Œå®ƒå°±ä¼šè¢«åŒ…è£…æˆPromise.resolve(è¿”å›å€¼)ï¼Œç„¶åå»æ‰§è¡Œå‡½æ•°çš„åŒæ­¥ä»£ç <br><br>çœ‹ä¸‹é¢è¿™ä¸ªç­‰ä»·çš„ä¾‹å­<br><br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">await</span> async2();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'async2 end'</span>)</span><br><span class="line">&#125;</span><br><span class="line">async1();</span><br><span class="line"></span><br><span class="line">ç­‰ä»·äº</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'async2 end'</span>)</span><br><span class="line">  resolve(<span class="built_in">Promise</span>.resolve()) <span class="comment">//Promise.resolve()å†³è®®ä¹‹åå°†thenä»£ç æ’å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—çš„å°¾éƒ¨</span></span><br><span class="line">&#125;)</span><br><span class="line">.then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</em>  asyncåŠawait é…åˆä½¿ç”¨<br><em>  awaitå°±æ˜¯<code>generator</code>åŠ ä¸Š<code>promise</code>çš„è¯­æ³•ç³–
</em>  <code>async/await</code>æ˜¯å¼‚æ­¥çš„ç»ˆæè§£å†³æ–¹æ¡ˆ<br><br><br><br>###  ä¼˜ç¼ºç‚¹<br> <font color="red">ä¼˜åŠ¿</font> 

<ul>
<li>å¤„ç†thençš„è°ƒç”¨é“¾ï¼Œèƒ½æ›´æ¸…æ™°çš„å†™å‡ºæ¥ä»£ç ï¼Œæ¯•ç«Ÿå†™ä¸€å †thenä¹Ÿå¾ˆ</li>
<li>èƒ½è§£å†³å›è°ƒåœ°ç‹±çš„é—®é¢˜</li>
</ul>
<font color="red">ç¼ºç‚¹</font>

<ul>
<li>å› ä¸º<code>await</code>å°†å¼‚æ­¥ä»£ç æ”¹é€ æˆäº†åŒæ­¥ä»£ç ,å¦‚æœå¤šä¸ªå¼‚æ­¥ä»£ç æ²¡æœ‰ä¾èµ–æ€§å´ä½¿ç”¨äº†<code>await</code>å¯¼è‡´æ€§èƒ½ä¸Šçš„é™ä½</li>
</ul>
<p>å¦‚ä¸‹</p>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"> <span class="keyword">await</span> fetch(<span class="built_in">url</span>)</span><br><span class="line"> <span class="keyword">await</span> fetch(url2)</span><br><span class="line"> <span class="keyword">await</span> fetch(url3)</span><br><span class="line">&#125;</span><br><span class="line">è¿™æ ·å„¿çš„ä»£ç  å¦‚æœæ²¡æœ‰ä¾èµ–æœ€å¥½ç”¨promise.all</span><br></pre></td></tr></table></figure>
<p>#æ€»ç»“</p>
<ul>
<li><p>ç”Ÿæˆå™¨æ˜¯ES6çš„ä¸€ä¸ªæ–°çš„å‡½æ•°ç±»å‹ å®ƒå¹¶ä¸åƒæ™®é€šå‡½æ•°é‚£æ ·æ€»æ˜¯è¿è¡Œåˆ°ç»“æŸï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ç”Ÿæˆå™¨å¯ä»¥åœ¨è¿è¡Œå½“ä¸­ï¼ˆå®Œå…¨ä¿æŒå…¶çŠ¶æ€ï¼‰æš‚åœ å¹¶ä¸”å°†æ¥å†ä»å’±é¢˜ingçš„åœ°æ–¹æ¢å¤è¿è¡Œ</p>
</li>
<li><p>è¿™ç§ç®€ä½“çš„æš‚åœå’Œæ¢å¤æ˜¯åˆä½œå‹çš„ä¸æ˜¯æŠ¢å å‹çš„ï¼Œè¿™æ„å‘³ç€ç”Ÿæˆå™¨å…·æœ‰ç‹¬ä¸€æ— äºŒçš„èƒ½åŠ›æ¥æš‚åœè‡ªèº«ï¼Œè¿™æ˜¯é€šè¿‡å…³é”®å­—<code>yield</code>æ¥å®ç°çš„ ä¸è¿‡ åªæœ‰æ§åˆ¶ç”Ÿæˆå™¨çš„è¿­ä»£å™¨å…·æœ‰æ¢å¤ç”Ÿæˆå™¨çš„èƒ½åŠ›ï¼ˆnext(..)ï¼‰</p>
</li>
<li><p>yield/next ä¸åªæ˜¯æ§åˆ¶æœºåˆ¶ å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§åŒå‘æ¶ˆæ¯ä¼ é€’æœºåˆ¶ yieldè¡¨è¾¾å¼å¤‡æ³¨ä¸Šæ˜¯æš‚åœä¸‹æ¥ç­‰å¾…æŸä¸ªå€¼ æ¥ä¸‹æ¥çš„nextè°ƒç”¨åˆ™æ˜¯ä¼šå‘è¢«æš‚åœçš„yieldè¡¨è¾¾å¼ä¼ å›ä¸€ä¸ªå€¼</p>
</li>
<li><p>åœ¨å¼‚æ­¥æ§åˆ¶æµç¨‹æ–¹ä¾¿ç”Ÿæˆå™¨çš„å…³é”®ä¼˜ç‚¹æ˜¯ ç”Ÿæˆå™¨å†…éƒ¨çš„ä»£ç æ˜¯ä»¥è‡ªç„¶çš„åŒæ­¥/é¡ºåºæ–¹å¼è¡¨è¾¾ä»»åŠ¡çš„ä¸€ç³»åˆ—æ­¥éª¤ï¼Œå…¶æŠ€å·§åœ¨äº æˆ‘ä»¬æŠŠå¯èƒ½çš„å¼‚æ­¥éšè—åœ¨å…³é”®å­—yieldçš„åé¢ æŠŠå¼‚æ­¥ç§»åŠ¨åˆ°æ§åˆ¶ç”Ÿæˆå™¨çš„è¿­ä»£å™¨çš„ä»£ç éƒ¨åˆ†</p>
</li>
<li>æ¢å¥è¯è¯´ ç”Ÿæˆå™¨ä¸ºå¼‚æ­¥ä»£ç ä¿æŒäº†é¡ºåºåŒæ­¥ é˜»å¡çš„ä»£ç æ¨¡å¼ è¿™ä½¿å¾—å¤§è„‘å¯ä»¥æ›´è‡ªç„¶çš„è¿½è¸ªä»£ç  è§£å†³äº†åŸºäºå›è°ƒçš„å¼‚æ­¥çš„ç¼ºé™·</li>
</ul>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>promise</tag>
      </tags>
  </entry>
  <entry>
    <title>çœ‹å®Œè¿™ç¯‡ï¼Œæˆ‘å¥¶å¥¶éƒ½ä¼šè®¾è®¡ç»„ä»¶äº†</title>
    <url>/2019/07/29/part/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><a href="https://juejin.im/post/5d566e82f265da03f77e653c" target="_blank" rel="noopener">æ˜é‡‘é“¾æ¥</a></p>
<p>ç»„ä»¶åŒ–æ€æƒ³å¹¶ä¸æ˜¯å‰ç«¯ç‹¬æœ‰çš„ï¼Œä½†å´æ˜¯å‰ç«¯æŠ€æœ¯çš„å»¶ä¼¸</p>
<p>éšç€ä¸‰å¤§æ¡†æ¶å´›èµ·ï¼Œå‰ç«¯ç»„ä»¶åŒ–é€æ¸æˆä¸ºå‰ç«¯å¼€å‘çš„è¿«åˆ‡éœ€æ±‚ï¼Œä¸€ç§ä¸»æµï¼Œä¸€ç§å…±è¯†ï¼Œå®ƒä¸ä»…æé«˜å¼€å‘æ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†ç»´ç»„ä»¶å†…èšåŸåˆ™æŠ¤æˆæœ¬<br>å¼€å‘è€…ä»¬ä¸éœ€è¦å†é¢å¯¹ä¸€å †æ™¦æ¶©éš¾æ‡‚çš„ä»£ç ï¼Œè½¬è€Œåªéœ€è¦å…³æ³¨ä»¥ç»„ä»¶â½…å¼å­˜åœ¨çš„ä»£ç â½šæ®µ</p>
<p>è¿™æ˜¯ä¸€åœºæ–°çš„æŒ‘æˆ˜ï¼</p>
<h2 id="æ–‡ç« å¼€å§‹ä¹‹å‰ï¼Œæ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ"><a href="#æ–‡ç« å¼€å§‹ä¹‹å‰ï¼Œæ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ" class="headerlink" title="æ–‡ç« å¼€å§‹ä¹‹å‰ï¼Œæ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ"></a>æ–‡ç« å¼€å§‹ä¹‹å‰ï¼Œæ˜ç¡®æœ¬æ–‡çš„è¾¹ç•Œ</h2><ul>
<li>ä»å‰ç«¯å·¥ç¨‹è°ˆåˆ°ç»„ä»¶åŒ–å¼€å‘</li>
<li>ç»„ä»¶çš„è®¾è®¡åŸåˆ™</li>
<li>ç»„ä»¶çš„èŒèƒ½åˆ’åˆ†åŠåˆ©å¼Š</li>
<li>ç»„ä»¶è®¾è®¡çš„è¾¹ç•Œ</li>
<li>è½å®åˆ°å…·ä½“ä¸šåŠ¡ä¸­å¦‚ä½•åš</li>
<li>ä¸€äº›æ„Ÿæ‚Ÿ</li>
<li>æ€»ç»“</li>
</ul>
<h1 id="ä¸€ä¸ªé¢è¯•é¢˜å¼•å‘çš„æ€è€ƒ"><a href="#ä¸€ä¸ªé¢è¯•é¢˜å¼•å‘çš„æ€è€ƒ" class="headerlink" title="ä¸€ä¸ªé¢è¯•é¢˜å¼•å‘çš„æ€è€ƒ"></a>ä¸€ä¸ªé¢è¯•é¢˜å¼•å‘çš„æ€è€ƒ</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é¢è¯•å®˜é€šå¸¸ä¼šé—® å†™è¿‡å‰ç«¯é€šç”¨ç»„ä»¶å—ï¼Ÿ</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>ä½ å¯èƒ½ä¼šè‡ªä¿¡çš„è¡¨ç¤ºï¼š sureï¼</p>
<p>emm..æ˜¯çš„å—ï¼Ÿ</p>
<h1 id="ä»å‰ç«¯å·¥ç¨‹è°ˆåˆ°ç»„ä»¶åŒ–å¼€å‘"><a href="#ä»å‰ç«¯å·¥ç¨‹è°ˆåˆ°ç»„ä»¶åŒ–å¼€å‘" class="headerlink" title="ä»å‰ç«¯å·¥ç¨‹è°ˆåˆ°ç»„ä»¶åŒ–å¼€å‘"></a>ä»å‰ç«¯å·¥ç¨‹è°ˆåˆ°ç»„ä»¶åŒ–å¼€å‘</h1><p>å‰ç«¯å·¥ç¨‹ç»å†çš„ä¸‰ä¸ªé˜¶æ®µ</p>
<h2 id="1-åº“-æ¡†æ¶é€‰å‹"><a href="#1-åº“-æ¡†æ¶é€‰å‹" class="headerlink" title="1. åº“/æ¡†æ¶é€‰å‹"></a>1. åº“/æ¡†æ¶é€‰å‹</h2><p><img src="http://cdn.anruence.com/ku.png" alt="image"><br>ç¡®å®šæŠ€æœ¯é€‰å‹ï¼Œä¸ºé¡¹ç›®èŠ‚çœè®¸å¤šå·¥ç¨‹é‡<br>åæ¥ä¸‰å¤§æ¡†æ¶çš„æ¨ªç©ºå‡ºä¸–ï¼Œè§£æ”¾äº†ä¸å°‘ç”Ÿäº§åŠ›</p>
<h2 id="2-ç®€å•æ„å»ºä¼˜åŒ–"><a href="#2-ç®€å•æ„å»ºä¼˜åŒ–" class="headerlink" title="2. ç®€å•æ„å»ºä¼˜åŒ–"></a>2. ç®€å•æ„å»ºä¼˜åŒ–</h2><p><img src="http://cdn.anruence.com/tools.png" alt="image"></p>
<p>è§£å†³å®Œå¼€å‘æ•ˆç‡ï¼Œè¿˜éœ€è¦å…¼é¡¾è¿è¡Œæ€§èƒ½ï¼Œ<br>æ•…è€Œé€‰æ‹©æŸç§æ„å»ºå·¥å…·ï¼Œå¯¹ä»£ç è¿›è¡Œå‹ç¼©ï¼Œæ ¡éªŒï¼Œä¹‹åå†ä»¥é¡µé¢ä¸ºå•ä½è¿›è¡Œç®€å•çš„èµ„æºåˆå¹¶</p>
<h2 id="3-JS-CSSæ¨¡å—åŒ–å¼€å‘"><a href="#3-JS-CSSæ¨¡å—åŒ–å¼€å‘" class="headerlink" title="3. JS/CSSæ¨¡å—åŒ–å¼€å‘"></a>3. JS/CSSæ¨¡å—åŒ–å¼€å‘</h2><p><img src="http://cdn.anruence.com/jsmokuaihua.png" alt="image"></p>
<p>è§£å†³äº†åŸºæœ¬å¼€å‘æ•ˆç‡å’Œè¿è¡Œæ•ˆç‡ä¹‹åï¼Œå¼€å§‹è€ƒè™‘ç»´æŠ¤æ•ˆç‡äº†</p>
<p>åˆ†è€Œæ²»ä¹‹ï¼ˆä»¥åˆ†è§£é™ä½å¤æ‚åº¦ï¼‰æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­çš„é‡è¦æ€æƒ³ï¼Œæ˜¯å¤æ‚ç³»ç»Ÿå¼€å‘å’Œç»´æŠ¤çš„åŸºçŸ³,<font color="red">æ¨¡å—åŒ–å°±æ˜¯å‰ç«¯çš„åˆ†æ²»æ‰‹æ®µ</font></p>
<p>å› æ­¤,æ¨¡å—åŒ–å¼ºè°ƒçš„æ˜¯<strong>æ‹†åˆ†</strong>ï¼Œæœ€å¤§çš„ä»·å€¼å°±æ˜¯åˆ†æ²»ï¼Œæ„å‘³ç€ä¸ç®¡ä½ å°†æ¥æ˜¯å¦è¦å¤ç”¨è¿™å—å„¿ä»£ç ï¼Œéƒ½æœ‰å°†ä»–ä»¬æ‹†æˆä¸€ä¸ªæ¨¡å—çš„ç†ç”±</p>
<blockquote>
<p>å°†ä¸€ä¸ªå¤§é—®é¢˜ï¼Œä¸æ–­çš„æ‹†è§£ä¸ºå„ä¸ªå°é—®é¢˜è¿›è¡Œåˆ†æç ”ç©¶ï¼Œç„¶åå†ç»„åˆåˆ°ä¸€èµ·(åˆ†è€Œæ²»ä¹‹åŸåˆ™)</p>
</blockquote>
<h3 id="æ¨¡å—åŒ–çš„æ–¹æ¡ˆ"><a href="#æ¨¡å—åŒ–çš„æ–¹æ¡ˆ" class="headerlink" title="æ¨¡å—åŒ–çš„æ–¹æ¡ˆ"></a>æ¨¡å—åŒ–çš„æ–¹æ¡ˆ</h3><ul>
<li>JSæ¨¡å—åŒ–</li>
</ul>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">æ— æ¨¡å—åŒ–-&gt;å‡½æ•°å†™æ³•-&gt;å¯¹è±¡å†™æ³•-&gt;è‡ªæ‰§è¡Œå‡½æ•°-&gt;CommonJS/AMD/CMD-&gt;ES6 <span class="keyword">Module</span></span><br></pre></td></tr></table></figure>
<ul>
<li>CSSæ¨¡å—åŒ–</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">cssæ¨¡å—åŒ–æ˜¯åœ¨<span class="keyword">less</span>ï¼Œsassç­‰é¢„å¤„ç†å™¨çš„æ”¯æŒä¸‹å®ç°çš„</span><br></pre></td></tr></table></figure>
<h3 id="åšåˆ°è¿™äº›å°±å¤Ÿäº†å—ï¼Ÿ"><a href="#åšåˆ°è¿™äº›å°±å¤Ÿäº†å—ï¼Ÿ" class="headerlink" title="åšåˆ°è¿™äº›å°±å¤Ÿäº†å—ï¼Ÿ"></a>åšåˆ°è¿™äº›å°±å¤Ÿäº†å—ï¼Ÿ</h3><p>å½“ç„¶æ˜¯ä¸å¤Ÿçš„</p>
<p>æ¨¡å—åŒ–å¼ºè°ƒçš„æ˜¯<strong>æ‹†åˆ†</strong>ï¼Œæ— è®ºæ˜¯ä»ä¸šåŠ¡è§’åº¦è¿˜æ˜¯ä»æ¶æ„ã€æŠ€æœ¯è§’åº¦ï¼Œæ¨¡å—åŒ–é¦–å…ˆæ„å‘³ç€å°†ä»£ç ã€æ•°æ®ç­‰å†…å®¹æŒ‰ç…§å…¶èŒè´£ä¸åŒåˆ†ç¦»</p>
<p>å•çº¯çš„æ¨ªå‘æ‹†åˆ†ä¸šåŠ¡åŠŸèƒ½æ¨¡å—æœ‰ä¸€äº›é—®é¢˜<br><img src="http://cdn.anruence.com/2.png" alt></p>
<ul>
<li>é¢å‘è¿‡ç¨‹çš„ä»£ç  éšç€ä¸šåŠ¡çš„å‘å±•ä¸åˆ©äºç»´æŠ¤</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">éšç€ä¸šåŠ¡å‘å±•ï¼Œâ€è¿‡ç¨‹çº¿â€œä¹Ÿä¼šè¶Šæ¥è¶Šé•¿ï¼Œå…¶ä»–é¡¹ç›®æˆå‘˜æ ¹æ®å„è‡ªéœ€è¦ï¼Œåœ¨â€è¿‡ç¨‹çº¿â€œ åŠ æ’å„è‡ªé€»è¾‘ï¼Œæœ€ç»ˆè¿™ä¸ªé¡µé¢çš„é€»è¾‘å˜å¾—éš¾ä»¥ç»´æŠ¤</span><br><span class="line">æˆ‘ä»¬éœ€è¦æ‘†è„±ã€ä¸€æ³»è€Œä¸‹ã€‘å¼çš„ä»£ç ç¼–å†™</span><br></pre></td></tr></table></figure>
<ul>
<li>ä»…ä»…æœ‰JS/CSSæ¨¡å—åŒ–æ˜¯ä¸å¤Ÿçš„ï¼ŒUIï¼ˆé¡µé¢ï¼‰çš„åˆ†æ²»ä¹Ÿæ¯”è¾ƒè¿«åˆ‡</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">é™¤äº†<span class="keyword">JS</span>å’ŒCSSï¼Œç•Œé¢ä¹Ÿéœ€è¦æ‹†åˆ†ï¼Œå¦‚ä½•è®©æ¨¡å—åŒ–æ€æƒ³èå…¥HTMLè¯­è¨€</span><br></pre></td></tr></table></figure>
<h2 id="4-ç»„ä»¶åŒ–å¼€å‘ï¼ˆæœ¬æ–‡é‡ç‚¹ï¼‰"><a href="#4-ç»„ä»¶åŒ–å¼€å‘ï¼ˆæœ¬æ–‡é‡ç‚¹ï¼‰" class="headerlink" title="4. ç»„ä»¶åŒ–å¼€å‘ï¼ˆæœ¬æ–‡é‡ç‚¹ï¼‰"></a><font color="red">4. ç»„ä»¶åŒ–å¼€å‘ï¼ˆæœ¬æ–‡é‡ç‚¹ï¼‰</font></h2><h3 id="ç»„ä»¶åŒ–å¼€å‘çš„æ¼”å˜"><a href="#ç»„ä»¶åŒ–å¼€å‘çš„æ¼”å˜" class="headerlink" title="ç»„ä»¶åŒ–å¼€å‘çš„æ¼”å˜"></a>ç»„ä»¶åŒ–å¼€å‘çš„æ¼”å˜</h3><p>åœ¨å¤§è‚†å®£æ‰¬ç»„ä»¶åŒ–å¼€å‘æ¦‚å¿µä¹‹å‰ï¼Œä¹Ÿç»å†äº†å¯»æ±‚ç»„ä»¶åŒ–æœ€ä½³å®è·µçš„é˜¶æ®µ</p>
<h4 id="é¡µé¢ç»“æ„æ¨¡å—åŒ–"><a href="#é¡µé¢ç»“æ„æ¨¡å—åŒ–" class="headerlink" title="é¡µé¢ç»“æ„æ¨¡å—åŒ–"></a>é¡µé¢ç»“æ„æ¨¡å—åŒ–</h4><p><img src="http://cdn.anruence.com/jimu" alt="image"><br>ç®€å•æ¥è¯´å°±æ˜¯æŠŠé¡µé¢æƒ³è±¡æˆä¹é«˜æœºå™¨äººï¼Œéœ€è¦ä¸åŒé›¶ä»¶ç»„è£…ï¼Œç„¶åå°†å„ä¸ªéƒ¨åˆ†æ‹¼åˆ°ä¸€èµ·</p>
<p>è½å®åˆ°å®é™…å¼€å‘ä¸­åƒè¿™æ ·<br><img src="http://cdn.anruence.com/jiegouhua.png" alt></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°</p>
<ul>
<li>é¡µé¢pageModelåŒ…å«äº† <code>tabContainer</code>ï¼Œ<code>listContainer</code> å’Œ <code>imgsContainer</code> ä¸‰ä¸ªæ¨¡å—</li>
<li>æˆ‘ä»¬æ ¹æ®ä¸åŒçš„ä¸šåŠ¡é€»è¾‘å°è£…äº†ä¸åŒç±»å‹çš„model</li>
<li>æ¯ä¸ªmodelæœ‰è‡ªå·±çš„æ•°æ®ï¼Œæ¨¡æ¿ï¼Œé€»è¾‘ï¼Œå·²ç»ç®—æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŠŸèƒ½å•å…ƒ</li>
</ul>
<font color="red">å’¦ï¼Ÿå—…åˆ°ä¸€ä¸ç»„ä»¶åŒ–çš„å‘³é“</font>

<h4 id="Nå¹´å‰å¾®è½¯çš„ç»„ä»¶åŒ–çš„è§£å†³æ–¹æ¡ˆ-HTML-Component"><a href="#Nå¹´å‰å¾®è½¯çš„ç»„ä»¶åŒ–çš„è§£å†³æ–¹æ¡ˆ-HTML-Component" class="headerlink" title="Nå¹´å‰å¾®è½¯çš„ç»„ä»¶åŒ–çš„è§£å†³æ–¹æ¡ˆ HTML Component"></a>Nå¹´å‰å¾®è½¯çš„ç»„ä»¶åŒ–çš„è§£å†³æ–¹æ¡ˆ HTML Component</h4><p>å†å²æ€»æœ‰é—ğŸ–</p>
<p>æ—©åœ¨Nå¹´å‰å¾®è½¯æå‡ºè¿‡ä¸€å¥—è§£å†³æ–¹æ¡ˆï¼Œåä¸º<code>HTML Component</code></p>
<p><img src="http://cdn.anruence.com/4.jpg" alt="jsworke"></p>
<p>äº‹å®ä¸Šå·²ç»æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„ç»„ä»¶åŒ–æ–¹æ¡ˆäº†ï¼Œä½†æœ€åå´æ²¡èƒ½è¿›å…¥æ ‡å‡†ï¼Œä»ä»Šå¤©çš„è§’åº¦çœ‹ï¼Œå®ƒå¯ä»¥è¯´æ˜¯ç”Ÿä¸é€¢æ—¶</p>
<h4 id="WebComponents-æ ‡å‡†"><a href="#WebComponents-æ ‡å‡†" class="headerlink" title="WebComponents æ ‡å‡†"></a>WebComponents æ ‡å‡†</h4><p>å½“æ—¶â€æ‰€è°“çš„ç»„ä»¶â€œ</p>
<ul>
<li>æ­¤æ—¶çš„ç»„ä»¶åŸºæœ¬ä¸Šåªèƒ½è¾¾åˆ°æŸä¸ªåŠŸèƒ½å•å…ƒä¸Šçš„é›†åˆï¼Œèµ„æºéƒ½æ˜¯èµ„æºéƒ½æ˜¯æ¾æ•£åœ°åˆ†æ•£åœ¨ä¸‰ç§èµ„æºæ–‡ä»¶ä¸­</li>
<li>è€Œä¸”ç»„ä»¶ä½œç”¨åŸŸæš´éœ²åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œç¼ºä¹å†…èšæ€§å¾ˆå®¹æ˜“å°±ä¼šè·Ÿå…¶ä»–ç»„ä»¶äº§ç”Ÿå†²çªï¼ˆå¦‚æœ€ç®€å•çš„ css å‘½åå†²çªï¼‰</li>
</ul>
<p>äºæ˜¯ W3C æŒ‰è€ä¸ä½äº†ï¼Œåˆ¶å®šä¸€ä¸ª WebComponents æ ‡å‡†ï¼Œä¸ºç»„ä»¶åŒ–çš„æœªæ¥æŒ‡å¼•äº†æ˜è·¯</p>
<p>å¤§è‡´å››éƒ¨åˆ†åŠŸèƒ½</p>
<ul>
<li><code>&lt;template&gt;</code> å®šä¹‰ç»„ä»¶çš„ HTMLæ¨¡æ¿èƒ½åŠ›</li>
<li>Shadow Dom å°è£…ç»„ä»¶çš„å†…éƒ¨ç»“æ„ï¼Œå¹¶ä¸”ä¿æŒå…¶ç‹¬ç«‹æ€§</li>
<li>Custom Element å¯¹å¤–æä¾›ç»„ä»¶çš„æ ‡ç­¾ï¼Œå®ç°è‡ªå®šä¹‰æ ‡ç­¾</li>
<li>import è§£å†³ç»„ä»¶ç»“åˆå’Œä¾èµ–åŠ è½½</li>
</ul>
<p>æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå¯è¡Œçš„å®è·µåŒ–æ–¹æ¡ˆéœ€è¦å…·å¤‡å“ªäº›èƒ½åŠ›</p>
<ul>
<li>èµ„æºé«˜å†…èšï¼ˆç»„ä»¶èµ„æºå†…éƒ¨é«˜å†…èšï¼Œç»„ä»¶èµ„æºç”±è‡ªèº«åŠ è½½æ§åˆ¶ï¼‰</li>
<li>ä½œç”¨åŸŸç‹¬ç«‹ï¼ˆå†…éƒ¨ç»“æ„å¯†å°ï¼Œä¸ä¸å…¨å±€æˆ–å…¶ä»–ç»„ä»¶äº§ç”Ÿå½±å“ï¼‰</li>
<li>è‡ªå®šä¹‰æ ‡ç­¾ï¼ˆå®šä¹‰ç»„ä»¶çš„ä½¿ç”¨æ–¹å¼ï¼‰</li>
<li>å¯ç›¸äº’ç»„åˆï¼ˆç»„ä»¶é—´ç»„è£…æ•´åˆï¼‰</li>
<li>æ¥å£è§„èŒƒåŒ–ï¼ˆç»„ä»¶æ¥å£æœ‰ç»Ÿä¸€è§„èŒƒï¼Œæˆ–è€…æ˜¯ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼‰</li>
</ul>
<h4 id="ä¸‰å¤§æ¡†æ¶å‡ºç°"><a href="#ä¸‰å¤§æ¡†æ¶å‡ºç°" class="headerlink" title="ä¸‰å¤§æ¡†æ¶å‡ºç°"></a>ä¸‰å¤§æ¡†æ¶å‡ºç°</h4><p>ä»Šå¤©çš„å‰ç«¯ç”Ÿæ€é‡Œé¢ Reactï¼ŒAngularå’ŒVueä¸‰åˆ†å¤©ä¸‹ï¼Œå³ä½¿å®ƒä»¬å®šä½ä¸åŒï¼Œä½†æ ¸å¿ƒçš„å…±åŒç‚¹å°±æ˜¯æä¾›äº†ç»„ä»¶åŒ–çš„èƒ½åŠ›ï¼Œç®—æ˜¯ç›®å‰æ˜¯æ¯”è¾ƒå¥½çš„ç»„ä»¶åŒ–å®è·µ</p>
<h5 id="1-Vue-jsé‡‡ç”¨äº†JSONçš„æ–¹æ³•æè¿°ä¸€ä¸ªç»„ä»¶"><a href="#1-Vue-jsé‡‡ç”¨äº†JSONçš„æ–¹æ³•æè¿°ä¸€ä¸ªç»„ä»¶" class="headerlink" title="1. Vue.jsé‡‡ç”¨äº†JSONçš„æ–¹æ³•æè¿°ä¸€ä¸ªç»„ä»¶"></a>1. Vue.jsé‡‡ç”¨äº†JSONçš„æ–¹æ³•æè¿°ä¸€ä¸ªç»„ä»¶</h5><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PageContainer <span class="keyword">from</span> <span class="string">'./layout/PageContainer'</span></span><br><span class="line"><span class="keyword">import</span> PageFilter <span class="keyword">from</span> <span class="string">'./layout/PageFilter'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  install(Vue) &#123;</span><br><span class="line">    Vue.component(<span class="string">'PageContainer'</span>, PageContainer)</span><br><span class="line">    Vue.component(<span class="string">'PageFilter'</span>, PageFilter)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜æä¾›äº†SFCï¼ˆSingle File Componentï¼Œå•æ–‡ä»¶ç»„ä»¶ï¼‰â€˜.vueâ€™æ–‡ä»¶æ ¼å¼</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">//...</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">  export default </span><span class="template-variable">&#123;</span></span><br><span class="line"><span class="template-variable">    data()&#123;&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"scss"</span>&gt;</span></span></span><br><span class="line"><span class="xml">//...</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h5 id="2-React-jså‘æ˜äº†JSXï¼ŒæŠŠCSSå’ŒHTMLéƒ½å¡è¿›JSæ–‡ä»¶é‡Œ"><a href="#2-React-jså‘æ˜äº†JSXï¼ŒæŠŠCSSå’ŒHTMLéƒ½å¡è¿›JSæ–‡ä»¶é‡Œ" class="headerlink" title="2. React.jså‘æ˜äº†JSXï¼ŒæŠŠCSSå’ŒHTMLéƒ½å¡è¿›JSæ–‡ä»¶é‡Œ"></a>2. React.jså‘æ˜äº†JSXï¼ŒæŠŠCSSå’ŒHTMLéƒ½å¡è¿›JSæ–‡ä»¶é‡Œ</h5><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tabs</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.props.items) &#123;</span><br><span class="line">            console.error(<span class="symbol">'Tabs</span>ä¸­éœ€è¦ä¼ å…¥æ•°æ®');</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        const propId = <span class="keyword">this</span>.props.id;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;ul className=&#123;<span class="keyword">this</span>.props.className&#125;&gt;</span><br><span class="line">              &lt;li&gt;æµ‹è¯•&lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Angular-jsé€‰æ‹©åœ¨åŸæœ¬çš„HTMLä¸Šæ‰©å±•"><a href="#Angular-jsé€‰æ‹©åœ¨åŸæœ¬çš„HTMLä¸Šæ‰©å±•" class="headerlink" title="Angular.jsé€‰æ‹©åœ¨åŸæœ¬çš„HTMLä¸Šæ‰©å±•"></a>Angular.jsé€‰æ‹©åœ¨åŸæœ¬çš„HTMLä¸Šæ‰©å±•</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> ng-model=<span class="string">"firstname"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'myApp'</span>, []);</span><br><span class="line">app.controller(<span class="string">'formCtrl'</span>, <span class="function"><span class="keyword">function</span><span class="params">($scope)</span> </span>&#123;</span><br><span class="line">    $scope.firstname = <span class="string">"John"</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="æ ‡å‡†ä¸‹çš„èµ„æºæ•´åˆ"><a href="#æ ‡å‡†ä¸‹çš„èµ„æºæ•´åˆ" class="headerlink" title="æ ‡å‡†ä¸‹çš„èµ„æºæ•´åˆ"></a>æ ‡å‡†ä¸‹çš„èµ„æºæ•´åˆ</h3><p><img src="http://cdn.anruence.com/sss.png" alt="image"></p>
<h4 id="å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹"><a href="#å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹" class="headerlink" title="å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹"></a>å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹</h4><ul>
<li>æ¯ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ªç›®å½•ï¼Œç»„ä»¶æ‰€éœ€çš„å„ç§èµ„æºéƒ½åœ¨è¿™ä¸ªç›®å½•ä¸‹å°±è¿‘ç»´æŠ¤ï¼›ï¼ˆæœ€å…·è½¯ä»¶å·¥ç¨‹ä»·å€¼ï¼‰</li>
<li>é¡µé¢ä¸Šçš„æ¯ä¸ªç‹¬ç«‹çš„å¯è§†/å¯äº¤äº’åŒºåŸŸè§†ä¸ºä¸€ä¸ªç»„ä»¶ï¼›</li>
<li>ç”±äºç»„ä»¶å…·æœ‰ç‹¬ç«‹æ€§ï¼Œå¯ä»¥è‡ªç”±ç»„åˆï¼›</li>
<li>é¡µé¢æ˜¯ç»„ä»¶çš„å®¹å™¨ï¼Œè´Ÿè´£ç»„åˆç»„ä»¶å½¢æˆåŠŸèƒ½å®Œæ•´çš„ç•Œé¢ï¼›</li>
<li>å½“ä¸éœ€è¦æŸä¸ªç»„ä»¶ï¼Œæˆ–è€…æƒ³è¦æ›¿æ¢ç»„ä»¶æ—¶ï¼Œå¯ä»¥æ•´ä¸ªç›®å½•åˆ é™¤/æ›¿æ¢</li>
</ul>
<h3 id="åº”ç”¨ç»“æ„å›¾"><a href="#åº”ç”¨ç»“æ„å›¾" class="headerlink" title="åº”ç”¨ç»“æ„å›¾"></a>åº”ç”¨ç»“æ„å›¾</h3><p><img src="http://cdn.anruence.com/niubi.png" alt="image"></p>
<ul>
<li>åˆ†å­æ˜¯ç”±åŸå­ç»„æˆçš„ï¼Œåˆ†å­åˆ†æˆåŸå­ï¼ŒåŸå­ä¹Ÿå¯ä»¥é‡æ–°ç»„åˆæˆæ–°çš„åˆ†å­</li>
<li>ä¸€ä¸ªç•Œé¢æ˜¯ç”±ç‹¬ç«‹çš„åˆ†å­ç»„ä»¶æ­å»ºè€Œæˆï¼Œåˆ†å­ç»„ä»¶ç”±åŸå­å…ƒä»¶æ„æˆï¼Œè¿™äº›åŸå­å¯é€šè¿‡ä¸åŒçš„ç»„åˆæ–¹å¼ï¼Œç»„æˆæ–°åˆ†å­ç»„ä»¶ï¼Œç»§è€Œé‡ç»„æ„æˆæ–°çš„ç•Œé¢</li>
</ul>
<h3 id="æ¨¡å—åŒ–ä¸ç»„ä»¶åŒ–å¯¹æ¯”"><a href="#æ¨¡å—åŒ–ä¸ç»„ä»¶åŒ–å¯¹æ¯”" class="headerlink" title="æ¨¡å—åŒ–ä¸ç»„ä»¶åŒ–å¯¹æ¯”"></a>æ¨¡å—åŒ–ä¸ç»„ä»¶åŒ–å¯¹æ¯”</h3><p>å¦‚æœä½ å»ç½‘ä¸Šæœã€æ¨¡å—å’Œç»„ä»¶çš„å¼‚åŒã€‘<br>å¯èƒ½ä¼šå¾—åˆ°æˆªç„¶ä¸åŒçš„ç­”æ¡ˆï¼Œå¤§éƒ¨åˆ†æè¿°çš„éƒ½æ˜¯ç‰‡é¢çš„</p>
<p>å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯ä»¥ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢åˆ†æï¼š</p>
<h4 id="ä»æ•´ä½“æ¦‚å¿µæ¥è®²"><a href="#ä»æ•´ä½“æ¦‚å¿µæ¥è®²" class="headerlink" title="ä»æ•´ä½“æ¦‚å¿µæ¥è®²"></a>ä»æ•´ä½“æ¦‚å¿µæ¥è®²</h4><ul>
<li>æ¨¡å—åŒ–æ˜¯ä¸€ç§åˆ†æ²»çš„æ€æƒ³ï¼Œè¯‰æ±‚æ˜¯è§£è€¦ï¼Œä¸€èˆ¬æŒ‡çš„æ˜¯jsæ¨¡å—ï¼Œæ¯”å¦‚ç”¨æ¥æ ¼å¼åŒ–æ—¶é—´çš„æ¨¡å—</li>
<li>ç»„ä»¶åŒ–æ˜¯æ¨¡å—åŒ–æ€æƒ³çš„å®ç°æ‰‹æ®µï¼Œè¯‰æ±‚æ˜¯å¤ç”¨ï¼ŒåŒ…å«äº†<code>template</code>ï¼Œ<code>style</code>ï¼Œ<code>script</code>ï¼Œscriptåˆå¯ä»¥ç”±å„ç§æ¨¡å—ç»„æˆ</li>
</ul>
<h4 id="ä»å¤ç”¨çš„è§’åº¦æ¥è®²"><a href="#ä»å¤ç”¨çš„è§’åº¦æ¥è®²" class="headerlink" title="ä»å¤ç”¨çš„è§’åº¦æ¥è®²"></a>ä»å¤ç”¨çš„è§’åº¦æ¥è®²</h4><ul>
<li>æ¨¡å—ä¸€èˆ¬æ˜¯é¡¹ç›®èŒƒå›´å†…æŒ‰ç…§é¡¹ç›®ä¸šåŠ¡å†…å®¹æ¥åˆ’åˆ†çš„ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡¹ç›®åˆ’åˆ†ä¸ºå­ç³»ç»Ÿã€æ¨¡å—ã€å­æ¨¡å—ï¼Œ<strong>ä»£ç åˆ†å¼€å°±æ˜¯æ¨¡å—</strong></li>
<li>ç»„ä»¶æ˜¯æŒ‰ç…§ä¸€äº›å°åŠŸèƒ½çš„é€šç”¨æ€§å’Œå¯å¤ç”¨æ€§æŠ½è±¡å‡ºæ¥çš„ï¼Œå¯ä»¥è·¨é¡¹ç›®ï¼Œæ˜¯å¯å¤ç”¨çš„æ¨¡å—</li>
</ul>
<h4 id="ä»å†å²å‘å±•è§’åº¦æ¥è®²"><a href="#ä»å†å²å‘å±•è§’åº¦æ¥è®²" class="headerlink" title="ä»å†å²å‘å±•è§’åº¦æ¥è®²"></a>ä»å†å²å‘å±•è§’åº¦æ¥è®²</h4><p>éšç€å‰ç«¯å¼€å‘è¶Šæ¥è¶Šå¤æ‚ã€å¯¹æ•ˆç‡è¦æ±‚è¶Šæ¥é«˜ï¼Œç”±é¡¹ç›®çº§æ¨¡å—åŒ–å¼€å‘ï¼Œè¿›ä¸€æ­¥æå‡åˆ°é€šç”¨åŠŸèƒ½ç»„ä»¶åŒ–å¼€å‘ï¼Œ<strong>æ¨¡å—åŒ–æ˜¯ç»„ä»¶åŒ–çš„å‰æï¼Œç»„ä»¶åŒ–æ˜¯æ¨¡å—åŒ–çš„æ¼”è¿›</strong></p>
<h1 id="ç»„ä»¶çš„è®¾è®¡åŸåˆ™"><a href="#ç»„ä»¶çš„è®¾è®¡åŸåˆ™" class="headerlink" title="ç»„ä»¶çš„è®¾è®¡åŸåˆ™"></a>ç»„ä»¶çš„è®¾è®¡åŸåˆ™</h1><p>ç»„ä»¶åŒ–æ–¹æ¡ˆä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å…·æœ‰ç»„ä»¶åŒ–è®¾è®¡æ€ç»´ï¼Œå®ƒæ˜¯ä¸€ç§ã€æ•´ç†æœ¯ã€‘å¸®åŠ©æˆ‘ä»¬é«˜æ•ˆå¼€å‘æ•´åˆ</p>
<ol>
<li>æ ‡å‡†æ€§</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä»»ä½•ä¸€ä¸ªç»„ä»¶éƒ½åº”è¯¥éµå®ˆä¸€å¥—æ ‡å‡†ï¼Œå¯ä»¥ä½¿å¾—ä¸åŒåŒºåŸŸçš„å¼€å‘äººå‘˜æ®æ­¤æ ‡å‡†å¼€å‘å‡ºä¸€å¥—æ ‡å‡†ç»Ÿä¸€çš„ç»„ä»¶</span><br><span class="line"></span><br><span class="line">APIå°½é‡å’Œå·²çŸ¥æ¦‚å¿µä¿æŒä¸€è‡´</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ç‹¬ç«‹æ€§</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">éµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Œä¿æŒç»„ä»¶çš„çº¯ç²¹æ€§</span><br><span class="line">å±æ€§é…ç½®ç­‰APIå¯¹å¤–å¼€æ”¾ï¼Œç»„ä»¶å†…éƒ¨çŠ¶æ€å¯¹å¤–å°é—­ï¼Œå°½å¯èƒ½çš„å°‘ä¸ä¸šåŠ¡è€¦åˆ</span><br><span class="line"></span><br><span class="line">é¿å…æš´éœ²ç»„ä»¶å†…éƒ¨å®ç°</span><br><span class="line"></span><br><span class="line">å…¥å£å¤„æ£€æŸ¥å‚æ•°çš„æœ‰æ•ˆæ€§ï¼Œå‡ºå£å¤„æ£€æŸ¥è¿”å›çš„æ­£ç¡®æ€§</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>å¤ç”¨ä¸æ˜“ç”¨ï¼Œé€‚ç”¨SPOTæ³•åˆ™ </li>
</ol>
<figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">UIå·®å¼‚ï¼Œæ¶ˆåŒ–åœ¨ç»„ä»¶å†…éƒ¨ï¼ˆæ³¨æ„å¹¶ä¸æ˜¯å†™ä¸€å †<span class="keyword">if</span>/<span class="keyword">else</span>ï¼‰</span><br><span class="line">è¾“å…¥è¾“å‡ºå‹å¥½ï¼Œæ˜“ç”¨</span><br><span class="line"></span><br><span class="line"><span class="built_in">Single</span> Point <span class="keyword">Of</span> Truthï¼Œå°±æ˜¯å°½é‡ä¸è¦é‡å¤ä»£ç ï¼Œå‡ºè‡ªã€ŠThe Art <span class="keyword">of</span> Unix Programmingã€‹</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>é¿å…ç›´æ¥æ“ä½œDOMï¼Œé¿å…ä½¿ç”¨ref</li>
</ol>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨çˆ¶ç»„ä»¶çš„ <span class="keyword">state</span> æ§åˆ¶å­ç»„ä»¶çš„çŠ¶æ€è€Œä¸æ˜¯ç›´æ¥é€šè¿‡ ref æ“ä½œå­ç»„ä»¶</span><br></pre></td></tr></table></figure>
<ol start="5">
<li><strong>æ— ç¯ä¾èµ–åŸåˆ™(ADP)</strong></li>
</ol>
<p>è®¾è®¡ä¸å½“å¯¼è‡´ç¯å½¢ä¾èµ–ç¤ºæ„å›¾<br><img src="http://cdn.anruence.com/1111111111.png" alt="image"></p>
<p><strong>å½±å“</strong></p>
<ul>
<li>ç»„ä»¶é—´è€¦åˆåº¦é«˜ï¼Œé›†æˆæµ‹è¯•éš¾</li>
<li>ä¸€å¤„ä¿®æ”¹ï¼Œå¤„å¤„å½±å“ï¼Œäº¤ä»˜å‘¨æœŸé•¿</li>
<li>å› ä¸ºç»„ä»¶ä¹‹é—´å­˜åœ¨å¾ªç¯ä¾èµ–ï¼Œå˜æˆäº†â€œå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹â€çš„é—®é¢˜</li>
</ul>
<p><strong>é‚£å€˜è‹¥æˆ‘ä»¬çœŸçš„é‡åˆ°äº†è¿™ç§é—®é¢˜ï¼Œå°±è¦è€ƒè™‘å¦‚ä½•å¤„ç†ï¼Ÿ</strong></p>
<font color="red">æ¶ˆé™¤ç¯å½¢ä¾èµ–</font>

<blockquote>
<p>æˆ‘ä»¬çš„è¿½æ±‚æ˜¯æ²¿ç€é€†å‘çš„ä¾èµ–å…³ç³»å³å¯å¯»æ‰¾åˆ°æ‰€æœ‰å—å½±å“çš„ç»„ä»¶</p>
</blockquote>
<p>åˆ›å»ºä¸€ä¸ªå…±åŒä¾èµ–çš„æ–°ç»„ä»¶</p>
<p><img src="http://cdn.anruence.com/xiaochu.png" alt="image"></p>
<ol start="6">
<li>ç¨³å®šæŠ½è±¡åŸåˆ™(SAP)</li>
</ol>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>ç»„ä»¶çš„æŠ½è±¡ç¨‹åº¦ä¸å…¶ç¨³å®šç¨‹åº¦æˆæ­£æ¯”ï¼Œ</span><br><span class="line"><span class="bullet">- </span>ä¸€ä¸ªç¨³å®šçš„ç»„ä»¶åº”è¯¥æ˜¯æŠ½è±¡çš„ï¼ˆé€»è¾‘æ— å…³çš„ï¼‰</span><br><span class="line"><span class="bullet">- </span>ä¸€ä¸ªä¸ç¨³å®šçš„ç»„ä»¶åº”è¯¥æ˜¯å…·ä½“çš„ï¼ˆé€»è¾‘ç›¸å…³çš„ï¼‰</span><br><span class="line"><span class="bullet">- </span>ä¸ºé™ä½ç»„ä»¶ä¹‹é—´çš„è€¦åˆåº¦ï¼Œæˆ‘ä»¬è¦é’ˆå¯¹æŠ½è±¡ç»„ä»¶ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ä¸šåŠ¡å®ç°ç¼–ç¨‹</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>é¿å…å†—ä½™çŠ¶æ€</li>
</ol>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">å¦‚æœä¸€ä¸ªæ•°æ®å¯ä»¥ç”±å¦ä¸€ä¸ª <span class="keyword">state</span> å˜æ¢å¾—åˆ°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®å°±ä¸æ˜¯ä¸€ä¸ª <span class="keyword">state</span>ï¼Œåªéœ€è¦å†™ä¸€ä¸ªå˜æ¢çš„å¤„ç†å‡½æ•°ï¼Œåœ¨ Vue ä¸­å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§</span><br><span class="line"></span><br><span class="line">å¦‚æœä¸€ä¸ªæ•°æ®æ˜¯å›ºå®šçš„ï¼Œä¸ä¼šå˜åŒ–çš„å¸¸é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®å°±å¦‚åŒ HTML å›ºå®šçš„ç«™ç‚¹æ ‡é¢˜ä¸€æ ·ï¼Œå†™æ­»æˆ–ä½œä¸ºå…¨å±€é…ç½®å±æ€§ç­‰ï¼Œä¸å±äº <span class="keyword">state</span></span><br><span class="line"></span><br><span class="line">å¦‚æœå…„å¼Ÿç»„ä»¶æ‹¥æœ‰ç›¸åŒçš„ <span class="keyword">state</span>ï¼Œé‚£ä¹ˆè¿™ä¸ª<span class="keyword">state</span> åº”è¯¥æ”¾åˆ°æ›´é«˜çš„å±‚çº§ï¼Œä½¿ç”¨ props ä¼ é€’åˆ°ä¸¤ä¸ªç»„ä»¶ä¸­</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>åˆç†çš„ä¾èµ–å…³ç³»</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">çˆ¶ç»„ä»¶ä¸ä¾èµ–å­ç»„ä»¶ï¼Œåˆ é™¤æŸä¸ªå­ç»„ä»¶ä¸ä¼šé€ æˆåŠŸèƒ½å¼‚å¸¸</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>æ‰å¹³åŒ–å‚æ•°</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é™¤äº†æ•°æ®ï¼Œé¿å…å¤æ‚çš„å¯¹è±¡ï¼Œå°½é‡åªæ¥æ”¶åŸå§‹ç±»å‹çš„å€¼</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>è‰¯å¥½çš„æ¥å£è®¾è®¡<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">æŠŠç»„ä»¶å†…éƒ¨å¯ä»¥å®Œæˆçš„å·¥ä½œåšåˆ°æè‡´ï¼Œè™½ç„¶æå€¡æ‹¥æŠ±å˜åŒ–ï¼Œä½†æ¥å£ä¸æ˜¯è¶Šå¤šè¶Šå¥½</span><br><span class="line"></span><br><span class="line">å¦‚æœå¸¸é‡å˜ä¸º <span class="built_in">props</span> èƒ½åº”å¯¹æ›´å¤šçš„åœºæ™¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½œä¸º <span class="built_in">props</span>ï¼ŒåŸæœ‰çš„å¸¸é‡å¯ä½œä¸ºé»˜è®¤å€¼ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœéœ€è¦ä¸ºäº†æŸä¸€è°ƒç”¨è€…ç¼–å†™å¤§é‡ç‰¹å®šéœ€æ±‚çš„ä»£ç ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é€šè¿‡æ‰©å±•ç­‰æ–¹å¼æ„å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">ä¿è¯ç»„ä»¶çš„å±æ€§å’Œäº‹ä»¶è¶³å¤Ÿçš„ç»™å¤§å¤šæ•°çš„ç»„ä»¶ä½¿ç”¨ã€‚</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="ç»„ä»¶çš„èŒèƒ½åˆ’åˆ†"><a href="#ç»„ä»¶çš„èŒèƒ½åˆ’åˆ†" class="headerlink" title="ç»„ä»¶çš„èŒèƒ½åˆ’åˆ†"></a>ç»„ä»¶çš„èŒèƒ½åˆ’åˆ†</h1><p>é‚£æœ‰äº†ç»„ä»¶è®¾è®¡çš„â€œAPIâ€ï¼Œå°±ä¸€å®šèƒ½å¼€å‘å‡ºé«˜è´¨é‡çš„ç»„ä»¶å—ï¼Ÿ</p>
<blockquote>
<p>ç»„ä»¶æœ€å¤§çš„ä¸ç¨³å®šæ€§æ¥è‡ªäºå±•ç°å±‚ï¼Œä¸€ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ï¼ŒåŸºäºåŠŸèƒ½åšå¥½èŒè´£åˆ’åˆ†</p>
</blockquote>
<p>æ ¹æ®ä»¥å¾€ç»éªŒï¼Œæˆ‘å°†ç»„ä»¶åˆ†ä¸ºä»¥ä¸‹å‡ ç±»</p>
<ul>
<li>åŸºç¡€ç»„ä»¶ï¼ˆé€šå¸¸åœ¨ç»„ä»¶åº“é‡Œå°±è§£å†³äº†ï¼‰</li>
<li>å®¹å™¨å‹ç»„ä»¶ï¼ˆContainerï¼‰</li>
<li>å±•ç¤ºå‹ç»„ä»¶ï¼ˆstatelessï¼‰</li>
<li>ä¸šåŠ¡ç»„ä»¶</li>
<li>é€šç”¨ç»„ä»¶<ul>
<li>UIç»„ä»¶</li>
<li>é€»è¾‘ç»„ä»¶</li>
</ul>
</li>
<li>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰</li>
</ul>
<font color="red">é™¤å®¹å™¨ç»„ä»¶å¤–ï¼Œå°½é‡ä¿è¯ç»„ä»¶éƒ½æ˜¯statelessçš„ï¼Œè¿™å¹¶ä¸å†²çªï¼</font>

<h2 id="åŸºç¡€ç»„ä»¶"><a href="#åŸºç¡€ç»„ä»¶" class="headerlink" title="åŸºç¡€ç»„ä»¶"></a>åŸºç¡€ç»„ä»¶</h2><p>ä¸ºäº†è®©å¼€å‘è€…æ›´å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæ¶Œç°å‡ºäº†å¾ˆå¤šä¼˜ç§€çš„UIç»„ä»¶åº“<br>æ¯”å¦‚<code>antd</code>ï¼Œ<code>element-ui</code>ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨APIä¾¿èƒ½æ»¡è¶³å¤§éƒ¨åˆ†çš„ä¸šåŠ¡åœºæ™¯ï¼Œå‰ç«¯è§’è‰²åç½®äº†ï¼Œå¼€å‘å˜å¾—æ›´ç®€å•äº†</p>
<h2 id="å®¹å™¨å‹ç»„ä»¶"><a href="#å®¹å™¨å‹ç»„ä»¶" class="headerlink" title="å®¹å™¨å‹ç»„ä»¶"></a>å®¹å™¨å‹ç»„ä»¶</h2><p>ä¸€ä¸ªå®¹å™¨æ€§è´¨çš„ç»„ä»¶ï¼Œä¸€èˆ¬å½“ä½œä¸€ä¸ªä¸šåŠ¡å­æ¨¡å—çš„å…¥å£ï¼Œæ¯”å¦‚ä¸€ä¸ªè·¯ç”±æŒ‡å‘çš„ç»„ä»¶</p>
<p><img src="http://cdn.anruence.com/RONGQIZUJIAN.png" alt="image"></p>
<h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul>
<li>å®¹å™¨ç»„ä»¶å†…çš„å­ç»„ä»¶é€šå¸¸å…·æœ‰ä¸šåŠ¡æˆ–æ•°æ®ä¾èµ–å…³ç³»</li>
<li>é›†ä¸­/ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†ï¼Œå‘å…¶ä»–å±•ç¤ºå‹/å®¹å™¨å‹ç»„ä»¶æä¾›æ•°æ®ï¼ˆå……å½“æ•°æ®æºï¼‰å’Œè¡Œä¸ºé€»è¾‘å¤„ç†ï¼ˆæ¥æ”¶å›è°ƒï¼‰</li>
<li>å¦‚æœä½¿ç”¨äº†å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œé‚£ä¹ˆå®¹å™¨å†…éƒ¨çš„ä¸šåŠ¡ç»„ä»¶å¯ä»¥è‡ªè¡Œè°ƒç”¨å…¨å±€çŠ¶æ€å¤„ç†ä¸šåŠ¡</li>
<li>ä¸šåŠ¡æ¨¡å—å†…å­ç»„ä»¶çš„é€šä¿¡ç­‰ç»Ÿç­¹å¤„ç†ï¼Œå……å½“å­çº§ç»„ä»¶é€šä¿¡çš„çŠ¶æ€ä¸­è½¬ç«™</li>
<li>æ¨¡ç‰ˆåŸºæœ¬éƒ½æ˜¯å­çº§ç»„ä»¶çš„é›†åˆï¼Œå¾ˆå°‘åŒ…å«<code>DOM</code>æ ‡ç­¾</li>
<li>è¾…åŠ©ä»£ç åˆ†ç¦»</li>
</ul>
<h3 id="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰"><a href="#è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰" class="headerlink" title="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰"></a>è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"purchase-box"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- é¢åŒ…å±‘å¯¼èˆª --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bread-crumbs</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"scroll-content"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æœç´¢åŒºåŸŸ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Search</span> <span class="attr">v-show</span>=<span class="string">"toggleFilter"</span> <span class="attr">:form</span>=<span class="string">"form"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å±•å¼€æ”¶èµ·åŒºåŸŸ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Toggle</span> <span class="attr">:toggleFilter</span>=<span class="string">"toggleFilter"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åˆ—è¡¨åŒºåŸŸ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">List</span> <span class="attr">:data</span>=<span class="string">"listData"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å±•ç¤ºå‹ï¼ˆstatelessï¼‰ç»„ä»¶"><a href="#å±•ç¤ºå‹ï¼ˆstatelessï¼‰ç»„ä»¶" class="headerlink" title="å±•ç¤ºå‹ï¼ˆstatelessï¼‰ç»„ä»¶"></a>å±•ç¤ºå‹ï¼ˆstatelessï¼‰ç»„ä»¶</h2><p>ä¸»è¦è¡¨ç°ä¸ºç»„ä»¶æ˜¯æ€æ ·æ¸²æŸ“çš„ï¼Œå°±åƒä¸€ä¸ªç®€å•çš„æ¨¡ç‰ˆæ¸²æŸ“è¿‡ç¨‹</p>
<p><img src="http://cdn.anruence.com/zhanshixing.png" alt="image"></p>
<h3 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul>
<li>åªé€šè¿‡propsæ¥å—æ•°æ®å’Œå›è°ƒå‡½æ•°ï¼Œä¸å……å½“æ•°æ®æº</li>
<li>å¯èƒ½åŒ…å«å±•ç¤ºå’Œå®¹å™¨ç»„ä»¶ å¹¶ä¸”ä¸€èˆ¬ä¼šæœ‰Domæ ‡ç­¾å’Œcssæ ·å¼</li>
<li>é€šå¸¸ç”¨props.children(react) æˆ–è€…slot(vue)æ¥åŒ…å«å…¶ä»–ç»„ä»¶</li>
<li>å¯¹ç¬¬ä¸‰æ–¹æ²¡æœ‰ä¾èµ–ï¼ˆå¯¹äºä¸€ä¸ªåº”ç”¨çº§çš„ç»„ä»¶æ¥è¯´å¯ä»¥æœ‰ï¼‰</li>
<li>å¯ä»¥æœ‰çŠ¶æ€ï¼Œåœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…å¯ä»¥æ“çºµå¹¶æ”¹å˜å…¶å†…éƒ¨çŠ¶æ€ï¼ŒèŒè´£å•ä¸€ï¼Œå°†ä¸å±äºè‡ªå·±çš„è¡Œä¸ºé€šè¿‡å›è°ƒä¼ é€’å‡ºå»ï¼Œè®©çˆ¶çº§å»å¤„ç†ï¼ˆæœç´¢ç»„ä»¶çš„æœç´¢äº‹ä»¶/è¡¨å•çš„æ·»åŠ äº‹ä»¶ï¼‰</li>
</ul>
<h3 id="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰-1"><a href="#è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰-1" class="headerlink" title="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰"></a>è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"purchase-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">"data"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:class</span>=<span class="string">"&#123;'is-empty': !data ||  data.length ==0 &#125;"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span> = <span class="string">"(item, index) in listItemConfig"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">"item + index"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">:prop</span>=<span class="string">"item.prop"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">:label</span>=<span class="string">"item.label"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">:width</span>=<span class="string">"item.width ? item.width : ''"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:min-width</span>=<span class="string">"item.minWidth ? item.minWidth : ''"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:max-width</span>=<span class="string">"item.maxWidth ? item.maxWidth : ''"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- æ“ä½œ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"æ“ä½œ"</span> <span class="attr">align</span>=<span class="string">"right"</span> <span class="attr">width</span>=<span class="string">"60"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">slot</span> <span class="attr">:data</span>=<span class="string">"scope.row"</span> <span class="attr">name</span>=<span class="string">"listOption"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- åˆ—è¡¨ä¸ºç©º --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"empty"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">common-empty</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    props: &#123;</span><br><span class="line"><span class="actionscript">        listItemConfig:&#123; <span class="comment">//åˆ—è¡¨é¡¹é…ç½®</span></span></span><br><span class="line"><span class="javascript">        type:<span class="built_in">Array</span>,</span></span><br><span class="line"><span class="javascript">        <span class="keyword">default</span>: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> [&#123;</span></span><br><span class="line"><span class="actionscript">                prop:<span class="string">'sku_name'</span>,</span></span><br><span class="line"><span class="actionscript">                label:<span class="string">'å•†å“åç§°'</span>,</span></span><br><span class="line">                minWidth:200</span><br><span class="line">            &#125;,&#123;</span><br><span class="line"><span class="actionscript">                prop:<span class="string">'sku_code'</span>,</span></span><br><span class="line"><span class="actionscript">                label:<span class="string">'SKU'</span>,</span></span><br><span class="line">                minWidth:120</span><br><span class="line">            &#125;,&#123;</span><br><span class="line"><span class="actionscript">                prop:<span class="string">'product_barcode'</span>,</span></span><br><span class="line"><span class="actionscript">                label:<span class="string">'æ¡å½¢ç '</span>,</span></span><br><span class="line">                minWidth:120</span><br><span class="line">            &#125;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="ä¸šåŠ¡ç»„ä»¶"><a href="#ä¸šåŠ¡ç»„ä»¶" class="headerlink" title="ä¸šåŠ¡ç»„ä»¶"></a>ä¸šåŠ¡ç»„ä»¶</h2><p>é€šå¸¸æ˜¯æ ¹æ®æœ€å°ä¸šåŠ¡çŠ¶æ€æŠ½è±¡è€Œå‡ºï¼Œæœ‰äº›ä¸šåŠ¡ç»„ä»¶ä¹Ÿå…·æœ‰ä¸€å®šçš„å¤ç”¨æ€§ï¼Œä½†å¤§å¤šæ•°æ˜¯ä¸€æ¬¡æ€§ç»„ä»¶</p>
<p><img src="http://cdn.anruence.com/yewu.png" alt="image"></p>
<h2 id="é€šç”¨ç»„ä»¶"><a href="#é€šç”¨ç»„ä»¶" class="headerlink" title="é€šç”¨ç»„ä»¶"></a>é€šç”¨ç»„ä»¶</h2><p>å¯ä»¥åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªAPPå†…é€šç”¨çš„ç»„ä»¶</p>
<h3 id="UIç»„ä»¶"><a href="#UIç»„ä»¶" class="headerlink" title="UIç»„ä»¶"></a>UIç»„ä»¶</h3><ul>
<li>ç•Œé¢æ‰©å±•ç±»ç»„ä»¶ï¼Œæ¯”å¦‚å¼¹çª—</li>
</ul>
<p><img src="http://cdn.anruence.com/UI.png" alt="image"></p>
<p>ç‰¹ç‚¹ï¼šå¤ç”¨æ€§å¼ºï¼Œåªé€šè¿‡ propsã€events å’Œ slots ç­‰ç»„ä»¶æ¥å£ä¸å¤–éƒ¨é€šä¿¡</p>
<h4 id="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰-2"><a href="#è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰-2" class="headerlink" title="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰"></a>è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆvueï¼‰</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"empty"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/images/empty.png"</span> <span class="attr">alt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æš‚æ— æ•°æ®<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="é€»è¾‘ç»„ä»¶"><a href="#é€»è¾‘ç»„ä»¶" class="headerlink" title="é€»è¾‘ç»„ä»¶"></a>é€»è¾‘ç»„ä»¶</h3><ul>
<li>ä¸åŒ…å«UIå±‚çš„æŸä¸ªåŠŸèƒ½çš„é€»è¾‘é›†åˆ</li>
</ul>
<h2 id="é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰"><a href="#é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰" class="headerlink" title="é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰"></a>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰</h2><p>é«˜é˜¶ç»„ä»¶å¯ä»¥çœ‹åšæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„ç»„åˆ<br>å¯ä»¥æŠŠé«˜é˜¶ç»„ä»¶çœ‹åšæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»–æ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŠŸèƒ½å¢å¼ºçš„ç»„ä»¶</p>
<p>é«˜é˜¶ç»„ä»¶å¯ä»¥æŠ½è±¡ç»„ä»¶å…¬å…±åŠŸèƒ½çš„æ–¹æ³•è€Œä¸æ±¡æŸ“ä½ æœ¬èº«çš„ç»„ä»¶<br>æ¯”å¦‚ <code>debounce</code> ä¸ <code>throttle</code></p>
<p>ç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤º</p>
<p><img src="http://cdn.anruence.com/hoc.png" alt="jsworke"></p>
<p>Reactä¸­é«˜é˜¶ç»„ä»¶æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ç»„ä»¶å°è£…å½¢å¼ï¼ŒVueå®˜æ–¹å†…ç½®äº†ä¸€ä¸ªé«˜é˜¶ç»„ä»¶<a href="https://github.com/vuejs/vue/blob/dev/src/core/components/keep-alive.js" target="_blank" rel="noopener">keep-alive</a>ï¼Œä½†å¹¶æœªæ¨èä½¿ç”¨HOC :(</p>
<p><strong>çŒœæƒ³åŸå› </strong></p>
<ul>
<li>Reactï¼šå†™ç»„ä»¶å°±æ˜¯åœ¨å†™å‡½æ•°ï¼Œå‡½æ•°æ‹¥æœ‰çš„åŠŸèƒ½ç»„ä»¶éƒ½æœ‰</li>
<li>Vueï¼šæ›´åƒæ˜¯é«˜åº¦å°è£…çš„å‡½æ•°ï¼Œèƒ½å¤Ÿè®©ä½ è½»æ¾çš„å®Œæˆä¸€äº›äº‹æƒ…çš„åŒæ—¶æŸå¤±ä¸€å®šçš„çµæ´»æ€§ï¼Œä½ éœ€è¦æŒ‰ç…§ä¸€å®šè§„åˆ™æ‰èƒ½ä½¿ç³»ç»Ÿæ›´å¥½çš„è¿è¡Œ</li>
</ul>
<h3 id="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆreactï¼‰"><a href="#è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆreactï¼‰" class="headerlink" title="è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆreactï¼‰"></a>è¡¨ç°å½¢å¼ğŸŒ°ï¼ˆreactï¼‰</h3><p>å“ç‰Œè½¦ç³»æ»‘åŠ¨çš„åŠ¨ç”»</p>
<p><img src="http://cdn.anruence.com/reacthoc.png" alt></p>
<h2 id="å„ç±»ç»„ä»¶ååŒç»„æˆä¸šåŠ¡æ¨¡å—"><a href="#å„ç±»ç»„ä»¶ååŒç»„æˆä¸šåŠ¡æ¨¡å—" class="headerlink" title="å„ç±»ç»„ä»¶ååŒç»„æˆä¸šåŠ¡æ¨¡å—"></a>å„ç±»ç»„ä»¶ååŒç»„æˆä¸šåŠ¡æ¨¡å—</h2><p><img src="http://cdn.anruence.com/MOKUAITU.png" alt="image"></p>
<h2 id="å®¹å™¨-å±•ç¤ºç»„ä»¶"><a href="#å®¹å™¨-å±•ç¤ºç»„ä»¶" class="headerlink" title="å®¹å™¨/å±•ç¤ºç»„ä»¶"></a>å®¹å™¨/å±•ç¤ºç»„ä»¶</h2><p>å¯¹æ¯”å›¾</p>
<p><img src="http://cdn.anruence.com/rongqitu.png" alt="image"></p>
<h3 id="å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ¦‚å¿µåªæ˜¯ä¸€ç§æ›´å¥½çš„ç»„ç»‡æ–¹å¼"><a href="#å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ¦‚å¿µåªæ˜¯ä¸€ç§æ›´å¥½çš„ç»„ç»‡æ–¹å¼" class="headerlink" title="å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ¦‚å¿µåªæ˜¯ä¸€ç§æ›´å¥½çš„ç»„ç»‡æ–¹å¼"></a>å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ¦‚å¿µåªæ˜¯ä¸€ç§æ›´å¥½çš„ç»„ç»‡æ–¹å¼</h3><ul>
<li>å„å¸å…¶èŒï¼Œä¸æ˜“å‡ºé”™ï¼Œå³ä½¿å‡ºé”™ï¼Œä¹Ÿèƒ½å¿«é€Ÿå®šä½é—®é¢˜</li>
<li>å®¹å™¨ç»„ä»¶ï¼Œä¸€ä¸ªè½½ä½“çš„å­˜åœ¨</li>
<li>å±•ç¤ºå‹ç»„ä»¶ä¸ä¸storeè€¦åˆï¼Œé€šè¿‡propsæ¥å£æ¥å®šä¹‰æ‰€éœ€çš„æ•°æ®å’Œæ–¹æ³•ï¼Œ<strong>å¤ç”¨æ€§ä¸æ­£ç¡®æ€§æ›´èƒ½ä¿è¯</strong></li>
</ul>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">å±•ç¤ºå‹ç»„ä»¶ç›´æ¥å’Œ<span class="keyword">store</span>é€šä¿¡çš„è¯ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæ”¶åˆ°é™åˆ¶ï¼Œå› ä¸ºä½ åœ¨<span class="keyword">store</span>é‡Œé¢çš„å­—æ®µå·²ç»é™åˆ¶ä»–çš„ä½¿ç”¨æ¬¡æ•°å’Œä½¿ç”¨çš„ä½ç½®</span><br></pre></td></tr></table></figure>
<font color="red">æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘ä»€ä¹ˆæ—¶å€™å¼•å…¥å®¹å™¨ç»„ä»¶ï¼Œä»€ä¹ˆæ—¶å€™å¼•å…¥å±•ç¤ºç»„ä»¶</font>

<h3 id="å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ—¶æœº"><a href="#å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ—¶æœº" class="headerlink" title="å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ—¶æœº"></a>å¼•å…¥å®¹å™¨ç»„ä»¶çš„æ—¶æœº</h3><p>ä¼˜å…ˆè€ƒè™‘å±•ç¤ºç»„ä»¶ï¼Œå½“ä½ æ„è¯†åˆ°æœ‰ä¸€äº›ä¸­é—´ç»„ä»¶ä¸ä½¿ç”¨å®ƒç»§æ‰¿çš„propsè€Œæ˜¯è½¬è€Œä¼ é€’ç»™ä»–ä»¬çš„å­çº§ï¼Œæ¯æ¬¡å­çº§ç»„ä»¶éœ€è¦æ›´å¤šæ•°æ®æ—¶ï¼Œéƒ½éœ€è¦â€œè·¯è¿‡â€è¿™äº›ä¸­é—´ç»„ä»¶æ—¶å°±è¦è€ƒè™‘å¼•å…¥å®¹å™¨ç»„ä»¶ï¼</p>
<p>ä¸¤è€…çš„åŒºåˆ«å¹¶æ²¡æœ‰è¢«ä¸¥æ ¼å®šä¹‰ï¼Œ<font color="red">äº‹å®ä¸Šä¸åœ¨æŠ€æœ¯ä¸Šè€Œæ˜¯ç›®çš„æ€§ä¸Š</font></p>
<h4 id="è¿™é‡Œæœ‰å‡ ä¸ªä¾›å‚è€ƒçš„ç‚¹"><a href="#è¿™é‡Œæœ‰å‡ ä¸ªä¾›å‚è€ƒçš„ç‚¹" class="headerlink" title="è¿™é‡Œæœ‰å‡ ä¸ªä¾›å‚è€ƒçš„ç‚¹"></a>è¿™é‡Œæœ‰å‡ ä¸ªä¾›å‚è€ƒçš„ç‚¹</h4><ul>
<li>å®¹å™¨ç»„ä»¶å€¾å‘äºæœ‰çŠ¶æ€ï¼Œå±•ç¤ºç»„ä»¶å€¾å‘äºæ— çŠ¶æ€ï¼Œè¿™ä¸æ˜¯ç¡¬æ€§è§„å®šï¼Œå®ƒä»¬éƒ½æ˜¯å¯ä»¥æœ‰çŠ¶æ€çš„</li>
<li>ä¸è¦æŠŠåˆ†ç¦»å®¹å™¨ç»„ä»¶å’Œå±•ç¤ºç»„ä»¶å½“åšæ•™æ¡ï¼Œå¦‚æœä½ ä¸ç¡®å®šè¯¥ç»„ä»¶æ˜¯å®¹å™¨ç»„ä»¶è¿˜æ˜¯å±•ç¤ºç»„ä»¶ï¼Œå°±æš‚æ—¶ä¸è¦åˆ†ç¦»ï¼Œå†™æˆå±•ç¤ºç»„ä»¶ï¼Œä¹Ÿè®¸æ˜¯ä¸ºæ—¶å°šæ—©ï¼Œåˆ«ç€æ€¥ï¼</li>
<li>è¿™æ˜¯ä¸€ä¸ªæŒç»­çš„é‡æ„è¿‡ç¨‹ï¼Œä¸ç”¨è¯•å›¾ä¸€æ¬¡å°±æŠŠå®ƒåšå¥½ï¼Œä¹ æƒ¯è¿™ç§æ¨¡å¼å°±ä¼šåŸ¹å…»èµ·ä¸€ç§ç›´è§‰ï¼ŒçŸ¥é“ä½•æ—¶å¼•å…¥å®¹å™¨ å°±åƒä½ çŸ¥é“ä½•æ—¶å°è£…ä¸€ä¸ªå‡½æ•°é‚£æ ·ï¼</li>
</ul>
<h2 id="è¿›è¡Œç»„ä»¶èŒèƒ½åˆ’åˆ†çš„åˆ©å¼Š"><a href="#è¿›è¡Œç»„ä»¶èŒèƒ½åˆ’åˆ†çš„åˆ©å¼Š" class="headerlink" title="è¿›è¡Œç»„ä»¶èŒèƒ½åˆ’åˆ†çš„åˆ©å¼Š"></a>è¿›è¡Œç»„ä»¶èŒèƒ½åˆ’åˆ†çš„åˆ©å¼Š</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>æ›´å¥½çš„å…³æ³¨åˆ†ç¦»</li>
</ul>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">ç”¨è¿™ç§æ–¹å¼å†™ç»„ä»¶ï¼Œä½ å¯ä»¥æ›´å¥½çš„ç†è§£ä½ çš„<span class="keyword">app</span>å’Œä½ çš„uiï¼Œç”šè‡³ä¼šé€æ¸å½¢æˆä½ è‡ªå·±çš„å¼€å‘å¥—è·¯</span><br></pre></td></tr></table></figure>
<ul>
<li>å¤ç”¨æ€§é«˜</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¸€ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ï¼Œè§£é™¤äº†ç»„ä»¶çš„è€¦åˆå¸¦æ¥æ›´é«˜å¤ç”¨æ€§</span><br></pre></td></tr></table></figure>
<ul>
<li>å®ƒæ˜¯appçš„è°ƒè‰²ç‰ˆï¼Œè®¾è®¡å¸ˆå¯ä»¥éšæ„è°ƒæ•´å®ƒçš„uiè€Œä¸ç”¨æ”¹å˜appçš„é€»è¾‘</li>
<li>è¿™ä¼šå¼ºåˆ¶ä½ æå–â€œå¸ƒå±€ç»„ä»¶â€ï¼Œè¾¾åˆ°æ›´é«˜çš„æ˜“ç”¨æ€§</li>
<li>æé«˜å¥å£®æ€§</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">ç”±äºå±•ç¤ºç»„ä»¶å’Œå®¹å™¨ç»„ä»¶æ˜¯é€šè¿‡propæ¥å£æ¥è¿æ¥ï¼Œå¯ä»¥åˆ©ç”¨propsçš„æ ¡éªŒæœºåˆ¶æ¥å¢å¼ºä»£ç çš„å¯é æ€§ï¼Œæ··åˆçš„ç»„ä»¶å°±æ²¡æœ‰è¿™ç§å¥½å¤„</span></span><br><span class="line"></span><br><span class="line"><span class="string">ä¸¾ä¸ªğŸŒ°(Vue)</span></span><br><span class="line"><span class="attr">  props:</span> <span class="string">&#123;</span></span><br><span class="line"><span class="attr">    editData:</span> <span class="string">Object,</span></span><br><span class="line"><span class="attr">    statusConfig:</span> <span class="string">&#123;</span></span><br><span class="line"><span class="attr">      type:</span> <span class="string">Object,</span></span><br><span class="line">      <span class="string">default()</span> <span class="string">&#123;</span></span><br><span class="line">        <span class="string">return</span> <span class="string">&#123;</span></span><br><span class="line"><span class="attr">          isShowOption:</span> <span class="literal">true</span><span class="string">,</span> <span class="string">//æ˜¯å¦æœ‰æ“ä½œæ </span></span><br><span class="line"><span class="attr">          isShowSaveBtn:</span> <span class="literal">false</span></span><br><span class="line">        <span class="string">&#125;;</span></span><br><span class="line">      <span class="string">&#125;</span></span><br><span class="line">    <span class="string">&#125;</span></span><br><span class="line">  <span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>å¯æµ‹è¯•æ€§</li>
</ul>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">ç»„ä»¶åšçš„äº‹æƒ…æ›´å°‘äº†ï¼Œæµ‹è¯•ä¹Ÿä¼šå˜å¾—å®¹æ˜“</span><br><span class="line">å®¹å™¨ç»„ä»¶ä¸ç”¨å…³å¿ƒUIçš„å±•ç¤ºï¼Œåªå…³å¿ƒæ•°æ®å’Œæ›´æ–°</span><br><span class="line">å±•ç¤ºç»„ä»¶åªæ˜¯å‘ˆç°ä¼ å…¥çš„<span class="built_in">props</span>ï¼Œå†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ä¹Ÿéå¸¸å®¹æ˜“mockæ•°æ®å±‚</span><br></pre></td></tr></table></figure>
<h3 id="æ‰€è°“çš„ç¼ºç‚¹"><a href="#æ‰€è°“çš„ç¼ºç‚¹" class="headerlink" title="æ‰€è°“çš„ç¼ºç‚¹"></a>æ‰€è°“çš„ç¼ºç‚¹</h3><ul>
<li>è®¾è®¡ç»„ä»¶åˆæœŸä¼šå¢åŠ ä¸€äº›å­¦ä¹ æˆæœ¬</li>
<li>ç”±äºéœ€è¦å°è£…ä¸€ä¸ªå®¹å™¨ï¼ŒåŒ…è£…ä¸€äº›æ•°æ®å’Œæ¥å£ç»™å±•ç¤ºç»„ä»¶ï¼Œ<strong>ä¼šå¢åŠ ä¸€äº›å·¥ä½œé‡</strong></li>
<li>åœ¨å±•ç¤ºç»„ä»¶å†…å¯¹propsçš„å£°æ˜ä¼šå¸¦æ¥å°‘é‡çš„å·¥ä½œ</li>
</ul>
<font color="red">é•¿è¿œæ¥çœ‹ï¼Œåˆ©å¤§äºå¼Šï¼Œç‰¹åˆ«æ˜¯é¡¹ç›®åˆæœŸï¼Œä¸€å®šè¦æœ‰ä¸€ä¸ªå¥½çš„è®¾è®¡ä¹ æƒ¯</font>

<h1 id="ç»„ä»¶è®¾è®¡çš„è¾¹ç•Œ"><a href="#ç»„ä»¶è®¾è®¡çš„è¾¹ç•Œ" class="headerlink" title="ç»„ä»¶è®¾è®¡çš„è¾¹ç•Œ"></a>ç»„ä»¶è®¾è®¡çš„è¾¹ç•Œ</h1><p>ç‰©æå¿…åï¼Œè·ƒè·ƒæ¬²è¯•å‰ï¼Œå¸¸å¸¸æ€è€ƒä»¥ä¸‹å‡ ä¸ªé—®é¢˜ä»¥å¼•å¯¼å®Œå–„ç»„ä»¶çš„è®¾è®¡</p>
<h2 id="é¡µé¢å±‚çº§ä¸å®œåµŒå¥—è¶…è¿‡ä¸‰å±‚ï¼Œåˆ‡å‹¿è¿‡åº¦è®¾è®¡"><a href="#é¡µé¢å±‚çº§ä¸å®œåµŒå¥—è¶…è¿‡ä¸‰å±‚ï¼Œåˆ‡å‹¿è¿‡åº¦è®¾è®¡" class="headerlink" title="é¡µé¢å±‚çº§ä¸å®œåµŒå¥—è¶…è¿‡ä¸‰å±‚ï¼Œåˆ‡å‹¿è¿‡åº¦è®¾è®¡"></a>é¡µé¢å±‚çº§ä¸å®œåµŒå¥—è¶…è¿‡ä¸‰å±‚ï¼Œåˆ‡å‹¿è¿‡åº¦è®¾è®¡</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åŸåˆ™ä¸Šç»„ä»¶åµŒå¥—è¶…è¿‡ä¸‰å±‚ï¼Œæ•°æ®ä¼ é€’çš„è¿‡ç¨‹å°±ä¼šå˜å¾—ç›¸å¯¹å¤æ‚</span><br></pre></td></tr></table></figure>
<h2 id="è¿™ä¸ªç»„ä»¶å¯å¦ï¼ˆæœ‰å¿…è¦ï¼‰å†åˆ†ï¼Ÿ"><a href="#è¿™ä¸ªç»„ä»¶å¯å¦ï¼ˆæœ‰å¿…è¦ï¼‰å†åˆ†ï¼Ÿ" class="headerlink" title="è¿™ä¸ªç»„ä»¶å¯å¦ï¼ˆæœ‰å¿…è¦ï¼‰å†åˆ†ï¼Ÿ"></a>è¿™ä¸ªç»„ä»¶å¯å¦ï¼ˆæœ‰å¿…è¦ï¼‰å†åˆ†ï¼Ÿ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åˆ’åˆ†ç²’åº¦çš„æ ¹æ®å®é™…æƒ…å†µæƒè¡¡ï¼Œå¤ªå°ä¼šæå‡ç»´æŠ¤æˆæœ¬ï¼Œå¤ªå¤§åˆä¸å¤Ÿçµæ´»å’Œé«˜å¤ç”¨æ€§</span><br><span class="line"></span><br><span class="line">æ˜¯å¦æ‰“ç ´äº†ä¸€ä¸ªé€»è¾‘ä¸Šæœ‰æ„ä¹‰çš„å®ä½“ï¼Œå€˜è‹¥æŠ½ç¦»çš„è¯ï¼Œè¿™ä¸ªä»£ç è¢«å¤ç”¨çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¦‚æœå®ƒåªæ˜¯å‡ è¡Œä»£ç ï¼Œé‚£ä¹ˆæœ€ç»ˆå¯èƒ½ä¼šåˆ›å»ºæ›´å¤šçš„ä»£ç æ¥åˆ†ç¦»å®ƒï¼Œæœ‰å¿…è¦å—ï¼Ÿæˆ‘è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯å¦è¶…è¿‡äº†æˆæœ¬ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¦‚æœä½ å½“å‰çš„é€»è¾‘ä¸å¤ªå¯èƒ½å‡ºç°åœ¨å…¶ä»–åœ°æ–¹ï¼Œé‚£ä¹ˆå°†å®ƒåµŒå…¥å…¶ä¸­æ›´å¥½ï¼Œå¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥éšæ—¶æŠ½ç¦»ï¼Œæ¯•ç«Ÿç»„ä»¶åŒ–æ²¡æœ‰ç»ˆç‚¹</span><br><span class="line"></span><br><span class="line">æ¯ä¸€ä¸ªç»„ä»¶éƒ½åº”è¯¥æœ‰å…¶ç‹¬ç‰¹çš„åˆ’åˆ†ç›®çš„çš„ï¼Œæœ‰çš„æ˜¯ä¸ºäº†å¤ç”¨å®ç°ï¼Œæœ‰çš„æ˜¯ä¸ºäº†å°è£…å¤æ‚åº¦æ¸…æ™°ä¸šåŠ¡å®ç°</span><br><span class="line">ç»„ä»¶åˆ’åˆ†çš„ä¾æ®é€šå¸¸æ˜¯ä¸šåŠ¡é€»è¾‘ã€åŠŸèƒ½ï¼Œè¦è€ƒè™‘å„ç»„ä»¶ä¹‹é—´çš„å…³ç³»æ˜¯å¦æ˜ç¡®ï¼ŒåŠå¯å¤ç”¨åº¦</span><br></pre></td></tr></table></figure>
<h2 id="æ€§èƒ½ä¼šå—åˆ°å½±å“å—ï¼Ÿ"><a href="#æ€§èƒ½ä¼šå—åˆ°å½±å“å—ï¼Ÿ" class="headerlink" title="æ€§èƒ½ä¼šå—åˆ°å½±å“å—ï¼Ÿ"></a>æ€§èƒ½ä¼šå—åˆ°å½±å“å—ï¼Ÿ</h2><figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">å¦‚æœçŠ¶æ€é¢‘ç¹æ›´æ”¹ï¼Œå¹¶ä¸”å½“å‰åœ¨ä¸€ä¸ªè¾ƒå¤§ä¸”å…³ç³»æ¯”è¾ƒç´§å¯†çš„ç»„ä»¶é‡Œï¼Œä¸ºäº†é¿å…æ€§èƒ½å—åˆ°å½±å“æœ€å¥½æŠ½ç¦»å‡ºæ¥ ä¸<span class="built_in">diff</span>ç­–ç•¥ç›¸å…³</span><br></pre></td></tr></table></figure>
<h2 id="è¿™ä¸ªç»„ä»¶çš„ä¾èµ–æ˜¯å¦å¯å†ç¼©å‡ï¼Ÿ"><a href="#è¿™ä¸ªç»„ä»¶çš„ä¾èµ–æ˜¯å¦å¯å†ç¼©å‡ï¼Ÿ" class="headerlink" title="è¿™ä¸ªç»„ä»¶çš„ä¾èµ–æ˜¯å¦å¯å†ç¼©å‡ï¼Ÿ"></a>è¿™ä¸ªç»„ä»¶çš„ä¾èµ–æ˜¯å¦å¯å†ç¼©å‡ï¼Ÿ</h2><p>ç¼©å‡ç»„ä»¶ä¾èµ–å¯ä»¥æé«˜ç»„ä»¶çš„å¯å¤ç”¨åº¦</p>
<h2 id="è¿™ä¸ªç»„ä»¶æ˜¯å¦å¯¹å…¶å®ƒç»„ä»¶é€ æˆä¾µå…¥ï¼Ÿ"><a href="#è¿™ä¸ªç»„ä»¶æ˜¯å¦å¯¹å…¶å®ƒç»„ä»¶é€ æˆä¾µå…¥ï¼Ÿ" class="headerlink" title="è¿™ä¸ªç»„ä»¶æ˜¯å¦å¯¹å…¶å®ƒç»„ä»¶é€ æˆä¾µå…¥ï¼Ÿ"></a>è¿™ä¸ªç»„ä»¶æ˜¯å¦å¯¹å…¶å®ƒç»„ä»¶é€ æˆä¾µå…¥ï¼Ÿ</h2><ul>
<li>å°è£…æ€§ä¸è¶³æˆ–è‡ªèº«è¶Šç•Œæ“ä½œï¼Œå°±å¯èƒ½å¯¹è‡ªèº«ä¹‹å¤–é€ æˆäº†ä¾µå…¥</li>
<li>ä¸€ä¸ªç»„ä»¶ä¸åº”å¯¹å…¶å®ƒå…„å¼Ÿç»„ä»¶é€ æˆç›´æ¥å½±å“</li>
</ul>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">å¸¸è§çš„ä¸€ç§æƒ…å†µæ˜¯ï¼šç»„ä»¶è¿è¡Œæ—¶å¯¹<span class="built_in">window</span>å¯¹è±¡æ·»åŠ resizeç›‘å¬äº‹ä»¶ä»¥å®ç°ç»„ä»¶å“åº”è§†çª—å°ºå¯¸å˜åŒ–äº‹ä»¶</span><br><span class="line"></span><br><span class="line">æœ€ä¼˜çš„æ–¹æ¡ˆï¼šç»„ä»¶æä¾›åˆ·æ–°æ–¹æ³•ï¼Œç”±çˆ¶ç»„ä»¶å®ç°è°ƒç”¨</span><br><span class="line">æ¬¡ä¼˜çš„æ–¹æ¡ˆï¼šç»„ä»¶destroyå‰æ¸…ç†æ¢å¤</span><br></pre></td></tr></table></figure>
<h2 id="æ¥å£è®¾è®¡æ˜¯å¦å…¼å®¹å¤§éƒ¨åˆ†åœºæ™¯ï¼Ÿ"><a href="#æ¥å£è®¾è®¡æ˜¯å¦å…¼å®¹å¤§éƒ¨åˆ†åœºæ™¯ï¼Ÿ" class="headerlink" title="æ¥å£è®¾è®¡æ˜¯å¦å…¼å®¹å¤§éƒ¨åˆ†åœºæ™¯ï¼Ÿ"></a>æ¥å£è®¾è®¡æ˜¯å¦å…¼å®¹å¤§éƒ¨åˆ†åœºæ™¯ï¼Ÿ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">éœ€è¦è€ƒè™‘éœ€è¦é€‚ç”¨çš„ä¸åŒåœºæ™¯ï¼Œåœ¨ç»„ä»¶æ¥å£è®¾è®¡æ—¶è¿›è¡Œå¿…è¦çš„å…¼å®¹</span><br></pre></td></tr></table></figure>
<h2 id="å½“åˆ«äººä½¿ç”¨è¿™ä¸ªç»„ä»¶æ—¶ï¼Œä¼šæ€ä¹ˆæƒ³ï¼Ÿ"><a href="#å½“åˆ«äººä½¿ç”¨è¿™ä¸ªç»„ä»¶æ—¶ï¼Œä¼šæ€ä¹ˆæƒ³ï¼Ÿ" class="headerlink" title="å½“åˆ«äººä½¿ç”¨è¿™ä¸ªç»„ä»¶æ—¶ï¼Œä¼šæ€ä¹ˆæƒ³ï¼Ÿ"></a>å½“åˆ«äººä½¿ç”¨è¿™ä¸ªç»„ä»¶æ—¶ï¼Œä¼šæ€ä¹ˆæƒ³ï¼Ÿ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ¥å£è®¾è®¡ç¬¦åˆè§„èŒƒå’Œå¤§ä¼—ä¹ æƒ¯ï¼Œå°½é‡è®©åˆ«äººç”¨èµ·æ¥ç®€å•æ˜“ä¸Šæ‰‹ï¼Œæ˜“ä¸Šæ‰‹æ˜¯æŒ‡æ›´ç¬¦åˆç›´è§‰</span><br></pre></td></tr></table></figure>
<h2 id="å‡å¦‚ä¸šåŠ¡éœ€è¦ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œæ˜¯å¦æ–¹ä¾¿æ¸…é™¤ï¼Ÿ"><a href="#å‡å¦‚ä¸šåŠ¡éœ€è¦ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œæ˜¯å¦æ–¹ä¾¿æ¸…é™¤ï¼Ÿ" class="headerlink" title="å‡å¦‚ä¸šåŠ¡éœ€è¦ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œæ˜¯å¦æ–¹ä¾¿æ¸…é™¤ï¼Ÿ"></a>å‡å¦‚ä¸šåŠ¡éœ€è¦ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œæ˜¯å¦æ–¹ä¾¿æ¸…é™¤ï¼Ÿ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å„ç»„ä»¶ä¹‹å‰ä»¥ç»„åˆçš„å…³ç³»äº’ç›¸é…åˆï¼Œä¹Ÿæ˜¯å¯¹åŠŸèƒ½éœ€æ±‚çš„æ¨¡å—åŒ–æŠ½è±¡ï¼Œå½“éœ€æ±‚å˜åŒ–æ—¶å¯ä»¥å°†å®ç°ä»¥æ¨¡å—ç²’åº¦è¿›è¡Œè°ƒæ•´</span><br></pre></td></tr></table></figure>
<p>ä¸Šæ–‡æåˆ°çš„å„ç§å‡†åˆ™ä»…ä»…æè¿°äº†ä¸€ç§å¼€å‘ç†å¿µï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§å¼€å‘è§„èŒƒï¼Œå€˜è‹¥ä½ è®¤å¯è¿™è§„èŒƒï¼Œå¯¹å®ƒçš„åˆ†æ²»ç­–ç•¥äº§ç”Ÿäº†å…±é¸£ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç»§ç»­èŠèŠå®ƒçš„å…·ä½“å®ç°äº†</p>
<p>é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜</p>
<font color="red">ä½ å¿ƒä¸­çš„ç›¸å¯¹å®Œç¾çš„ç»„ä»¶æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ</font>


<h1 id="è½å®åˆ°å…·ä½“ä¸šåŠ¡ä¸­å¦‚ä½•åš"><a href="#è½å®åˆ°å…·ä½“ä¸šåŠ¡ä¸­å¦‚ä½•åš" class="headerlink" title="è½å®åˆ°å…·ä½“ä¸šåŠ¡ä¸­å¦‚ä½•åš"></a>è½å®åˆ°å…·ä½“ä¸šåŠ¡ä¸­å¦‚ä½•åš</h1><h2 id="åˆ’åˆ†ä¾æ®"><a href="#åˆ’åˆ†ä¾æ®" class="headerlink" title="åˆ’åˆ†ä¾æ®"></a>åˆ’åˆ†ä¾æ®</h2><p>æ˜ç¡®ä½ çš„ç»„ä»¶åˆ’åˆ†ä¾æ®ï¼Œç›®å‰æ˜¯ä¸¤ç§</p>
<ul>
<li>æ ¹æ®ä¸šåŠ¡åˆ’åˆ†</li>
<li>æ ¹æ®æŠ€æœ¯åˆ’åˆ†</li>
</ul>
<ol>
<li>æˆ‘æ›´å¤šçš„æ˜¯æ ¹æ®ä¸šåŠ¡å»è®¾è®¡æˆ‘åº”ç”¨ä¸­çš„ç»„ä»¶æ ‘ï¼Œå¯èƒ½ä¼šç”»ä¸ªè‰å›¾æˆ–xmindï¼Œå®ƒå¯ä»¥å¸®æˆ‘ç»Ÿè§‚å…¨å±€</li>
<li>æ˜ç¡®å„ä¸ªç»„ä»¶çš„è¾¹ç•Œï¼Œå†…éƒ¨stateçš„è®¾è®¡ï¼Œpropsçš„è®¾è®¡ä»¥åŠä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»ï¼ˆéœ€è¦å›è°ƒå‡ºå»çš„äº‹ä»¶ï¼‰</li>
<li>æ˜ç¡®å„ä¸ªç»„ä»¶çš„å®šä½ä¸èŒèƒ½åˆ’åˆ†ï¼Œè®¾è®¡å¥½çˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶çš„é€šä¿¡æœºåˆ¶</li>
<li>æ­æ¶å­</li>
<li>æ¶å­æœ‰äº†ï¼Œå¼€å§‹å¡«ç©º</li>
</ol>
<h2 id="åˆ‡å‰²æ¨¡ç‰ˆï¼ˆé¡µé¢ç»“æ„æ¨¡å—åŒ–ï¼‰"><a href="#åˆ‡å‰²æ¨¡ç‰ˆï¼ˆé¡µé¢ç»“æ„æ¨¡å—åŒ–ï¼‰" class="headerlink" title="åˆ‡å‰²æ¨¡ç‰ˆï¼ˆé¡µé¢ç»“æ„æ¨¡å—åŒ–ï¼‰"></a>åˆ‡å‰²æ¨¡ç‰ˆï¼ˆé¡µé¢ç»“æ„æ¨¡å—åŒ–ï¼‰</h2><p>è¿™æ˜¯æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•ï¼Œå½“ä¸€ä¸ªç»„ä»¶æ¸²æŸ“äº†å¾ˆå¤šå…ƒç´ ï¼Œå°±éœ€è¦å°è¯•åˆ†ç¦»è¿™äº›ç»„ä»¶çš„æ¸²æŸ“é€»è¾‘<br>æˆ‘ä»¬ä»¥æ˜é‡‘é¡µé¢ä¸ºä¾‹</p>
<p><img src="http://cdn.anruence.com/5.png" alt="jsworke"></p>
<p>å¤§ä½“ä¸Šçœ‹ï¼Œå¯ä»¥åˆ†ä¸ºPart1ï¼ŒPart2ï¼ŒPart3</p>
<h3 id="åˆæ­¥å¼€å‘"><a href="#åˆæ­¥å¼€å‘" class="headerlink" title="åˆæ­¥å¼€å‘"></a>åˆæ­¥å¼€å‘</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"part1 left"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å†…å®¹--&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"part1 right"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å†…å®¹--&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"part1 right"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å†…å®¹--&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é—®é¢˜ï¼š</p>
<ul>
<li>ä»£ç é‡å¤§ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œéš¾ä»¥æµ‹è¯•</li>
<li>æœ‰äº›è®¸é‡å¤é‡</li>
</ul>
<h3 id="åŒ–ç¹ä¸ºç®€"><a href="#åŒ–ç¹ä¸ºç®€" class="headerlink" title="åŒ–ç¹ä¸ºç®€"></a>åŒ–ç¹ä¸ºç®€</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">part1</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">part2</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">part3</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¥½å¤„ï¼š</p>
<ul>
<li>åŒä¹‹å‰çš„æ–¹å¼ç›¸æ¯”ï¼Œè¿™ä¸ªå¾®å¦™çš„æ”¹è¿›æ˜¯é©å‘½æ€§çš„</li>
<li>è§£å†³äº†æµ‹è¯•å›°éš¾ï¼Œç»´æŠ¤å›°éš¾çš„é—®é¢˜</li>
</ul>
<p>é—®é¢˜ï¼š</p>
<ul>
<li>æ²¡æœ‰è§£å†³ä»£ç é‡å¤çš„é—®é¢˜ï¼Œè¿™ç§æŒ‰æ¨¡å—åˆ’åˆ†ï¼Œå¤ç”¨æ€§ä½</li>
</ul>
<p>ä½†æˆ‘çœ‹è¿‡å¾ˆå¤šé¡¹ç›®çš„ä»£ç ï¼Œå°±æ˜¯è¿™ä¹ˆå¹²çš„ï¼Œè®¤ä¸ºè‡ªå·±åšäº†ç»„ä»¶åŒ–ï¼ŒæŠ½è±¡çš„è¿˜ä¸é”™(@_@)</p>
<h3 id="ç»„ä»¶æŠ½è±¡"><a href="#ç»„ä»¶æŠ½è±¡" class="headerlink" title="ç»„ä»¶æŠ½è±¡"></a>ç»„ä»¶æŠ½è±¡</h3><p>å®ƒä»¬æœ‰ç›¸ä¼¼çš„å¤–å±‚ï¼Œpart2å’Œpart3æ›´æœ‰ç›¸ä¼¼çš„titlebarï¼Œé™¤äº†ä¸šåŠ¡å†…å®¹ï¼Œå®Œå…¨å°±æ˜¯ä¸€æ¨¡ä¸€æ ·</p>
<p>ğŸŒ°ï¼ˆvueï¼‰</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"part"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="template-variable">&#123;&#123; title &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"content"</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†partå†…å¯ä»¥æŠ½è±¡çš„æ•°æ®éƒ½åšæˆäº†propsï¼Œåˆ©ç”¨slotå»åšæ¨¡ç‰ˆ<br>é‚£ä¹ˆæˆ‘ä»¬åœ¨å¼€å‘ç›¸åº”Part1ï¼ŒPart2æ—¶</p>
<p>ğŸŒ°ï¼ˆvueï¼‰<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">part</span> <span class="attr">title</span>=<span class="string">"äº¦èˆ’"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">"content"</span>&gt;</span>----<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">part</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">part</span> <span class="attr">title</span>=<span class="string">"å…´éš†è‡»å›­æˆ·å‹"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">"content"</span>&gt;</span>-----<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">part</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>æ›´å…·ä»£è¡¨æ€§çš„ç¤ºä¾‹å›¾</p>
<p><img src="http://cdn.anruence.com/6.png" alt="jsworke"></p>
<ul>
<li>UIå·®å¼‚åœ¨å“ªé‡Œå®šä¹‰ï¼Ÿ</li>
</ul>
<p>åœ¨ä¸šåŠ¡é€»è¾‘å±‚å¤„ç†</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">é¦–å…ˆè¦æ˜ç¡®ä¸€ç‚¹ï¼Œè¿™äº›å·®å¼‚å¹¶ä¸æ˜¯ç»„ä»¶æœ¬èº«é€ æˆçš„ï¼Œæ˜¯ä½ è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘é€ æˆçš„ï¼Œæ‰€ä»¥å®¹å™¨ç»„ä»¶ï¼ˆçˆ¶ç»„ä»¶ï¼‰åº”è¯¥ä¸ºæ­¤ä¹°å•</span><br></pre></td></tr></table></figure>
<ul>
<li>æ•°æ®å·®å¼‚åœ¨å“ªé‡Œå®šä¹‰ï¼Ÿ</li>
</ul>
<p>ç»“åˆç»„ä»¶æœ¬èº«å’Œä¸šåŠ¡ä¸Šä¸‹æ–‡å°†å·®å¼‚åˆç†çš„æ¶ˆé™¤åœ¨å†…éƒ¨</p>
<figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line">æ¯”å¦‚part3ä¸­ï¼Œå…¶ä»–çš„partåªæœ‰ä¸€ä¸ªç±»ä¼¼æ›´å¤š&gt;&gt;çš„<span class="keyword">link</span>ï¼Œä½†æ˜¯å®ƒå´æœ‰å¤šä¸ª(ä¸€å±…ï¼ŒäºŒå±…<span class="params">...</span>)</span><br><span class="line">è¿™é‡Œæˆ‘æ¨èå°†è¿™ç§å·®å¼‚ä½“ç°åœ¨ç»„ä»¶å†…éƒ¨ï¼Œè®¾è®¡æ–¹æ³•ä¹Ÿå¾ˆå¤šï¼š</span><br><span class="line">æ¯”å¦‚å¯ä»¥å°†<span class="keyword">link</span>æ•°ç»„åŒ–ä¸ºlinksï¼›</span><br><span class="line">æ¯”å¦‚å¯ä»¥å°†æ›´å¤š&gt;&gt;çœ‹ä½œæ˜¯ä¸€ä¸ªdefaultçš„<span class="keyword">link</span>ï¼Œè€Œå¤šä½™çš„éƒ¨åˆ†åˆ™æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ç‰¹æ®Š<span class="keyword">link</span>ï¼Œè¿™ä¸¤è€…åˆå¹¶ç»„æˆäº†linksã€‚ç”¨æˆ·è‡ªå®šä¹‰çš„é»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼Œéœ€è¦å¼•ç”¨ç»„ä»¶æ—¶è¿›è¡Œä¼ å…¥ã€‚</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»„ä»¶å‘½åè§„åˆ™ï¼Ÿ</li>
</ul>
<p>ç»„ä»¶è®¾è®¡åˆæœŸï¼Œå°±åº”è¯¥æ‹¥æœ‰ä¸è€¦åˆä¸šåŠ¡çš„åå­—</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">ä¸€ä¸ªé€šç”¨çš„æˆ–è€…è¯´æœªæ¥å¯èƒ½é€šç”¨çš„ï¼Œè¦æœ‰ç›¸å¯¹åˆç†çš„å‘½åï¼Œæ¯”å¦‚ <span class="keyword">Search</span>ï¼Œ<span class="keyword">List</span>,å°½é‡ä¸è¦å‡ºç°ä¸ä¸šåŠ¡è€¦åˆè¿‡æ·±çš„ä¸šåŠ¡åè¯ï¼Œé€šç”¨ç»„ä»¶ä¸ä¸šåŠ¡æ— å…³ï¼Œåªä¸è‡ªèº«æŠ½è±¡çš„ç»„ä»¶æœ‰å…³</span><br><span class="line">æˆ‘ä»¬åœ¨è®¾è®¡ç»„ä»¶åˆæœŸï¼Œå°±åº”è¯¥æœ‰è¿™ç§æ€æƒ³ï¼Œç­‰åˆ°çœŸæ­£å¯ä»¥æŠ½å‡ºå…¬ç”¨ç»„ä»¶äº†ï¼Œå†å»è‹¦é€¼çš„åæ”¹åå­—ï¼Ÿ</span><br><span class="line">åº“é€šå¸¸éƒ½æƒ³è®©å¹¿å¤§å¼€å‘è€…ç”¨ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡ç»„ä»¶æ—¶ï¼Œå¯ä»¥é™ä½æ ‡å‡†åˆ°å…ˆåšåˆ°ä½ çš„æ•´ä¸ª<span class="keyword">APP</span>ä¸­é€šç”¨</span><br></pre></td></tr></table></figure>
<h2 id="ç»„ä»¶åˆ’åˆ†ç»†ç²’åº¦çš„è€ƒé‡ï¼ˆæŠ½ä¹‹æœ‰åº¦ï¼‰"><a href="#ç»„ä»¶åˆ’åˆ†ç»†ç²’åº¦çš„è€ƒé‡ï¼ˆæŠ½ä¹‹æœ‰åº¦ï¼‰" class="headerlink" title="ç»„ä»¶åˆ’åˆ†ç»†ç²’åº¦çš„è€ƒé‡ï¼ˆæŠ½ä¹‹æœ‰åº¦ï¼‰"></a>ç»„ä»¶åˆ’åˆ†ç»†ç²’åº¦çš„è€ƒé‡ï¼ˆæŠ½ä¹‹æœ‰åº¦ï¼‰</h2><p>ç»„ä»¶è®¾è®¡è§„åˆ™æ˜æ˜ç™½ç™½å†™ç€æˆ‘ä»¬è¦éµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Œè¿™ä¹Ÿå¸¦æ¥äº†ä¸Šæ–‡èŠè¿‡çš„<font color="red">è¿‡åº¦æŠ½è±¡ï¼ˆç»„ä»¶åŒ–ï¼‰</font>çš„é—®é¢˜ï¼Œæˆ‘ä»¬ç»“åˆå…·ä½“çš„ä¸šåŠ¡èŠä¸€ä¸‹</p>
<p><img src="http://cdn.anruence.com/7.png" alt="jsworke"></p>
<p>è¦å®ç°å¾½ç« ç»„ä»¶ï¼Œå®ƒæœ‰ä¸¤éƒ¨åˆ†ç»„æˆ</p>
<ul>
<li>æŒ‰é’®</li>
<li>å³ä¸Šè§’æç¤ºï¼ˆå°çº¢ç‚¹/iconï¼‰</li>
</ul>
<p>ä¸¤è€…éƒ½æ˜¯ç¬¦åˆå•ä¸€èŒè´£çš„ï¼Œå¯ä»¥å°†å…¶æŠ½ç¦»æˆä¸€ä¸ªç‹¬ç«‹ç»„ä»¶ï¼Œä½†æ˜¯é€šå¸¸ä¸è¦è¿™ä¹ˆåš</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">å› ä¸ºåŒä¸€ä¸ª<span class="keyword">app</span>çš„é£æ ¼å¿…å°†æ˜¯ç»Ÿä¸€çš„ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡åˆ«çš„åº”ç”¨åœºæ™¯äº†ï¼Œå°±åƒä¸Šæ–‡æ‰€è¯´çš„ï¼ŒæŠ½ç¦»ç»„ä»¶ä¹‹å‰ï¼Œå¤šé—®è‡ªå·±ä¸ºä»€ä¹ˆä»¥åŠæŠ•å…¥/äº§å‡ºæ¯”ï¼Œæ²¡æœ‰ç»å¯¹çš„è§„åˆ™</span><br></pre></td></tr></table></figure>
<h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><font color="red">å•ä¸€èŒè´£ç»„ä»¶è¦å»ºç«‹åœ¨å¯å¤ç”¨çš„åŸºç¡€ä¸Šï¼Œå¯¹äºä¸å¯å¤ç”¨çš„å•â¼€èŒè´£ç»„ä»¶æˆ‘ä»¬ä»…ä»…ä½œä¸ºç‹¬ç«‹ç»„ä»¶çš„å†…éƒ¨ç»„ä»¶å³å¯</font>

<h3 id="æŸäºŒæ‰‹è½¦ç½‘ç«™ä½“ç°å…¶ç»†ç²’åº¦çš„ä¾‹å­"><a href="#æŸäºŒæ‰‹è½¦ç½‘ç«™ä½“ç°å…¶ç»†ç²’åº¦çš„ä¾‹å­" class="headerlink" title="æŸäºŒæ‰‹è½¦ç½‘ç«™ä½“ç°å…¶ç»†ç²’åº¦çš„ä¾‹å­"></a>æŸäºŒæ‰‹è½¦ç½‘ç«™ä½“ç°å…¶ç»†ç²’åº¦çš„ä¾‹å­</h3><p><img src="http://cdn.anruence.com/1.gif" alt="jsworke"></p>
<p>æ€è€ƒï¼Œå¦‚æœè®©ä½ å®ç°ä½ ä¼šå¦‚ä½•è®¾è®¡â€¦<br>æˆ‘å½“åˆæ˜¯è¿™ä¹ˆè®¾è®¡çš„</p>
<p><img src="http://cdn.anruence.com/8.png" alt="jsworke"></p>
<p>index.js(react)</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"select-brand-box"</span> <span class="attr">onTouchStart</span>=</span></span><span class="template-variable">&#123;touchStartHandler&#125;</span><span class="xml"><span class="tag"> <span class="attr">onTouchMove</span>=</span></span><span class="template-variable">&#123;touchMoveHandler&#125;</span><span class="xml"><span class="tag"> <span class="attr">onTouchEnd</span>=</span></span><span class="template-variable">&#123;touchEndHandler.bind(this, touchEndCallback)&#125;</span><span class="xml"><span class="tag">&gt;</span></span></span><br><span class="line"><span class="xml">     <span class="tag">&lt;<span class="name">NavBar</span>&gt;</span><span class="tag">&lt;/<span class="name">NavBar</span>&gt;</span></span></span><br><span class="line"><span class="xml">     <span class="tag">&lt;<span class="name">Brand</span> <span class="attr">key</span>=<span class="string">"brands-list"</span> </span></span><span class="template-variable">&#123;...brandsProps&#125;</span><span class="xml"><span class="tag"> /&gt;</span></span></span><br><span class="line"><span class="xml">     <span class="tag">&lt;<span class="name">Series</span> <span class="attr">key</span>=<span class="string">"series-list"</span> </span></span><span class="template-variable">&#123;...seriesProps&#125;</span><span class="xml"><span class="tag"> &gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"> </span></span><br><span class="line"><span class="xml"> export default BrandHoc(index);</span></span><br></pre></td></tr></table></figure>
<p>Brand.js(react)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"brand-box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"brand-wrap"</span> <span class="attr">ref</span>=<span class="string">"brandWrap"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">"brands-title hot-brands-title"</span>&gt;</span>çƒ­é—¨å“ç‰Œ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">FlexLayout</span> <span class="attr">onClick</span>=<span class="string">&#123;hotBrandClick&#125;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">HotBrands</span> <span class="attr">HotBrands</span>=<span class="string">&#123;hotBrands&#125;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">FlexLayout</span>&gt;</span></span><br><span class="line">        &#123;!isHideStar &amp;&amp; <span class="tag">&lt;<span class="name">UnlimitType</span> &#123;<span class="attr">...unlimitProps</span>&#125; /&gt;</span>&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">AllBrands</span> &#123;<span class="attr">...brandsProps</span>&#125; /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">AsideLetter</span> &#123;<span class="attr">...asideProps</span>&#125; /&gt;</span></span><br><span class="line">    &#123;showPop ? <span class="tag">&lt;<span class="name">PopTips</span> <span class="attr">key</span>=<span class="string">"pop-tips"</span> <span class="attr">tip</span>=<span class="string">&#123;currentLetter&#125;</span> /&gt;</span> : null&#125;</span><br><span class="line">    &#123;showBrandLoading ? <span class="tag">&lt;<span class="name">Loading</span> /&gt;</span> : null&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>FlexLayout.js(react)</p>
<p><img src="http://cdn.anruence.com/9.png" alt="jsworke"></p>
<p>è¿™ä¸ªç¤ºä¾‹å‡ ä¹æ¶µç›–äº†æ‰€æœ‰çš„è§„åˆ™</p>
<ul>
<li>é¦–å…ˆç»„ä»¶çš„è®¾è®¡æ˜¯æ ¹æ®ä¸šåŠ¡åˆ’åˆ†çš„ï¼Œæ‰€ä»¥å³ä¾§å­—æ¯å¯¼èˆªï¼ˆAsideLetterï¼‰æ‰æ²¡æœ‰åœ¨æœ€å¤–å±‚çš„å®¹å™¨ç»„ä»¶ï¼Œå¦åˆ™é€šä¿¡é—®é¢˜ä¼šå ç”¨ä¸€éƒ¨åˆ†ç¯‡å¹…ï¼Œäº‹å®ä¸Šè¿™æ˜¯æœ‰è§£çš„</li>
<li>å…¥å£ç»„ä»¶æ˜¯å®¹å™¨ç»„ä»¶ï¼Œäº‹å®ä¸ŠæŠŠå®ƒå½“åšä¸€ä¸ªè§„åˆ™å°±è¡Œäº†ï¼Œä¸šåŠ¡é€»è¾‘çš„è½½ä½“</li>
<li>é™¤äº†å®¹å™¨ç»„ä»¶å¤–ï¼Œå…¶ä»–çš„ç»„ä»¶éƒ½è¢«æŠ½æˆå…¬ç”¨çš„äº†ï¼ŒäºŒæ‰‹è½¦å¹³å°ç±»ä¼¼çš„åœºæ™¯éå¸¸å¤š</li>
</ul>
<p><img src="http://cdn.anruence.com/10.png" alt="jsworke"></p>
<ul>
<li>å–è½¦å¹³å°ç±»ä¼¼çš„å›¾æ–‡æ··æ’å¤šä¸”å½¢æ€å„ä¸ç›¸åŒï¼Œåº”ç”¨åœºæ™¯å¹¿æ³›ï¼ŒæŠ½ï¼UIå·®å¼‚æ¶ˆåŒ–åœ¨ç»„ä»¶å†…éƒ¨ï¼Œå‚è€ƒFlexLayout.jsï¼Œç»™å®šdefault props</li>
<li>å¯æå–çš„ç»„ä»¶è¿‡å¤šï¼ˆä¸šåŠ¡é©±åŠ¨ï¼‰å¯¼è‡´é€šè®¯å›°éš¾å¦‚ä½•è§£å†³ï¼Ÿ é‚£è¯´æ˜ä½ éœ€è¦æ–°å¢å¯ç®¡ç†çŠ¶æ€çš„å®¹å™¨ç»„ä»¶ï¼Œä¸Šä¾‹ä¸­Brandï¼ŒSeriesä¹Ÿæ˜¯å®¹å™¨ç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†å­ç»„ä»¶çš„å¤§å°äº‹å®œ</li>
<li>ç»†ç²’åº¦çš„è€ƒé‡ï¼Œè€ƒè™‘ä»˜å‡ºäº§å‡ºæ¯”</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">"brands-title hot-brands-title"</span>&gt;</span>çƒ­é—¨å“ç‰Œ<span class="tag">&lt;/<span class="name">p</span>&gt;</span> åªæœ‰ä¸€è¡Œï¼Œç›´æ¥å†™å°±å®Œäº†</span><br></pre></td></tr></table></figure>
<ul>
<li>ç»„ä»¶æŠ½ç¦»çš„è¿‡ç¨‹å°±æ˜¯æ— é™å‘æ— çŠ¶æ€ï¼ˆå±•ç¤ºå‹ï¼‰ç»„ä»¶æ— é™é è¿‘çš„è¿‡ç¨‹</li>
</ul>
<h2 id="é€šç”¨æ€§è€ƒé‡"><a href="#é€šç”¨æ€§è€ƒé‡" class="headerlink" title="é€šç”¨æ€§è€ƒé‡"></a>é€šç”¨æ€§è€ƒé‡</h2><p>ç»„ä»¶çš„å½¢æ€(UI)æ°¸è¿œæ˜¯åƒå˜ä¸‡åŒ–çš„,ä½†æ˜¯å…¶è¡Œä¸º(é€»è¾‘)æ˜¯å›ºå®šçš„,å› æ­¤é€šç”¨ç»„ä»¶çš„ç§˜è¯€ä¹‹â¼€å°±æ˜¯<font color="red">å°†DOM ç»“æ„çš„æ§åˆ¶æƒäº¤ç»™å¼€å‘è€…,ç»„ä»¶åªè´Ÿè´£â¾ä¸ºå’Œæœ€åŸºæœ¬çš„DOMç»“æ„</font></p>
<p>è¿™æ˜¯ä¸€ä¸ªæ˜¾çœ¼çš„æ —å­</p>
<p>æŸä¸€å¤©ï¼Œä½ æ¥åˆ°è¿™æ ·å„¿çš„éœ€æ±‚</p>
<p><img src="http://cdn.anruence.com/12.png" alt="jsworke"></p>
<p>å¼€å¿ƒï¼Œç®€å•ï¼Œä¸‰ä¸‹äº”é™¤äºŒå†™å®Œäº†</p>
<p>çªç„¶æœ‰ä¸€å¤©åˆæœ‰è¿™æ ·å„¿çš„éœ€æ±‚</p>
<p><img src="http://cdn.anruence.com/13.png" alt="jsworke"></p>
<p>emm..å¯å®šåˆ¶ï¼Ÿä¹‹å‰çš„selectæ²¡æ³•ç”¨äº†ï¼Œæ€ä¹ˆåšï¼Ÿè¦ä¿®æ”¹ä¸Šä¸€ä¸ªæˆ–è€…å†å†™ä¸€ä¸ªå—ï¼Ÿ<br>ä¸€æ—¦å‡ºç°äº†è¿™ç§æƒ…å†µï¼Œè¯æ˜ä¹‹å‰çš„ç»„ä»¶éœ€è¦é‡æ–°è®¾è®¡äº†</p>
<p>å®ç°é€šç”¨æ€§è®¾è®¡çš„å…³é”®ä¸€ç‚¹æ˜¯<font color="red">æ”¾å¼ƒå¯¹Domçš„æŒæ§</font></p>
<h3 id="é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œé‚£ä¹ˆå¤šéœ€è¦è‡ªå®šä¹‰çš„åœ°æ–¹ï¼Œé‚£ç»„ä»¶ä¼šä¸ä¼šå¾ˆéš¾ç”¨ï¼Ÿ"><a href="#é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œé‚£ä¹ˆå¤šéœ€è¦è‡ªå®šä¹‰çš„åœ°æ–¹ï¼Œé‚£ç»„ä»¶ä¼šä¸ä¼šå¾ˆéš¾ç”¨ï¼Ÿ" class="headerlink" title="é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œé‚£ä¹ˆå¤šéœ€è¦è‡ªå®šä¹‰çš„åœ°æ–¹ï¼Œé‚£ç»„ä»¶ä¼šä¸ä¼šå¾ˆéš¾ç”¨ï¼Ÿ"></a>é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œé‚£ä¹ˆå¤šéœ€è¦è‡ªå®šä¹‰çš„åœ°æ–¹ï¼Œé‚£ç»„ä»¶ä¼šä¸ä¼šå¾ˆéš¾ç”¨ï¼Ÿ</h3><p>é€šç”¨æ€§è®¾è®¡åœ¨å°†Domç»“æ„å†³å®šæƒäº¤ç»™å¼€å‘è€…çš„åŒæ—¶æŒ‡å®šé»˜è®¤å€¼</p>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªæ–°é²œå‡ºç‚‰(vue)ğŸŒ°</p>
<p>Listç»„ä»¶</p>
<p><img src="http://cdn.anruence.com/14.png" alt="jsworke"></p>
<p>çˆ¶ç»„ä»¶ğŸŒ°(vue)åŠslot</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">æ¨¡ç‰ˆï¼ˆä¼ªä»£ç ï¼‰</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;List :data=<span class="string">"tableData[item.type]"</span> :loading=<span class="string">"loading"</span> @loadMore=<span class="string">"loadMore"</span> :noMore=<span class="string">"noMore"</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">a</span> v-<span class="keyword">if</span>=<span class="string">"item.type == 0"</span> slot=<span class="string">"listOption"</span> slot-scope=<span class="string">"childScope"</span> class=<span class="string">"edit-btn"</span> @click=<span class="string">"edit(childScope.data)"</span> v-bind:key=<span class="string">"childScope.data.id"</span>&gt;&#123;&#123;Status[childScope<span class="selector-class">.data</span><span class="selector-class">.status</span>][<span class="string">'text'</span>]&#125;&#125;&lt;/a&gt;</span><br><span class="line">&lt;/List&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">config</span><span class="params">(ä¼ªä»£ç )</span></span></span><br><span class="line">export const Status = &#123;</span><br><span class="line">  <span class="comment">//....</span></span><br><span class="line">  <span class="number">1</span>: &#123;</span><br><span class="line">    <span class="selector-tag">label</span>: <span class="string">'è‰ç¨¿'</span>,</span><br><span class="line">    type: <span class="string">''</span>,</span><br><span class="line">    text: <span class="string">'ç¼–è¾‘'</span>,</span><br><span class="line">    class: <span class="string">'note'</span></span><br><span class="line">  &#125;&#125;</span><br><span class="line">  <span class="comment">//...</span></span><br></pre></td></tr></table></figure>
<p>åˆæœ‰ä¸€ä¸ªæ —å­(vue)</p>
<p><img src="http://cdn.anruence.com/15.png" alt="jsworke"></p>
<ul>
<li>Dialogåªè´Ÿè´£åŸºç¡€çš„é€»è¾‘ï¼Œäº¤å‡ºæ§åˆ¶æƒç»™åˆ°ä¸šåŠ¡ï¼Œè‡³äºä½ çš„ä¸šåŠ¡éœ€è¦ä»€ä¹ˆï¼Œåœ¨å®¹å™¨ç»„ä»¶ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰å»å¤„ç†</li>
</ul>
<p>å¿ä¸ä½æ”¾ä¸Šç£çŸ³ä¸šåŠ¡çš„åé¢ä¾‹å­</p>
<p><img src="http://cdn.anruence.com/16.png" alt="jsworke"></p>
<p>éš¾ç”¨æ— éæ˜¯ä¸¤æ–¹é¢çš„é—®é¢˜</p>
<ol>
<li>ä¸è‚¯ç§»äº¤æ§åˆ¶æƒ</li>
<li>æ²¡æœ‰APIæ–‡æ¡£</li>
</ol>
<p>æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘ä¸åœºæ™¯éƒ½åŒ…å«åœ¨ç»„ä»¶å†…éƒ¨ï¼Œå¤–ç•Œåªé€šè¿‡å˜é‡æ¥æ§åˆ¶ï¼Œåˆè¡·æ˜¯å¥½çš„ï¼Œä½†æ˜¯éšç€ä¸šåŠ¡å‘å±•ï¼Œç»„ä»¶è¶Šæ¥è¶Šåºå¤§ï¼Œå¼€å‘è€…ä¹Ÿè¶Šæ¥è¶ŠåŠ›ä¸ä»å¿ƒäº†</p>
<p>åˆšå¥½ç°é˜¶æ®µUIæ”¹ç‰ˆï¼Œæˆ‘ä»¬çš„å·¥ä½œé‡å°±ç”±åªæ”¹æ ·å¼ç›´æ¥è½¬åŒ–ä¸ºæ¨å€’é‡æ¥äº†ï¼Œåˆæ²¡æœ‰è¯¦ç»†çš„æ–‡æ¡£ï¼Œå·¥ä½œé‡ç¬é—´ç¿»äº†Nå€ğŸ˜­å®å®å¿ƒé‡Œè‹¦å®å®ä¸è¯´</p>
<h2 id="å–„ç”¨è®¾è®¡æ¨¡å¼"><a href="#å–„ç”¨è®¾è®¡æ¨¡å¼" class="headerlink" title="å–„ç”¨è®¾è®¡æ¨¡å¼"></a>å–„ç”¨è®¾è®¡æ¨¡å¼</h2><p>å…¶å®ä¸€å¼€å§‹ï¼Œæˆ‘å¹¶æ²¡æœ‰ä¸“é—¨å»å¥—ç”¨è®¾è®¡æ¨¡å¼ï¼Œå®Œå…¨æ˜¯ä¸šåŠ¡é©±ä½¿<br>ä½ ä¸€å®šè§åˆ°è¿‡è¿™æ ·å„¿çš„</p>
<p><img src="http://cdn.anruence.com/17.png" alt="jsworke"></p>
<p>ä¸€æ—¦è¿™æ ·å„¿çš„é€»è¾‘å¤šäº†ï¼Œé‚£æ˜¯ä¸æ˜¯å°±è·Ÿä¸šåŠ¡è€¦åˆäº†ï¼Œè·Ÿä¸šåŠ¡è€¦åˆå¤šäº†ï¼Œé‚£ç»„ä»¶è‡ªç„¶æ²¡æœ‰ä»€ä¹ˆé€šç”¨æ€§äº†ï¼Œå³ä½¿æˆ‘ä»¬ä¸è€ƒè™‘åˆ°é€šç”¨æ€§ï¼Œé‚£å†™çš„ç´¯å§ï¼Ÿ</p>
<p>è€ƒè™‘ä¸‹è¿™æ ·å†™ä¼šä¸ä¼šå¥½ä¸€ç‚¹</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">configï¼ˆä¼ªä»£ç ï¼‰</span><br><span class="line">export const Status = &#123;</span><br><span class="line">  <span class="number">4</span>: &#123;</span><br><span class="line">    <span class="selector-tag">label</span>: <span class="string">'éƒ¨åˆ†å…¥åº“'</span>,</span><br><span class="line">    type: <span class="string">''</span>,</span><br><span class="line">    text: <span class="string">'æŸ¥çœ‹'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">æ¨¡ç‰ˆ(vue)</span><br><span class="line">&lt;<span class="selector-tag">a</span> v-<span class="keyword">if</span>=<span class="string">"item.type == 0"</span> slot=<span class="string">"listOption"</span> slot-scope=<span class="string">"childScope"</span> class=<span class="string">"edit-btn"</span> @click=<span class="string">"edit(childScope.data)"</span> v-bind:key=<span class="string">"childScope.data.id"</span>&gt;&#123;&#123;Status[childScope<span class="selector-class">.data</span><span class="selector-class">.status</span>][<span class="string">'text'</span>]&#125;&#125;&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p>ä¸–ç•Œä¸Šæœ¬æ²¡æœ‰è®¾è®¡æ¨¡å¼ï¼Œå†™çš„äººå¤šäº†ï¼Œå°±è‡ªæˆä¸€å¥—è„±é¢–è€Œå‡ºè¿›è€Œè¢«å†å²é“­è®°äº†ï¼ä¸ä»…å¦‚æ­¤,ä¸€éƒ¨åˆ†çœ‹ä¼¼å¤æ‚çš„ä¸šåŠ¡å¦‚æœåˆç†è®¾è®¡é…ç½®é¡¹ï¼Œå¯ä»¥ä¼šä¸ºä½ çœå»ä¸€å¤§ç¯‡js</p>
<h1 id="ä¸€äº›æ„Ÿæ‚Ÿ"><a href="#ä¸€äº›æ„Ÿæ‚Ÿ" class="headerlink" title="ä¸€äº›æ„Ÿæ‚Ÿ"></a>ä¸€äº›æ„Ÿæ‚Ÿ</h1><p>åƒç£çŸ³è¿™ç§åº•å±‚çš„ä¸šåŠ¡æ”¯æŒç³»ç»Ÿï¼Œç¦»ä¸å¼€å¤§é‡çš„åˆ—è¡¨ï¼ŒæŸ¥è¯¢ï¼Œç¼–è¾‘ï¼Œè¯¦æƒ…ç­‰ï¼Œæˆ‘ä¸€èˆ¬ä¼šèŠ±30ç§’æ­å¥½æ¶å­ï¼Œåƒä½†ä¸é™äºä¸‹é¢è¿™ç§</p>
<p><img src="http://cdn.anruence.com/18.png" alt="jsworke"></p>
<ul>
<li>index:æ¨¡å—å…¥å£ï¼ˆæ‰¿æ‹…å®¹å™¨èŒè´£ï¼‰</li>
<li>apiï¼šæ•´å—ä¸šåŠ¡çš„API</li>
<li>components ä¸šåŠ¡ç»„ä»¶é›†åˆ</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">1. </span>Formï¼šè¡¨å• ä¸€èˆ¬ä¼šè¢«add.vueï¼ˆç¼–è¾‘ï¼‰ å’Œedit.vueï¼ˆè¯¦æƒ…ï¼‰å¼•ç”¨</span><br><span class="line"><span class="bullet">2. </span>Listï¼šåˆ—è¡¨</span><br><span class="line"><span class="bullet">3. </span>Search: æœç´¢ç»„ä»¶</span><br><span class="line"><span class="bullet">4. </span>å…¶ä»–ä¸šåŠ¡ä¸­æœ‰ä½†å´æ²¡çœ‹åˆ°çš„åŸºæœ¬ä¸Šéƒ½å·²ç»æŠ½ç¦»åˆ°commonäº† æ¯”å¦‚é¢åŒ…å±‘å¯¼èˆªï¼Œæ”¶èµ·å±•å¼€åŠŸèƒ½ç­‰</span><br></pre></td></tr></table></figure>
<ul>
<li>libs é¡µé¢çš„å„ç§é…ç½®</li>
</ul>
<h2 id="å…·ä½“ä½“ç°ï¼ˆç£çŸ³åˆšåˆšé‡æ„çš„æ¨¡å—ï¼‰"><a href="#å…·ä½“ä½“ç°ï¼ˆç£çŸ³åˆšåˆšé‡æ„çš„æ¨¡å—ï¼‰" class="headerlink" title="å…·ä½“ä½“ç°ï¼ˆç£çŸ³åˆšåˆšé‡æ„çš„æ¨¡å—ï¼‰"></a>å…·ä½“ä½“ç°ï¼ˆç£çŸ³åˆšåˆšé‡æ„çš„æ¨¡å—ï¼‰</h2><p>é‡‡è´­æ¨¡å—ç»“æ„å›¾</p>
<p><img src="http://cdn.anruence.com/2222323232323.png" alt="image"></p>
<p>Form</p>
<p><img src="http://cdn.anruence.com/edit.png" alt="image"></p>
<p>Edit</p>
<p><img src="http://cdn.anruence.com/form.png" alt="image"></p>
<p>æ— è®ºæœ‰å¤šå°‘ç§çŠ¶æ€ï¼Œåªåœ¨editè¿™å±‚å®¹å™¨ç»´æŠ¤</p>
<h2 id="è¦è¿™ä¹ˆåšçš„åŸå› "><a href="#è¦è¿™ä¹ˆåšçš„åŸå› " class="headerlink" title="è¦è¿™ä¹ˆåšçš„åŸå› "></a>è¦è¿™ä¹ˆåšçš„åŸå› </h2><ul>
<li>componentsä¸­çš„ç»„ä»¶åªæ˜¯æš‚å­˜ï¼Œéƒ½æœ‰å¯èƒ½è¢«å‡çº§æˆé€šç”¨ç»„ä»¶ï¼Œæ‰€ä»¥å‘½åè¦æ³¨æ„ï¼Œä¸€ç±»çš„ä¿æŒäº†ç»Ÿä¸€ï¼Œé˜²æ­¢ä¸šåŠ¡è€¦åˆ</li>
<li>bugæœ‰è¿¹å¯å¾ªï¼Œæ•°æ®çš„é—®é¢˜æˆ‘ä¸€å®šä»å¤–å‘é‡Œæ’æŸ¥ï¼Œæ ·å¼é—®é¢˜ä»é‡Œå‘å¤–æ’æŸ¥ï¼Œå®šä½é—®é¢˜å¿«</li>
<li>ä¸é‡å¤ä»£ç åšæ–—äº‰ï¼Œæ—¶åˆ»ä¿æŒä¸€ç§å¼ºè¿«ç—‡çš„å¿ƒæ€å»æ•´ç†å„ä¸ªæ¨¡å—ï¼Œå½¢æˆè‡ªå·±çš„ç¼–ç é£æ ¼ï¼Œè¿›è€Œå›¢é˜Ÿé£æ ¼æ‰æœ‰å¯èƒ½ç»Ÿä¸€</li>
</ul>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul>
<li>å¯¹äºç»„ä»¶è®¾è®¡ï¼Œå……åˆ†çš„å‡†å¤‡å›ºç„¶ï¼Œä½†åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œåˆ‡å®çš„ç»“æœæ‰æ˜¯æœ€é‡è¦çš„ï¼Œç»„ä»¶è®¾è®¡ä¹Ÿä¸è¦è¿‡åº¦è®¾è®¡æ›´ä¸è¦åœæ»ä¸å‰ï¼Œè¯¥åšçš„æ—¶å€™å°±å»åšï¼Œå‘ç°ä¸å¥½å°±å»æ”¹</li>
<li>æœ‰ç©ºé—²æ—¶é—´å°±å»æ€è€ƒæ—©æœŸä¸å¤Ÿç†æƒ³çš„ä»£ç ï¼Œå®ƒå¯ä»¥ä½œä¸ºæˆ‘ä»¬å‘å‰å‘å±•çš„åŸºç¡€</li>
<li>æŠ€æœ¯åœ¨å˜è¿ï¼Œä½†ç»„ä»¶åŒ–çš„æ ¸å¿ƒå¹¶æ²¡æœ‰æ”¹å˜ï¼Œç›®æ ‡ä»ç„¶æ˜¯åœ¨APIè®¾è®¡å°½å¯èƒ½æ¥è¿‘åŸç”Ÿçš„æƒ…å†µä¸‹å®Œæˆå¤ç”¨ã€è§£è€¦ã€å°è£…ã€æŠ½è±¡çš„ç›®æ ‡ï¼Œæœ€ç»ˆæœåŠ¡äºå¼€å‘ï¼Œæé«˜æ•ˆç‡é™ä½é”™è¯¯ç‡</li>
</ul>
<ul>
<li>ç»„ä»¶åŒ–æ˜¯å¯¹å®ç°çš„åˆ†å±‚ï¼Œæ˜¯æ›´æœ‰æ•ˆåœ°ä»£ç ç»„åˆæ–¹å¼</li>
<li>ç»„ä»¶åŒ–æ˜¯å¯¹èµ„æºçš„é‡ç»„å’Œä¼˜åŒ–ï¼Œä»è€Œä½¿é¡¹ç›®èµ„æºç®¡ç†æ›´åˆç†ï¼Œæ–¹ä¾¿æ‹”æ’ã€æ–¹ä¾¿é›†æˆã€æ–¹ä¾¿åˆ é™¤ã€æ–¹ä¾¿åˆ é™¤åé‡æ–°åŠ å…¥</li>
<li>è¿™ç§åŒ–ç¹ä¸ºç®€çš„æ€æƒ³åœ¨åç«¯å¼€å‘ä¸­çš„ä½“ç°æ˜¯å¾®æœåŠ¡ï¼Œè€Œåœ¨å‰ç«¯å¼€å‘ä¸­çš„ä½“ç°å°±æ˜¯ç»„ä»¶åŒ–</li>
</ul>
<ul>
<li>ç»„ä»¶åŒ–æœ‰åˆ©äºå•å…ƒæµ‹è¯•ä¸è‡ªæµ‹æ•ˆç‡å¯¹é‡æ„è¾ƒå‹å¥½</li>
<li>æ–°äººåŠ å…¥å¯ä»¥ç›´æ¥åˆ†é…ç»„ä»¶è¿›è¡Œå¼€å‘ã€æµ‹è¯•ï¼Œè€Œééœ€è¦ç†Ÿæ‚‰æ•´ä¸ªé¡¹ç›®ï¼Œå¯ä»¥ä»ä¸€ä¸ªç»„ä»¶çš„å¼€å‘ä½¿æ–°è¿›äººå‘˜æ¯”è¾ƒå¿«é€Ÿç†Ÿæ‚‰é¡¹ç›®ã€äº†è§£åˆ°å¼€å‘è§„èŒƒ</li>
<li>ä½ çš„ç›´æ¥è´£ä»»å¯èƒ½æ˜¯ç¼–å†™ä»£ç ï¼Œä½†ä½ çš„ç»ˆæç›®æ ‡æ˜¯åœ¨åˆ›å»ºäº§å“</li>
</ul>
<p>æœ€åè¯´ä¸€å¥</p>
<font color="red">ç»„ä»¶åŒ–æ²¡æœ‰ç»ˆç‚¹ï¼Œday day up</font>

<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul>
<li><a href="https://engineering.carsguide.com.au/front-end-component-design-principles-55c5963998c9?gi=b5b86599de92" target="_blank" rel="noopener">https://engineering.carsguide.com.au/front-end-component-design-principles-55c5963998c9?gi=b5b86599de92</a></li>
<li><a href="https://segmentfault.com/a/1190000009952681" target="_blank" rel="noopener">https://segmentfault.com/a/1190000009952681</a></li>
<li><a href="https://juejin.im/post/5a73d6435188257a6a789d0d" target="_blank" rel="noopener">https://juejin.im/post/5a73d6435188257a6a789d0d</a></li>
<li><a href="https://medium.com/merrickchristensen/function-as-child-components-5f3920a9ace9" target="_blank" rel="noopener">https://medium.com/merrickchristensen/function-as-child-components-5f3920a9ace9</a></li>
<li><a href="http://www.alloyteam.com/2015/11/we-will-be-componentized-web-long-text/" target="_blank" rel="noopener">http://www.alloyteam.com/2015/11/we-will-be-componentized-web-long-text/</a></li>
</ul>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>ç»„ä»¶è®¾è®¡</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€ä¸ªé—®é¢˜å¼•å‡ºçš„pushStateç”¨æ³•</title>
    <url>/2018/11/27/pushState/</url>
    <content><![CDATA[<h3 id="å¼•å‡ºé—®é¢˜"><a href="#å¼•å‡ºé—®é¢˜" class="headerlink" title="å¼•å‡ºé—®é¢˜"></a>å¼•å‡ºé—®é¢˜</h3><p>ä¸ºä»€ä¹ˆæœ‰è¿™ç¯‡æ–‡ç« .<br>æœ€è¿‘çš„å¼€å‘ä¸­é‡åˆ°è¿™ä¹ˆä¸€ä¸ªé—®é¢˜<br>å¦‚ä¸‹å›¾<br><img src="/images/pushState/pushState1.gif" alt="gifqian"><br>æ‰«ç è¿›å…¥ç½‘é¡µ ç‚¹å‡»å¼¹å‡ºè¦†ç›–æ•´ä¸ªæ‰‹æœºå±å¹•çš„å±‚ æ­¤æ—¶ç‚¹å‡»æµè§ˆå™¨çš„è¿”å› ä¼šç›´æ¥å›é€€åˆ°ä¹‹å‰æ‰«ç é¡µé¢<br>å…¶å® è¿™ä¸ªé€»è¾‘å¾ˆåˆç† å› ä¸ºå®ƒæ²¡æœ‰å†å²è®°å½• æ²¡æœ‰æ‰€è°“çš„ä¸Šä¸€ä¸ªé¡µé¢ ç¨‹åºä¸Šæ˜¯åˆç†çš„<br>ä½†ç”¨æˆ·ä½“éªŒæ— ç–‘æ˜¯å·®åˆ°æè‡´<br>å¯¹äºç”¨æˆ·æ¥è®² å¯èƒ½æˆ‘åªæ˜¯æƒ³æŠŠå½“å‰çš„å¼¹å±‚å…³æ‰è€Œä¸æ˜¯é€€å‡ºç½‘é¡µ</p>
<p>é‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿ</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>æ²¡æœ‰å†å²è®°å½• é‚£æˆ‘ä»¬å°±æ‰‹åŠ¨é€ å‡ºæ¥ä¸€æ¡â€œå†å²è®°å½•â€ï¼Œè®©ç¨‹åºçš„è¿”å›æ—¶ èƒ½å¤Ÿæœ‰è¿¹å¯å¾ª<br>æœ€ç»ˆæ•ˆæœ<br><img src="/images/pushState/pushState2.gif" alt="gifqian"></p>
<p>ç›¸å…³ä»£ç </p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"> componentDidMount()&#123;</span><br><span class="line">        <span class="comment">//ç›‘å¬popstateäº‹ä»¶</span></span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'popstate'</span>,<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.navLeftClick();</span><br><span class="line">        &#125;)    </span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//å¼¹å±‚çš„è¿”å›æŒ‰é’®</span></span><br><span class="line">   navLeftClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">           showBrandContainer: <span class="literal">false</span></span><br><span class="line">       &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">componentWillUnmount() &#123;</span><br><span class="line">    <span class="comment">// ç¦»å¼€é¡µé¢çš„æ—¶å€™å–æ¶ˆç›‘å¬popstate</span></span><br><span class="line">   <span class="built_in">window</span>.removeEventListener(<span class="string">'popstate'</span>,<span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">this</span>.back();</span><br><span class="line">   &#125;) </span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    selectBrand = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">window</span>.history.pushState(&#123;page: <span class="number">1</span>&#125;, <span class="string">"title 1"</span>, <span class="string">"?page=1"</span>); <span class="comment">//å‘historyå¯¹è±¡pushä¸€æ¡state</span></span><br><span class="line"></span><br><span class="line">          &lt;!-- å®ç°å‚æ•°é€ä¼ ----</span><br><span class="line">        <span class="keyword">let</span> search = <span class="built_in">window</span>.location.search;</span><br><span class="line">        <span class="built_in">window</span>.history.pushState(&#123; page: <span class="number">1</span> &#125;, <span class="string">""</span>, search);</span><br><span class="line">        å®ç°å‚æ•°é€ä¼ ---- --&gt;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            showBrandContainer: <span class="literal">true</span> <span class="comment">//å¼€å¯å¼¹å±‚</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="History"><a href="#History" class="headerlink" title="History"></a>History</h3><p>DOMä¸­çš„windowå¯¹è±¡é€šè¿‡window.historyæ–¹æ³•æä¾›äº†å¯¹æµè§ˆå™¨å†å²è®°å½•çš„è¯»å–ï¼Œè®©ä½ å¯ä»¥åœ¨ç”¨æˆ·çš„è®¿é—®è®°å½•ä¸­å‰è¿›å’Œåé€€<br>ä»HTML5å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ“ä½œè¿™ä¸ªå†å²è®°å½•å †æ ˆ<br><strong>å‰è¿›</strong>  <code>window.history.forward();</code><br><strong>åé€€</strong> <code>window.history.back();</code><br><strong>å‘å‰ç§»åŠ¨Né¡µ</strong> <code>window.history.go(-N);</code><br><strong>å‘åç§»åŠ¨Né¡µ</strong> <code>window.history.go(N);</code><br>ä½ ç”šè‡³å¯ä»¥é€šè¿‡æ£€æŸ¥æµè§ˆå™¨å†å²è®°å½•çš„lengthå±æ€§æ¥æ‰¾åˆ°å†å²è®°å½•å †æ ˆä¸­çš„é¡µé¢æ€»æ•°<br><code>window.history.length</code></p>
<h4 id="HTML5-historyæ–°ç‰¹æ€§pushStateã€replaceState"><a href="#HTML5-historyæ–°ç‰¹æ€§pushStateã€replaceState" class="headerlink" title="HTML5 historyæ–°ç‰¹æ€§pushStateã€replaceState"></a>HTML5 historyæ–°ç‰¹æ€§pushStateã€replaceState</h4><p>HTML5å¼•å…¥äº†histtory.pushState()å’Œhistory.replaceState()è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä»–ä»¬å…è®¸æ·»åŠ å’Œä¿®æ”¹historyå®ä½“ã€‚åŒæ—¶ï¼Œè¿™äº›æ–¹æ³•ä¼šå’Œwindow.onpostateäº‹ä»¶ä¸€èµ·å·¥ä½œï¼Œå…³äºwindow.popstate å¯å‚è€ƒ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/onpopstate" target="_blank" rel="noopener">window.popstate</a><br>pushStateï¼šå‘ history æ·»åŠ å½“å‰é¡µé¢çš„è®°å½• ä½¿ç”¨history.pushState()æ–¹æ³•æ¥ä¿®æ”¹referrer<br>replaceStateï¼šå’Œ pushState çš„ç”¨æ³•å®Œå…¨ä¸€æ ·ï¼ŒåŒºåˆ«å°±æ˜¯å®ƒç”¨äºä¿®æ”¹å½“å‰é¡µé¢åœ¨ history ä¸­çš„è®°å½• </p>
<p>ä¸€ä¸ªğŸŒ°</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">å‡è®¾http://<span class="number">10.70</span>.<span class="number">134.53</span>:<span class="number">3000</span>/opt/financial æ§åˆ¶å°æ‰§è¡Œäº†JS</span><br><span class="line">var <span class="keyword">state</span>Obj = &#123; foo: <span class="string">"test"</span> &#125;; history.pushState(<span class="keyword">state</span>Obj, <span class="string">"page 2"</span>,<span class="string">"test.html"</span>);</span><br><span class="line">urlåœ°å€æ å˜ä¸º http://<span class="number">10.70</span>.<span class="number">134.53</span>:<span class="number">3000</span>/opt/test.htmlï¼Œä½†æµè§ˆå™¨ä¸ä¼šåŠ è½½bar.htmlé¡µé¢ï¼Œå³ä½¿è¿™ä¸ªé¡µé¢å­˜åœ¨ä¹Ÿä¸ä¼šåŠ è½½ã€‚</span><br><span class="line">æ­¤æ—¶ å¦‚æœä½ ç‚¹å‡»æµè§ˆå™¨çš„è¿”å› æµè§ˆå™¨å°±è²Œä¼¼æœ‰äº†å‰ä¸€é¡µ</span><br><span class="line">å¦‚ä¸‹å›¾ï¼š</span><br></pre></td></tr></table></figure>
<p><img src="/images/pushState/pushState3.gif" alt="gifqian"></p>
<p>æ€»ç»“ï¼š</p>
<p>å…³äº popstate äº‹ä»¶ éœ€è¦æ³¨æ„çš„å‡ ç‚¹</p>
<ul>
<li>è°ƒç”¨history.pushState()æˆ–è€…history.replaceState()ä¸ä¼šè§¦å‘popstateäº‹ä»¶.</li>
<li>popstateäº‹ä»¶åªä¼šåœ¨æµè§ˆå™¨æŸäº›è¡Œä¸ºä¸‹è§¦å‘, æ¯”å¦‚ç‚¹å‡»åé€€ã€å‰è¿›æŒ‰é’®(æˆ–è€…åœ¨JavaScriptä¸­è°ƒç”¨history.back()ã€history.forward()ã€history.go()æ–¹æ³•).</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ è¦è§¦å‘è¯¥äº‹ä»¶ ä½ éœ€è¦ä¸¤æ­¥</p>
<ol>
<li>æ·»åŠ å¹¶æ¿€æ´»ä¸€ä¸ªå†å²è®°å½•æ¡ç›®(history.pushState)</li>
<li>.æ”¹å˜å†å²è®°å½•æ¡ç›®(ç”¨æˆ·è¡Œä¸º,æ¯”å¦‚åé€€,å‰è¿›)</li>
</ol>
]]></content>
      <categories>
        <category>react</category>
      </categories>
  </entry>
  <entry>
    <title>æ­ç§˜setStateæœºåˆ¶</title>
    <url>/2019/01/27/re_setState/</url>
    <content><![CDATA[<h2 id="å¼€ç¯‡"><a href="#å¼€ç¯‡" class="headerlink" title="å¼€ç¯‡"></a>å¼€ç¯‡</h2><p>è¦è¯´<code>React</code>è®¾è®¡ä½“ç°äº†å“åº”å¼ç¼–ç¨‹æ€æƒ³</p>
<blockquote>
<p>UI=f(state) </p>
</blockquote>
<p><a href="https://www.zhihu.com/people/morgancheng/activities" target="_blank" rel="noopener">ç¨‹å¢¨Morgan</a>çš„æ€»ç»“çœŸæ˜¯æ°åˆ°å¥½å¤„</p>
<p><code>state</code>äº<code>React</code>å¾ˆé‡è¦ï¼Œ<code>setState</code>ä½œä¸ºç®¡ç†<code>state</code>çš„é‡è¦æ–¹æ³•è‡ªç„¶ä¹Ÿæ˜¯å¤´ç­‰å…¬æ°‘</p>
<p>å½“ç„¶äº†ï¼Œå¦‚æœåªæ˜¯ç®€å•ç”¨æ³•ï¼ŒAPIè¶³å¤Ÿäº†ï¼Œä½ çŸ¥é“å¦‚ä½•è®¾ç½®ï¼Œå¦‚ä½•æ›´æ–°ï¼Œæˆ–è®¸èƒ½è§£å†³çœ¼å‰çš„éœ€æ±‚ï¼Œä½†æ˜¯éœ€æ±‚ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå¯èƒ½ä¼šè¢«åŠ¨é™·å…¥<code>setState</code>æ€ªåœˆ</p>
<p>åœ¨å“ªé‡Œè·Œå€’å°±æŠŠå“ªé‡Œä¹°ä¸‹æ¥ï¼Œè¢«å‘äº†ä¹‹åï¼Œç—›å®šæ€ç—›å†³å®šç ”ç©¶ä¸‹<code>setState</code>æ€ªè±¡ï¼Œæœ€åå‘ç° reactçœŸæ˜¯åšå¤§ç²¾æ·±</p>
<font color="red">æ–‡ç« å¤ªå¤ªå¤ªé•¿äº†ï¼Œä¸å¤ªæ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥æ‹‰åˆ°æœ€åæ€»ç»“ï¼Œä¹Ÿèƒ½é¿å…å…¥å‘</font>

<a id="more"></a>
<h2 id="å¼•å‡ºé—®é¢˜"><a href="#å¼•å‡ºé—®é¢˜" class="headerlink" title="å¼•å‡ºé—®é¢˜"></a>å¼•å‡ºé—®é¢˜</h2><p><strong>å¦‚æœé¢è¯•å®˜é—®ä½ </strong></p>
<ol>
<li>setState æ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ</li>
<li>å®ƒå¯èƒ½æ˜¯åŒæ­¥çš„å—ï¼Ÿå¦‚æœå¯èƒ½çš„è¯å¦‚ä½•å®ç°åŒæ­¥æ›´æ–°stateï¼Ÿ</li>
</ol>
<p>å¦‚æœæ˜¯çœ‹è¿™ç¯‡æ–‡ç« ä¹‹å‰ æˆ‘çš„ç­”æ¡ˆå¯èƒ½æ˜¯è¿™æ ·å„¿</p>
<ol>
<li>å®ƒæ˜¯å¼‚æ­¥çš„ ä¸èƒ½ç«‹é©¬æ‹¿åˆ°ç»“æœ</li>
<li>emmâ€¦.</li>
</ol>
<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><!--æœ€å¥½çš„æ–¹å¼å°±æ˜¯å¸¦ç€ç–‘é—®çœ‹æºç ï¼ˆåŸºäºç‰ˆæœ¬<font color="red">16.4.1</font>ï¼‰ï¼Œç›¸ä¿¡æˆ‘ è°ƒè¯•å¤§æ³•å¥½-->
<p>å¯èƒ½ä¼šæœ‰ç–‘é—®çš„å‡ ä¸ªé—®é¢˜.</p>
<h3 id="1-ä¸ºä»€ä¹ˆè¦ç”¨setStateæ›´æ–°stateä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆè¦ç”¨setStateæ›´æ–°stateä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆè¦ç”¨setStateæ›´æ–°stateä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆè¦ç”¨setStateæ›´æ–°stateä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Ÿ</h3><p>å…ˆæ›´æ­£ä¸€ä¸ªè§‚ç‚¹ æ˜¯å¯ä»¥é€šè¿‡<code>this.state</code>å¯¹è±¡ä¿®æ”¹stateçš„ ä¹Ÿç¡®å®èƒ½æ”¹å˜çŠ¶æ€ï¼Œä½†æ˜¯ä¸èƒ½é©±åŠ¨uiæ›´æ–°ï¼ˆä¸èµ°renderï¼‰é‚£.. æœ‰ä»€ä¹ˆæ„ä¹‰</p>
<h3 id="2-setStateæ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"><a href="#2-setStateæ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ" class="headerlink" title="2. setStateæ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"></a>2. setStateæ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ</h3><p>setStateæ˜¯åŒæ­¥æ‰§è¡Œçš„ ä½†æ˜¯stateå¹¶ä¸ä¸€å®šä¼šåŒæ­¥æ›´æ–°ï¼ˆå¼‚æ­¥æ›´æ–°ï¼‰,è¿™æ˜¯ç»“è®º</p>
<p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ è®©æˆ‘ä»¬å¸¦ç€é—®é¢˜å»æºç ï¼ˆåŸºäºç‰ˆæœ¬<font color="red">16.4.1</font>ï¼‰ä¸­å¯»æ‰¾ç­”æ¡ˆ</p>
<hr>
<h4 id="åœºæ™¯ä¸€ï¼ˆåˆæˆäº‹ä»¶ä¸­è°ƒç”¨setStateï¼‰"><a href="#åœºæ™¯ä¸€ï¼ˆåˆæˆäº‹ä»¶ä¸­è°ƒç”¨setStateï¼‰" class="headerlink" title="åœºæ™¯ä¸€ï¼ˆåˆæˆäº‹ä»¶ä¸­è°ƒç”¨setStateï¼‰"></a><font color="green"><strong>åœºæ™¯ä¸€ï¼ˆåˆæˆäº‹ä»¶ä¸­è°ƒç”¨setStateï¼‰</strong></font></h4><p>ç‚¹å‡»æŒ‰é’®å®ç°åŠ ä¸€çš„æ“ä½œ</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">on</span>Click = ()=&gt; &#123;</span><br><span class="line">   this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">       val: this.<span class="keyword">state</span>.val + <span class="number">1</span></span><br><span class="line">   &#125;)</span><br><span class="line">   console.<span class="keyword">log</span>('<span class="keyword">on</span>Click', this.<span class="keyword">state</span>.val);</span><br><span class="line"> &#125;</span><br><span class="line"> ...</span><br><span class="line"> render()&#123;</span><br><span class="line">console.<span class="keyword">log</span>('render', this.<span class="keyword">state</span>.val);</span><br><span class="line"> <span class="variable">&lt;button onClick=&#123;this.onClick&#125;&gt;</span>åŠ <span class="number">1</span>&lt;/button&gt;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆ è¿™æ˜¯<font color="red">åˆæˆäº‹ä»¶</font>ä¸­æ“ä½œ<code>state</code>,</p>
<p><strong>äº†è§£ä»€ä¹ˆæ˜¯åˆæˆäº‹ä»¶ï¼Ÿ</strong></p>
<blockquote>
<p>reactä¸ºäº†è§£å†³è·¨å¹³å°ï¼Œå…¼å®¹æ€§é—®é¢˜ï¼Œè‡ªå·±å°è£…äº†ä¸€å¥—äº‹ä»¶æœºåˆ¶ï¼Œä»£ç†äº†åŸç”Ÿçš„äº‹ä»¶ï¼Œåƒåœ¨jsxä¸­å¸¸è§çš„onClickã€onChangeè¿™äº›éƒ½æ˜¯åˆæˆäº‹ä»¶</p>
</blockquote>
<p>ç›¯ç€è¿™å¼ ç½‘ç»œç›—å›¾ï¼Œç”»çš„å®Œå…¨ç¬¦åˆæˆ‘çš„é¢„æœŸï¼Œå…ˆæœ‰ä¸ªæ¦‚è§ˆï¼Œä¸‹æ–‡ä¼šè·Ÿè¸ªè§£é‡Š</p>
<p><img src="/images/setState/setState__.jpg" alt="setStateçš„æ›´æ–°è¿‡ç¨‹"></p>
<p>å½“ä½ ç‚¹å‡»<code>onClick</code>æ—¶</p>
<ul>
<li>ç¬¬ä¸€é˜¶æ®µ ï¼ˆå¯¹åˆæˆäº‹ä»¶çš„å‰æœŸå¤„ç†ï¼‰</li>
</ul>
<p>reactä¼šåœ¨æ­£å¼<code>setState</code>å‰æ‰§è¡Œä¸€å †preé’©å­å‡½æ•°(<font color="red">å¤§éƒ¨åˆ†éƒ½ä¸éœ€è¦å…³å¿ƒ</font>),ä½ å¯ä»¥åœ¨chromeè°ƒè¯•å°æˆ–è€…<code>console.trace()</code>è¿½è¸ªåˆ°<br>åƒè¿™æ ·å„¿ğŸ‘‡<br><img src="/images/setState/trace.png" alt="trace"><br>è¿™äº›éƒ½æ˜¯reactçš„å‰æœŸå¤„ç† è¿™ä¸ªè¿‡ç¨‹ä½ åªéœ€è¦å…³å¿ƒğŸ‘‡</p>
<p><img src="/images/setState/pre11.png" alt="preé’©å­"></p>
<p>å¾—åˆ°çš„ä¿¡æ¯<br>isBatchingUpdatesé»˜è®¤ä¸ºfalse,åœ¨è¿™é‡Œ(æŸä¸€ä¸ªpreé’©å­å‡½æ•°ä¸­è¢«ç½®ä¸ºtrueäº†)ï¼Œåˆ’é‡ç‚¹ï¼Œä»¥åè¦è€ƒçš„ æ­¤æ—¶ç¨‹åºèµ°çš„æ˜¯<font color="red">tryåˆ†æ”¯</font></p>
<p>è‡³æ­¤ï¼Œå‰æœŸå¤„ç†ç»“æŸ</p>
<ul>
<li>ç¬¬äºŒé˜¶æ®µï¼ˆsetStateäº‹ä»¶çš„å¤„ç†ï¼‰</li>
</ul>
<p>çº¢æ¡†éƒ¨åˆ†æ˜¯<code>setState</code>é€»è¾‘çš„è°ƒç”¨æ ˆï¼Œæ‰§è¡Œåˆ°<code>requestWork</code>æ–¹æ³•æ—¶ä¼šäºŒæ¬¡åˆ¤æ–­ å¦‚ä¸‹å›¾ğŸ‘‡<br><img src="/images/setState/sasas.png" alt="sasas"></p>
<p>äºŒé˜¶æ®µå®Œ</p>
<ul>
<li>ç¬¬ä¸‰é˜¶æ®µï¼ˆé‡ç½®posté’©å­,æ›´æ–°state æ¸²æŸ“uiæ“ä½œï¼‰</li>
</ul>
<p>æ¥ä¸Šæ–‡ï¼Œé‚£ä¹ˆæˆ‘æƒ³çŸ¥é“å®ƒä¼šreturnåˆ°å“ªé‡Œå‘¢<br>é€šè¿‡è¿½è¸ªå‘ç° ä¼šèµ°ä½ ä¸»è¿›ç¨‹é‡Œçš„<code>console</code>è¯­å¥<br><img src="/images/setState/state_delay.png" alt="stateå»¶è¿Ÿæ›´æ–°"><br><strong>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¯´setStateæ›´å¼‚æ­¥çš„</strong><br>ä¸Šæ–‡ä¸­æåˆ°æˆ‘ä»¬ç°åœ¨ä»ç„¶å¤„åœ¨tryåˆ†æ”¯ä¸­ï¼Œè€Œåœ¨ finally ä¸­æ‰ä¼šæ›´æ–°<code>state</code>å¹¶ä¸”æ¸²æŸ“åˆ°UIä¸Šï¼Œæ­¤æ—¶æˆ‘ä»¬å¾—åˆ°çš„ä»ç„¶æ˜¯<code>æ›´æ–°å‰çš„ state</code> å€¼ï¼Œè¿™å°±å¯¼è‡´äº†<code>æ‰€è°“çš„&quot;å¼‚æ­¥&quot;</code>,ä¸ºä»€ä¹ˆè¦ç”¨<code>&quot;&quot;</code>å·,å› ä¸ºè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬çš„æœ¬æ„ï¼Œæ˜¯<code>reactä¸ºäº†æ€§èƒ½ç€æƒ³ç§è‡ªåšçš„å¤„ç†</code></p>
<hr>
<p>æ¥ç€å¾€ä¸‹èµ°ï¼š<br><img src="/images/setState/sssswww.png" alt="ssssww"><br>æœ€ç»ˆè¿˜ä¼šèµ°åˆ°è¿™ä¸ªæ–¹æ³•<br>è¿™ä¸ªæ–¹æ³•é‡Œé¢æœ‰ä¸ª try finally è¯­æ³•, åˆ°è¿™é‡Œ æˆ‘ä»¬çŸ¥é“äº†åŸæ¥returnåˆ°äº†è¿™ä¸ªfn<br>ç»§ç»­ğŸ‘‡<br><img src="/images/setState/post0.png" alt="posté’©å­"><br><img src="/images/setState/ui.png" alt="ui"></p>
<p>renderä¹‹å åˆæˆäº‹ä»¶ä¸­setStateçš„é€»è¾‘å°±ç»“æŸäº†</p>
<hr>
<h4 id="åœºæ™¯äºŒï¼ˆç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨setStateï¼‰"><a href="#åœºæ™¯äºŒï¼ˆç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨setStateï¼‰" class="headerlink" title="åœºæ™¯äºŒï¼ˆç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨setStateï¼‰"></a><font color="green"><strong>åœºæ™¯äºŒï¼ˆç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨setStateï¼‰</strong></font></h4><p>å®é™…ä¸Šä¸åœºæ™¯ä¸€åªåœ¨ç¬¬ä¸€é˜¶æ®µä¸åŒï¼ˆæ²¡æœ‰å¯¹åˆæˆäº‹ä»¶çš„å„ç§å¤„ç†ï¼‰æˆ‘ä»¬å¯èƒ½æƒ³åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸä¸­èŠä¸‹stateçš„æ›´æ–°çŠ¶å†µ</p>
<p>æˆ‘ä»¬ç…§ä¾‹å…ˆæ¥ä¸ªå°demo å†æ¥åˆ†æä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·å„¿çš„ç»“æœ</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">state</span> = &#123;</span><br><span class="line">   val:<span class="number">0</span>,</span><br><span class="line">   name:'yishu',</span><br><span class="line">   age:<span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"> componentWillMount()&#123;</span><br><span class="line">      this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">      console.<span class="keyword">log</span>('componentWillMountç¬¬ä¸€æ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val)</span><br><span class="line">      this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">      console.<span class="keyword">log</span>('componentWillMountç¬¬äºŒæ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val)</span><br><span class="line">    &#125;</span><br><span class="line">     componentDidMount()&#123;</span><br><span class="line">      this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">            val: this.<span class="keyword">state</span>.val + <span class="number">1</span>,</span><br><span class="line">            name:'ğŸ¶'</span><br><span class="line">        &#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬ä¸€æ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">            val: this.<span class="keyword">state</span>.val + <span class="number">1</span>,</span><br><span class="line">            name:'ğŸ±',</span><br><span class="line">            age:<span class="number">81</span></span><br><span class="line">        &#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬äºŒæ¬¡è¾“å‡º', this.<span class="keyword">state</span>.val)</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     componentDidUpdate()&#123;</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidUpdateæ‰§è¡Œ',this.<span class="keyword">state</span>.val)</span><br><span class="line">    &#125;</span><br><span class="line">render()&#123;</span><br><span class="line">      if(this.<span class="keyword">state</span>.val !==<span class="number">0</span>)&#123;</span><br><span class="line">            console.<span class="keyword">log</span>('renderæ‰§è¡Œ',this.<span class="keyword">state</span>)</span><br><span class="line">        &#125;</span><br><span class="line">  <span class="variable">&lt;p&gt;</span>å½“å‰çš„å€¼:&#123;this.<span class="keyword">state</span>.val&#125;&lt;/p&gt;</span><br><span class="line">  <span class="variable">&lt;p&gt;</span>ä½ çš„åå­—:&#123;this.<span class="keyword">state</span>.name&#125;&lt;/p&gt;</span><br><span class="line">  <span class="variable">&lt;p&gt;</span>èŠ³é¾„:&#123;this.<span class="keyword">state</span>.age&#125;&lt;/p&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥ç»™å‡ºç»“æœ</p>
<p><img src="/images/setState/component_state.png" alt="component_state"><br>å…¶å®ç»è¿‡å„ç§APIçš„ç†é™¶ï¼Œä¸è¿è¡Œä¹Ÿèƒ½çŸ¥é“ç»“æœ,æ—¢ç„¶æ‘Šå¼€æ¥è®²ï¼Œå°±æ¯”è¾ƒæƒ³çŸ¥é“ä¸ºä»€ä¹ˆã€‚</p>
<p>æŒ‰ç…§æµç¨‹ ï¼Œå…ˆæ¥ä¸€å¼ è°ƒç”¨æ ˆé¸Ÿç°å›¾ï¼ˆç½‘å›¾ï¼‰</p>
<p><img src="/images/setState/gouzihanshu.jpg" alt="é’©å­å‡½æ•°ä¸­setStateçš„è°ƒç”¨æ ˆ"><br>è¿˜æ˜¯ä¸‰ä¸ªé˜¶æ®µ</p>
<ul>
<li><p>ç¬¬ä¸€é˜¶æ®µ<br><img src="/images/setState/did.png" alt="did"></p>
</li>
<li><p>ç¬¬äºŒé˜¶æ®µ<br><img src="/images/setState/2121233434.png" alt="2121233434"><br>åˆ°ç°åœ¨å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œä¸åœºæ™¯ä¸€ä¸åŒçš„æ˜¯ èµ°çš„æ˜¯<code>requestWork</code>ä¸­çš„ç¬¬ä¸€ä¸ª<code>if</code>åˆ†æ”¯,åœºæ™¯ä¸€ï¼ˆç¬¬äºŒä¸ªifåˆ†æ”¯ï¼‰ä¸ç®¡å“ªç§æƒ…å†µ ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ é‚£å°±æ˜¯ä¸ä¼šèµ°åˆ°ä¸‹é¢çš„åŒæ­¥æ›´æ–°åˆ†æ”¯ å¹¶ä¸” ä¸¤ç§æƒ…å†µéƒ½è¿˜åªæ˜¯åœ¨<strong>try</strong>æ¨¡å—ä¸­æ‰§è¡Œ å†å¾€ä¸‹çš„æµç¨‹å‚è€ƒåœºæ™¯ä¸€</p>
</li>
<li><p>ç¬¬ä¸‰é˜¶æ®µ<br>åŒåœºæ™¯ä¸€</p>
</li>
</ul>
<p>å…³äºè¿™ä¸€åœºæ™¯ èƒŒç€</p>
<font color="red"><code>render</code>ä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸæ‹¿åˆ°çš„éƒ½æ˜¯æ›´æ–°ä¹‹å‰çš„å€¼ï¼Œrenderä¹‹åæ‰§è¡Œçš„æ‰èƒ½æ‹¿åˆ°æœ€æ–°çš„å€¼ æ¯”å¦‚ <code>componentDidUpdate</code></font>

<hr>
<h3 id="3-setStateå¯ä»¥å˜æˆåŒæ­¥æ›´æ–°å—ï¼Ÿ-å¦‚æœå¯ä»¥çš„è¯-æ€ä¹ˆåšæ‰èƒ½è·å–æœ€æ–°çš„å€¼ï¼Ÿ"><a href="#3-setStateå¯ä»¥å˜æˆåŒæ­¥æ›´æ–°å—ï¼Ÿ-å¦‚æœå¯ä»¥çš„è¯-æ€ä¹ˆåšæ‰èƒ½è·å–æœ€æ–°çš„å€¼ï¼Ÿ" class="headerlink" title="3. setStateå¯ä»¥å˜æˆåŒæ­¥æ›´æ–°å—ï¼Ÿ å¦‚æœå¯ä»¥çš„è¯ æ€ä¹ˆåšæ‰èƒ½è·å–æœ€æ–°çš„å€¼ï¼Ÿ"></a>3. setStateå¯ä»¥å˜æˆåŒæ­¥æ›´æ–°å—ï¼Ÿ å¦‚æœå¯ä»¥çš„è¯ æ€ä¹ˆåšæ‰èƒ½è·å–æœ€æ–°çš„å€¼ï¼Ÿ</h3><p>é¢è¯•å®˜è¿™ä¹ˆé—®çš„è¯ é€šå¸¸éƒ½æ˜¯å¯ä»¥ ğŸ˜‚<br>é‚£æˆ‘ä»¬å¦‚ä½•åš<br>å®è·µä¸­ä¸€èˆ¬æ¯ä¸ªäººéƒ½æœ‰ä¸€åˆ°ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œè¿™é‡Œåˆ—ä¸¾ä¸­å¤„ç†æ–¹æ¡ˆ å¹¶å°†åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­æ·±å…¥ç ”ç©¶ ä¸ºä»€ä¹ˆ å®ƒ å¯ä»¥.</p>
<ul>
<li>åœ¨<strong>åŸç”Ÿäº‹ä»¶</strong>ä¸­è°ƒç”¨<code>setState</code>å‡½æ•°</li>
<li>åˆ©ç”¨setStateå›è°ƒå‡½æ•°</li>
<li>setTimeoutç­‰å¼‚æ­¥æ“ä½œä¸­è°ƒç”¨<code>setState</code>å‡½æ•°</li>
<li>æœ€è¿‘åˆšè¢«ç§è‰çš„å‡½æ•°å¼setstateç”¨æ³•</li>
<li>componentDidUpdateä¸­è·å–</li>
</ul>
<p>åè¯é‡Šä¹‰ï¼š<br><strong>åŸç”Ÿäº‹ä»¶</strong>ï¼šæŒ‡éreactåˆæˆäº‹ä»¶ï¼ŒåŸç”Ÿè‡ªå¸¦çš„äº‹ä»¶ç›‘å¬ <code>addEventListener</code> ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç”¨åŸç”Ÿ<code>jsã€jq</code>ç›´æ¥ <code>document.querySelector().onclick</code> è¿™ç§ç»‘å®šäº‹ä»¶çš„å½¢å¼</p>
<hr>
<h4 id="åœ¨åŸç”Ÿäº‹ä»¶ä¸­è°ƒç”¨setStateå‡½æ•°"><a href="#åœ¨åŸç”Ÿäº‹ä»¶ä¸­è°ƒç”¨setStateå‡½æ•°" class="headerlink" title="åœ¨åŸç”Ÿäº‹ä»¶ä¸­è°ƒç”¨setStateå‡½æ•°"></a>åœ¨<strong>åŸç”Ÿäº‹ä»¶</strong>ä¸­è°ƒç”¨<code>setState</code>å‡½æ•°</h4><p>ä¸€ä¸ªå°demo</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">state</span> = &#123;</span><br><span class="line">   val:<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">componentDidMount = () =&gt;&#123;</span><br><span class="line"> document.querySelector('<span class="comment">#btn-raw').addEventListener('click', this.onClick);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">on</span>Click = ()=&gt; &#123;</span><br><span class="line">   this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">       val: this.<span class="keyword">state</span>.val + <span class="number">1</span></span><br><span class="line">   &#125;);</span><br><span class="line">   console.<span class="keyword">log</span>('<span class="keyword">on</span>Click', this.<span class="keyword">state</span>.val);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">render()&#123;</span><br><span class="line"> if(this.<span class="keyword">state</span>.val !==<span class="number">0</span>)&#123;</span><br><span class="line">            console.<span class="keyword">log</span>('renderæ‰§è¡Œ',this.<span class="keyword">state</span>)</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="variable">&lt;button id="btn-raw"&gt;</span>Increment &lt;/button&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœ<br><img src="/images/setState/js.png" alt="js"><br>æ„æ–™ä¹‹ä¸­</p>
<p>æŒ‰ç†æ¥è¯´è¿˜éœ€è¦å¼ é¸Ÿç°å›¾ åœ¨è¿™é‡Œ ğŸ‘‡</p>
<p><img src="/images/setState/js0setState.jpg" alt="åŸç”Ÿäº‹ä»¶çš„setState"></p>
<p>å…¶å®åº”è¯¥å·²ç»æŒºæ¸…æ™°äº†ï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨è°ƒè¯•å™¨é‡Œèµ°ä¸€ä¸‹</p>
<ul>
<li>ç¬¬ä¸€é˜¶æ®µï¼ˆsetStateé€»è¾‘ä¹‹å‰çš„å¤„ç†ï¼‰</li>
</ul>
<p><img src="/images/setState/js_xzs.png" alt="js_xzs"><br>ç”»é£çªå˜ï¼Œè°ƒç”¨æ ˆå†…ä¸å†æ‰§è¡Œä¸€å †çœ‹ä¸æ‡‚çš„preé’©å­å‡½æ•°äº†<br>ç®€å•çš„ç†è§£ä¸º ç”¨åŸç”Ÿäº‹ä»¶è°ƒç”¨æ—¶ ä¸å—reactæ§åˆ¶äº† ä¹Ÿå°±æ²¡åŠæ³•é’ˆå¯¹å®ƒæ‰§è¡Œä¸€å †å‡½æ•°ï¼Œç›´æ¥èµ°setStateçš„é€»è¾‘äº†</p>
<ul>
<li>ç¬¬äºŒé˜¶æ®µï¼ˆsetStateæ‰§è¡Œé€»è¾‘ï¼‰</li>
</ul>
<p><img src="/images/setState/js999.png" alt="js999"></p>
<p>èµ°äº†ç¬¬ä¸‰ä¸ª<code>if</code>åˆ†æ”¯ åŒæ­¥æ›´æ–°äº†ï¼ˆæ‰§è¡Œäº†render å†åœ¨clickå‡½æ•°ä¸­æ‰“å°çš„ æ‰€ä»¥æ‹¿åˆ°äº†æœ€æ–°å€¼ï¼‰</p>
<ul>
<li>ç¬¬ä¸‰é˜¶æ®µ</li>
</ul>
<p>å‚è€ƒåœºæ™¯ä¸€</p>
<hr>
<h4 id="åˆ©ç”¨setStateå›è°ƒå‡½æ•°"><a href="#åˆ©ç”¨setStateå›è°ƒå‡½æ•°" class="headerlink" title="åˆ©ç”¨setStateå›è°ƒå‡½æ•°"></a>åˆ©ç”¨setStateå›è°ƒå‡½æ•°</h4><p>APIå°±ä¸å¤šè¯´äº†</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"> this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">       val:this.<span class="keyword">state</span>.val + <span class="number">1</span></span><br><span class="line">        &#125;,()=&gt;&#123;</span><br><span class="line">          console.<span class="keyword">log</span>('cllback',this.<span class="keyword">state</span>.val);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åŸç†ï¼šå›è°ƒå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå…¶å®renderå‡½æ•°å·²ç»è¢«è°ƒç”¨è¿‡äº† å‚è€ƒ<code>demo</code>çš„æ‰§è¡Œç»“æœ</p>
<hr>
<h4 id="setTimeoutç­‰å¼‚æ­¥æ“ä½œä¸­è°ƒç”¨setStateå‡½æ•°"><a href="#setTimeoutç­‰å¼‚æ­¥æ“ä½œä¸­è°ƒç”¨setStateå‡½æ•°" class="headerlink" title="setTimeoutç­‰å¼‚æ­¥æ“ä½œä¸­è°ƒç”¨setStateå‡½æ•°"></a>setTimeoutç­‰å¼‚æ­¥æ“ä½œä¸­è°ƒç”¨<code>setState</code>å‡½æ•°</h4><p>å®é™…ä¸Š è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„åœºæ™¯ï¼Œä½ å¯ä»¥åœ¨åˆæˆäº‹ä»¶ä¸­ è°ƒç”¨ <code>setTimeout</code> ï¼Œå¯ä»¥åœ¨ç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨ <code>setTimeout</code> ï¼Œä¹Ÿå¯ä»¥åœ¨åŸç”Ÿäº‹ä»¶<code>setTimeout</code>ï¼Œä½†æ˜¯ä¸ç®¡æ˜¯å“ªä¸ªåœºæ™¯ä¸‹ï¼ŒåŸºäº <code>event loop</code>çš„æ¨¡å‹ä¸‹ï¼Œ setTimeout ä¸­é‡Œå» setState æ€»èƒ½æ‹¿åˆ°æœ€æ–°çš„stateå€¼</p>
<p>ä¸€ä¸ªdemo ğŸ‘‡</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">this.<span class="keyword">state</span> = &#123;</span><br><span class="line">       val:<span class="number">0</span>,</span><br><span class="line">       name:'yishu',</span><br><span class="line">       age:<span class="number">18</span></span><br><span class="line">   &#125;</span><br><span class="line">       componentDidMount()&#123;</span><br><span class="line">        // // debugger;</span><br><span class="line">        // // ç”Ÿå‘½å‘¨æœŸä¸­è°ƒç”¨---------------</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">            val: this.<span class="keyword">state</span>.val + <span class="number">1</span>,</span><br><span class="line">            name:'ğŸ¶'</span><br><span class="line">        &#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬ä¸€æ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">            val: this.<span class="keyword">state</span>.val + <span class="number">1</span>,</span><br><span class="line">            name:'ğŸ±',</span><br><span class="line">            age:<span class="number">81</span></span><br><span class="line">        &#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬äºŒæ¬¡è¾“å‡º', this.<span class="keyword">state</span>.val)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">set</span>Timeout(() =&gt; &#123;</span><br><span class="line">            console.<span class="keyword">log</span>('å¼€å§‹<span class="built_in">set</span>Timeout', this.<span class="keyword">state</span>.val)</span><br><span class="line">            this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">                val: this.<span class="keyword">state</span>.val + <span class="number">1</span></span><br><span class="line">            &#125;);</span><br><span class="line">            console.<span class="keyword">log</span>('<span class="built_in">set</span>Timeoutç¬¬ä¸€æ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">            this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">                val: this.<span class="keyword">state</span>.val + <span class="number">1</span></span><br><span class="line">            &#125;);</span><br><span class="line">            console.<span class="keyword">log</span>('<span class="built_in">set</span>Timeoutç¬¬äºŒæ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">        &#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;</span><br><span class="line">            val: this.<span class="keyword">state</span>.val + <span class="number">1</span></span><br><span class="line">        &#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬ä¸‰æ¬¡è¾“å‡º', this.<span class="keyword">state</span>.val)        </span><br><span class="line">    &#125;</span><br><span class="line">render()&#123;</span><br><span class="line">if(this.<span class="keyword">state</span>.val !==<span class="number">0</span>)&#123;</span><br><span class="line">            console.<span class="keyword">log</span>('renderæ‰§è¡Œ',this.<span class="keyword">state</span>)</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="variable">&lt;p&gt;</span>å½“å‰çš„å€¼:&#123;this.<span class="keyword">state</span>.val&#125;&lt;/p&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/setState/setTimeout.png" alt="setTimeout"><br>ä¸Šè¿°ç»“æœï¼Œå¦‚æœä½ äº†è§£<font color="red">jsäº‹ä»¶å¾ªç¯ï¼ˆ event loopï¼‰</font>çš„æœºåˆ¶ å°±å¤ªç®€å•äº†</p>
<p>é»˜è®¤ä½ å·²ç»é˜…è¯»è¿‡å…¨æ–‡çš„ä¸ŠåŠéƒ¨åˆ† äº†è§£äº† <code>setState</code>é€»è¾‘éƒ½æ˜¯åœ¨<strong>try</strong>æ¨¡å—ä¸­æ‰§è¡Œçš„,æ­¤æ—¶å½“æ‰§è¡Œåˆ° <code>setTimeout</code> çš„æ—¶å€™ï¼ŒæŠŠå®ƒä¸¢åˆ°<strong>å®šæ—¶å™¨è§¦å‘çº¿ç¨‹(æµè§ˆå™¨æä¾›çš„çº¿ç¨‹)</strong>å»ç»´æŠ¤ï¼Œå¹¶æ²¡æœ‰ç«‹å³æ‰§è¡Œï¼Œå…ˆæ‰§è¡Œçš„ <code>finally</code> ä»£ç å—ï¼Œç­‰ finally æ‰§è¡Œå®Œäº†ï¼Œ <code>isBatchingUpdates</code> åˆå˜ä¸ºäº† <code>false</code> ï¼Œå¯¼è‡´æœ€åå»æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ setState æ—¶å€™ï¼Œ requestWork èµ°çš„æ˜¯å’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·çš„ <code>expirationTime === Sync if</code>åˆ†æ”¯ï¼Œæ‰€ä»¥è¡¨ç°å°±ä¼šå’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·ï¼Œå¯ä»¥åŒæ­¥æ‹¿åˆ°æœ€æ–°çš„<code>state</code>å€¼ã€‚</p>
<p>å…³äºjsäº‹ä»¶å¾ªç¯ åˆæ˜¯å¦ä¸€ä¸ªæ¨¡å—å„¿çš„ä¸œè¥¿ å€¼å¾—å•å¼€ä¸€ç« å»ç ”ç©¶ï¼Œè¿™é‡Œå°±ä¸å†ç»†è¯´äº† æ„Ÿå…´è¶£çš„åŒå­¦ å¯ç§»æ­¥<br><a href="http://maying.ink/2018/11/17/%E5%BD%BB%E5%BA%95%E7%90%86%E8%A7%A3js%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/#more">jsåˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„</a> å¯»æ‰¾ç­”æ¡ˆ</p>
<hr>
<h3 id="4-å‡½æ•°å¼setStateç”¨æ³•"><a href="#4-å‡½æ•°å¼setStateç”¨æ³•" class="headerlink" title="4. å‡½æ•°å¼setStateç”¨æ³•"></a>4. å‡½æ•°å¼setStateç”¨æ³•</h3><p>æˆ‘åœ¨æƒ³ æ€ä¹ˆæ‰èƒ½æ›´å¥½å¼•å‡ºè¿™ä¸ªå¤§å½©è›‹ï¼Œé‚£ä¾¿åˆæ¶‰åŠåˆ°å¦ä¸€ä¸ªé—®é¢˜<br>ä»¥ä¸Šæ–‡ç« ä¸­æˆ‘ä»¬ä¸ºäº†è¯´æ˜<code>setStateæ‰§è¡Œçš„å¤§æµç¨‹</code> æœ‰ä¸€ä¸ªå®é™…å­˜åœ¨å´æ²¡æåŠçš„é—®é¢˜ï¼Œé‚£å°±æ˜¯<code>setStateçš„æ‰¹é‡æ›´æ–°</code></p>
<p>ç±»ä¼¼è¿™æ ·å„¿çš„ä»£ç </p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">//...</span><br><span class="line">this.<span class="built_in">set</span>State(&#123;val: this.<span class="keyword">state</span>.val + <span class="number">1</span>&#125;);</span><br><span class="line">console.<span class="keyword">log</span>('componentDidMountç¬¬ä¸€æ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">this.<span class="built_in">set</span>State(&#123;val: this.<span class="keyword">state</span>.val + <span class="number">1</span>&#125;);</span><br><span class="line">console.<span class="keyword">log</span>('componentDidMountç¬¬äºŒæ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">this.<span class="built_in">set</span>State(&#123;val: this.<span class="keyword">state</span>.val + <span class="number">1</span>&#125;);</span><br><span class="line">console.<span class="keyword">log</span>('componentDidMountç¬¬ä¸‰æ¬¡æ‰§è¡Œ', this.<span class="keyword">state</span>.val)</span><br><span class="line">//...</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„æ‰§è¡Œç»“æœ<br><img src="/images/setState/render.png" alt="rende"></p>
<p>APIå‘Šè¯‰æˆ‘å¯ä»¥æ¥å—ï¼Œä½†æ˜¯æœ‰ç‚¹ç‚¹æ‡µ å‘ç”Ÿäº†ä»€ä¹ˆâ€¦ emm<br>å‡å¦‚è¿™ä¹ˆå†™ ä¼šä¸ä¼šæ›´æ¸…æ™°ğŸ‘‡</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> currentCount = <span class="keyword">this</span>.state.count;</span><br><span class="line"><span class="keyword">this</span>.setState(&#123;count: currentCount + <span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">this</span>.setState(&#123;count: currentCount + <span class="number">1</span>&#125;);</span><br><span class="line"><span class="keyword">this</span>.setState(&#123;count: currentCount + <span class="number">1</span>&#125;);</span><br></pre></td></tr></table></figure>
<p>å¯¹çš„ ä½ æ¯æ¬¡è®¾ç½®çš„éƒ½æ˜¯åŒä¸€ä¸ªå€¼<br>setStateå¤šæ¬¡,re-renderä¸€æ¬¡ï¼Œå¤šæ¬¡åŒæ­¥æ‰§è¡Œçš„<code>setState</code>ï¼Œä¼šè¿›è¡Œåˆå¹¶ï¼Œç±»ä¼¼äº<code>Object.assign</code>,ç›¸åŒçš„<code>key</code>ä¼šè¢«è¦†ç›– æ‰€ä»¥ç»“æœä¸º<font color="red">1</font></p>
<p>ä¸ºäº†ä¸åé¢˜ å®ç°è¿‡ç¨‹æš‚æ—¶çœç•¥,æ¥å—è¿™ä¸ªç»“è®º,è®©æˆ‘ä»¬çœ‹å‡½æ•°å¼setStateç”¨æ³•</p>
<font color="red">å¦‚æœä¼ é€’ç»™this.setStateçš„å‚æ•°<code>ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡è€Œæ˜¯ä¸€ä¸ªå‡½æ•°</code> é‚£å°±å®Œå…¨ä¸ä¸€æ ·å„¿äº†</font>

<p>ä¸€ä¸ªå°ğŸŒ°ä½“éªŒä¸‹ç¥å¥‡çš„æ•ˆæœ</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">componentDidMound = () =&gt;&#123;</span><br><span class="line">        console.<span class="keyword">log</span>('å‚æ•°ä¸ºå‡½æ•°ç¬¬ä¸€æ¬¡æ‰§è¡Œ',this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(this.increment);</span><br><span class="line">        console.<span class="keyword">log</span>('å‚æ•°ä¸ºå‡½æ•°ç¬¬äºŒæ¬¡æ‰§è¡Œ',this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(this.increment);</span><br><span class="line">        console.<span class="keyword">log</span>('å‚æ•°ä¸ºå‡½æ•°ç¬¬ä¸‰æ¬¡æ‰§è¡Œ',this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(this.increment);</span><br><span class="line">        console.<span class="keyword">log</span>('å‚æ•°ä¸ºå‡½æ•°ç¬¬å››æ¬¡æ‰§è¡Œ',this.<span class="keyword">state</span>.val)</span><br><span class="line">&#125;</span><br><span class="line">   /**</span><br><span class="line">     * @description incrementå‡½æ•°å¹¶ä¸å»ä¿®æ”¹ç»„ä»¶çŠ¶æ€ï¼Œåªæ˜¯æŠŠâ€œå¸Œæœ›çš„çŠ¶æ€æ”¹å˜â€è¿”å›ç»™Reactï¼Œç»´æŠ¤çŠ¶æ€è¿™äº›è‹¦åŠ›æ´»å®Œå…¨äº¤ç»™Reactå»åšã€‚</span><br><span class="line">     * params  <span class="keyword">state</span>ï¼šå½“å‰çš„<span class="keyword">state</span></span><br><span class="line">     * params  propsï¼šå½“å‰çš„props</span><br><span class="line">     * @return å¯¹è±¡ä»£è¡¨ä¹‹å‰ä½ æƒ³ç»™this.<span class="built_in">set</span>Stateä¼ é€’çš„å‚æ•° æ¯”å¦‚ä½ è®¤ä¸ºç¬¬ä¸€æ¬¡ä¼ <span class="number">0</span> ç¬¬äºŒæ¬¡ä¼ <span class="number">1</span> </span><br><span class="line">     * @memberof SetState</span><br><span class="line">     */</span><br><span class="line">    increment = (<span class="keyword">state</span>, props) =&gt; &#123;</span><br><span class="line">        // è®¡ç®—è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•æœ‰äº›æ”¹å˜ï¼Œä¸å†ä¾èµ–äºthis.<span class="keyword">state</span>ï¼Œè€Œæ˜¯ä¾èµ–äºè¾“å…¥å‚æ•°<span class="keyword">state</span>ã€‚</span><br><span class="line">        console.<span class="keyword">log</span>('---state',<span class="keyword">state</span>) </span><br><span class="line">        return &#123;val: <span class="keyword">state</span>.val + <span class="number">1</span>&#125;; //åŒæ ·æ˜¯æŠŠçŠ¶æ€ä¸­çš„countåŠ <span class="number">1</span>ï¼Œä½†æ˜¯çŠ¶æ€çš„æ¥æºä¸æ˜¯this.<span class="keyword">state</span>ï¼Œè€Œæ˜¯è¾“å…¥å‚æ•°<span class="keyword">state</span>ã€‚</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/setState/fn_state.png" alt="fn_state"><br>ä»”ç»†çœ‹ä¸‹ä»£ç ä¸­çš„æ³¨é‡Šéƒ¨åˆ†<br>ç»“è®ºï¼š<br>å¯¹äºå¤šæ¬¡è°ƒç”¨å‡½æ•°å¼setStateçš„æƒ…å†µï¼ŒReactä¼šä¿è¯è°ƒç”¨æ¯æ¬¡incrementæ—¶ï¼Œstateéƒ½å·²ç»åˆå¹¶äº†ä¹‹å‰çš„çŠ¶æ€ä¿®æ”¹ç»“æœã€‚<br>ä½†æ˜¯ åœ¨<code>increment</code>å‡½æ•°è¢«è°ƒç”¨æ—¶<code>ï¼Œthis.state</code>å¹¶æ²¡æœ‰è¢«æ”¹å˜ï¼Œä¾ç„¶è¦ç­‰åˆ°<code>render</code>å‡½æ•°è¢«é‡æ–°æ‰§è¡Œæ—¶æ‰è¢«æ”¹å˜ï¼Œä¹Ÿæ²¡æœ‰æ¨ç¿»ä¸Šæ–‡çš„ç»“è®º çœŸå¥½ã€‚</p>
<p>APIçš„è®¾è®¡ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œå¼€å‘è€…ç¼–å†™æ— å‰¯ä½œç”¨çš„å‡½æ•° increment å¹¶ä¸ä¼šå»æ”¹å˜ç»„ä»¶çŠ¶æ€ï¼Œåªæ˜¯æŠŠâ€œå¸Œæœ›çš„çŠ¶æ€æ”¹å˜â€è¿”å›ç»™Reactï¼Œç»´æŠ¤çŠ¶æ€è¿™äº›è‹¦åŠ›æ´»å®Œå…¨äº¤ç»™Reactå»åšã€‚<br>ä¹Ÿæ­£æ˜¯ æµç¨‹çš„æ§åˆ¶æƒäº¤ç»™äº†Reactï¼Œæ‰€ä»¥Reactæ‰èƒ½åè°ƒå¤šä¸ªsetStateè°ƒç”¨çš„å…³ç³»ã€‚</p>
<h3 id="4-æ‰‹åŠ¨é¿å…setStateçš„ä¸å½“è°ƒç”¨å¸¦æ¥çš„æ€§èƒ½é—®é¢˜"><a href="#4-æ‰‹åŠ¨é¿å…setStateçš„ä¸å½“è°ƒç”¨å¸¦æ¥çš„æ€§èƒ½é—®é¢˜" class="headerlink" title="4. æ‰‹åŠ¨é¿å…setStateçš„ä¸å½“è°ƒç”¨å¸¦æ¥çš„æ€§èƒ½é—®é¢˜"></a>4. æ‰‹åŠ¨é¿å…setStateçš„ä¸å½“è°ƒç”¨å¸¦æ¥çš„æ€§èƒ½é—®é¢˜</h3><p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±æ¸…æ¥šäº†setStateæ‰§è¡Œæœºåˆ¶ï¼Œé‚£ä¹ˆ æˆ‘ä»¬åº”è¯¥æ€æ ·å„¿åˆ©ç”¨è‡ªå·±çš„çŸ¥è¯†æ‰‹åŠ¨ä¼˜åŒ–é¡µé¢æ€§èƒ½å‘¢</p>
<p>è¿™é‡Œåˆ—ä¸¾äº†å‡ æ¡</p>
<ul>
<li>é™¤äº†ç‰¹æ®Šéœ€æ±‚ å°½é‡ä¸è¦åœ¨éåˆæˆäº‹ä»¶ä¸­è°ƒç”¨<code>setState</code> è¿™æ ·å„¿ä¼šå¤±æ§ å˜æˆçœŸçš„åŒæ­¥æ›´æ–°äº† æ¯æ¬¡æ›´æ–°éƒ½ä¼šèµ°render èµ°renderå°±ä¸å¯é¿å…çš„æ¶‰åŠåˆ° <code>diffå¯¹æ¯”</code>.. æ›´æ–°è¿‡ç¨‹å¾ˆé¢‘ç¹ï¼Œä¹Ÿå°±ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</li>
<li>ä¸è¦åœ¨ <code>shouldComponentUpdate</code> å’Œ <code>componentWillUpdate</code> ä¸­è°ƒç”¨ setState ä¼šé€ æˆå¾ªç¯<br><img src="/images/setState/xunhuan.jpg" alt="xunhuan"></li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>setStateä¸ä¼šç«‹åˆ»æ”¹å˜Reactç»„ä»¶ä¸­stateçš„å€¼ï¼›</li>
<li>setStateé€šè¿‡å¼•å‘ä¸€æ¬¡ç»„ä»¶çš„æ›´æ–°è¿‡ç¨‹æ¥å¼•å‘é‡æ–°ç»˜åˆ¶ï¼›</li>
<li>å¤šæ¬¡setStateå‡½æ•°è°ƒç”¨äº§ç”Ÿçš„æ•ˆæœä¼šåˆå¹¶ã€‚</li>
<li>setState åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’ŒsetTimeout ä¸­éƒ½æ˜¯åŒæ­¥çš„ï¼Œæ‰¹é‡æ›´æ–°çš„ç­–ç•¥æ˜¯åŸºäºâ€å¼‚æ­¥â€ä¹‹ä¸Šçš„ï¼Œåœ¨setTimeoutå’ŒåŸç”Ÿäº‹ä»¶ä¸­æ˜¯æ²¡æœ‰çš„ï¼Œå› ä¸ºæ­¤æ—¶æ—¶ä¸å—æ§çš„</li>
<li>setState çš„â€œå¼‚æ­¥â€å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®ç°ï¼Œå…¶å®æœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œå½¢æˆäº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ï¼Œä¹Ÿæœ‰è§£å†³æ–¹æ¡ˆå¯ä»¥ç›´æ¥æ‹¿åˆ°æœ€æ–°çš„å€¼</li>
<li>setState çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨â€œå¼‚æ­¥â€ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’ŒsetTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨â€œå¼‚æ­¥â€ä¸­å¦‚æœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡setStateï¼ŒsetStateçš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå–æœ€åä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æœæ˜¯åŒæ—¶setStateå¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚</li>
<li>åƒå†™å—æ§ç»„ä»¶é‚£æ ·å„¿å»æ“ä½œsetState</li>
</ul>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://zhuanlan.zhihu.com/p/39512941" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/39512941</a><br>        <a href="https://zhuanlan.zhihu.com/p/25990883" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/25990883</a></p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>setState</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Node.jsé€æ­¥å»ºç«‹å¤šè·¯å¤ç”¨çš„RPCé€šé“</title>
    <url>/2020/03/23/rpc/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¾æ‰˜Nodejsä½¿ç”¨ <code>Buffer</code>  <code>net</code>ç­‰æ¨¡å—é€æ­¥æ„å»ºæ»¡è¶³åº”ç”¨åœºæ™¯çš„RPCé€šé“</p>
<h1 id="1-RPCè°ƒç”¨"><a href="#1-RPCè°ƒç”¨" class="headerlink" title="1. RPCè°ƒç”¨"></a>1. RPCè°ƒç”¨</h1><p>RPC</p>
<p>å…¨ç§° <code>Remote Procedure Call</code> ç¿»è¯‘æˆä¸­æ–‡ï¼šè¿œç¨‹è¿‡ç¨‹è°ƒç”¨</p>
<p>emm.. æˆ‘åªæ˜¯ä¸ªå°å‰ç«¯..</p>
<p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1584877960225&amp;di=1beedaa2bf83dbc8d438dc36164af7d3&amp;imgtype=0&amp;src=http%3A%2F%2Fimg3.cache.netease.com%2Fphoto%2F0005%2F2013-02-20%2F8O5Q4R5K0AI90005.jpg" alt="image"></p>
<h2 id="1-1-å¦‚ä½•é€šä¿—çš„è§£é‡Šæ˜¯RPCï¼Ÿ"><a href="#1-1-å¦‚ä½•é€šä¿—çš„è§£é‡Šæ˜¯RPCï¼Ÿ" class="headerlink" title="1.1 å¦‚ä½•é€šä¿—çš„è§£é‡Šæ˜¯RPCï¼Ÿ"></a>1.1 å¦‚ä½•é€šä¿—çš„è§£é‡Šæ˜¯RPCï¼Ÿ</h2><h3 id="1-1-1-æœ¬åœ°è¿‡ç¨‹è°ƒç”¨"><a href="#1-1-1-æœ¬åœ°è¿‡ç¨‹è°ƒç”¨" class="headerlink" title="1.1.1 æœ¬åœ°è¿‡ç¨‹è°ƒç”¨"></a>1.1.1 æœ¬åœ°è¿‡ç¨‹è°ƒç”¨</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆ‘ç°åœ¨åœ¨å®¶é‡Œï¼Œæˆ‘éœ€è¦æ´—è¡£æœï¼Œå°±æŠŠè¡£æœæ‰”åˆ°æ´—è¡£æœºæ´—äº†</span><br></pre></td></tr></table></figure>
<h3 id="1-1-2-è¿œç¨‹è¿‡ç¨‹è°ƒç”¨-RPC"><a href="#1-1-2-è¿œç¨‹è¿‡ç¨‹è°ƒç”¨-RPC" class="headerlink" title="1.1.2 è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(RPC)"></a>1.1.2 è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(RPC)</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æˆ‘ç°åœ¨åœ¨é€›è¡—ï¼Œæˆ‘éœ€è¦æ´—è¡£æœï¼Œäºæ˜¯ç»™åœ¨å®¶é‡Œçš„ç”·ç¥¨æ‰“ä¸ªå“¥ç”µè¯ï¼Œä»–æŠŠè¡£æœæ‰”åˆ°æ´—è¡£æœºæ´—äº†</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆæˆ‘å°±å®ç°äº†RPCè°ƒç”¨ï¼ï¼</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="1-2-ä»å‰ç«¯çš„è§’åº¦ä¸Šæ¥ç†è§£RPCè°ƒç”¨ï¼Ÿ"><a href="#1-2-ä»å‰ç«¯çš„è§’åº¦ä¸Šæ¥ç†è§£RPCè°ƒç”¨ï¼Ÿ" class="headerlink" title="1.2 ä»å‰ç«¯çš„è§’åº¦ä¸Šæ¥ç†è§£RPCè°ƒç”¨ï¼Ÿ"></a>1.2 ä»å‰ç«¯çš„è§’åº¦ä¸Šæ¥ç†è§£RPCè°ƒç”¨ï¼Ÿ</h2><p>ä»æˆ‘ä»¬ç†Ÿæ‚‰çš„Ajaxå…¥æ‰‹ï¼Œå®ƒä¸RPCè°ƒç”¨ç±»ä¼¼ï¼Œæˆ‘ä»¬æ¥å¯¹æ¯”ä¸€ä¸‹</p>
<h3 id="1-2-1-ç›¸åŒç‚¹"><a href="#1-2-1-ç›¸åŒç‚¹" class="headerlink" title="1.2.1 ç›¸åŒç‚¹"></a>1.2.1 ç›¸åŒç‚¹</h3><h4 id="1-2-1-1-éƒ½æ˜¯ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´çš„ç½‘ç»œé€šä¿¡"><a href="#1-2-1-1-éƒ½æ˜¯ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´çš„ç½‘ç»œé€šä¿¡" class="headerlink" title="1.2.1.1 éƒ½æ˜¯ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´çš„ç½‘ç»œé€šä¿¡"></a>1.2.1.1 éƒ½æ˜¯ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´çš„ç½‘ç»œé€šä¿¡</h4><ul>
<li>Ajaxï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„é€šä¿¡</li>
<li>PRCï¼šæœåŠ¡å™¨å’Œå¦å¤–ä¸€å°æœåŠ¡å™¨çš„é€šä¿¡</li>
</ul>
<p>çœ‹å›¾è¯´è¯</p>
<p><img src="http://cdn.anruence.com/rpc.png" alt="image"></p>
<h4 id="1-2-1-2-éœ€è¦åŒæ–¹çº¦å®šä¸€ä¸ªæ•°æ®æ ¼å¼"><a href="#1-2-1-2-éœ€è¦åŒæ–¹çº¦å®šä¸€ä¸ªæ•°æ®æ ¼å¼" class="headerlink" title="1.2.1.2 éœ€è¦åŒæ–¹çº¦å®šä¸€ä¸ªæ•°æ®æ ¼å¼"></a>1.2.1.2 éœ€è¦åŒæ–¹çº¦å®šä¸€ä¸ªæ•°æ®æ ¼å¼</h4><h3 id="1-2-2-ä¸åŒç‚¹"><a href="#1-2-2-ä¸åŒç‚¹" class="headerlink" title="1.2.2 ä¸åŒç‚¹"></a>1.2.2 ä¸åŒç‚¹</h3><h4 id="1-2-2-1-ä¸ä¸€å®šä½¿ç”¨DNSä½œä¸ºå¯»å€æœåŠ¡"><a href="#1-2-2-1-ä¸ä¸€å®šä½¿ç”¨DNSä½œä¸ºå¯»å€æœåŠ¡" class="headerlink" title="1.2.2.1 ä¸ä¸€å®šä½¿ç”¨DNSä½œä¸ºå¯»å€æœåŠ¡"></a>1.2.2.1 ä¸ä¸€å®šä½¿ç”¨DNSä½œä¸ºå¯»å€æœåŠ¡</h4><ul>
<li>Ajax æ˜¯å‘ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œä½¿ç”¨DNSè¿›è¡Œå¯»å€æœåŠ¡</li>
</ul>
<p>è¯·æ±‚è¿‡ç¨‹<br><img src="http://cdn.anruence.com/dns.png" alt="image"></p>
<ul>
<li>RPCé€šä¿¡ä¸€èˆ¬æ˜¯åœ¨å†…ç½‘è¿›è¡Œè¯·æ±‚ï¼Œä½¿ç”¨ç‰¹æœ‰çš„æœåŠ¡ï¼ˆæ¯”å¦‚idï¼‰<br>è¯·æ±‚è¿‡ç¨‹<br><img src="http://cdn.anruence.com/rpcxunzhi.png" alt="image"></li>
</ul>
<h4 id="1-2-2-2-åº”ç”¨å±‚åè®®ä¸€èˆ¬ä¸ä½¿ç”¨HTTP"><a href="#1-2-2-2-åº”ç”¨å±‚åè®®ä¸€èˆ¬ä¸ä½¿ç”¨HTTP" class="headerlink" title="1.2.2.2 åº”ç”¨å±‚åè®®ä¸€èˆ¬ä¸ä½¿ç”¨HTTP"></a>1.2.2.2 åº”ç”¨å±‚åè®®ä¸€èˆ¬ä¸ä½¿ç”¨HTTP</h4><p>Ajaxï¼šä½¿ç”¨HTTPæ–‡æœ¬åè®®ï¼ˆhtml,jsonï¼‰<br>RPC:æœåŠ¡ç«¯ä¹‹é—´çš„é€šä¿¡ï¼Œå¯¹æ•ˆç‡è¦æ±‚æ›´é«˜æ‰€ä»¥ä½¿ç”¨ä¸€äº›äºŒè¿›åˆ¶åè®®å–ä»£HTTPï¼ŒäºŒè¿›åˆ¶åè®®æ€§èƒ½ä¸Šå­˜åœ¨ä¼˜åŠ¿</p>
<ul>
<li>æ›´å°çš„æ•°æ®åŒ…</li>
<li>æ›´å¿«çš„ç¼–ç é€Ÿç‡</li>
</ul>
<h4 id="1-2-2-3-åŸºäºTCP-UDPåè®®"><a href="#1-2-2-3-åŸºäºTCP-UDPåè®®" class="headerlink" title="1.2.2.3 åŸºäºTCP/UDPåè®®"></a>1.2.2.3 åŸºäºTCP/UDPåè®®</h4><ul>
<li>æµè§ˆå™¨è°ƒç”¨ï¼ˆAjaxï¼‰ä½¿ç”¨ TCPæ˜¯éµå¾ªHTTPçš„è§„èŒƒ</li>
<li>RPCè°ƒç”¨ä½¿ç”¨äº†TCPå¤šç§é€šä¿¡æ–¹å¼<ol>
<li>å•å·¥é€šä¿¡ï¼ˆç‹¬æœ¨æ¡¥ï¼‰</li>
</ol>
</li>
</ul>
<p>ç±»æ¯”ç‹¬æœ¨æ¡¥ï¼Œä¸¤å²¸åŒä¸€æ—¶é—´å†…åªèƒ½æœ‰ä¸€æ–¹é€šè¿‡<br><img src="http://cdn.anruence.com/dangong.png" alt="image"></p>
<pre><code>1.   åŠåŒå·¥é€šä¿¡ï¼ˆè½®ç•ªå•å·¥é€šä¿¡ï¼Œç‹¬æœ¨æ¡¥ï¼‰
</code></pre><p><img src="http://cdn.anruence.com/banshuanggongtongxin.png" alt="image"></p>
<pre><code>1.   å…¨åŒå·¥é€šä¿¡
</code></pre><p><img src="http://cdn.anruence.com/quanshuanggongtongxiin.png" alt="image"></p>
<h2 id="2-ä½¿ç”¨Buffterç¼–è§£ç äºŒè¿›åˆ¶æ•°æ®åŒ…"><a href="#2-ä½¿ç”¨Buffterç¼–è§£ç äºŒè¿›åˆ¶æ•°æ®åŒ…" class="headerlink" title="2. ä½¿ç”¨Buffterç¼–è§£ç äºŒè¿›åˆ¶æ•°æ®åŒ…"></a>2. ä½¿ç”¨Buffterç¼–è§£ç äºŒè¿›åˆ¶æ•°æ®åŒ…</h2><p>ç”¨æ¥å¤„ç†TCPé“¾æ¥ä¸­çš„æµä»¥åŠæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®</p>
<p><a href="http://nodejs.cn/api/buffer.html" target="_blank" rel="noopener">Bufferå®˜æ–¹ä»‹ç»</a></p>
<h3 id="2-1-buffteråˆ›å»º"><a href="#2-1-buffteråˆ›å»º" class="headerlink" title="2.1 buffteråˆ›å»º"></a>2.1 buffteråˆ›å»º</h3><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">const buffter1 = Buffer.from('yishu')</span><br><span class="line">const buffter2 = Buffer.alloc(<span class="number">20</span>)</span><br><span class="line">console.log(buffter1)</span><br><span class="line">console.log(buffter2)</span><br><span class="line"></span><br><span class="line">&lt;Buffer <span class="number">79</span> <span class="number">69</span> <span class="number">73</span> <span class="number">68</span> <span class="number">75</span>&gt;</span><br><span class="line">&lt;Buffer <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-buffterè¯»å†™"><a href="#2-2-buffterè¯»å†™" class="headerlink" title="2.2 buffterè¯»å†™"></a>2.2 buffterè¯»å†™</h3><p>äºŒè¿›åˆ¶åè®®ï¼šä¸åŒå­—æ®µå¡åœ¨äºŒè¿›åˆ¶æµä¸­çš„ä¸åŒä½ç½®</p>
<p>åŸºæœ¬æ“ä½œ</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">buffter<span class="number">2.</span>writeI<span class="symbol">nt8</span><span class="comment">(12,1)</span></span><br></pre></td></tr></table></figure>
<p>å›¾ç¤ºç¼–ç äºŒè¿›åˆ¶åŒ…<br><img src="http://cdn.anruence.com/lll.png" alt="image"></p>
<p><strong>å›¾è§£ï¼š</strong><br>å‰ä¸‰ä½ä»£è¡¨ä¸€ä¸ªå­—æ®µï¼Œä¸­é—´ä»£è¡¨ä¸€ä¸ªå­—æ®µï¼Œåé¢åˆä»£è¡¨ä¸€ä¸ªå­—æ®µ<br>æ‰€ä»¥ï¼Œç¼–ç äºŒè¿›åˆ¶åŒ…çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œä¸‰æ¬¡writeå†™æ“ä½œ</p>
<p>çœ‹èµ·æ¥è¿˜æ˜¯ç¨è®¸éº»çƒ¦å—·</p>
<p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=908304341,3029384854&amp;fm=26&amp;gp=0.jpg" alt="image"></p>
<p>æœ‰æœ¨æœ‰åƒJsonæ ¼å¼åŒ–æ–¹å¼å¦‚æ­¤ç®€å•çš„ç¼–ç æ–¹å¼</p>
<p>ç­”æ¡ˆï¼šæœ‰ï¼</p>
<p><a href="https://www.npmjs.com/package/protocol-buffers" target="_blank" rel="noopener">protocol-buffers-npmåŒ…</a></p>
<p>ä½¿ç”¨ç¤ºä¾‹</p>
<figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">test.proto</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">int32</span> id  = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">string</span> payload = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js<br><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> protobuf = <span class="built_in">require</span>(<span class="string">'protocol-buffers'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// pass a proto file as a buffer/string or pass a parsed protobuf-schema object</span></span><br><span class="line"><span class="keyword">var</span> messages = protobuf(fs.readFileSync(__dirname + <span class="string">'/test.proto'</span>,<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="keyword">var</span> buf = messages.Test.encode(&#123;</span><br><span class="line">  <span class="attribute">id:</span><span class="string"> 42,</span></span><br><span class="line"><span class="string">  payload</span>: <span class="string">'hello world'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(buf) <span class="comment">// should print a buffer</span></span><br><span class="line">&#123;<span class="comment">/* &lt;Buffer 08 2a 12 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64&gt; */</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(messages.Test.decode(buf))</span><br><span class="line"><span class="comment">// &#123; id: 42, payload: 'hello world' &#125;</span></span><br></pre></td></tr></table></figure></p>
<p>æ˜æ˜¾å‘ç°</p>
<ul>
<li>æ›´ç›´è§‚</li>
<li>æ›´å¥½ç»´æŠ¤</li>
<li>æ›´ä¾¿äºåˆä½œ</li>
</ul>
<p>æ­£æ˜¯æ‰€æœŸç›¼çš„è¿™æ ·é¸­ï½<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1584891026316&amp;di=474986ffbe473f99d8664a54b1f89076&amp;imgtype=0&amp;src=http%3A%2F%2Fp5.pccoo.cn%2Fwinccoo%2F20170317%2F2017031716023399665328.gif" alt="image"></p>
<h2 id="3-å»ºç«‹å¤šè·¯å¤ç”¨çš„RPCé€šé“"><a href="#3-å»ºç«‹å¤šè·¯å¤ç”¨çš„RPCé€šé“" class="headerlink" title="3. å»ºç«‹å¤šè·¯å¤ç”¨çš„RPCé€šé“"></a>3. å»ºç«‹å¤šè·¯å¤ç”¨çš„RPCé€šé“</h2><h3 id="3-1-éœ€æ±‚1-å®ç°å•å·¥é€šä¿¡é€šé“"><a href="#3-1-éœ€æ±‚1-å®ç°å•å·¥é€šä¿¡é€šé“" class="headerlink" title="3.1 éœ€æ±‚1 å®ç°å•å·¥é€šä¿¡é€šé“"></a>3.1 éœ€æ±‚1 å®ç°å•å·¥é€šä¿¡é€šé“</h3><p>client.js</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> net = require(<span class="string">'net'</span>);</span><br><span class="line"><span class="keyword">const</span> socket  = <span class="keyword">new</span> net.Socket(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">socket.<span class="built_in">connect</span>(&#123;</span><br><span class="line">    host:<span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port:<span class="number">6002</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">socket.<span class="built_in">write</span>(<span class="string">'good!maying'</span>)  <span class="comment">//å•å·¥é€šä¿¡</span></span><br></pre></td></tr></table></figure>
<p>server.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>);</span><br><span class="line"></span><br><span class="line">net.createServer(<span class="function">(<span class="params">socket</span>)=&gt;</span>&#123;</span><br><span class="line">    socket.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'buffer'</span>,buffer,buffer.toString())</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">.listen(<span class="number">6002</span>)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°ç»“æœ</p>
<p><img src="http://cdn.anruence.com/goodmoring.png" alt="image"></p>
<p>è¿™é‡Œå®ç°äº†TCPé€šä¿¡æ–¹å¼ä¹‹ä¸€ <font color="red">å•å·¥é€šä¿¡</font></p>
<h3 id="3-1-éœ€æ±‚2-å®ç°åŠåŒå·¥é€šä¿¡é€šé“"><a href="#3-1-éœ€æ±‚2-å®ç°åŠåŒå·¥é€šä¿¡é€šé“" class="headerlink" title="3.1 éœ€æ±‚2 å®ç°åŠåŒå·¥é€šä¿¡é€šé“"></a>3.1 éœ€æ±‚2 å®ç°åŠåŒå·¥é€šä¿¡é€šé“</h3><h4 id="3-1-1-å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æœ‰æ¥æœ‰å›"><a href="#3-1-1-å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æœ‰æ¥æœ‰å›" class="headerlink" title="3.1.1 å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æœ‰æ¥æœ‰å›"></a>3.1.1 å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æœ‰æ¥æœ‰å›</h4><ul>
<li>å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªæ­£å¸¸æ•°æ®</li>
<li>æœåŠ¡ç«¯è¿”å›ä¸€ä¸ªç›¸åº”çš„æ•°æ®</li>
</ul>
<h4 id="3-1-2-é‡ç‚¹é€»è¾‘"><a href="#3-1-2-é‡ç‚¹é€»è¾‘" class="headerlink" title="3.1.2 é‡ç‚¹é€»è¾‘"></a>3.1.2 é‡ç‚¹é€»è¾‘</h4><p>åœ¨å•å·¥é€šä¿¡æ¨¡å¼ä¸‹</p>
<ul>
<li>clientç«¯ï¼šå‘è¯·æ±‚æ•°æ®ï¼Œç­‰åˆ°æœåŠ¡å™¨ç«¯è¿”å›ç»“æœä¹‹åï¼Œå†æ¬¡è¯·æ±‚</li>
<li>serverç«¯ï¼šæ¥æ”¶åˆ°è¯·æ±‚åï¼ŒåŒ¹é…è¿”å›</li>
</ul>
<h4 id="3-1-3-ä»£ç "><a href="#3-1-3-ä»£ç " class="headerlink" title="3.1.3 ä»£ç "></a>3.1.3 ä»£ç </h4><p>client.js</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºsocket</span></span><br><span class="line"><span class="keyword">const</span> socket = <span class="keyword">new</span> net.Socket(&#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿æ¥æœåŠ¡å™¨</span></span><br><span class="line">socket.connect(&#123;</span><br><span class="line">    host: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port: <span class="number">6002</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> lessonids = [</span><br><span class="line">    <span class="string">"136797"</span>,</span><br><span class="line">    <span class="string">"136798"</span>,</span><br><span class="line">    <span class="string">"136799"</span>,</span><br><span class="line">    <span class="string">"136800"</span>,</span><br><span class="line">    <span class="string">"136801"</span>,</span><br><span class="line">    <span class="string">"136803"</span>,</span><br><span class="line">    <span class="string">"136804"</span>,</span><br><span class="line">    <span class="string">"136806"</span>,</span><br><span class="line">    <span class="string">"136807"</span>,</span><br><span class="line">    <span class="string">"136808"</span>,</span><br><span class="line">    <span class="string">"136809"</span>,</span><br><span class="line">    <span class="string">"141994"</span>,</span><br><span class="line">    <span class="string">"143517"</span>,</span><br><span class="line">    <span class="string">"143557"</span>,</span><br><span class="line">    <span class="string">"143564"</span>,</span><br><span class="line">    <span class="string">"143644"</span>,</span><br><span class="line">    <span class="string">"146470"</span>,</span><br><span class="line">    <span class="string">"146569"</span>,</span><br><span class="line">    <span class="string">"146582"</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> id = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * lessonids.length);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾€æœåŠ¡å™¨ä¼ æ•°æ®</span></span><br><span class="line">socket.write(encode(id));</span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">'data'</span>, <span class="function">(<span class="params">buffer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(buffer.toString())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶åˆ°æ•°æ®ä¹‹åï¼ŒæŒ‰ç…§åŠåŒå·¥é€šä¿¡çš„é€»è¾‘ï¼Œé©¬ä¸Šå¼€å§‹ä¸‹ä¸€æ¬¡è¯·æ±‚</span></span><br><span class="line">    id = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * lessonids.length);</span><br><span class="line">    socket.write(encode(id));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠç¼–ç è¯·æ±‚åŒ…çš„é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">    buffer = Buffer.alloc(<span class="number">4</span>);</span><br><span class="line">    buffer.writeInt32BE(</span><br><span class="line">        lessonids[index]</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>server.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºtcpæœåŠ¡å™¨</span></span><br><span class="line"><span class="keyword">const</span> server = net.createServer(<span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    socket.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ä»ä¼ æ¥çš„bufferé‡Œè¯»å‡ºä¸€ä¸ªint32</span></span><br><span class="line">        <span class="keyword">const</span> lessonid = buffer.readInt32BE();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 50æ¯«ç§’åå›å†™æ•°æ®</span></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">            socket.write(</span><br><span class="line">                Buffer.from(data[lessonid])</span><br><span class="line">            );</span><br><span class="line">        &#125;, <span class="number">50</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬ç«¯å£å¯åŠ¨æœåŠ¡</span></span><br><span class="line">server.listen(<span class="number">6002</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data = &#123;</span><br><span class="line">    <span class="number">136797</span>: <span class="string">"01 | è¯¾ç¨‹ä»‹ç»"</span>,</span><br><span class="line">    <span class="number">136798</span>: <span class="string">"02 | å†…å®¹ç»¼è¿°"</span>,</span><br><span class="line">    <span class="number">136799</span>: <span class="string">"03 | Node.jsæ˜¯ä»€ä¹ˆï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">136800</span>: <span class="string">"04 | Node.jså¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">136801</span>: <span class="string">"05 | è¯¾ç¨‹å®æˆ˜é¡¹ç›®ä»‹ç»"</span>,</span><br><span class="line">    <span class="number">136803</span>: <span class="string">"06 | ä»€ä¹ˆæ˜¯æŠ€æœ¯é¢„ç ”ï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">136804</span>: <span class="string">"07 | Node.jså¼€å‘ç¯å¢ƒå®‰è£…"</span>,</span><br><span class="line">    <span class="number">136806</span>: <span class="string">"08 | ç¬¬ä¸€ä¸ªNode.jsç¨‹åºï¼šçŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"</span>,</span><br><span class="line">    <span class="number">136807</span>: <span class="string">"09 | æ¨¡å—ï¼šCommonJSè§„èŒƒ"</span>,</span><br><span class="line">    <span class="number">136808</span>: <span class="string">"10 | æ¨¡å—ï¼šä½¿ç”¨æ¨¡å—è§„èŒƒæ”¹é€ çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"</span>,</span><br><span class="line">    <span class="number">136809</span>: <span class="string">"11 | æ¨¡å—ï¼šnpm"</span>,</span><br><span class="line">    <span class="number">141994</span>: <span class="string">"12 | æ¨¡å—ï¼šNode.jså†…ç½®æ¨¡å—"</span>,</span><br><span class="line">    <span class="number">143517</span>: <span class="string">"13 | å¼‚æ­¥ï¼šéé˜»å¡I/O"</span>,</span><br><span class="line">    <span class="number">143557</span>: <span class="string">"14 | å¼‚æ­¥ï¼šå¼‚æ­¥ç¼–ç¨‹ä¹‹callback"</span>,</span><br><span class="line">    <span class="number">143564</span>: <span class="string">"15 | å¼‚æ­¥ï¼šäº‹ä»¶å¾ªç¯"</span>,</span><br><span class="line">    <span class="number">143644</span>: <span class="string">"16 | å¼‚æ­¥ï¼šå¼‚æ­¥ç¼–ç¨‹ä¹‹Promise"</span>,</span><br><span class="line">    <span class="number">146470</span>: <span class="string">"17 | å¼‚æ­¥ï¼šå¼‚æ­¥ç¼–ç¨‹ä¹‹async/await"</span>,</span><br><span class="line">    <span class="number">146569</span>: <span class="string">"18 | HTTPï¼šä»€ä¹ˆæ˜¯HTTPæœåŠ¡å™¨ï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">146582</span>: <span class="string">"19 | HTTPï¼šç®€å•å®ç°ä¸€ä¸ªHTTPæœåŠ¡å™¨"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://cdn.anruence.com/half.gif" alt="image"></p>
<h3 id="3-2-éœ€æ±‚1-å®ç°å…¨åŒå·¥é€šä¿¡é€šé“"><a href="#3-2-éœ€æ±‚1-å®ç°å…¨åŒå·¥é€šä¿¡é€šé“" class="headerlink" title="3.2 éœ€æ±‚1 å®ç°å…¨åŒå·¥é€šä¿¡é€šé“"></a>3.2 éœ€æ±‚1 å®ç°å…¨åŒå·¥é€šä¿¡é€šé“</h3><p>clientç«¯è‡ªç”±å‘é€æ•°æ®åŒ…ï¼Œæ— éœ€ç­‰å¾…serverç«¯è¿”å›</p>
<h4 id="3-2-1-è§£å†³åŠåŒå·¥é€šä¿¡çš„é—®é¢˜"><a href="#3-2-1-è§£å†³åŠåŒå·¥é€šä¿¡çš„é—®é¢˜" class="headerlink" title="3.2.1 è§£å†³åŠåŒå·¥é€šä¿¡çš„é—®é¢˜"></a>3.2.1 è§£å†³åŠåŒå·¥é€šä¿¡çš„é—®é¢˜</h4><ul>
<li>åŠåŒå·¥é€šä¿¡è¿›è¡Œå¹¶å‘å®¹æ˜“å¯¼è‡´è¯·æ±‚åŒ…å’Œå“åº”åŒ…æ—¶åºé”™ä¹±</li>
</ul>
<p>çœ‹å›¾è§£é‡Šä¸€ä¸‹</p>
<p><img src="http://cdn.anruence.com/qwwqw.png" alt="image"></p>
<ol>
<li>clientåŒæ—¶å‘é€id1ï¼Œid2çš„è¯·æ±‚</li>
<li>serverç«¯å¤„ç†â€¦</li>
<li>serverè¿”å›id2çš„å¤„ç†ç»“æœ</li>
<li>serverè¿”å›id1çš„å¤„ç†ç»“æœ</li>
</ol>
<p>clientç«¯å¦‚ä½•å°†ä¸¤ä¸ªè¯·æ±‚å’Œè¿”å›æ•°æ®å¯¹åº”å‘¢ï¼Ÿ</p>
<p>å¦‚æœæ ¹æ®è¿”å›çš„æ—¶é—´æ¥è¿›è¡ŒåŒ¹é…ï¼Œå°±ä¼šé€ æˆé”™ä¹±</p>
<p><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2814248882,3142720346&amp;fm=26&amp;gp=0.jpg" alt="image"></p>
<font color="red">å¦‚ä½•è§£å†³?</font>


<p>è¿™æ­£æ˜¯å…¨åŒå·¥é€šä¿¡æ¨¡å¼è¦è§£å†³çš„é—®é¢˜</p>
<p>å°†è¯·æ±‚åŒ…å’Œè¿”å›åŒ…éƒ½åŠ ä¸Šä¸€ä¸ªåºå·</p>
<p>å°±åƒä¸‹å›¾è¿™æ ·</p>
<p><img src="http://cdn.anruence.com/sasasas.png" alt="image"></p>
<h4 id="3-2-2-é‡ç‚¹é€»è¾‘"><a href="#3-2-2-é‡ç‚¹é€»è¾‘" class="headerlink" title="3.2.2 é‡ç‚¹é€»è¾‘"></a>3.2.2 é‡ç‚¹é€»è¾‘</h4><p>åœ¨åŠåŒå·¥é€šä¿¡æ¨¡å¼ä¸‹ </p>
<ul>
<li>clientç«¯ï¼šå¢åŠ seqï¼Œä¸ºæ•°æ®åŒ…ç»‘å®šç‰¹æœ‰çš„id buffer</li>
<li>serverç«¯ï¼šåœ¨è¿”å›çš„æ•°æ®åŒ…é‡Œç»‘å®šid buffer</li>
</ul>
<h4 id="3-2-3-ä»£ç "><a href="#3-2-3-ä»£ç " class="headerlink" title="3.2.3 ä»£ç "></a>3.2.3 ä»£ç </h4><p>client.js</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>);</span><br><span class="line"><span class="keyword">const</span> socket  = <span class="keyword">new</span> net.Socket(&#123;&#125;);</span><br><span class="line"><span class="keyword">let</span> seq =  <span class="number">0</span>;</span><br><span class="line">socket.connect(&#123;</span><br><span class="line">    host:<span class="string">'127.0.0.1'</span>,</span><br><span class="line">    port:<span class="number">6002</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LESSON_IDS = [</span><br><span class="line">    <span class="string">"136797"</span>,</span><br><span class="line">    <span class="string">"136798"</span>,</span><br><span class="line">    <span class="string">"136799"</span>,</span><br><span class="line">    <span class="string">"136800"</span>,</span><br><span class="line">    <span class="string">"136801"</span>,</span><br><span class="line">    <span class="string">"136803"</span>,</span><br><span class="line">    <span class="string">"136804"</span>,</span><br><span class="line">    <span class="string">"136806"</span>,</span><br><span class="line">    <span class="string">"136807"</span>,</span><br><span class="line">    <span class="string">"136808"</span>,</span><br><span class="line">    <span class="string">"136809"</span>,</span><br><span class="line">    <span class="string">"141994"</span>,</span><br><span class="line">    <span class="string">"143517"</span>,</span><br><span class="line">    <span class="string">"143557"</span>,</span><br><span class="line">    <span class="string">"143564"</span>,</span><br><span class="line">    <span class="string">"143644"</span>,</span><br><span class="line">    <span class="string">"146470"</span>,</span><br><span class="line">    <span class="string">"146569"</span>,</span><br><span class="line">    <span class="string">"146582"</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> index = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * LESSON_IDS.length);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">socket.on(<span class="string">'data'</span>,<span class="function">(<span class="params">buffer</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> seqBuffer = buffer.slice(<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">const</span> titleBuffer = buffer.slice(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(seqBuffer.readInt16BE(),titleBuffer.toString())</span><br><span class="line">    <span class="comment">// è¯·æ±‚å›æ¥ä¹‹åå†æ¬¡å‘é€</span></span><br><span class="line">    index = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * LESSON_IDS.length);</span><br><span class="line">    socket.write(encode(index));</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">index</span>)</span>&#123;</span><br><span class="line">    buffer = Buffer.alloc(<span class="number">6</span>);</span><br><span class="line">    buffer.writeInt16BE(seq)</span><br><span class="line">    buffer.writeInt32BE(</span><br><span class="line">        LESSON_IDS[index],<span class="number">2</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å‘åŒ…'</span>,seq,LESSON_IDS[index])</span><br><span class="line">    seq++;</span><br><span class="line">    <span class="keyword">return</span> buffer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    index = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * LESSON_IDS.length);</span><br><span class="line">    socket.write(encode(index));</span><br><span class="line">&#125;, <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// for(let k = 0;k&lt; 100; k++)&#123;</span></span><br><span class="line"><span class="comment">//     index = Math.floor(Math.random() * LESSON_IDS.length);</span></span><br><span class="line"><span class="comment">//     socket.write(encode(index));</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>
<p>server.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> net = <span class="built_in">require</span>(<span class="string">'net'</span>);</span><br><span class="line"></span><br><span class="line">net.createServer(<span class="function">(<span class="params">socket</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// socket.write</span></span><br><span class="line">    socket.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">buffer</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// console.log('buffer',buffer)</span></span><br><span class="line">        <span class="keyword">const</span> seqBuffer = buffer.slice(<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">const</span> lessonId = buffer.readInt32BE(<span class="number">2</span>);</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> buffer = Buffer.concat([</span><br><span class="line">            seqBuffer,</span><br><span class="line">            Buffer.from(LESSON_DATA[lessonId])</span><br><span class="line">        ])</span><br><span class="line">        socket.write(buffer)</span><br><span class="line">    &#125;,<span class="number">10</span>+<span class="built_in">Math</span>.random() * <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">.listen(<span class="number">6002</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> LESSON_DATA = &#123;</span><br><span class="line">    <span class="number">136797</span>: <span class="string">"01 | è¯¾ç¨‹ä»‹ç»"</span>,</span><br><span class="line">    <span class="number">136798</span>: <span class="string">"02 | å†…å®¹ç»¼è¿°"</span>,</span><br><span class="line">    <span class="number">136799</span>: <span class="string">"03 | Node.jsæ˜¯ä»€ä¹ˆï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">136800</span>: <span class="string">"04 | Node.jså¯ä»¥ç”¨æ¥åšä»€ä¹ˆï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">136801</span>: <span class="string">"05 | è¯¾ç¨‹å®æˆ˜é¡¹ç›®ä»‹ç»"</span>,</span><br><span class="line">    <span class="number">136803</span>: <span class="string">"06 | ä»€ä¹ˆæ˜¯æŠ€æœ¯é¢„ç ”ï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">136804</span>: <span class="string">"07 | Node.jså¼€å‘ç¯å¢ƒå®‰è£…"</span>,</span><br><span class="line">    <span class="number">136806</span>: <span class="string">"08 | ç¬¬ä¸€ä¸ªNode.jsç¨‹åºï¼šçŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"</span>,</span><br><span class="line">    <span class="number">136807</span>: <span class="string">"09 | æ¨¡å—ï¼š CommonJSè§„èŒƒ"</span>,</span><br><span class="line">    <span class="number">136808</span>: <span class="string">"10 | æ¨¡å—ï¼šä½¿ç”¨æ¨¡å—è§„èŒƒæ”¹é€ çŸ³å¤´å‰ªåˆ€å¸ƒæ¸¸æˆ"</span>,</span><br><span class="line">    <span class="number">136809</span>: <span class="string">"11 | æ¨¡å—ï¼šnpm"</span>,</span><br><span class="line">    <span class="number">141994</span>: <span class="string">"12 | æ¨¡å—ï¼šNode.jså†…ç½®æ¨¡å—"</span>,</span><br><span class="line">    <span class="number">143517</span>: <span class="string">"13 | å¼‚æ­¥ï¼šéé˜»å¡I/O"</span>,</span><br><span class="line">    <span class="number">143557</span>: <span class="string">"14 | å¼‚æ­¥ï¼šå¼‚æ­¥ç¼–ç¨‹ä¹‹callback"</span>,</span><br><span class="line">    <span class="number">143564</span>: <span class="string">"15 | å¼‚æ­¥ï¼šäº‹ä»¶å¾ªç¯"</span>,</span><br><span class="line">    <span class="number">143644</span>: <span class="string">"16 | å¼‚æ­¥ï¼šå¼‚æ­¥ç¼–ç¨‹ä¹‹Promise"</span>,</span><br><span class="line">    <span class="number">146470</span>: <span class="string">"17 | å¼‚æ­¥ï¼šå¼‚æ­¥ç¼–ç¨‹ä¹‹async/await"</span>,</span><br><span class="line">    <span class="number">146569</span>: <span class="string">"18 | HTTPï¼šä»€ä¹ˆæ˜¯HTTPæœåŠ¡å™¨ï¼Ÿ"</span>,</span><br><span class="line">    <span class="number">146582</span>: <span class="string">"19 | HTTPï¼šç®€å•å®ç°ä¸€ä¸ªHTTPæœåŠ¡å™¨"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°ç»“æœ</p>
<p><img src="http://cdn.anruence.com/gif5%E6%96%B0%E6%96%87%E4%BB%B6.gif" alt="image"></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æˆ‘ä»¬åœ¨å¤§é‡å‰ç½®çŸ¥è¯†çš„åŸºç¡€ä¸Šï¼Œä¸€æ­¥æ­¥æ¨å¯¼å‡ºäº†å…¨åŒå·¥é€šé“çš„æ­å»ºï¼Œå½“ç„¶äº†ï¼Œè¿™æ˜¯ä¸å®Œæ•´çš„ï¼Œè¿˜æœ‰ä¸€äº›æƒ…å†µéœ€è¦å¤„ç†<br>å›é¡¾ä¸€ä¸‹å…¨åŒå·¥é€šé“æ­å»ºè¿‡ç¨‹</p>
<ul>
<li>å…³é”®åœ¨äºåº”ç”¨å±‚åè®®éœ€è¦æœ‰æ ‡è®°åŒ…å·çš„å­—æ®µâœ…</li>
<li>å¤„ç†ä»¥ä¸‹æƒ…å†µï¼Œéœ€è¦æœ‰æ ‡è®°åŒ…é•¿çš„å­—æ®µ<ul>
<li>å‡ºç°åŸå› ï¼šTCPåº•å±‚ä¼˜åŒ–æœºåˆ¶ï¼ŒæŠŠåŒæ—¶å‘çš„ä¸€äº›åŒ…æ‹¼èµ·æ¥</li>
<li>ç²˜åŒ…â</li>
<li>ä¸å®Œæ•´åŒ…â</li>
</ul>
</li>
<li>é”™è¯¯å¤„ç†<ul>
<li>ç½‘ç»œç­‰ </li>
</ul>
</li>
</ul>
<p>å¸Œæœ›è¯»å®Œæœ¬æ–‡ï¼Œä½ ä¼šå¯¹RPCé€šé“æœ‰äº›ç²—æµ…çš„è®¤è¯†</p>
<p>æœªå®Œå¾…ç»­..</p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Node.js</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptä¸‹çš„setTimeout(fn,0)æ„å‘³ç€ä»€ä¹ˆï¼Ÿ[è½¬]</title>
    <url>/2018/01/16/setTimeout(fn,0)/</url>
    <content><![CDATA[<p>è¿‘æœŸåœ¨ç ”ç©¶å¼‚æ­¥ç¼–ç¨‹çš„æˆ‘å¯¹äºsetTimeoutä¹‹ç±»çš„ä¸œè¥¿å¼‚å¸¸æ•æ„Ÿã€‚åœ¨SegmentFaultä¸Šçœ‹åˆ°äº†ä¸€ä¸ªé—®é¢˜ã€Šå…³äºSetTimeoutæ—¶é—´è®¾ä¸º0æ—¶ã€‹ï¼šæé—®è€…è¯»äº†ä¸€ç¯‡æ–‡ç« ï¼ŒåŸæ–‡è§£é‡ŠsetTimeoutå»¶è¿Ÿæ—¶é—´ä¸º0æ—¶ä¼šå‘ç”Ÿçš„äº‹æƒ…ï¼Œæé—®è€…æå‡ºäº†å‡ ä¸ªæ–‡ç« ä¸­çš„å‡ ä¸ªç–‘ç‚¹ã€‚è¯»äº†é‚£ç¯‡æ–‡ç« ä¹‹åå‘ç°åŸæ–‡çš„ä½œè€…å¯¹äºsetTimeoutçš„ç†è§£å’Œè‡ªå·±çš„è®¤çŸ¥æœ‰ç‚¹å‡ºå…¥ï¼Œäºæ˜¯ç¼–å†™äº†ç›¸å…³æµ‹è¯•çš„ä»£ç ä»¥æ±‚ç­”æ¡ˆã€‚æœ€ç»ˆç¼–å†™äº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<p>æœ¬æ–‡å†…å®¹å¦‚ä¸‹ï¼š</p>
<p>èµ·å› <br>å•çº¿ç¨‹çš„JavaScript<br>setTimeoutèƒŒåæ„å‘³ç€ä»€ä¹ˆ<br><a id="more"></a><br>èµ·å› <br>ä¸Šåˆåœ¨SegmentFaultä¸Šçœ‹åˆ°äº†è¿™ä¸ªé—®é¢˜ã€Šå…³äºSetTimeout æ—¶é—´è®¾ä¸º0æ—¶ã€‹ï¼ˆæ³¨ï¼šSegmentFaultæ­£åœ¨è°ƒæ•´å¤‡æ¡ˆï¼Œå¦‚ä¸èƒ½è®¿é—®ï¼Œè¯·ç‚¹å‡»è¿™é‡Œï¼‰ï¼ŒåŸæé—®è€…æ³¨æ˜äº†é—®é¢˜æ¥æºï¼šã€ŠJS setTimeoutå»¶è¿Ÿæ—¶é—´ä¸º0çš„è¯¦è§£ã€‹ã€‚è¿™ä¸ªé—®é¢˜æ¥æºä¹Ÿæ˜¯è½¬è½½çš„ï¼Œæˆ‘åæ¥æ‰¾åˆ°äº†å‡ºå¤„ã€‚<br>åœ¨é—®é¢˜æ¥æºçš„é‚£ç¯‡çš„æ–‡ç« ä¸­ï¼ˆåè€…ï¼‰ï¼Œè®²è¿°äº†JSæ˜¯å•çº¿ç¨‹å¼•æ“ï¼šå®ƒæŠŠä»»åŠ¡æ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œä¸ä¼šåŒæ­¥å»æ‰§è¡Œï¼Œå¿…é¡»åœ¨å®Œæˆä¸€ä¸ªä»»åŠ¡åæ‰å¼€å§‹å¦å¤–ä¸€ä¸ªä»»åŠ¡ã€‚<br>è€Œåï¼Œè½¬è½½çš„é‚£ç¯‡æ–‡ç« åˆ—å‡ºå¹¶è¡¥å……äº†åŸæ–‡çš„æ —å­ï¼š</p>
<p>&lt;!DOCTYPE HTML PUBLIC â€œ-//W3C//DTD HTML 4.01//ENâ€ â€œ<a href="http://www.w3.org/TR/html4/strict.dtd&quot;&gt;" target="_blank" rel="noopener">http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</a></p>
<p><html></html></p>
<p><head><meta name="generator" content="Hexo 3.9.0"><br>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><br>    <title>setTimeout</title><br>    <script type="text/javascript"><br>        function get(id) {<br>            return document.getElementById(id);<br>        }<br>        window.onload = function () {<br>            //ç¬¬ä¸€ä¸ªä¾‹å­ï¼šæœªä½¿ç”¨setTimeout<br>            get(â€˜makeinputâ€™).onmousedown = function () {<br>                var input = document.createElement(â€˜inputâ€™);<br>                input.setAttribute(â€˜typeâ€™, â€˜textâ€™);<br>                input.setAttribute(â€˜valueâ€™, â€˜test1â€™);<br>                get(â€˜inpwrapperâ€™).appendChild(input);<br>                input.focus();<br>                input.select();<br>            }<br>            //ç¬¬äºŒä¸ªä¾‹å­ï¼šä½¿ç”¨setTimeout<br>            get(â€˜makeinput2â€™).onmousedown = function () {<br>                var input = document.createElement(â€˜inputâ€™);<br>                input.setAttribute(â€˜typeâ€™, â€˜textâ€™);<br>                input.setAttribute(â€˜valueâ€™, â€˜test1â€™);<br>                get(â€˜inpwrapper2â€™).appendChild(input);<br>                //setTimeout<br>                setTimeout(function () {<br>                    input.focus();<br>                    input.select();<br>                }, 0);<br>            }<br>            //ç¬¬ä¸‰ä¸ªä¾‹å­ï¼Œonkeypressè¾“å…¥çš„æ—¶å€™å°‘äº†ä¸€ä¸ªå€¼<br>            get(â€˜inputâ€™).onkeypress = function () {<br>                get(â€˜previewâ€™).innerHTML = this.value;<br>            }<br>        }<br>    </script><br></head></p>
<p><body><br>    <h1><code>setTimeout</code></h1><br>    <h2>1ã€æœªä½¿ç”¨ <code>setTimeout</code></h2><br>    <button id="makeinput">ç”Ÿæˆ input</button><br>    <p id="inpwrapper"></p></body></p>
<pre><code>&lt;h2&gt;2ã€ä½¿ç”¨ &lt;code&gt;setTimeout&lt;/code&gt;&lt;/h2&gt;
&lt;button id=&quot;makeinput2&quot;&gt;ç”Ÿæˆ input&lt;/button&gt;
&lt;p id=&quot;inpwrapper2&quot;&gt;&lt;/p&gt;


&lt;h2&gt;3ã€å¦ä¸€ä¸ªä¾‹å­&lt;/h2&gt;
&lt;p&gt;
    &lt;input type=&quot;text&quot; id=&quot;input&quot; value=&quot;&quot; /&gt;&lt;span id=&quot;preview&quot;&gt;&lt;/span&gt;
&lt;/p&gt;
</code></pre><p><br><br>ä»£ç è¿è¡Œå®ä¾‹è¯·æˆ³è¿™é‡Œã€‚<br>åŸæ–‡ä¸­æœ‰è¿™ä¹ˆä¸€æ®µè¯ï¼Œæè¿°çš„æœ‰ç‚¹æŠ½è±¡ï¼š</p>
<p>JavaScriptå¼•æ“åœ¨æ‰§è¡Œonmousedownæ—¶ï¼Œç”±äºæ²¡æœ‰å¤šçº¿ç¨‹çš„åŒæ­¥æ‰§è¡Œï¼Œä¸å¯èƒ½åŒæ—¶å»å¤„ç†åˆšåˆ›å»ºå…ƒç´ çš„focus å’Œselectæ–¹æ³•ï¼Œç”±äºè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œåœ¨å®Œæˆonmousedownåï¼ŒJavaScript å¼•æ“å·²ç»ä¸¢å¼ƒäº†è¿™ä¸¤ä¸ªä»»åŠ¡ï¼Œæ­£å¦‚ç¬¬ä¸€ç§æƒ…å†µã€‚è€Œåœ¨ç¬¬äºŒç§æƒ…å†µä¸­ï¼Œç”±äºsetTimeoutå¯ä»¥æŠŠä»»åŠ¡ä»æŸä¸ªé˜Ÿåˆ—ä¸­è·³è„±æˆä¸ºæ–°é˜Ÿåˆ—ï¼Œå› è€Œèƒ½å¤Ÿå¾—åˆ°æœŸæœ›çš„ç»“æœã€‚</p>
<p>æˆ‘çœ‹åˆ°è¿™é‡Œå°±è§‰å¾—éå¸¸ä¸å¯¹åŠ²äº†ã€‚å› ä¸ºæŒ‰ç…§è¿™ç§ä»»åŠ¡ä¼šè¢«ä¸¢å¼ƒçš„è¯´æ³•ï¼Œé‚£ä¹ˆåªè¦åœ¨äº‹ä»¶è§¦å‘çš„å‡½æ•°ä¸­å†è§¦å‘å…¶ä»–çš„äº‹ä»¶éƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œæµè§ˆå™¨æ˜¯ç»å¯¹ä¸ä¼šè¿™ä¹ˆåšçš„ï¼Œäºæ˜¯æˆ‘ç¼–å†™äº†æµ‹è¯•ä»£ç ï¼š</p>
<pre><code>window.onload = function () {
    //ç¬¬ä¸€ä¸ªä¾‹å­ï¼šæœªä½¿ç”¨setTimeout
    get(&apos;makeinput&apos;).onmousedown = function () {
        var input = document.createElement(&apos;input&apos;);
        input.setAttribute(&apos;type&apos;, &apos;text&apos;);
        input.setAttribute(&apos;value&apos;, &apos;test1&apos;);
        get(&apos;inpwrapper&apos;).appendChild(input);
        //æŒ‰ç…§æ–‡ä¸­çš„ç†è®ºï¼Œè¿™é‡Œçš„clickä¸ä¼šè¢«è§¦å‘ï¼Œä½†å®ƒå´æˆåŠŸè§¦å‘äº†
        get(&apos;inpwrapper&apos;).click();//è§¦å‘äº†inpwrapperçš„onclickäº‹ä»¶
    }
    get(&apos;inpwrapper&apos;).onclick = function () {
        alert(&apos;linkFly&apos;);
    };
}
</code></pre><p>ä¸‹é¢çš„onclick()æœ€ç»ˆæ˜¯æ‰§è¡Œäº†ï¼šå¼¹å‡ºäº†â€linkFlyâ€ã€‚</p>
<p>è€Œåœ¨è½¬è½½çš„æ–‡ä¸­ä¸ºäº†å¼•äººæ·±æ€ï¼Œåˆæå‡ºäº†ç¬¬ä¸‰ä¸ªä¾‹å­ï¼š</p>
<p>åœ¨æ­¤ï¼Œä½ å¯ä»¥çœ‹çœ‹ä¾‹å­ 3ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯å®æ—¶æ›´æ–°è¾“å…¥çš„æ–‡æœ¬ï¼Œç°åœ¨è¯·è¯•è¯•ï¼Œä½ ä¼šå‘ç°é¢„è§ˆåŒºåŸŸæ€»æ˜¯è½åä¸€æ‹ï¼Œæ¯”å¦‚ä½ è¾“ a, é¢„è§ˆåŒºå¹¶æ²¡æœ‰å‡ºç° a, åœ¨ç´§æ¥è¾“å…¥bæ—¶ï¼Œaæ‰ä¸æ…Œä¸å¿™åœ°å‡ºç°ã€‚</p>
<p>è€Œæ–‡ä¸­æœ€åç•™ç»™å¤§å®¶çš„æ€è€ƒçš„é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨setTimeoutå†æ¬¡è°ƒæ•´æµè§ˆå™¨çš„ä»£ç ä»»åŠ¡è¿è¡Œé˜Ÿåˆ—ã€‚</p>
<pre><code>var domInput = get(&apos;input&apos;);
domInput.onkeypress = function () {
    setTimeout(function () {
        //ç¬¬ä¸‰ä¸ªä¾‹å­çš„é—®é¢˜å°±è¿™æ ·å°±ä¼šè¢«è§£å†³
        get(&apos;preview&apos;).innerHTML = domInput.value;
    })
}
</code></pre><p>åŸæ–‡å’Œè½¬è½½çš„æ–‡ç« ä¸­éƒ½å¯¹setTimeout(fn,0)è¿›è¡Œäº†æ€è€ƒï¼Œä½†åŸæ–‡æŒ‡å‡ºçš„é—®é¢˜æœ¬è´¨æ¼æ´ç™¾å‡ºï¼Œæ‰€ä»¥æ‰å‡ºäº†è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬çš„æ­£æ–‡ï¼Œç°åœ¨å¼€å§‹ã€‚</p>
<p>å•çº¿ç¨‹çš„JavaScript<br>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹æµè§ˆå™¨ä¸‹çš„JavaScriptï¼š</p>
<ul>
<li>javascriiptå¼•æ“çº¿ç¨‹</li>
<li>GUIæ¸²æŸ“çº¿ç¨‹</li>
<li>æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹</li>
</ul>
<p>javascriptå¼•æ“æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨å•çº¿ç¨‹æ‰§è¡Œçš„ï¼ŒJSå¼•æ“ä¸€ç›´ç­‰å¾…ç€ä»»åŠ¡é˜Ÿåˆ—ä¸­ä»»åŠ¡çš„åˆ°æ¥ï¼Œç„¶ååŠ ä»¥å¤„ç†ï¼Œæµè§ˆå™¨æ— è®ºä»€ä¹ˆæ—¶å€™éƒ½åªæœ‰ä¸€ä¸ªJSçº¿ç¨‹åœ¨è¿è¡ŒJSç¨‹åºã€‚<br>GUIæ¸²æŸ“çº¿ç¨‹è´Ÿè´£æ¸²æŸ“æµè§ˆå™¨ç•Œé¢ï¼Œå½“ç•Œé¢éœ€è¦é‡ç»˜ï¼ˆRepaintï¼‰æˆ–ç”±äºæŸç§æ“ä½œå¼•å‘å›æµ(reflow)æ—¶,è¯¥çº¿ç¨‹å°±ä¼šæ‰§è¡Œã€‚ä½†éœ€è¦æ³¨æ„ GUIæ¸²æŸ“çº¿ç¨‹ä¸JSå¼•æ“æ˜¯äº’æ–¥çš„ï¼Œå½“JSå¼•æ“æ‰§è¡Œæ—¶GUIçº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼ŒGUIæ›´æ–°ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ç­‰åˆ°JSå¼•æ“ç©ºé—²æ—¶ç«‹å³è¢«æ‰§è¡Œã€‚<br>äº‹ä»¶è§¦å‘çº¿ç¨‹ï¼Œå½“ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘æ—¶è¯¥çº¿ç¨‹ä¼šæŠŠäº‹ä»¶æ·»åŠ åˆ°å¾…å¤„ç†é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œç­‰å¾…JSå¼•æ“çš„å¤„ç†ã€‚è¿™äº›äº‹ä»¶å¯æ¥è‡ªJavaScriptå¼•æ“å½“å‰æ‰§è¡Œçš„ä»£ç å—å¦‚setTimeOutã€ä¹Ÿå¯æ¥è‡ªæµè§ˆå™¨å†…æ ¸çš„å…¶ä»–çº¿ç¨‹å¦‚é¼ æ ‡ç‚¹å‡»ã€AJAXå¼‚æ­¥è¯·æ±‚ç­‰ï¼Œä½†ç”±äºJSçš„å•çº¿ç¨‹å…³ç³»æ‰€æœ‰è¿™äº›äº‹ä»¶éƒ½å¾—æ’é˜Ÿç­‰å¾…JSå¼•æ“å¤„ç†ã€‚ï¼ˆå½“çº¿ç¨‹ä¸­æ²¡æœ‰æ‰§è¡Œä»»ä½•åŒæ­¥ä»£ç çš„å‰æä¸‹æ‰ä¼šæ‰§è¡Œå¼‚æ­¥ä»£ç ï¼‰<br>jsçš„å•çº¿ç¨‹åœ¨è¿™ä¸€æ®µé¢è¯•ä»£ç ä¸­å°¤ä¸ºæ˜æ˜¾ï¼ˆç†è§£å³å¯ï¼Œè¯·ä¸è¦å°è¯•â€¦æµè§ˆå™¨ä¼šå‡æ­»çš„ï¼‰ï¼š</p>
<pre><code>var isEnd = true;
window.setTimeout(function () {
    isEnd = false;//1såï¼Œæ”¹å˜isEndçš„å€¼
}, 1000);
//è¿™ä¸ªwhileæ°¸è¿œçš„å ç”¨äº†jsçº¿ç¨‹ï¼Œæ‰€ä»¥setTimeouté‡Œé¢çš„å‡½æ•°æ°¸è¿œä¸ä¼šæ‰§è¡Œ
while (isEnd);
//alertä¹Ÿæ°¸è¿œä¸ä¼šå¼¹å‡º
alert(&apos;end&apos;);
</code></pre><p>åœ¨æˆ‘å·¥ä½œä¸­å¯¹jsçš„è®¤è¯†ï¼Œä¸ªäººè®¤ä¸ºjsçš„ä»»åŠ¡å•ä½æ˜¯å‡½æ•°ã€‚å³ï¼Œä¸€ä¸ªå‡½æ•°è¡¨ç¤ºç€ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œåˆ™åœ¨æµè§ˆå™¨ä¸­å½“å‰çš„ä»»åŠ¡å³æ²¡æœ‰ç»“æŸã€‚<br>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“å‰ä»»åŠ¡å› ä¸ºwhileçš„æ‰§è¡Œè€Œé€ æˆæ°¸è¿œæ— æ³•æ‰§è¡Œï¼Œæ‰€ä»¥åé¢çš„setTimeoutä¹Ÿæ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œã€‚å®ƒåœ¨æµè§ˆå™¨çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p>Browser Event</p>
<p>setTimeoutèƒŒåæ„å‘³ç€ä»€ä¹ˆ<br>è¿™ç¯‡æ–‡ç« ä¸€ç›´åœ¨ä½¿ç”¨setTimeoutä¸ºæˆ‘ä»¬å±•ç°å’Œç†è§£jså•çº¿ç¨‹çš„è®¾è®¡ï¼Œåªæ˜¯å®ƒé”™è¯¯çš„ä½¿ç”¨äº†Eventæ¥è¿›è¡Œæ¼”ç¤ºï¼Œå¹¶è¿‡åº¦è§£è¯»äº†Eventã€‚<br>è¿™é‡ŒåŸæ–‡å’Œè½¬è½½çš„æ–‡ç« å¿½ç•¥äº†è¿™äº›åŸºç¡€çš„äº‹ä»¶è§¦å‘ï¼Œè€Œä¸”ä¹ŸååæŒ‘äº†ä¸¤å¥—æœ¬èº«è®¾è®¡å°±æ¯”è¾ƒå¤æ‚çš„APIï¼šonmouseXXXç³»å’ŒonkeyXXXç³»ã€‚</p>
<p>onKeyXXXç³»çš„APIè§¦å‘é¡ºåºå¦‚å›¾ï¼š</p>
<p>onKeyXXX</p>
<p>è€Œæˆ‘ä¸ªäººæ‰€ç†è§£å®ƒä»¬å¯¹åº”çš„åŠŸèƒ½ï¼š</p>
<p>onkeydown - ä¸»è¦è·å–å’Œå¤„ç†å½“å‰æŒ‰ä¸‹æŒ‰é”®ï¼Œä¾‹å¦‚æŒ‰ä¸‹Enteråè¿›è¡Œæäº¤ã€‚åœ¨è¿™ä¸€å±‚ï¼Œå¹¶æ²¡æœ‰æ›´æ–°ç›¸å…³DOMå…ƒç´ çš„å€¼ã€‚<br>onkeypress - ä¸»è¦è·å–å’Œå¤„ç†é•¿æŒ‰é”®ï¼Œå› ä¸ºonkeypressåœ¨é•¿æŒ‰é”®ç›˜çš„æƒ…å†µä¸‹ä¼šåå¤è§¦å‘ç›´åˆ°é‡Šæ”¾ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰æ›´æ–°ç›¸å…³DOMå…ƒç´ çš„å€¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼škeypressä¹‹åæ‰ä¼šæ›´æ–°å€¼ï¼Œæ‰€ä»¥åœ¨é•¿æŒ‰é”®ç›˜åå¤è§¦å‘onkeypressäº‹ä»¶çš„æ—¶å€™ï¼Œåä¸€ä¸ªè§¦å‘çš„onkeypressèƒ½å¾—åˆ°ä¸Šä¸€ä¸ªonkeypressçš„å€¼ã€‚æ‰€ä»¥å‡ºç°äº†onkeypressæ¯æ¬¡å–å€¼éƒ½ä¼šæ˜¯ä¸Šä¸€æ¬¡çš„å€¼è€Œä¸æ˜¯æœ€æ–°å€¼ã€‚<br>onkeyup - è§¦å‘onkeyupçš„DOMå…ƒç´ çš„å€¼åœ¨è¿™é‡Œå·²ç»æ›´æ–°ï¼Œå¯ä»¥æ‹¿åˆ°æœ€æ–°çš„å€¼ï¼Œæ‰€ä»¥è¿™é‡Œä¸»è¦å¤„ç†ç›¸å…³DOMå…ƒç´ çš„å€¼ã€‚<br>æµç¨‹å°±æ˜¯ä¸Šé¢çš„å›¾ç”»çš„é‚£æ ·ï¼š</p>
<p>onkeydown =&gt; onkeypress =&gt; onkeyup</p>
<p>ä½¿ç”¨äº†setTimeoutä¹‹åï¼Œæµç¨‹åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·å­çš„ï¼š</p>
<p>onkeydown =&gt; onkeypress =&gt; function =&gt; onkeyup</p>
<p>ä½¿ç”¨setTimeout(fn,0)ä¹‹åï¼Œåœ¨onkeypressåé¢æ’å…¥äº†æˆ‘ä»¬çš„å‡½æ•°functionã€‚ä¸Šé¢æ‰€è¯´ï¼Œæµè§ˆå™¨åœ¨onkeypressä¹‹åå°±ä¼šæ›´æ–°ç›¸å…³DOMå…ƒç´ çš„çŠ¶æ€ï¼ˆinput[type=text]çš„valueï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„functioné‡Œé¢å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„å€¼ã€‚<br>æ‰€ä»¥æˆ‘ä»¬åœ¨onkeypressé‡Œé¢æŒ‚èµ·setTimeoutèƒ½æ‹¿åˆ°æ­£ç¡®çš„å€¼ï¼Œä¸‹é¢çš„ä»£ç å¯ä»¥æµ‹è¯•ä½¿ç”¨setTimeout(fn,0)ä¹‹åçš„æµç¨‹ï¼š</p>
<pre><code>window.onload = function () {
    var domInput = get(&apos;input&apos;), view = get(&apos;preview&apos;);
    //onkeypresså…¼å®¹æ€§å’Œè¯´æ˜ï¼šhttp://www.w3school.com.cn/jsref/jsref_events.asp
    domInput.onkeypress = function () {
        setTimeout(function () {
            //è¿™ä¸ªå‡½æ•°åœ¨keypressä¹‹åï¼Œkeyupä¹‹å‰æ‰§è¡Œ
            console.log(&apos;linkFly&apos;);
        });
    };
    domInput.onkeyup = function () {
        console.log(&apos;up&apos;);
    };
};
</code></pre><p>ç„¶åæˆ‘ä»¬å†æ¥è°ˆè°ˆåŸä»£ç ä¸­çš„ç¤ºä¾‹1å’Œç¤ºä¾‹2ï¼Œç¤ºä¾‹1å’Œç¤ºä¾‹2çš„åŒºåˆ«åœ¨è¿™é‡Œï¼š</p>
<pre><code>//ç¤ºä¾‹1
input.focus();
input.select();

//ç¤ºä¾‹2
setTimeout(function () {
    input.focus();
    input.select();
}, 0);
</code></pre><p>åŸæ–‡ç« ä¸­è¯´ç¤ºä¾‹1çš„focus()å’Œselect()åœ¨onmousedownäº‹ä»¶ä¸­è¢«ä¸¢å¼ƒï¼Œä»è€Œå¯¼è‡´äº†æ²¡æœ‰é€‰ä¸­ï¼Œä½†åŸæ–‡çš„ä½œè€…å¿½ç•¥äº†ä»–æ³¨å†Œçš„äº‹ä»¶æ˜¯ï¼šonmousedownã€‚<br>æˆ‘ä»¬æš‚ä¸”ä¸è®¨è®ºonmouseXXXç³»çš„å…¶ä»–APIï¼Œæˆ‘ä»¬ä»…å…³æ³¨å’Œç‚¹å‡»ç›¸å…³çš„ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼š</p>
<p>mousedown - é¼ æ ‡æŒ‰é’®æŒ‰ä¸‹<br>mouseup - é¼ æ ‡æŒ‰é’®é‡Šæ”¾<br>click - å®Œæˆå•å‡»<br>æˆ‘ä»¬åœ¨onmousedowné‡Œé¢æ–°å»ºäº†inputï¼Œå¹¶ä¸”é€‰ä¸­inputçš„å€¼ï¼ˆè°ƒç”¨äº†input.focus(),input.select()ï¼‰ã€‚<br>é‚£ä¹ˆä¸ºä»€ä¹ˆæ²¡æœ‰è¢«é€‰ä¸­å‘¢ï¼Ÿè¿™æ ·ï¼Œæˆ‘ä»¬æ¥åšä¸€æ¬¡æµ‹è¯•ï¼Œçœ‹çœ‹æˆ‘ä»¬çš„onfocusåˆ°åº•æ˜¯è¢«ä¸¢å¼ƒäº†ï¼Œè¿˜æ˜¯è§¦å‘äº†ã€‚æˆ‘ä»¬æŠŠåŸæ–‡çš„ä»£ç è¿›è¡Œæ”¹å†™ï¼š</p>
<pre><code>window.onload = function () {
    var makeBtn = get(&apos;makeinput&apos;);
    //è§‚å¯ŸonmouseXXXç³»å®Œæˆæ•´ä¸ªå•å‡»çš„é¡ºåº
    makeBtn.onmousedown = function (e) {
        console.log(e.type);
        var input = document.createElement(&apos;input&apos;);
        input.setAttribute(&apos;type&apos;, &apos;text&apos;);
        input.setAttribute(&apos;value&apos;, &apos;test1&apos;);
        get(&apos;inpwrapper&apos;).appendChild(input);
        input.onfocus = function () {//è§‚å¯Ÿæˆ‘ä»¬æ–°ç”Ÿæˆçš„inputä»€ä¹ˆæ—¶å€™è·å–ç„¦ç‚¹çš„ï¼Œæˆ–è€…å®ƒæœ‰æ²¡æœ‰åƒåŸæ–‡ä½œè€…è¯´çš„é‚£æ ·è¢«ä¸¢å¼ƒäº†
            console.info(&apos;input focus&apos;);
        };
        input.focus();
        input.select();
    }
    makeBtn.onclick = function (e) {
        console.log(e.type);
    };
    makeBtn.onmouseup = function (e) {
        console.log(e.type);
    };
    makeBtn.onfocus = function () {//è§‚å¯Ÿæˆ‘ä»¬ç”ŸæˆæŒ‰é’®ä»€ä¹ˆæ—¶å€™è·å–ç„¦ç‚¹çš„
        console.log(&apos;makeBtn focus&apos;);
    }
};
</code></pre><p>ä»£ç è¿è¡Œçš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š<br>onmouseXXX &amp; focus</p>
<p>æˆ‘ä»¬çš„input focusæ‰§è¡Œäº†â€”â€”é‚£ä¹ˆå®ƒä¸ºä»€ä¹ˆæ²¡æœ‰è·å–åˆ°ç„¦ç‚¹å‘¢ï¼Ÿæˆ‘ä»¬å†çœ‹çœ‹åé¢æ‰§è¡Œçš„å‡½æ•°ï¼šæˆ‘ä»¬ç‚¹å‡»çš„æŒ‰é’®ï¼Œåœ¨mousedownä¹‹åï¼Œæ‰è·å¾—ç„¦ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šæˆ‘ä»¬çš„inputæœ¬æ¥å·²ç»å¾—åˆ°äº†focus()ï¼Œä½†åœ¨onmousedownä¹‹åï¼Œæˆ‘ä»¬ç‚¹å‡»çš„æŒ‰é’®æ‰è¿Ÿè¿Ÿè§¦å‘äº†è‡ªå·±çš„onfocus()ï¼Œå¯¼è‡´æˆ‘ä»¬çš„inputè¢«è¦†ç›–ã€‚<br>æˆ‘ä»¬å†åŠ ä¸ŠsetTimeoutè¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code>window.onload = function () {
    var makeBtn = get(&apos;makeinput&apos;);
    makeBtn.onmousedown = function (e) {
        console.log(e.type);
        var input = document.createElement(&apos;input&apos;);
        input.setAttribute(&apos;type&apos;, &apos;text&apos;);
        input.setAttribute(&apos;value&apos;, &apos;test1&apos;);
        get(&apos;inpwrapper&apos;).appendChild(input);
        input.onfocus = function () {
            console.info(&apos;input focus&apos;);
        };
        //æˆ‘ä»¬åŠ ä¸ŠsetTimeoutï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ
        setTimeout(function () {
            input.focus();
            input.select();
        });
    }
    makeBtn.onclick = function (e) {
        console.log(e.type);
    };
    makeBtn.onmouseup = function (e) {
        console.log(e.type);
    };
    makeBtn.onfocus = function () {
        console.log(&apos;makeBtn focus&apos;);
    }
};
</code></pre><p>æ‰§è¡Œç»“æœæ˜¯è¿™æ ·ï¼š<br>onmouseXXX and settimeout</p>
<p>å¯ä»¥çœ‹è§å½“æˆ‘ä»¬ç‚¹å‡»â€ç”Ÿæˆâ€æŒ‰é’®çš„æ—¶å€™ï¼ŒæŒ‰é’®çš„focusæ­£ç¡®çš„æ‰§è¡Œäº†ï¼Œç„¶åæ‰æ‰§è¡Œäº†input focusã€‚<br>åœ¨ç¤ºä¾‹1ä¸­ï¼Œæˆ‘ä»¬åœ¨onmousedown()ä¸­æ‰§è¡Œäº†input.focus()å¯¼è‡´inputå¾—åˆ°ç„¦ç‚¹ï¼Œè€Œonmousedownä¹‹åï¼Œæˆ‘ä»¬ç‚¹å‡»çš„æŒ‰é’®æ‰è¿Ÿè¿Ÿå¾—åˆ°äº†è‡ªå·±çš„ç„¦ç‚¹ï¼Œé€ æˆäº†æˆ‘ä»¬inputåˆšæ‹¿åˆ°æ‰‹è¿˜æ²¡ç„çƒ­çš„ç„¦ç‚¹è¢«è½¬ç§»ã€‚<br>è€Œç¤ºä¾‹2ä¸­çš„ä»£ç ï¼Œæˆ‘ä»¬å»¶è¿Ÿäº†ç„¦ç‚¹ï¼Œå½“æŒ‰é’®è·å¾—ç„¦ç‚¹ä¹‹åï¼Œæˆ‘ä»¬çš„inputå†æŠŠç„¦ç‚¹æŠ¢è¿‡æ¥ï¼Œæ‰€ä»¥ï¼Œä½¿ç”¨setTimeout(fn,0)ä¹‹åï¼Œæˆ‘ä»¬çš„inputå¯ä»¥å¾—åˆ°ç„¦ç‚¹å¹¶é€‰ä¸­æ–‡æœ¬ã€‚<br>è¿™é‡Œå€¼å¾—æ€è€ƒçš„focus()çš„æ‰§è¡Œæ—¶æœºï¼Œæ ¹æ®è¿™æ¬¡æµ‹è¯•è§‚å¯Ÿï¼Œå‘ç°focusäº‹ä»¶å¥½åƒæŒ‚è½½åœ¨mousedownä¹‹å†…çš„æœ€åé¢ï¼Œè€Œä¸æ˜¯ç›´æ¥æŒ‚åœ¨mousedownçš„åé¢ã€‚å®ƒå’Œmousedownä»¿ä½›æ˜¯ä¸€ä½“çš„ã€‚<br>æˆ‘ä»¬ä½¿ç”¨setTimeoutä¹‹å‰çš„ä»»åŠ¡æµç¨‹æ˜¯è¿™æ ·çš„ï¼ˆ-&gt;è¡¨ç¤ºåœ¨ä¸Šä¸€ä¸ªä»»åŠ¡ä¸­ï¼Œ=&gt;è¡¨ç¤ºåœ¨ä¸Šä¸€ä¸ªä»»åŠ¡åï¼‰ï¼š</p>
<p><code>onmousedown -&gt; onmousedownä¸­æ‰§è¡Œäº†input.focus() -&gt; button.onfocus =&gt; onmouseup =&gt; onclick</code></p>
<p>onmouseXXXäº‹ä»¶æµç¨‹</p>
<p>è€Œæˆ‘ä»¬ä½¿ç”¨äº†setTimeoutä¹‹åçš„ä»»åŠ¡æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<p><code>onmousedown -&gt; button.onfocus =&gt; input.focus =&gt; onmouseup =&gt; onclick</code></p>
<p>onmouseXXX+setTimeoutäº‹ä»¶æµç¨‹</p>
<p>è€Œä»ä¸Šé¢çš„æµç¨‹ä¸Šæˆ‘ä»¬å¾—çŸ¥äº†å¦å¤–çš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠinput.focusæŒ‚åœ¨mouseupå’Œclickä¸‹ï¼Œå› ä¸ºåœ¨è¿™äº›äº‹ä»¶ä¹‹å‰ï¼Œæˆ‘ä»¬çš„æŒ‰é’®å·²ç»å¾—åˆ°è¿‡ç„¦ç‚¹äº†ï¼Œä¸ä¼šå†æŠ¢æˆ‘ä»¬çš„ç„¦ç‚¹äº†ã€‚</p>
<pre><code>makeBtn.click = function (e) {
    console.log(e.type);
    var input = document.createElement(&apos;input&apos;);
    input.setAttribute(&apos;type&apos;, &apos;text&apos;);
    input.setAttribute(&apos;value&apos;, &apos;test1&apos;);
    get(&apos;inpwrapper&apos;).appendChild(input);
    input.onfocus = function () {//è§‚å¯Ÿæˆ‘ä»¬æ–°ç”Ÿæˆçš„inputä»€ä¹ˆæ—¶å€™è·å–ç„¦ç‚¹çš„
        console.info(&apos;input focus&apos;);
    };
    input.focus();
    input.select();
}
</code></pre><p>æˆ‘ä»¬åº”è¯¥è®¤è¯†åˆ°ï¼Œåˆ©ç”¨setTimeout(fn,0)çš„ç‰¹æ€§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨æŸäº›æç«¯åœºæ™¯ä¸‹ï¼Œä¿®æ­£æµè§ˆå™¨çš„ä¸‹ä¸€ä¸ªä»»åŠ¡</p>
<p>æ€»ç»“ï¼š<br><strong>æ„æ€å°±æ˜¯è¯´inputçš„focusæœ‰æ‰§è¡Œï¼Œ åªæ˜¯è¢«buttonçš„mouseupå½±å“äº†ï¼Œæ‰€ä»¥è¦è¦æŠŠfocus()æ”¾åˆ°åé¢æ‰§è¡Œ<br>é¡µé¢ä¸Šåªæœ‰ä¸€ä¸ªå…ƒç´ èƒ½è·å¾—ç„¦ç‚¹ï¼Œå°±è¿™æ ·è€Œå·²ã€‚ã€‚</strong></p>
<p>å‚è€ƒå’Œå¼•ç”¨<br>JavaScriptå¼‚æ­¥æœºåˆ¶<br>ä»€ä¹ˆæ˜¯ Event Loop<br>javascriptçº¿ç¨‹è§£é‡Š<br>JavaScript - å‰ç«¯å¼€å‘äº¤æµç¾¤ï¼š377786580</p>
<p>ä½œè€…ï¼šlinkFly<br>åŸæ–‡ï¼š<a href="http://www.cnblogs.com/silin6/p/4333999.html" target="_blank" rel="noopener">http://www.cnblogs.com/silin6/p/4333999.html</a><br>å‡ºå¤„ï¼š<a href="http://www.cnblogs.com/silin6/" target="_blank" rel="noopener">www.cnblogs.com/silin6/</a></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½ ä¸çŸ¥é“çš„JSç³»åˆ—-thisæŒ‡å‘</title>
    <url>/2019/03/26/this/</url>
    <content><![CDATA[<p>thisæ˜¯jsä¸­æœ€å¤æ‚çš„æœºåˆ¶ä¹‹ä¸€</p>
<blockquote>
<p>ä»»ä½•è¶³å¤Ÿå…ˆè¿›çš„æŠ€æœ¯éƒ½å’Œé­”æ³•æ— å¼‚  - Arthur C.Clarke</p>
</blockquote>
<a id="more"></a>
<p>ä½†å…¶å®thisæœºåˆ¶å¹¶æ²¡æœ‰é‚£ä¹ˆå…ˆè¿›ï¼Œæ˜¯æˆ‘ä»¬çš„è‡†æƒ³æŠŠå®ƒæƒ³å¤æ‚äº†ï¼Œåœ¨ç¼ºä¹è®¤çŸ¥çš„æƒ…å†µä¸‹ï¼Œthiså¯¹ä½ æ¥è¯´å°±æ˜¯é­”æ³•</p>
<h3 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨thisï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨thisï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨thisï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨thisï¼Ÿ</h3><p>å®ƒæä¾›äº†ä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼æ¥éšå¼ä¼ é€’ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œå› æ­¤å¯ä»¥å°†APIè®¾è®¡å¾—æ›´åŠ ç®€æ´å¹¶ä¸”æ˜“äºä½¿ç”¨</p>
<h3 id="å¯¹äºthisçš„è¯¯è§£"><a href="#å¯¹äºthisçš„è¯¯è§£" class="headerlink" title="å¯¹äºthisçš„è¯¯è§£"></a>å¯¹äºthisçš„è¯¯è§£</h3><ol>
<li>æŒ‡å‘å‡½æ•°è‡ªèº«</li>
</ol>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">å¸¸è§éœ€è¦æŒ‡å‘è‡ªèº«çš„åœºæ™¯æ˜¯é€’å½’</span><br><span class="line">åŒ¿åçš„å‡½æ•°æ— æ³•æŒ‡å‘è‡ªèº«</span><br><span class="line">ä¼ ç»Ÿçš„<span class="selector-tag">arguments</span><span class="selector-class">.callee</span>å·²ç»å¼ƒç”¨</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸ</li>
</ol>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">thisåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼Œåœ¨<span class="keyword">js</span>å†…éƒ¨ä½œç”¨åŸŸå’Œå¯¹è±¡ç›¸ä¼¼ï¼Œå¯è§çš„æ ‡è¯†ç¬¦éƒ½æ˜¯å®ƒçš„å±æ€§,ä½†æ˜¯ä½œç”¨åŸŸâ€œå¯¹è±¡â€æ— æ³•é€šè¿‡<span class="keyword">js</span>ä»£ç è®¿é—®ï¼Œå®ƒå­˜åœ¨äº<span class="keyword">JS</span>å¼•æ“å†…éƒ¨</span><br></pre></td></tr></table></figure>
<h3 id="thisåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#thisåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="thisåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"></a>thisåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>thisæ˜¯è¿è¡Œæ—¶è¿›è¡Œç»‘å®šçš„ å¹¶ä¸æ˜¯åœ¨ç¼–å†™æ—¶ç»‘å®šçš„ å®ƒçš„ä¸Šä¸‹æ–‡å–å†³äºå‡½æ•°è°ƒç”¨æ—¶çš„å„ç§æ¡ä»¶ thisç»‘å®šå’Œå‡½æ•°å£°æ˜çš„ä½ç½®æ²¡æœ‰ä»»ä½•å…³ç³» åªå–å†³äºå‡½æ•°çš„è°ƒç”¨æ–¹å¼</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">å½“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ ä¼šåˆ›å»ºä¸€ä¸ªæ´»åŠ¨è®°å½•ï¼ˆæ‰§è¡Œä¸Šä¸‹æ–‡ï¼‰è¿™ä¸ªè®°å½•ä¼šåŒ…å«å‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼ˆè°ƒç”¨æ ˆï¼‰å‡½æ•°çš„è°ƒç”¨æ–¹æ³• ä¼ å…¥çš„å‚æ•°ç­‰ <span class="keyword">this</span>å°±æ˜¯è®°å½•çš„å…¶ä¸­ä¸€ä¸ªå±æ€§ä¼šåœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ç”¨åˆ°</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>æ—¶å‡½æ•°è¢«è°ƒç”¨æ—¶å‘ç”Ÿçš„ç»‘å®š æŒ‡å‘ä»€ä¹ˆå®Œå…¨å–å†³äºå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨</span><br></pre></td></tr></table></figure>
<h4 id="è°ƒç”¨ä½ç½®"><a href="#è°ƒç”¨ä½ç½®" class="headerlink" title="è°ƒç”¨ä½ç½®"></a>è°ƒç”¨ä½ç½®</h4><p>å¯»æ‰¾â€å‡½æ•°è¢«è°ƒç”¨çš„ä½ç½®â€<br>éœ€è¦åˆ†æè°ƒç”¨æ ˆï¼ˆä¸ºäº†åˆ°è¾¾å½“å‰æ‰§è¡Œä½ç½®æ‰€è°ƒç”¨çš„æ‰€æœ‰å‡½æ•°ï¼‰</p>
<h4 id="ç»‘å®šè§„åˆ™"><a href="#ç»‘å®šè§„åˆ™" class="headerlink" title="ç»‘å®šè§„åˆ™"></a>ç»‘å®šè§„åˆ™</h4><p>æ‰¾åˆ°è°ƒç”¨ä½ç½® ç„¶åæŒ‰ç…§ç»“è®ºä¸­çš„å››æ¡è§„åˆ™åˆ¤æ–­</p>
<h4 id="é»˜è®¤ç»‘å®š"><a href="#é»˜è®¤ç»‘å®š" class="headerlink" title="é»˜è®¤ç»‘å®š"></a>é»˜è®¤ç»‘å®š</h4><p>ç‹¬ç«‹å‡½æ•°è°ƒç”¨æ—¶ï¼Œå¦‚æœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°±ç»‘å®šåˆ°undefined å¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ </p>
<h4 id="éšå¼ç»‘å®š-å¯¹è±¡ä¸Šçš„å‡½æ•°è°ƒç”¨"><a href="#éšå¼ç»‘å®š-å¯¹è±¡ä¸Šçš„å‡½æ•°è°ƒç”¨" class="headerlink" title="éšå¼ç»‘å®š(å¯¹è±¡ä¸Šçš„å‡½æ•°è°ƒç”¨)"></a>éšå¼ç»‘å®š(å¯¹è±¡ä¸Šçš„å‡½æ•°è°ƒç”¨)</h4><p>å½“å‡½æ•°å¼•ç”¨æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡æ—¶ éšå¼ç»‘å®šè§„åˆ™ä¼šæŠŠå‡½æ•°ä¸­çš„thisç»‘å®šåˆ°è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡</p>
<p><strong>å¯¹è±¡å±æ€§å¼•ç”¨é“¾ä¸­åªæœ‰æœ€é¡¶å±‚æˆ–è€…è¯´æœ€åä¸€å±‚ä¼šå½±å“è°ƒç”¨ä½ç½®</strong></p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span><span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  console.log(this.a)</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">var</span> <span class="title">obj2</span> = <span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">  a:42,</span></span></span><br><span class="line"><span class="function"><span class="comment">  foo:foo</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj1 = <span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  a:2,</span></span><br><span class="line"><span class="comment">  obj2:obj2</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"></span><br><span class="line">obj1.obj2.foo(); <span class="comment">//42</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">10</span>,</span><br><span class="line">    c: <span class="keyword">this</span>.a + <span class="number">20</span>,</span><br><span class="line">    fn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(obj.c); <span class="comment">//40</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.fn()); <span class="comment">//10</span></span><br></pre></td></tr></table></figure>
<p>å•ç‹¬çš„{}æ˜¯ä¸ä¼šå½¢æˆæ–°çš„ä½œç”¨åŸŸçš„ï¼Œå› æ­¤è¿™é‡Œçš„<code>this.a</code>ï¼Œç”±äºå¹¶æ²¡æœ‰ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œæ‰€ä»¥å®ƒä»ç„¶å¤„äºå…¨å±€ä½œç”¨åŸŸä¹‹ä¸­ã€‚æ‰€ä»¥è¿™é‡Œçš„<code>this</code>å…¶å®æ˜¯æŒ‡å‘çš„<code>window</code>å¯¹è±¡ã€‚</p>
<p><strong>è¢«éšå¼ç»‘å®šçš„å‡½æ•°ä¼šä¸¢å¤±ç»‘å®šå¯¹è±¡è€Œæ‰§è¡Œé»˜è®¤ç»‘å®šè§„åˆ™ ä¸‹é¢æ˜¯ä¸¤ä¸ªåœºæ™¯</strong></p>
<p>1.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  a:<span class="number">2</span>,</span><br><span class="line">  foo:foo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bar = obj1.foo; <span class="comment">//å‡½æ•°åˆ«å</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">"global"</span>; <span class="comment">//å…¨å±€å±æ€§a</span></span><br><span class="line">bar(); <span class="comment">//barå¼•ç”¨çš„æ˜¯fooæœ¬èº« å› æ­¤æ­¤æ—¶çš„barå…¶å®æ˜¯ä¸€ä¸ªä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦çš„å‡½æ•°è°ƒç”¨ å› æ­¤ä½¿ç”¨äº†é»˜è®¤ç»‘å®š</span></span><br></pre></td></tr></table></figure>
<p><strong>2.å½“ä¼ å…¥å›è°ƒå‡½æ•°æ—¶ ä½¿ç”¨é»˜è®¤ç»‘å®šè§„åˆ™</strong></p>
<p>å‚æ•°ä¼ é€’å°±æ˜¯ä¸€ç§éšå¼èµ‹å€¼ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å…¥å‡½æ•°æ—¶ä¹Ÿä¼šè¢«éšå¼èµ‹å€¼</p>
<p>å¦‚æœæŠŠå‡½æ•°ä¼ å…¥è¯­è¨€å†…ç½®å‡½æ•° ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dofoo</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">  fn();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  a:<span class="number">2</span>,</span><br><span class="line">  foo:foo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">"global mama"</span>; <span class="comment">//å…¨å±€å±æ€§a</span></span><br><span class="line"></span><br><span class="line">dofoo(obj1.foo) <span class="comment">//global mama</span></span><br><span class="line"></span><br><span class="line">setTimeout(obj1.foo,<span class="number">100</span>) <span class="comment">//global mama å°†å‡½æ•°ä¼ å…¥è¯­è¨€å†…ç½®çš„å‡½æ•°</span></span><br><span class="line">ç›¸å½“äº</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setTimeout</span>(<span class="params">fn,delay</span>)</span>&#123;</span><br><span class="line"><span class="comment">//ç­‰å¾…delayä¹‹å</span></span><br><span class="line">fn() </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ˜¾å¼ç»‘å®š-ä½¿ç”¨call-apply-bind"><a href="#æ˜¾å¼ç»‘å®š-ä½¿ç”¨call-apply-bind" class="headerlink" title="æ˜¾å¼ç»‘å®š(ä½¿ç”¨call apply bind)"></a>æ˜¾å¼ç»‘å®š(ä½¿ç”¨call apply bind)</h4><p>é€šè¿‡å›ºå®šthisæ¥ä¿®å¤ï¼Œå¯ä»¥åœ¨æŸä¸ªå¯¹è±¡ä¸Šå¼ºåˆ¶è°ƒç”¨å‡½æ•°<br><code>ä½¿ç”¨ call apply æˆ–è€…bind</code></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">ä»–ä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°å¼å¯¹è±¡ï¼Œå®ƒä»¬ä¼šæŠŠè¿™ä¸ªå¯¹è±¡ç»‘å®šåˆ°<span class="keyword">this</span>ï¼Œæ¥ç€åœ¨è°ƒç”¨å‡½æ•°æ—¶æŒ‡å®šè¿™ä¸ª<span class="keyword">this</span> å› ä¸ºä½ å¯ä»¥ç›´æ¥æŒ‡å®š<span class="keyword">this</span>çš„ç»‘å®šå¯¹è±¡ å› æ­¤æˆ‘ä»¬ç§°ä¹‹ä¸ºæ˜¾å¼ç»‘å®š</span><br></pre></td></tr></table></figure>
<p>å¦‚æœ foo.call(1) //ä¸€ä¸ªåŸå§‹å€¼å½“ä½œå¯¹è±¡ è¿™ä¸ªåŸå§‹å€¼ä¼šè½¬æ¢æˆå®ƒçš„å¯¹è±¡å½¢å¼(è£…ç®±)</p>
<p><strong>å¯æƒœï¼Œæ˜¾ç¤ºç»‘å®šæ— æ³•è§£å†³ä¸¢å¤±ç»‘å®šçš„é—®é¢˜</strong></p>
<p>ä½†æ˜¯æ˜¾ç¤ºç»‘å®šçš„ä¸€ä¸ªå˜ç§â€œç¡¬ç»‘å®šâ€å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</p>
<p><strong>ç¡¬ç»‘å®š</strong>ï¼šæ— è®ºä½•æ—¶è°ƒç”¨å‡½æ•°barå®ƒæ€»ä¼šæ‰‹åŠ¨åœ¨objè°ƒç”¨foo è¿™ç§ç»‘å®šæ˜¯ä¸€ç§æ˜¾å¼çš„å¼ºåˆ¶ç»‘å®š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">  a:<span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;</span><br><span class="line">  a:<span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  foo.call(obj1)</span><br><span class="line">&#125;</span><br><span class="line">bar(); <span class="comment">//2</span></span><br><span class="line">setTimeout(bar,<span class="number">100</span>) <span class="comment">//2</span></span><br><span class="line">bar.call(obj2) <span class="comment">// 2 ç¡¬ç»‘å®šçš„barä¸å¯èƒ½å†ä¿®æ”¹å®ƒçš„this</span></span><br></pre></td></tr></table></figure>
<p>ç”±äºç¡¬ç»‘å®šæ˜¯ä¸€ç§å¸¸ç”¨çš„æ¨¡å¼ï¼Œæ‰€ä»¥ES5æä¾›äº†å†…ç½®çš„æ–¹æ³•<br><code>Function.prototype.bind</code></p>
<p>äº†è§£äº†ç”¨æ³• æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªdemo</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line">fn.bind().bind(a)() <span class="comment">// ?</span></span><br></pre></td></tr></table></figure>
<p>ç­”æ¡ˆåº”è¯¥æ˜¯<code>window</code> ä½ å›ç­”å¯¹äº†å—</p>
<p>äº‹å®ä¸Š æˆ‘ä¹ˆå¯ä»¥æ”¹å†™ä¸€ä¸‹</p>
<p>å®ƒç±»ä¼¼äº</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="keyword">this</span>)&#125;</span><br><span class="line"><span class="keyword">let</span> fn2 = <span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fn.apply();</span><br><span class="line">  &#125;.apply(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn2() <span class="comment">//window</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å„¿ç»“æœèƒ½çŒœåˆ°äº†å—</p>
<p>fnä¸­çš„thisæ°¸è¿œç”±<code>ç¬¬ä¸€ä¸ªbind</code>å†³å®š æ‰€ä»¥ ç»“æœæ°¸è¿œæ˜¯window</p>
<h4 id="newç»‘å®š"><a href="#newç»‘å®š" class="headerlink" title="newç»‘å®š"></a>newç»‘å®š</h4><figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">jsä¸­çš„æ„é€ å‡½æ•°åªæ˜¯ä¸€äº›ä½¿ç”¨<span class="keyword">new</span><span class="type"></span>æ“ä½œç¬¦æ—¶è¢«è°ƒç”¨çš„å‡½æ•° ä»–ä»¬ä¸å¹¶ä¸å±äºæŸä¸ªç±»ä¹Ÿä¸ä¼šå»å®ä¾‹åŒ–ä¸€ä¸ªç±» ä»–ä»¬åªæ˜¯è¢«<span class="keyword">new</span><span class="type"></span>æ“ä½œç¬¦è°ƒç”¨çš„æ™®é€šå‡½æ•°</span><br><span class="line"></span><br><span class="line">æ’æ’­<span class="keyword">new</span><span class="type"></span>è°ƒç”¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„æ“ä½œ</span><br><span class="line"><span class="number">1.</span> åˆ›å»ºï¼ˆæ„é€ ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼‰</span><br><span class="line"><span class="number">2.</span> è¿™ä¸ªå¯¹è±¡ä¼šè¢«æ‰§è¡ŒåŸå‹é“¾æ¥</span><br><span class="line"><span class="number">3.</span> è¿™ä¸ªä¿¡è´·æƒ³å›ç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„<span class="built_in">this</span></span><br><span class="line"><span class="number">4.</span> å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡é‚£ä¹ˆ<span class="keyword">new</span><span class="type"></span>è¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°å¯¹è±¡</span><br></pre></td></tr></table></figure>
<p>ç”±æ­¤å¯ä»¥çŸ¥é“ newæ“ä½œç¬¦è°ƒç”¨æ—¶ï¼ŒthisæŒ‡å‘ç”Ÿæˆçš„æ–°å¯¹è±¡<br>âš ï¸new è°ƒç”¨æ—¶çš„è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼è¿”å›å¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œæ‰ä¼šè¿”å›æ–°å¯¹è±¡<br>å…³äºè¿™ä¸€ç‚¹</p>
<p><a href>è¿™åº”è¯¥æ˜¯ä¸€ç¯‡å…³äºæ¨¡æ‹Ÿå®ç°JSçš„newæ“ä½œç¬¦çš„æ–‡ç« </a></p>
<h4 id="ç»‘å®šä¼˜å…ˆçº§"><a href="#ç»‘å®šä¼˜å…ˆçº§" class="headerlink" title="ç»‘å®šä¼˜å…ˆçº§"></a>ç»‘å®šä¼˜å…ˆçº§</h4><p>newè°ƒç”¨ &gt;æ˜¾ç¤ºç»‘å®š(apply,call,bind) &gt; éšå¼ç»‘å®šï¼ˆå¯¹è±¡ä¸Šçš„å‡½æ•°è°ƒç”¨ï¼‰ &gt; é»˜è®¤ç»‘å®š</p>
<h4 id="ç»‘å®šä¾‹å¤–"><a href="#ç»‘å®šä¾‹å¤–" class="headerlink" title="ç»‘å®šä¾‹å¤–"></a>ç»‘å®šä¾‹å¤–</h4><p>è§„åˆ™æ€»æœ‰ä¾‹å¤–ï¼Œè¿™é‡Œä¹Ÿä¸€æ ·</p>
<p>å½“ä½ æŠŠ<code>null</code>æˆ–è€…<code>undefined</code>ä½œä¸º<code>this</code>çš„ç»‘å®šå¯¹è±¡ä¼ å…¥<code>call apply</code>æˆ–è€…<code>bind</code> è¿™äº›åœ¨è°ƒç”¨æ—¶å€™ä¼šè¢«å¿½ç•¥åº”ç”¨é»˜è®¤è§„åˆ™<br>åº”ç”¨åœºæ™¯ï¼šå½“ä½ è¦ä¼ å…¥å‚æ•°æ—¶å€™ å¦‚æœå‡½æ•°ä¸å…³å¿ƒthisçš„è¯ ä½ å¯ä»¥ä¼ å…¥nullå½“ä½œä¸€ä¸ªå ä½å€¼ ä½†æ˜¯è¿™ç§æ–¹å¼ä¸å¯å– ç»‘å®šthiså¯èƒ½ä¼šå¼•èµ·å‰¯ä½œç”¨</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  a:<span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">3</span></span><br><span class="line">foo.call(<span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸€ç§æ›´å®‰å…¨çš„this</p>
<p><code>Object.create(null)</code>åˆ›å»ºçš„ç©ºå¯¹è±¡ä¸ä¼šåˆ›å»º<code>object.prototype</code> æ¯”<code>{}</code>æ›´ç©º æ¯”<code>null</code>çš„è¯­ä¹‰æ›´æ¸…æ¥š</p>
<p>ä»£ç å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a,b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> w = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">foo.apply(w,[<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨bind()è¿›è¡ŒæŸ¯é‡ŒåŒ–</span></span><br><span class="line"><span class="keyword">var</span> bar = foo.bind(w,<span class="number">2</span>)</span><br><span class="line">bar(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><strong>é—´æ¥å¼•ç”¨</strong><br>ä½ ä¼šæœ‰æ„æ— æ„çš„åˆ›å»ºä¸€ä¸ªå‡½æ•°çš„é—´æ¥å¼•ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¼šåº”ç”¨é»˜è®¤è§„åˆ™<br><strong>å®ƒæœ€å®¹æ˜“åœ¨èµ‹å€¼æ—¶äº§ç”Ÿ</strong><br>ç±»ä¼¼è¿™æ ·å„¿çš„</p>
<p><code>(p.foo = o.foo)();</code> å®ƒçš„è¿”å›å€¼æ˜¯ç›®æ ‡å‡½æ•°çš„å¼•ç”¨ï¼Œå› æ­¤è°ƒç”¨çš„ä½ç½®æ˜¯<code>foo()</code>è€Œä¸æ˜¯<code>p.foo()</code>æˆ–è€…<code>o.foo()</code>æ‰€ä»¥ä½¿ç”¨é»˜è®¤ç»‘å®š</p>
<h4 id="ç®­å¤´å‡½æ•°è°ƒç”¨æ¨¡å¼"><a href="#ç®­å¤´å‡½æ•°è°ƒç”¨æ¨¡å¼" class="headerlink" title="ç®­å¤´å‡½æ•°è°ƒç”¨æ¨¡å¼"></a>ç®­å¤´å‡½æ•°è°ƒç”¨æ¨¡å¼</h4><p>å…ˆçœ‹ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„é‡è¦åŒºåˆ«ï¼š</p>
<ol>
<li>æ²¡æœ‰è‡ªå·±çš„thisã€superã€argumentså’Œnew.targetç»‘å®šã€‚</li>
<li>ä¸èƒ½ä½¿ç”¨newæ¥è°ƒç”¨ã€‚</li>
<li>æ²¡æœ‰åŸå‹å¯¹è±¡ã€‚</li>
<li>ä¸å¯ä»¥æ”¹å˜thisçš„ç»‘å®šã€‚</li>
<li>å½¢å‚åç§°ä¸èƒ½é‡å¤ã€‚</li>
</ol>
<hr>
<p>ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰<code>this</code>ç»‘å®šï¼Œå¿…é¡»é€šè¿‡æŸ¥æ‰¾ä½œç”¨åŸŸé“¾æ¥å†³å®šå…¶å€¼ã€‚<br>å¦‚æœç®­å¤´å‡½æ•°è¢«éç®­å¤´å‡½æ•°åŒ…å«ï¼Œåˆ™<code>this</code>ç»‘å®šçš„æ˜¯æœ€è¿‘ä¸€å±‚éç®­å¤´å‡½æ•°çš„<code>this</code>ï¼Œå¦åˆ™<code>this</code>çš„å€¼åˆ™è¢«è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span>;</span><br><span class="line"><span class="keyword">var</span> student = &#123;</span><br><span class="line">    name: <span class="string">'ma'</span>,</span><br><span class="line">    doSth: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// var self = this;</span></span><br><span class="line">        <span class="keyword">var</span> arrowDoSth = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// console.log(self.name);</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">        arrowDoSth();</span><br><span class="line">    &#125;,</span><br><span class="line">    arrowDoSth2: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">student.doSth(); <span class="comment">// 'ma'</span></span><br><span class="line">student.arrowDoSth2(); <span class="comment">// 'window'</span></span><br></pre></td></tr></table></figure>
<h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><ul>
<li>thisä¸æŒ‡å‘å‡½æ•°è‡ªèº«</li>
<li>thisä¸æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼Œå½“ä½ æƒ³è¦æŠŠthiså’Œè¯æ³•ä½œç”¨åŸŸæŸ¥æ‰¾æ··åˆä½¿ç”¨æ—¶ï¼Œä¸€å®šè¦æé†’è‡ªå·± è¿™æ˜¯æ— æ³•å®ç°çš„</li>
<li>thiså®é™…ä¸Šæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶å‘ç”Ÿç»‘å®šçš„ï¼ŒæŒ‡å‘ä»€ä¹ˆå®Œå…¨å–å†³äºå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨</li>
<li>å¦‚æœè¦åˆ¤æ–­ä¸€ä¸ªè¿è¡Œä¸­å‡½æ•°çš„thisç»‘å®š å°±éœ€è¦æ‰¾åˆ°è¿™ä¸ªå‡½æ•°çš„ç›´æ¥è°ƒç”¨ä½ç½® æ‰¾åˆ°ä¹‹åæŒ‰ç…§ä¸‹é¢è¿™å››æ¡è§„åˆ™åˆ¤æ–­thisçš„ç»‘å®šå¯¹è±¡</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>ç”±newè°ƒç”¨ï¼Ÿç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡</span><br><span class="line"><span class="number">2.</span>ç”±callæˆ–applyæˆ–bindè°ƒç”¨(æ˜¾ç¤ºç»‘å®š)ï¼Ÿç»‘å®šåˆ°æŒ‡å®šçš„å¯¹è±¡</span><br><span class="line"><span class="number">3.</span>ç”±ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨ï¼ˆéšå¼ç»‘å®šï¼‰ï¼Ÿç»‘å®šåˆ°ä¸Šä¸‹æ–‡å¯¹è±¡</span><br><span class="line"><span class="number">4.</span>å¦‚æœéƒ½ä¸æ˜¯çš„è¯ ä½¿ç”¨é»˜è®¤ç»‘å®šï¼Œå¦‚æœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°±ç»‘å®šåˆ°undefined å¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡</span><br></pre></td></tr></table></figure>
<ul>
<li>ES6ä¸­çš„ç®­å¤´å‡½æ•°ä¸ä¼šä½¿ç”¨å››æ¡æ ‡å‡†çš„ç»‘å®šè§„åˆ™ï¼Œè€Œæ˜¯æ ¹æ®å½“å‰çš„è¯æ³•ä½œç”¨åŸŸæ¥å†³å®šthis,å®ƒä¼šç»§æ‰¿å¤–å±‚å‡½æ•°è°ƒç”¨çš„thisç»‘å®š(æ— è®ºthisç»‘å®šåˆ°ä»€ä¹ˆ),è¿™è·ŸES6ä¹‹å‰ä»£ç ä¸­çš„<code>self=this</code>æœºåˆ¶ä¸€æ ·ï¼ˆå®é™…ä¸Šç®­å¤´å‡½æ•°å°†ç¨‹åºçŒ¿ä»¬å¸¸çŠ¯çš„ä¸€ä¸ªé”™è¯¯ï¼š<font color="red">æ··æ·†thisç»‘å®šè§„åˆ™å’Œè¯æ³•ä½œç”¨åŸŸè§„åˆ™ </font>ç»™æ ‡å‡†åŒ–äº†,è¿™ç‚¹å®¹æ˜“é€ æˆè¯¯è§£ï¼‰</li>
<li>DOMäº‹ä»¶å‡½æ•°ï¼šä¸€èˆ¬æŒ‡å‘ç»‘å®šäº‹ä»¶çš„DOMå…ƒç´ ï¼Œä½†æœ‰äº›æƒ…å†µç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼ˆæ¯”å¦‚IE6~IE8çš„attachEventï¼‰</li>
</ul>
<p>æ£€éªŒä¸€ä¸‹å­¦ä¹ æˆæœ</p>
<p><a href="https://www.cnblogs.com/xxcanghai/p/5189353.html" target="_blank" rel="noopener">å°å°æ²§æµ·ï¼šä¸€é“å¸¸è¢«äººè½»è§†çš„å‰ç«¯JSé¢è¯•é¢˜</a><br><a href="https://segmentfault.com/a/1190000010981003" target="_blank" rel="noopener">ä»è¿™ä¸¤å¥—é¢˜ï¼Œé‡æ–°è®¤è¯†JSçš„thisã€ä½œç”¨åŸŸã€é—­åŒ…ã€å¯¹è±¡</a></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>this</tag>
      </tags>
  </entry>
  <entry>
    <title>å‡½æ•°èŠ‚æµä¸é˜²æŠ–</title>
    <url>/2019/02/19/throttleAnddebounce/</url>
    <content><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åšå®¢ä¸­çš„å¤§éƒ¨åˆ†æ–‡ç«  å¤§éƒ¨åˆ†éƒ½æœ‰ä¸€ä¸ªå¼•å­ï¼Œè¦è¯´æ˜çš„é€šå¸¸æ˜¯ä¸€äº›é›¶é›¶ç¢ç¢æˆ–è€…å¤§å¤šè€³ç†Ÿèƒ½è¯¦çš„â€œçŸ¥è¯†ç‚¹â€</p>
<p>æˆ‘è®¤ä¸ºé‡åˆ°äº†é—®é¢˜ è§£å†³äº†é—®é¢˜ ç„¶åæ‰ä¼šå½¢æˆä¸€ä¸ªçŸ¥è¯†ç‚¹è€Œä¸æ˜¯ä¸ºäº†åº”ç”¨æŸä¸ªçŸ¥è¯†ç‚¹å»æ­å»ºåœºæ™¯ï¼Œå¦åˆ™ çœŸçš„æ˜¯è¿‡ç›®å³å¿˜<br>è§£å†³æœ€è¿‘ä¸€ä¸ªé—®é¢˜ä¹‹å‰ å¹¶æ²¡æœ‰è®¡åˆ’å†™å…³äºé˜²æŠ–å’ŒèŠ‚æµçš„é—®é¢˜ï¼Œé—®é¢˜å¼•å¯¼ä½ è¯´ éœ€è¦é‡è§†è¿™ä¸€å—å„¿äº†</p>
<p>æ­¤æ–‡ç³» ä¸è¦å†é—®æˆ‘XXç³»åˆ—ä¹‹ <font color="red">ä¸è¦å†é—®æˆ‘å‡½æ•°èŠ‚æµå’Œé˜²æŠ–äº†</font></p>
<a id="more"></a>
<h3 id="å¼•å‡ºé—®é¢˜"><a href="#å¼•å‡ºé—®é¢˜" class="headerlink" title="å¼•å‡ºé—®é¢˜"></a>å¼•å‡ºé—®é¢˜</h3><p>éœ€æ±‚ï¼šè®°å½•ç”¨æˆ·çš„æµè§ˆæ·±åº¦</p>
<p><img src="/images/throllte/scroll.gif" alt="---"></p>
<p>ä¸€æ—¦ä½ ä½¿ç”¨äº†ç±»ä¼¼<code>scroll</code>çš„æµè§ˆå™¨äº‹ä»¶ï¼Œè§¦å‘é¢‘ç‡æ¯”è¾ƒé«˜ï¼Œè‹¥ç¨å¤„ç†å‡½æ•°å¾®å¤æ‚ï¼Œéœ€è¦è¾ƒå¤šçš„è¿ç®—æ‰§è¡Œæ—¶é—´ï¼Œå“åº”é€Ÿåº¦è·Ÿä¸ä¸Šè§¦å‘é¢‘ç‡ï¼Œå¾€å¾€ä¼šå‡ºç°å»¶è¿Ÿï¼Œä¼šå‡ºç°å¡é¡¿ç”šè‡³å¼•å‘å‡æ­»</p>
<p>åœ¨èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•åªå“åº”éƒ¨åˆ†è¯·æ±‚ï¼Œäº‹å®ä¸ŠæŸäº›åœºæ™¯ä¸‹çš„å¯†é›†æ€§è¯·æ±‚ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„</p>
<p>æ­¤æ—¶ æˆ‘å¹¶ä¸çŸ¥é“ éœ€è¦ç”¨ â€œé˜²æŠ–â€è¿™ä¸ªæ™¦æ¶©çš„ç»“è®ºå»è§£å†³ï¼ŒåªçŸ¥é“ç›®çš„æ˜¯åªæ˜¯åœ¨<strong>æµè§ˆåˆ°</strong>è¿™è¾†è½¦çš„æ—¶å€™æ‰“ç‚¹</p>
<hr>
<p><strong>é‚£ç¨‹åºä¸­è¦æ€ä¹ˆä½“ç°<font color="red">æˆ‘æµè§ˆåˆ°</font>è¿™ä¸ªæ¦‚å¿µå‘¢ï¼Ÿ</strong></p>
<p>å…ˆè¦çº¦å®šä¸€ä»¶äº‹<br>å‡è®¾ç”¨æˆ·æµè§ˆåˆ°æŸä¸€è¾†è½¦ä¹‹ååœé¡¿äº†è¶…è¿‡ä½ é¢„è®¾çš„æ—¶é—´å€¼ å°±è®¤ä¸ºæ˜¯æµè§ˆäº†</p>
<p>åˆ©ç”¨<code>setTimeout</code>å®ç°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> timeout = <span class="literal">null</span>;   </span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;        </span><br><span class="line">            clearTimeout(timeout);</span><br><span class="line">            timeout = setTimeout(fn,<span class="number">200</span>);</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡é—­åŒ…ä¿å­˜ä¸€ä¸ªå®šæ—¶å™¨çš„æ ‡è®°<code>timeout</code>ï¼Œå†æ¬¡æ‰§è¡Œçš„æ—¶å€™clearæ‰ä¹‹å‰çš„ï¼Œåˆé‡æ–°è®¡æ—¶ è¿™å°±ä¿è¯äº† è§¦å‘éå¸¸é¢‘ç¹çš„<code>scroll</code>äº‹ä»¶åˆå¹¶æˆä¸€æ¬¡æ‰§è¡Œã€‚å½“è°ƒç”¨åŠ¨ä½œè¿‡næ¯«ç§’åï¼Œæ‰ä¼šæ‰§è¡Œè¯¥åŠ¨ä½œï¼Œè‹¥åœ¨è¿™næ¯«ç§’å†…åˆè°ƒç”¨æ­¤åŠ¨ä½œåˆ™å°†é‡æ–°è®¡ç®—æ‰§è¡Œæ—¶é—´ æ‰€ä»¥çŸ­æ—¶é—´å†…çš„è¿ç»­åŠ¨ä½œæ°¸è¿œåªä¼šè§¦å‘ä¸€æ¬¡ï¼Œæ¯”å¦‚è¯´ç”¨æ‰‹æŒ‡ä¸€ç›´æŒ‰ä½ä¸€ä¸ªå¼¹ç°§ï¼Œå®ƒå°†ä¸ä¼šå¼¹èµ·ç›´åˆ°ä½ æ¾æ‰‹ä¸ºæ­¢</p>
<p>ç°åœ¨çš„æ•ˆæœ</p>
<p><img src="/images/throllte/fangdou111.gif" alt="fangdou111"></p>
<p>å¥½åƒå—æ§åˆ¶äº† æ»‘åŠ¨è¿‡ç¨‹ä¸­ä¸ä¼šæ‰§è¡Œï¼Œä¸€æ—¦æˆ‘ä»¬åœä¸‹è¶…è¿‡næ¯«ç§’ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡<br>ç”±æ­¤å¾—åˆ°ä¸€ä¸ªç»“è®º</p>
<font color="red">å¤„ç†æ­¤ç±»é—®é¢˜å°±æ˜¯è¦ä¿è¯å‡½æ•°åœ¨ç‰¹å®šçš„æ—¶é—´å†…ï¼ˆä½ è®¾ç½®çš„å»¶è¿Ÿæ—¶é—´ï¼‰ä¸è¢«å†è°ƒç”¨åæ‰§è¡Œ</font>

<p>æˆ‘ä»¬çš„é—®é¢˜è§£å†³äº†ï¼Œä¸Šç½‘éšä¾¿ä¸€æœï¼Œå®ƒæ˜¯ä¸€ç±»<code>çŸ¥è¯†ç‚¹</code>ï¼Œè¶Šå‘æ„Ÿå…´è¶£æƒ¹</p>
<hr>
<h3 id="å¾—å‡ºç»“è®º-å¼•å‡º-é˜²æŠ–-ä¸-èŠ‚æµ"><a href="#å¾—å‡ºç»“è®º-å¼•å‡º-é˜²æŠ–-ä¸-èŠ‚æµ" class="headerlink" title="å¾—å‡ºç»“è®º å¼•å‡º é˜²æŠ– ä¸ èŠ‚æµ"></a>å¾—å‡ºç»“è®º å¼•å‡º é˜²æŠ– ä¸ èŠ‚æµ</h3><p>æ‰€ä»¥è¯´æˆ‘ä»¬ç›´æ¥æ¥è§¦åˆ°äº† <code>å‡½æ•°é˜²æŠ–</code>ï¼Œåœ¨æ­¤ä¹‹å‰ æˆ‘è§‰å¾—å®ƒæ˜¯æ™¦æ¶©éš¾æ‡‚çš„ï¼Œç°åœ¨è¶Šå‘æ¸…æ™°äº†<br>è¯´åˆ°è¿™å„¿ ä¸å¾—ä¸æå¦ä¸€ä¸ªå…„å¼Ÿ <code>å‡½æ•°èŠ‚æµ</code>ï¼Œå› ä¸ºåº”ç”¨åœºæ™¯ç›¸ä¼¼è€Œä¸ç›¸åŒï¼Œæ‰€ä»¥ç»å¸¸ä¼šè¢«æ‹¿æ¥æ¯”è¾ƒ</p>
<h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>ç½‘ä¸Šæœ‰å¾ˆå¤šå…³äºä¸¤è€…çš„æ¦‚å¿µ<br>ç®€å•æ¥è®²ï¼š<br><strong>å‡½æ•°èŠ‚æµ</strong>ï¼šæŒ‡å®šæ—¶é—´é—´éš”å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">ğŸŒ°<span class="number">1</span></span><br><span class="line">ä¸€ä¸ªæ¯”è¾ƒå½¢è±¡çš„ä¾‹å­æ˜¯å¦‚æœå°†æ°´é¾™å¤´æ‹§ç´§ç›´åˆ°æ°´æ˜¯ä»¥æ°´æ»´çš„å½¢å¼æµå‡ºï¼Œé‚£ä½ ä¼šå‘ç°æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå°±ä¼šæœ‰ä¸€æ»´æ°´æµå‡º</span><br><span class="line">ğŸŒ°<span class="number">2</span></span><br><span class="line">åœ°é“é—¸æœºï¼Œæ¯ä¸ªäººè¿›å…¥å<span class="number">3</span>ç§’åé—¨å…³é—­ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªäººè¿›å…¥ã€‚</span><br></pre></td></tr></table></figure>
<p><strong>å‡½æ•°é˜²æŠ–</strong>ï¼šä»»åŠ¡é¢‘ç¹è§¦å‘çš„æƒ…å†µä¸‹ï¼Œåªæœ‰ä»»åŠ¡è§¦å‘çš„é—´éš”è¶…è¿‡æŒ‡å®šé—´éš”çš„æ—¶å€™ï¼Œä»»åŠ¡æ‰ä¼šæ‰§è¡Œ ï¼ˆå½“ä¸€ä¸ªåŠ¨ä½œè¿ç»­è§¦å‘ï¼Œåªæ‰§è¡Œæœ€åä¸€æ¬¡ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ğŸŒ°</span><br><span class="line">ç”¨æ‰‹æŒ‡ä¸€ç›´æŒ‰ä½ä¸€ä¸ªå¼¹ç°§ï¼Œå®ƒå°†ä¸ä¼šå¼¹èµ·ç›´åˆ°ä½ æ¾æ‰‹ä¸ºæ­¢</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸‹å›¾ æ„Ÿå—ä¸€ä¸‹ä¸‰ç§ç¯å¢ƒå¯¹äº<code>mousemove</code>äº‹ä»¶å›è°ƒçš„æ‰§è¡Œæƒ…å†µ<br><img src="/images/throllte/fn_dou.png" alt="fn_dou"></p>
<p>ç«–çº¿çš„ç–å¯†ç¨‹åº¦ä»£è¡¨äº‹ä»¶ä¹‹è¡Œçš„é¢‘ç¹ç¨‹åº¦<br><strong>å¯ä»¥å¾—åˆ°</strong>ï¼š</p>
<ul>
<li>æ­£å¸¸æƒ…å†µä¸‹ å‡½æ•°æ‰§è¡Œçš„éå¸¸é¢‘ç¹</li>
<li>å»æŠ–ä¹‹åå¾ˆç¨€ç– åªæœ‰å½“é¼ æ ‡åœæ­¢ç§»åŠ¨æ—¶æ‰ä¼šæ‰§è¡Œä¸€æ¬¡</li>
<li>èŠ‚æµåˆ†å¸ƒçš„æ¯”è¾ƒå‡åŒ€ æ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šæ‰§è¡Œä¸€æ¬¡</li>
</ul>
<hr>
<h4 id="demoç¤ºä¾‹"><a href="#demoç¤ºä¾‹" class="headerlink" title="demoç¤ºä¾‹"></a>demoç¤ºä¾‹</h4><p>åŸç”Ÿscroll</p>
<p><img src="/images/throllte/scrolldemo.gif" alt="scrolldemo"></p>
<p>å‡½æ•°å»æŠ–</p>
<p><img src="/images/throllte/debouce.gif" alt="debouce"></p>
<p>å‡½æ•°èŠ‚æµ<br><img src="/images/throllte/throllte.gif" alt="throllte"></p>
<p>æˆ‘ä»¬åœ¨çœŸå®åœºæ™¯ä¸­å¯ä»¥æ„Ÿå—åˆ°æ— è®ºé‡‡å–å“ªç§æ–¹æ¡ˆéƒ½ä¼šæ˜æ˜¾å‡å°‘äº†å›è°ƒçš„æ‰§è¡Œï¼Œå¾—åˆ°äº† éƒ½æ˜¯ç”¨æ¥æ§åˆ¶æŸä¸ªå‡½æ•°åœ¨ä¸€å®šæ—¶é—´å†…æ‰§è¡Œæ¬¡æ•°çš„å¤šå°‘ä»¥ä¼˜åŒ–é«˜é¢‘ç‡æ‰§è¡Œjsä»£ç çš„ä¸€ç§æŠ€å·§ï¼Œä¸¤è€…ç›¸ä¼¼è€Œåˆä¸åŒçš„ç»“è®º</p>
<p>é‚£ä¹ˆ æˆ‘ä»¬ å¦‚ä½•é€‰æ‹©è¿™ä¸¤ç§æ–¹æ¡ˆï¼Ÿ</p>
<h4 id="ä¼˜åŒ–æ–¹æ¡ˆçš„åº”ç”¨åœºæ™¯"><a href="#ä¼˜åŒ–æ–¹æ¡ˆçš„åº”ç”¨åœºæ™¯" class="headerlink" title="ä¼˜åŒ–æ–¹æ¡ˆçš„åº”ç”¨åœºæ™¯"></a>ä¼˜åŒ–æ–¹æ¡ˆçš„åº”ç”¨åœºæ™¯</h4><p>é€‰æ‹©å“ªä¸ª å–å†³äºåº”ç”¨åœºæ™¯</p>
<hr>
<p><strong>å‡½æ•°é˜²æŠ–</strong></p>
<p>å¦‚æœä½ çš„éœ€æ±‚æ˜¯è¿ç»­çš„æ—¶é—´åªéœ€è¦è§¦å‘ä¸€æ¬¡å›è°ƒ</p>
<p>æ¯”å¦‚ï¼š</p>
<ol>
<li>æœç´¢æ¡†è¾“å…¥ å¯èƒ½éœ€è¦ç­‰åˆ°ç”¨æˆ·æœ€åä¸€æ¬¡è¾“å…¥å®Œ å†å»å‘é€è¯·æ±‚</li>
<li>æ‰‹æœºå·ï¼Œé‚®ç®±ç­‰è¾“å…¥æ£€æµ‹</li>
<li>æµè§ˆå™¨çª—å£çš„<code>resize</code> ä½ è‚¯å®šè¦ç­‰åˆ°çª—å£è°ƒæ•´å®Œæˆåå†è¿›è¡Œæ¸²æŸ“</li>
<li>scrolläº‹ä»¶ç­‰</li>
</ol>
<p><strong>å‡½æ•°èŠ‚æµ</strong></p>
<p>å›ºå®šæ—¶é—´é—´éš”æ‰§è¡Œçš„</p>
<p>æ¯”å¦‚ï¼š</p>
<ol>
<li>æ»šåŠ¨åŠ è½½ å¸¸å¸¸éœ€è¦æ»šåŠ¨åˆ°åº•éƒ¨åŠ è½½ä¸‹ä¸€é¡µ</li>
<li>è¡¨å•çš„é‡å¤æäº¤</li>
<li>è¿›åº¦æ¡çš„æ›´æ–°</li>
<li>é«˜é¢‘çš„ç‚¹å‡»ï¼ˆæ¯”å¦‚æŠ½å¥–ï¼‰</li>
<li>é«˜é¢‘çš„é¼ æ ‡ç§»åŠ¨ï¼Œæ¸¸æˆå°„å‡»ç±»çš„</li>
</ol>
<p>å“¦ ç†è§£äº†å¦‚ä½•é€‰æ‹© ä¸‹ä¸€ä¸ªé—®é¢˜å°±æ˜¯å¦‚ä½•ç”¨</p>
<hr>
<h4 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h4><p>å¼•å‡ºé—®é¢˜æ¨¡å— å…¶å®æˆ‘ä»¬å·²ç»åšåˆ°äº† <code>é˜²æŠ–</code></p>
<p><strong>å‡½æ•°é˜²æŠ–ï¼ˆdebounceï¼‰ç®€å•å®ç°</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>, <span class="keyword">this</span>.debounce(<span class="keyword">this</span>.scrollListener, <span class="number">500</span>), <span class="literal">false</span>);</span><br><span class="line">   </span><br><span class="line">  debounce = <span class="function">(<span class="params">fn, wait</span>) =&gt;</span> &#123;  </span><br><span class="line">        <span class="keyword">var</span> timeout = <span class="literal">null</span>;   </span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;        </span><br><span class="line">            <span class="keyword">if</span>(timeout !== <span class="literal">null</span>)&#123;</span><br><span class="line">                clearTimeout(timeout);</span><br><span class="line">            &#125;; </span><br><span class="line">            timeout = setTimeout(fn, wait);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å‡½æ•°é˜²æŠ–åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œæœ‰500msçš„å»¶è¿Ÿã€‚å†æ¬¡æ‰§è¡Œæ—¶ï¼Œè‹¥å‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡æœªæ‰§è¡Œå®Œï¼Œåˆ™ clear æ‰å®šæ—¶ä»»åŠ¡ï¼Œé‡æ–°å®šæ—¶</p>
<hr>
<p><strong>å‡½æ•°èŠ‚æµï¼ˆthrottleï¼‰</strong></p>
<p>å®šæ—¶å™¨ç‰ˆæœ¬å®ç°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> _.throttle = <span class="function">(<span class="params">func, wait</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">     <span class="comment">// åˆ¤æ–­æ˜¯å¦å·²ç©ºé—²ï¼Œå¦‚æœåœ¨æ‰§è¡Œä¸­ï¼Œåˆ™ç›´æ¥return</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      func();</span><br><span class="line">      timer = <span class="literal">null</span>;</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å‡½æ•°èŠ‚æµçš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†é™åˆ¶å‡½æ•°ä¸€æ®µæ—¶é—´å†…<strong>åªèƒ½æ‰§è¡Œä¸€æ¬¡</strong> ä½¿ç”¨<code>setTimeout</code>æ‰§è¡Œã€‚åœ¨å»¶æ—¶çš„æ—¶é—´å†…ï¼Œæ–¹æ³•è‹¥è¢«è§¦å‘ï¼Œåˆ™ç›´æ¥é€€å‡ºæ–¹æ³•ã€‚ä»è€Œè¾¾åˆ°å‡½æ•°ä¸€æ®µæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡çš„ç›®çš„</p>
<p>æ—¶é—´æˆ³ç‰ˆç®€å•å®ç°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> throttle = <span class="function">(<span class="params">func, wait</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> last = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> current_time = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (current_time - last &gt; wait) &#123;</span><br><span class="line">      func.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">      last = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å…¶å®ç°åŸç†ï¼Œé€šè¿‡æ¯”å¯¹ä¸Šä¸€æ¬¡æ‰§è¡Œæ—¶é—´ä¸æœ¬æ¬¡æ‰§è¡Œæ—¶é—´çš„æ—¶é—´å·®ä¸é—´éš”æ—¶é—´çš„å¤§å°å…³ç³»ï¼Œæ¥åˆ¤æ–­æ˜¯å¦æ‰§è¡Œå‡½æ•°ã€‚è‹¥æ—¶é—´å·®å¤§äºé—´éš”æ—¶é—´ï¼Œåˆ™ç«‹åˆ»æ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚å¹¶æ›´æ–°ä¸Šä¸€æ¬¡æ‰§è¡Œæ—¶é—´ã€‚</p>
<hr>
<h4 id="å‡½æ•°èŠ‚æµä¸å‡½æ•°é˜²æŠ–å¼‚åŒ"><a href="#å‡½æ•°èŠ‚æµä¸å‡½æ•°é˜²æŠ–å¼‚åŒ" class="headerlink" title="å‡½æ•°èŠ‚æµä¸å‡½æ•°é˜²æŠ–å¼‚åŒ"></a>å‡½æ•°èŠ‚æµä¸å‡½æ•°é˜²æŠ–å¼‚åŒ</h4><p>å…¶å®åˆ°è¿™é‡Œåº”è¯¥æ¯”è¾ƒèƒ½æ¸…æ™°çš„ç†è§£ç”šè‡³é€‰æ‹©é€‚åˆçœŸå®åœºæ™¯çš„ä¼˜åŒ–æ–¹æ¡ˆäº†</p>
<p><strong>ç›¸åŒç‚¹</strong></p>
<ul>
<li>éƒ½å¯ä»¥é€šè¿‡å»¶æ—¶å™¨å®ç°</li>
<li>ç›®çš„éƒ½æ˜¯ é™ä½å›è°ƒæ‰§è¡Œé¢‘ç‡ èŠ‚çº¦è®¡ç®—æœºèµ„æº</li>
</ul>
<p><strong>ä¸åŒç‚¹</strong></p>
<ul>
<li><p>å…¶å®ä»ä¸¤è€…çš„æ¦‚å¿µä¹Ÿèƒ½çœ‹å‡ºæ¥</p>
</li>
<li><p>å‡½æ•°é˜²æŠ–ï¼šå…³æ³¨ä¸€å®šæ—¶é—´è¿ç»­è§¦å‘ï¼Œåªåœ¨æœ€åæ‰§è¡Œä¸€æ¬¡</p>
</li>
<li>å‡½æ•°èŠ‚æµï¼šä¸€æ®µæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡ã€‚</li>
</ul>
<h3 id="å†™åœ¨æœ€åçš„è¯"><a href="#å†™åœ¨æœ€åçš„è¯" class="headerlink" title="å†™åœ¨æœ€åçš„è¯"></a>å†™åœ¨æœ€åçš„è¯</h3><p>å¾ˆå¤šæ—¶å€™ å¸¦ç€é—®é¢˜æ¥éªŒè¯ç»“è®º æ›´èƒ½æŠŠè‡ªå·±ç½®èº«åˆ°åœºæ™¯ä¸­è€ƒè™‘</p>
<h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a href="https://jinlong.github.io/2016/04/24/Debouncing-and-Throttling-Explained-Through-Examples/" target="_blank" rel="noopener">https://jinlong.github.io/2016/04/24/Debouncing-and-Throttling-Explained-Through-Examples/</a><br><a href="https://github.com/hanzichi/underscore-analysis/issues/20" target="_blank" rel="noopener">https://github.com/hanzichi/underscore-analysis/issues/20</a><br><a href="https://segmentfault.com/a/1190000008768202" target="_blank" rel="noopener">https://segmentfault.com/a/1190000008768202</a></p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>å†™åœ¨å…¥èŒä¸¤å‘¨å¹´</title>
    <url>/2019/03/22/twoYears/</url>
    <content><![CDATA[<p>åšå®¢è®¡åˆ’</p>
]]></content>
  </entry>
  <entry>
    <title>ä¸€ä¸ªé¡µé¢ä»è¾“å…¥urlåˆ°åŠ è½½å®Œæˆ è¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆ</title>
    <url>/2019/03/31/urlrender/</url>
    <content><![CDATA[<h4 id="å…ˆæ¥äº†è§£ä»¥ä¸‹-äº”å±‚å› ç‰¹å°”åè®®æ ˆ"><a href="#å…ˆæ¥äº†è§£ä»¥ä¸‹-äº”å±‚å› ç‰¹å°”åè®®æ ˆ" class="headerlink" title="å…ˆæ¥äº†è§£ä»¥ä¸‹ äº”å±‚å› ç‰¹å°”åè®®æ ˆ"></a>å…ˆæ¥äº†è§£ä»¥ä¸‹ äº”å±‚å› ç‰¹å°”åè®®æ ˆ</h4><ul>
<li>åº”ç”¨å±‚ï¼ˆdns httpï¼‰ DNSè§£ææˆipå¹¶å®Œæˆhttpè¯·æ±‚å‘é€</li>
<li>ä¼ è¾“å±‚ï¼ˆtcp udpï¼‰ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹å»ºç«‹tcpé“¾æ¥</li>
<li>ç½‘ç»œå±‚ ï¼ˆip ARPï¼‰ IPå¯»å€</li>
<li>æ•°å­—é“¾è·¯å±‚ å°†è¯·æ±‚æ•°æ®å°è£…æˆå¸§</li>
<li>ç‰©ç†å±‚ åˆ©ç”¨ç‰©ç†ä»‹è´¨ä¼ è¾“æ¯”ç‰¹æµ</li>
</ul>
<a id="more"></a>
<h4 id="ç®€ä»‹ç‰ˆæœ¬"><a href="#ç®€ä»‹ç‰ˆæœ¬" class="headerlink" title="ç®€ä»‹ç‰ˆæœ¬"></a>ç®€ä»‹ç‰ˆæœ¬</h4><ol>
<li>æµè§ˆå™¨æ ¹æ®è¯·æ±‚çš„urläº¤ç»™DNSè§£æ æ‰¾åˆ°è¿™çœŸå®IP å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚</li>
<li>æœåŠ¡å™¨äº¤ç»™åå°å¤„ç†å®Œæˆåè¿”å›æ•°æ®ï¼Œæµè§ˆå™¨æ¥æ”¶æ–‡ä»¶ï¼ˆhtml,css javascript)ç­‰</li>
<li>æµè§ˆå™¨å¯¹åŠ è½½åˆ°çš„èµ„æºè¿›è¡Œè¯­æ³•è§£æï¼Œæ„å»ºç›¸åº”çš„å†…éƒ¨æ•°æ®ç»“æ„ï¼ˆDomæ ‘ cssæ ‘ renderæ ‘ç­‰ï¼‰</li>
<li>è½½å…¥è§£æåˆ°çš„èµ„æºæ–‡ä»¶æ¸²æŸ“é¡µé¢å®Œæˆ</li>
</ol>
<h4 id="è¯¦ç»†ç‰ˆæœ¬"><a href="#è¯¦ç»†ç‰ˆæœ¬" class="headerlink" title="è¯¦ç»†ç‰ˆæœ¬"></a>è¯¦ç»†ç‰ˆæœ¬</h4><ol>
<li>æµè§ˆå™¨å¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¯¹urlè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯httpåè®®ï¼Œåˆ™å°±æŒ‰ç…§webçš„æ–¹å¼æ¥å¤„ç†</li>
<li>æµè§ˆå™¨è§£æurlï¼Œä¸€èˆ¬æˆ‘ä¹ˆè¾“å…¥çš„éƒ½æ˜¯æœåŠ¡å™¨åŸŸåï¼Œæˆ‘ä»¬ä¼šå…ˆæŸ¥æ‰¾å¯¹åº”çš„ip</li>
<li>é¦–å…ˆä¼šæŸ¥çœ‹æµè§ˆå™¨çš„DNSç¼“å­˜,å¦‚æœå­˜åœ¨ï¼Œåˆ™åŸŸåè§£æåˆ°æ­¤å®Œæˆ</li>
<li>å¦‚æœæµè§ˆå™¨è‡ªèº«çš„ç¼“å­˜æ²¡æœ‰æ‰¾åˆ°ç›¸åº”çš„æ¡ç›®ï¼Œå°±ä¼šå°è¯•è¯»å–æ“ä½œç³»ç»Ÿçš„hostæ–‡ä»¶æ¥çœ‹æ—¶éƒ½å­˜åœ¨å¯¹åº”çš„æ˜ å°„å…³ç³»</li>
<li>å¦‚æœhostæ–‡ä»¶æ²¡æœ‰ï¼Œç»§ç»­æŸ¥æ‰¾æœ¬åœ°çš„åŸŸåæœåŠ¡å™¨</li>
<li>å¦‚æœæœ¬åœ°çš„åŸŸåæœåŠ¡å™¨è¿˜æ²¡æœ‰æ‰¾åˆ°çš„è¯ ï¼Œå®ƒå°±ä¼šå‘è·ŸæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè¿›è¡Œé€’å½’æŸ¥è¯¢</li>
<li>æŸ¥åˆ°äº†IPåœ°å€ï¼Œä¼šå°†è®°å½•å­˜å‚¨åœ¨æœ¬åœ°ç¼“å­˜ï¼Œæ­¤æ—¶ç½‘ç»œå±‚ä¾¿ä¼šé€šè¿‡ipåœ°å€å¯»å¾—å¯¹åº”æœåŠ¡å™¨çš„ç‰©ç†åœ°å€</li>
<li>å¯»å¾—æœåŠ¡å™¨çš„åœ°å€ å®¢æˆ·ç«¯åœ¨ç½‘ç»œä¼ è¾“å±‚ä¾¿å¯ä»¥å’ŒæœåŠ¡å™¨é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹TCPIPé“¾æ¥</li>
</ol>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">TCPIPè¯·æ±‚</span><br><span class="line"></span><br><span class="line">httpçš„æœ¬è´¨å°±æ˜¯TCP/IPè¯·æ±‚</span><br><span class="line">éœ€è¦ç»å†ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹é“¾æ¥ <span class="number">4</span>æ¬¡æŒ¥æ‰‹æ–­å¼€è¿æ¥</span><br><span class="line">TCPå°†httpé•¿æŠ¥æ–‡åˆ’åˆ†ä¸ºçŸ­æŠ¥æ–‡ï¼Œé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ä¸æœåŠ¡å™¨å»ºç«‹é“¾æ¥è¿›è¡Œå¯é ä¼ è¾“</span><br><span class="line"></span><br><span class="line">ä¸‰æ¬¡æ¡æ‰‹</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> å®¢æˆ·ç«¯ï¼šä½ æ˜¯XXæœåŠ¡å™¨å—</span><br><span class="line"><span class="number">2.</span> æœåŠ¡ç«¯ï¼šæˆ‘æ˜¯XXæœåŠ¡å™¨ï¼Œä½ æ˜¯å®¢æˆ·ç«¯å—ï¼Ÿ</span><br><span class="line"><span class="number">3.</span> å®¢æˆ·ç«¯ï¼šæ˜¯çš„ æˆ‘æ˜¯å®¢æˆ·ç«¯</span><br><span class="line">æˆåŠŸ </span><br><span class="line"></span><br><span class="line">å››æ¬¡æŒ¥æ‰‹</span><br><span class="line">ä¸»åŠ¨æ–¹ï¼šæˆ‘å·²ç»å…³é—­äº†å‘ä½ é‚£è¾¹çš„ä¿¡æ¯å‘é€é€šé“ï¼Œåªèƒ½è¢«åŠ¨æ¥å—ä¿¡æ¯äº†</span><br><span class="line">è¢«åŠ¨æ–¹ï¼šæ”¶åˆ°é€šé“å…³é—­ä¿¡æ¯</span><br><span class="line">è¢«åŠ¨æ–¹ï¼šæˆ‘ç°åœ¨ä¹Ÿå…³é—­äº†</span><br><span class="line">ä¸»åŠ¨æ–¹ï¼šæ”¶åˆ°æ¶ˆæ¯ è¿æ¥æ–­å¼€ ä¹‹ååŒæ–¹æ— æ³•é€šä¿¡</span><br><span class="line"></span><br><span class="line">TCPIPè¯·æ±‚ï¼šæµè§ˆå™¨åœ¨åŒä¸€ä¸ªåŸŸåä¸‹å¹¶å‘çš„TCPé“¾æ¥æ˜¯æœ‰é™åˆ¶çš„ï¼ˆ<span class="number">2</span><span class="number">-10</span>ä¸ªï¼‰</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>é“¾æ¥æˆåŠŸå é“¾è·¯å±‚å°†è¯·æ±‚æ•°æ®å°è£…æˆå¸§</li>
<li>æœ€åç‰©ç†å±‚é€šè¿‡ç‰©ç†ä»‹è´¨è¿›è¡Œä¼ è¾“</li>
<li>åˆ°äº†æœåŠ¡å™¨å°±ä¼šé€šè¿‡ç›¸åçš„æ–¹å¼å°†æ•°æ®ä¸€å±‚ä¸€å±‚çš„è¿˜åŸå›å»</li>
<li>è¯·æ±‚åˆ°äº†åç«¯æœåŠ¡å™¨ä¸€èˆ¬éƒ½ä¼šæœ‰ç»Ÿä¸€çš„éªŒè¯ å¦‚å®‰å…¨éªŒè¯ï¼Œè·¨åŸŸéªŒè¯ç­‰ï¼ŒéªŒè¯æœªé€šè¿‡å°±ç›´æ¥è¿”å›ç›¸åº”çš„httpæŠ¥æ–‡</li>
<li>éªŒè¯é€šè¿‡åå°±ä¼šè¿›å…¥åå°ä»£ç  æ­¤æ—¶ç¨‹åºæ”¶åˆ°è¯·æ±‚æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼ˆå¦‚æŸ¥è¯¢æ•°æ®åº“ç­‰ï¼‰</li>
<li>å¦‚æœæµè§ˆå™¨è®¿é—®è¿‡ ä¸”ç¼“å­˜ä¸Šæœ‰ç›¸åº”çš„èµ„æºä¾¿ä¼šä¸æœåŠ¡å™¨æœ€åçš„ä¿®æ”¹æ—¶é—´å¯¹æ¯”ï¼Œä¸€è‡´ä¾¿è¿”å›304 å‘Šè¯‰æµè§ˆå™¨å¯ä»¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜</li>
<li>å‰ç«¯æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”æˆåŠŸçš„æŠ¥æ–‡ä¾¿å¼€å§‹ä¸‹è½½ç½‘é¡µ<br>ä¸‹è½½å®Œçš„ç½‘é¡µäº¤ç»™æµè§ˆå™¨çš„å†…æ ¸ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰è¿›è¡Œå¤„ç†</li>
</ol>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="bullet">* </span>æ ¹æ®é¡¶éƒ¨å®šä¹‰çš„DTDç±»å‹è¿›è¡Œç›¸åº”çš„è§£ææ–¹å¼</span><br><span class="line"><span class="bullet">* </span>æ¸²æŸ“è¿›ç¨‹å†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ ç½‘é¡µçš„è§£æä¼šè¢«äº¤ç»™å†…éƒ¨çš„GUIæ¸²æŸ“è¿›ç¨‹å¤„ç†</span><br><span class="line"><span class="bullet">* </span>é¦–å…ˆæ¸²æŸ“è¿›ç¨‹ä¸­çš„htmlè§£é‡Šå™¨å°†htmlç½‘é¡µå’Œèµ„æºä»å­—èŠ‚æµè§£é‡Šè½¬åŒ–ä¸ºå­—ç¬¦æµ</span><br><span class="line"><span class="bullet">* </span>å†é€šè¿‡è¯æ³•åˆ†æå™¨å°†å­—ç¬¦æµè§£é‡Šæˆè¯è¯­</span><br><span class="line"><span class="bullet">* </span>ä¹‹åé€šè¿‡è¯­æ³•åˆ†æå™¨æ ¹æ®è¯è¯­æ„æˆèŠ‚ç‚¹ï¼Œæœ€åé€šè¿‡è¿™äº›èŠ‚ç‚¹ç»„å»ºä¸€ä¸ªDOMæ ‘</span><br><span class="line"><span class="bullet">* </span>è¿™ä¸ªè¿‡ç¨‹ä¸­ å¦‚æœé‡åˆ°çš„DOMèŠ‚ç‚¹æ˜¯jsä»£ç ï¼Œå°±ä¼šè°ƒç”¨jså¼•æ“å¯¹jsä»£ç è¿›è¡Œè§£é‡Šæ‰§è¡Œã€‚æ­¤æ—¶ç”±äºjså¼•æ“å’ŒGUIæ¸²æŸ“è¿›ç¨‹çš„äº’æ–¥ï¼ŒGUIæ¸²æŸ“å°±ä¼šè¢«æŒ‚èµ·ï¼Œæ¸²æŸ“è¿‡ç¨‹åœæ­¢ï¼›å¦‚æœjsä»£ç çš„è¿è¡Œä¸­å¯¹domæ ‘è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆéƒ½æ²¡æ ‘çš„æ„å»ºéœ€è¦é‡æ–°å¼€å§‹</span><br><span class="line"><span class="bullet">* </span>å¦‚æœèŠ‚ç‚¹éœ€è¦ä¾èµ–å…¶ä»–èµ„æºï¼ˆå›¾ç‰‡ cssï¼‰ä¾¿ä¼šè°ƒç”¨ç½‘ç»œæ¨¡å—çš„èµ„æºå»åŠ è½½å®ƒä»¬ï¼Œä½†ä»–ä»¬æ˜¯å¼‚æ­¥çš„æ‰€ä»¥ä¸ä¼šé˜»å¡å½“å‰domæ ‘çš„æ„å»º</span><br><span class="line"><span class="bullet">* </span>å¦‚æœé‡åˆ°çš„æ˜¯jsèµ„æºurlï¼ˆæ²¡æœ‰æ ‡è®°å¼‚æ­¥ï¼‰åˆ™éœ€è¦åœæ­¢å½“å‰domçš„æ„å»º ç›´åˆ°jsçš„èµ„æºåŠ è½½å¹¶è¢«jså¼•æ“æ‰§è¡Œåæ‰ç»§ç»­æ„å»ºdom</span><br><span class="line"><span class="bullet">* </span>å¯¹äºcss cssè§£é‡Šå™¨ä¼šå°†cssæ–‡ä»¶è§£é‡Šæˆå†…éƒ¨è¡¨ç¤ºç»“æ„ï¼ˆåŒhtmlè§£æ å­èŠ‚æµ-&gt;å­—ç¬¦æµ-&gt;è¯è¯­-&gt;èŠ‚ç‚¹ï¼‰ï¼Œç”Ÿæˆcssè§„åˆ™æ ‘</span><br><span class="line"><span class="bullet">* </span>ç„¶ååˆå¹¶cssæ ‘å’Œdomæ ‘ï¼Œç”Ÿæˆrenderæ¸²æŸ“æ ‘</span><br><span class="line"><span class="bullet">* </span>æœ€åå¯¹renderæ ‘è¿›è¡Œå¸ƒå±€å’Œç»˜åˆ¶ï¼Œå¹¶å°†ç»“æœé€šè¿‡IOçº¿ç¨‹ä¼ é€’ç»™Browseræ§åˆ¶è¿›ç¨‹ï¼ˆæµè§ˆå™¨ä¸»è¿›ç¨‹ï¼‰è¿›è¡Œæ˜¾ç¤º</span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>viewportså‰–æä¸€</title>
    <url>/2017/08/03/viewports%E5%89%96%E6%9E%90%E4%B8%80/</url>
    <content><![CDATA[<p>å› ä¸ºå·¥ä½œçš„åŸå› ï¼Œå¾ˆå°‘æœ‰æœºä¼šæ¥è§¦ç§»åŠ¨webå¼€å‘ï¼Œä¸€ç›´éƒ½è¿˜æŒºé—æ†¾çš„ï¼Œå¶å°”å†™å‡ ä¸ªé¡µé¢ä¹Ÿéƒ½æ˜¯â€œæŒ‰ç…§å¥—è·¯â€å‡ºç‰Œï¼Œæœ€è¿‘ç»ˆäºæœ‰ç©ºäº†è§£ä¸€äº›æ¦‚å¿µæ€§çš„ä¸œè¥¿ï¼Œè®°å½•ä¸€ä¸‹<br>æ–‡ä¸­çš„å›¾ç‰‡ä¸ºäº†è¯´æ˜é—®é¢˜å‡ä¸º<code>ç›—å›¾</code>ï¼Œå…·ä½“å‡ºå¤„ä¼šåœ¨æ–‡æœ«æ³¨æ˜</p>
<p>æœ¬æ–‡å¤§æ¦‚å°†ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µä»¥åšå¯¹æ¯”</p>
<ul>
<li>PC<ul>
<li><a href="#line1"> <font face="STCAIYUN" size="3" color="blueGreen">è®¾å¤‡çš„pixelså’ŒCSSçš„pixels</font></a></li>
<li><a href="#line2"> <font face="STCAIYUN" size="3" color="blueGreen">æ‰€è°“çš„100%ç¼©æ”¾</font></a></li>
<li><a href="#line3"> <font face="STCAIYUN" size="3" color="blueGreen">å±å¹•å°ºå¯¸å’Œæµè§ˆå™¨å°ºå¯¸</font></a></li>
<li><a href="#line4"> <font face="STCAIYUN" size="3" color="blueGreen">é¡µé¢çš„æ»šåŠ¨ç§»ä½</font></a></li>
<li><a href="#line5"> <font face="STCAIYUN" size="3" color="blueGreen">viewportä»¥åŠåº¦é‡viewport</font></a></li>
<li><a href="#line6"> <font face="STCAIYUN" size="3" color="blueGreen">htmlå…ƒç´ ä»¥åŠåº¦é‡html</font></a></li>
<li><a href="#line7"> <font face="STCAIYUN" size="3" color="blueGreen">å…³äºäº‹ä»¶åæ ‡</font></a></li>
<li><a href="#line8"> <font face="STCAIYUN" size="3" color="blueGreen">åª’ä½“æŸ¥è¯¢width/heightä¸ device-width/height</font></a></li>
</ul>
</li>
<li>mobile<ul>
<li><a href="#line9"> <font face="STCAIYUN" size="3" color="blueGreen">mobileæµè§ˆå™¨</font></a></li>
<li><a href="#line10"> <font face="STCAIYUN" size="3" color="blueGreen">ä¸¤ç§viewport</font></a><ul>
<li><font face="STCAIYUN" size="3" color="red">layoutviewport</font></li>
<li><font face="STCAIYUN" size="3" color="red">visualviewport</font></li>
</ul>
</li>
<li><a href="#line11"> <font face="STCAIYUN" size="3" color="blueGreen">ç¼©æ”¾ Zooming</font></a></li>
<li><a href="#line12"> <font face="STCAIYUN" size="3" color="blueGreen">å±å¹•å°ºå¯¸</font></a></li>
<li><a href="#line13"> <font face="STCAIYUN" size="3" color="blueGreen">é¡µé¢çš„æ»šåŠ¨ç§»ä½</font></a></li>
<li><a href="#line14"> <font face="STCAIYUN" size="3" color="blueGreen">htmlå…ƒç´ ä»¥åŠåº¦é‡html</font></a></li>
<li><a href="#line15"> <font face="STCAIYUN" size="3" color="blueGreen">å…³äºäº‹ä»¶åæ ‡</font></a></li>
<li><a href="#line16"> <font face="STCAIYUN" size="3" color="blueGreen">åª’ä½“æŸ¥è¯¢width/heightä¸ device-width/height</font></a></li>
<li><a href="#line17"> <font face="STCAIYUN" size="3" color="blueGreen">viewportçš„metaæ ‡ç­¾</font></a></li>
</ul>
</li>
</ul>
<p></p><p id="line1"></p>
<p><font face="STCAIYUN" color="#883958" size="3">è®¾å¤‡çš„pixelså’ŒCSSçš„pixels</font><br></p><br><strong>è®¾å¤‡çš„pixels</strong><br>    è®¾å¤‡åƒç´ æ˜¯æˆ‘ä»¬ç›´è§‰ä¸Šè§‰å¾—ã€Œé è°±ã€çš„åƒç´ ã€‚è¿™äº›åƒç´ ä¸ºä½ æ‰€ä½¿ç”¨çš„å„ç§è®¾å¤‡éƒ½æä¾›äº†æ­£è§„çš„åˆ†è¾¨ç‡<br>    å¤§å¤šæ•°æƒ…å†µä¸‹èƒ½ä»<code>screen.width/height</code> å–å‡ºå…·ä½“å€¼<br>    å½“ç„¶äº† è®¾å¤‡çš„pixelså¯¹webå¼€å‘äººå‘˜å‡ ä¹æ¯«æ— ç”¨å¤„<br>    è¿™é‡Œåªéœ€è¦çŸ¥é“å®ƒçš„æ¦‚å¿µå³å¯<br><strong>CSSçš„pixels</strong><br>è¿™äº›å°±æ˜¯é‚£äº›æ§åˆ¶ä½ çš„æ ·å¼è¡¨å¦‚ä½•è¢«æ¸²æŸ“çš„åƒç´ <p></p>
<p>ç°ä»£æµè§ˆå™¨ä¸Šçš„ç¼©æ”¾æ˜¯åŸºäº<code>ä¼¸å±•</code>pixels<br>æ‰€ä»¥ htmlå…ƒç´ ä¸Šçš„å®½åº¦ä¸ä¼šå› ä¸ºä½ ç¼©æ”¾äº†200%è€Œå˜æˆäº†ä¸¤å€å®½ï¼Œå®ƒåœ¨å½¢å¼ä¸Šè¿˜æ˜¯ä¸€å€å®½ åªä¸è¿‡å ç”¨äº†ä¸¤å€çš„è®¾å¤‡pixels<br>å¦‚ä¸‹å›¾1-1 æœ‰4ä¸ª1pixelsï¼Œç¼©æ”¾ä¸º100%çš„htmlå…ƒç´  æ­¤æ—¶css pixelså’Œè®¾å¤‡çš„pixelså®Œå…¨é‡åˆ<br><img src="/images/viewports/1.jpg" alt><br>æ­¤æ—¶æˆ‘ä»¬å¦‚æœç¼©å°æµè§ˆå™¨ cssçš„pixelså¼€å§‹æ”¶ç¼©ï¼Œå¯¼è‡´1å•ä½çš„è®¾å¤‡pixels ä¸Šé‡å äº†å¤šä¸ªcssçš„pixels å¦‚ä¸‹å›¾1-2<br><img src="/images/viewports/2.jpg" alt><br>å¦‚æœæ”¾å¤§æµè§ˆå™¨ cssçš„pixelså°±ä¼šæ”¾å¤§ å¯¼è‡´1å•ä½çš„css pixelsä¸Šé‡å äº†å¤šä¸ªè®¾å¤‡pixels å¦‚å›¾1-3<br><img src="/images/viewports/3.jpg" alt><br>æ€»è€Œè¨€ä¹‹ ä½ åªéœ€è¦å…³æ³¨CSSçš„pixels è¿™äº›pixelså°†æŒ‡å®šä½ çš„æ ·å¼è¢«å¦‚ä½•æ¸²æŸ“<br>å°±åƒä¸Šé¢æ‰€è¯´çš„ è®¾å¤‡çš„pixelså¯¹å¼€å‘äººå‘˜æ— ç”¨ ä½†æ˜¯å¯¹ç”¨æˆ·æœ‰ç”¨ï¼Œå› ä¸ºç”¨æˆ·å›æ‰‹åŠ¨ç¼©æ”¾é¡µé¢ï¼Œè¿™äº›å¼€å‘äººå‘˜ä¸ç”¨å…³æ³¨ <font face="STCAIYUN" color="red" size="3">æµè§ˆå™¨ä¼šè‡ªåŠ¨ä¿è¯ä½ çš„css pixelsä¼šè¢«ä¼¸å±•è¿˜æ˜¯è¢«æ”¶ç¼©</font></p>
<p></p><p id="line2"></p>
<p><font face="STCAIYUN" color="#883958" size="3">æ‰€è°“çš„100%ç¼©æ”¾</font><br></p><p></p>
<p><font face="STCAIYUN" color="red" size="3">100% ç¼©æ”¾çš„æƒ…å†µä¸‹ 1å•ä½çš„çš„CSS pixels ä¸¥æ ¼ç­‰äº1å•ä½çš„è®¾å¤‡pixels</font></p>
<p></p><p id="line3"></p>
<p><font face="STCAIYUN" color="#883958" size="3">å±å¹•å°ºå¯¸å’Œæµè§ˆå™¨å°ºå¯¸</font><br></p><br><strong>å±å¹•å°ºå¯¸ï¼ˆScreen sizeï¼‰</strong><br>å«ä¹‰ï¼šç”¨æˆ·çš„å±å¹•çš„å®Œæ•´å¤§å°<br>åº¦é‡ï¼šè®¾å¤‡çš„pixels ä¸ä¼šå› ä¸ºç¼©æ”¾è€Œæ”¹å˜ æ˜¯æ˜¾ç¤ºå™¨çš„ç‰¹å¾<br>å¯¹æˆ‘ä»¬æ¥è¯´<font face="STCAIYUN" color="red" size="4">æ²¡ç”¨</font><br>è·å–æ–¹å¼<br>å¦‚ä¸‹å›¾1-4<br><img src="/images/viewports/4.jpg" alt><p></p>
<p><strong>æµè§ˆå™¨å°ºå¯¸ï¼ˆWindow sizeï¼‰</strong><br>å«ä¹‰ï¼šåŒ…å«<code>æ»šåŠ¨æ¡å°ºå¯¸</code>çš„æµè§ˆå™¨å®Œæ•´å°ºå¯¸<br>åº¦é‡ï¼šCSS pixels<br>æµè§ˆå™¨å†…éƒ¨å°ºå¯¸ï¼Œå®ƒå®šä¹‰äº†å½“å‰ç”¨æˆ·æœ‰å¤šå¤§åŒºåŸŸã€‚å¯ä¾›ä½ çš„csså¸ƒå±€å ç”¨<br>å¦‚ä¸‹å›¾1-5<br><img src="/images/viewports/5.jpg" alt></p>
<p></p><p id="line4"></p>
<p><font face="STCAIYUN" color="#883958" size="3">é¡µé¢çš„æ»šåŠ¨ç§»ä½</font><br></p><br>å«ä¹‰ï¼šé¡µé¢çš„ç§»ä½<br>åº¦é‡ï¼šCSS pixels<br>å®šä¹‰äº†é¡µé¢ï¼ˆdocumentï¼‰çš„ç›¸å¯¹äºçª—å£è¿œç‚¹çš„ä½ç§»ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è·å–ç”¨æˆ·æ»šåŠ¨äº†å¤šå°‘çš„æ»šåŠ¨æ¡è·ç¦»<br>å¦‚ä¸‹å›¾1-6<br><img src="/images/viewports/6.jpg" alt><p></p>
<p></p><p id="line5"></p>
<p><font face="STCAIYUN" color="#883958" size="3">viewportä»¥åŠåº¦é‡viewport</font><br></p><br><strong>viewport</strong><br>å•Šå•Šå•Š ç»ˆäºæåˆ°viewportäº† é¸¡å†»<p></p>
<p><font face="STCAIYUN" color="red" size="3">åˆ’é‡ç‚¹</font> <code>viewport</code>æ˜¯æ§åˆ¶<code>&lt;html&gt;</code>å…ƒç´ çš„å®¹å™¨  æ˜¯<code>&lt;html&gt;</code>çš„çˆ¹</p>
<p>ä½ å‘ç°äº†ä¹ˆï¼Ÿ<br>ç™¾åˆ†æ¯”å¸ƒå±€æ—¶ ä½ å®šä¹‰çš„ä¸€ä¸ªä¾§è¾¹æ å®½åº¦ä¸º10% å½“ä½ æ”¹å˜å¤§å°æ—¶ å®ƒçš„å®½åº¦ä¼šè‡ªåŠ¨æ‰©å¼ å’Œæ”¶ç¼©  åŸç†æ˜¯å•¥<br>å½“ç„¶äº† å®ƒçš„å®½åº¦æ˜¯ä¾èµ–çˆ¶å…ƒç´  å‡å¦‚å®ƒçˆ¶å…ƒç´ å°±æ˜¯<code>&lt;body&gt;</code> é‚£ä¹ˆ<code>&lt;body&gt;</code>å¤šå®½ï¼Ÿ<br>å‘ä¸Šç±»æ¨ <code>&lt;body&gt;</code>çš„å®½åº¦å–å†³äºå®ƒçš„çˆ¶å…ƒç´ <code>&lt;html&gt;</code><br>å‘ƒ.. åºŸè¯å¥½å¤š <code>&lt;html&gt;</code>å®½åº¦å–å†³äºå®ƒçš„çˆ¶å…ƒç´ <br> <code>&lt;html&gt;</code>æ°å¥½ç­‰äºæµè§ˆå™¨çš„å®½åº¦ æ‰€ä»¥ä½ çš„10%ä¼šå ç”¨æµè§ˆå™¨å®½åº¦çš„10% æˆ‘ä»¬éƒ½æ˜¯è¿™ä¹ˆç”¨çš„  ä»Šå¤©æ·±æ‰’å‘ç°<br><code>&lt;html&gt;</code>å®½åº¦å—<code>viewport</code>é™åˆ¶ ï¼Œç­‰äº<code>viewport</code>å®½åº¦çš„100%<br>ä¹Ÿå°±æ˜¯è¯´<br><code>viewport</code>ä¸¥æ ¼ç­‰äºæµè§ˆå™¨çª—å£<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>viewport</code>ä¸æ˜¯ä¸€ä¸ªhtmlçš„æ¦‚å¿µ æ‰€ä»¥ä¸èƒ½é€šè¿‡CSSä¿®æ”¹å®ƒ</p>
<p><strong>çœŸå®é¡µé¢å®½åº¦æ¦‚å¿µ</strong><br>å¦‚æœä½ æ”¾å¤§é¡µé¢å‡ å€ å¦‚ä½•æ ‡è¯†é¡µé¢å®½åº¦ï¼ˆæ­¤æ—¶å·²ç»æœ‰æ¨ªå‘æ»šåŠ¨æ¡äº†ï¼Œä¹Ÿå°±æ˜¯è¯´é¡µé¢çš„å†…å®¹æº¢å‡ºäº†<code>&lt;html&gt;</code>å…ƒç´ ï¼‰<br>ä½¿ç”¨ document width<br>å¦‚å›¾1-7<br><img src="/images/viewports/7.jpg" alt><br>å¦‚å›¾1-8<br><img src="/images/viewports/8.jpg" alt><br><strong>åº¦é‡viewport</strong><br>å«ä¹‰ï¼šviewportå°ºå¯¸<br>åº¦é‡ï¼šCSS pixels<br>å¦‚ä¸‹å›¾1-9<br><img src="/images/viewports/9.jpg" alt><br>document.documentElement ä»£è¡¨<font face="STCAIYUN" color="red" size="3">HTMLæ–‡æ¡£æ ¹å…ƒç´ </font><code>&lt;html&gt;</code><br>æ¥ å…ˆçœ‹å¼ å›¾<br><img src="/images/viewports/10.jpg" alt><br>è¿™å¼ å›¾æ˜¯åœ¨ä¸º<code>&lt;html&gt;</code>å…ƒç´ èµ‹å€¼25% ä½†æ˜¯<code>document.documentElement.clientWidth</code>å€¼ä»ç„¶ä¸å˜<br>è¯´æ˜<font face="STCAIYUN" color="red" size="3">document. documentElement. clientWidth/Heightåªä¼šç»™å‡ºviewportçš„å°ºå¯¸ï¼Œè€Œä¸ç®¡<html>å…ƒç´ å°ºå¯¸å¦‚ä½•æ”¹å˜</html></font></p>
<p><font face="STCAIYUN" color="#886" size="4">é‚£ä¹ˆé—®é¢˜æ¥äº†</font><br>æˆ‘æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç”¨<code>window.innerWidth</code>æ¥å®šä¹‰<code>viewport</code><br>å‘ƒ.<br>ä»–ä¸<code>document.documentElement.clientWidth</code>æœ‰ä¸€ç‚¹ç»†å¾®çš„å·®åˆ«<br>å‰è€…ä¸åŒ…å«æ»šåŠ¨æ¡</p>
<p></p><p id="line6"></p>
<p><font face="STCAIYUN" color="#883958" size="3">htmlå…ƒç´ ä»¥åŠåº¦é‡html</font><br></p><br><strong>html</strong><br>taçˆ¹(<code>viewport</code>)å¦‚æœ<code>document.documentElement.clientWidth</code>è¡¨ç¤ºé‚£ä¹ˆ<code>&lt;html&gt;</code>è¿™æ ·è·å– <code>document.documentElement.offsetWidth</code><br><img src="/images/viewports/11.jpg" alt><br>å¦‚æœç»™<code>&lt;html&gt;</code>å…ƒç´ èµ‹å€¼äº†å®½åº¦ é‚£ä¹ˆ<code>offsetWidth</code>å°±ä¼šçœŸå®çš„åæ˜ å‡ºæ¥<p></p>
<p><img src="/images/viewports/12.jpg" alt></p>
<p></p><p id="line7"></p>
<p><font face="STCAIYUN" color="#883958" size="3">å…³äºäº‹ä»¶åæ ‡</font><br></p><br><strong>pageX/Y, clientX/Y, screenX/Y</strong><p></p>
<ul>
<li>pageX/Yï¼šä»<html>åŸç‚¹åˆ°äº‹ä»¶è§¦å‘ç‚¹çš„CSSçš„ pixels</html></li>
<li>clientX/Yï¼šä»viewportåŸç‚¹ï¼ˆæµè§ˆå™¨çª—å£ï¼‰åˆ°äº‹ä»¶è§¦å‘ç‚¹çš„CSSçš„ pixels</li>
<li>screenX/Yï¼šä»ç”¨æˆ·æ˜¾ç¤ºå™¨çª—å£åŸç‚¹åˆ°äº‹ä»¶è§¦å‘ç‚¹çš„è®¾å¤‡ çš„ pixelsã€‚<br>ä¸Šå›¾<br><img src="/images/viewports/13.jpg" alt><br><img src="/images/viewports/14.jpg" alt><br><img src="/images/viewports/15.jpg" alt></li>
</ul>
<p></p><p id="line8"></p>
<p><font face="STCAIYUN" color="#883958" size="3">åª’ä½“æŸ¥è¯¢width/heightä¸ device-width/height</font><br></p><p></p>
<ul>
<li><code>device-width/height</code>ä½¿ç”¨<code>screen.width/height</code>æ¥åšä¸ºçš„åˆ¤å®šå€¼ã€‚è¯¥å€¼ä»¥è®¾å¤‡çš„pixelsæ¥åº¦é‡</li>
<li><code>width/height</code>ä½¿ç”¨<code>documentElement.clientWidth/Height</code>å³viewportçš„å€¼ã€‚è¯¥å€¼ä»¥CSSçš„pixelsæ¥åº¦é‡<br><img src="/images/viewports/16.jpg" alt><br>æ¡Œé¢æµè§ˆå™¨ä¸Šä½¿ç”¨<font face="STCAIYUN" color="red" size="4">width</font><br><p id="line9"><br><font face="STCAIYUN" color="#883958" size="3">mobileæµè§ˆå™¨</font><br></p><br>ç§»åŠ¨è®¾å¤‡çš„å±å¹•å®½åº¦æ¯”æ¡Œé¢æµè§ˆå™¨å°ï¼ˆå¥½å¤šåºŸè¯.ï¼‰<br>è¯•æƒ³ä¸€ä¸‹ å¦‚æœæˆ‘ä»¬åªæ˜¯copyæ¡Œé¢çš„æ ·å¼åˆ°ç§»åŠ¨è®¾å¤‡ è¯¥æœ‰å¤šä¸‘<br>å¦‚ä¸‹å›¾<br>ç§»åŠ¨è®¾å¤‡æµè§ˆå™¨åœ¨åˆå§‹é»˜è®¤æ‰“å¼€ä»¥æœ€å°ç¼©æ”¾æ¨¡å¼æ‰“å¼€ç½‘ç«™ã€‚ï¼ˆå³åœ¨æ‰‹æœºå±å¹•ä¸Šå±•ç¤ºå®Œæ•´å®½åº¦çš„é¡µé¢ï¼‰</li>
</ul>
<p><img src="/images/viewports/viewport-21.jpg" alt></p>
<p><font face="STCAIYUN" color="#285853" size="3">å‡è®¾å½“å‰è®¾å¤‡çš„å®½åº¦æ˜¯400px è¿˜æ˜¯ä¹‹å‰è¯´è¿‡çš„10%ä¾§è¾¹æ ï¼Œå¦‚æœç§»åŠ¨è®¾å¤‡ä¸ŠåšåŒæ ·çš„å¤„ç†ï¼Œä¼šæ˜¾ç¤º40pxçš„å®½ å¤ªçª„äº†ï¼Œå¸ƒå±€ä¼šå˜å¾—éå¸¸å¯æ€•</font><br>é‚£ä¹ˆ å¦‚ä½•å¤„ç†?</p>
<p></p><p id="line10"></p>
<p><font face="STCAIYUN" color="#883958" size="3">ä¸¤ç§viewport</font></p><br>å› ä¸ºviewportå¤ªçª„ï¼Œæœ€æ˜¾ç„¶çš„è§£å†³æ–¹å¼å°±æ˜¯å°†å®ƒå˜å®½<br>ç”±æ­¤ å¼•å‡ºäº† è™šæ‹Ÿè§†å£  ï¼ˆ<code>viewportvisualviewport</code>ï¼‰ ä¸      å¸ƒå±€è§†å£ï¼ˆ<code>viewportlayoutviewport</code>ï¼‰<br>å…³äºå®ƒä»¬ æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§£é‡Š<p></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  æƒ³è±¡ä¸€ä¸‹viewportlayoutviewportæ˜¯ä¸€å¼ å¤§çš„ä¸èƒ½æ”¹å˜å¤§å°å’Œè§’åº¦çš„å›¾ç‰‡ ç°åœ¨ä½ æœ‰ä¸ªæ›´å°çš„æ¡†æ¥è§‚çœ‹è¿™å¼ å¤§å›¾ç‰‡</span><br><span class="line">è¿™ä¸ªæ¡†è¢«ä¸é€æ˜çš„ææ–™åŒ…å›´ å› è€Œä½ åªèƒ½çœ‹åˆ°å¤§å›¾ç‰‡çš„ä¸€éƒ¨åˆ† ä½ é€šè¿‡è¿™ä¸ªæ¡†å­çœ‹åˆ°çš„å¤§å›¾ç‰‡çš„é‚£éƒ¨åˆ†å°±å«åšè™šæ‹Ÿè§†å£ï¼ˆviewportvisualviewportï¼‰</span><br><span class="line"></span><br><span class="line">ä½ æ‹¿ç€è¿™ä¸ªæ¡†æ‹¿ç€ç«™çš„ç¦»å¤§å›¾åŸç‚¹ï¼ˆç”¨æˆ·çš„ç¼©å°é¡µé¢åŠŸèƒ½ï¼‰ä»¥ä¸€æ¬¡æ€§çœ‹åˆ°è¿™ä¸ªå¤§å›¾ç‰‡</span><br><span class="line">ä½ ç«™çš„ç¦»çš„è¿‘ä¸€ç‚¹ï¼ˆç”¨æˆ·çš„æ”¾å¤§é¡µé¢åŠŸèƒ½ï¼‰ä»¥çœ‹åˆ°ä¸€éƒ¨åˆ†</span><br><span class="line">ä½ èƒ½æ”¹å˜è¿™ä¸ªæ¡†æ¡†çš„è¿œè¿‘ ä½†æ˜¯è¿™å¼ å¤§å›¾ç‰‡çš„å¤§å°å’Œå½¢çŠ¶éƒ½ä¸ä¼šæ”¹å˜</span><br></pre></td></tr></table></figure>
<p>visualviewportæ˜¯å½“å‰æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„éƒ¨åˆ†é¡µé¢ã€‚ç”¨æˆ·ä¼šæ»šåŠ¨é¡µé¢æ¥æ”¹å˜å¯è§éƒ¨åˆ†ï¼Œæˆ–è€…ç¼©æ”¾æµè§ˆå™¨æ¥æ”¹å˜visualviewportçš„å°ºå¯¸ã€‚<br>å¦‚ä¸‹å›¾<br><img src="/images/viewports/20.jpg" alt><br>ä½†æ˜¯CSSå¸ƒå±€ é€šå¸¸æ˜¯æŒ‰ç…§<font face="STCAIYUN" color="red" size="3">layoutviewportå®šä¹‰çš„ï¼Œè¿™è¦æ¯”visualviewportå®½å¾ˆå¤š</font></p>
<p><html>å…ƒç´ çš„å®½åº¦ç»§æ‰¿äºlayoutviewport</html></p>
<p></p><p id="line11"></p>
<p><font face="STCAIYUN" color="#883958" size="3">ç¼©æ”¾ Zooming</font><br></p><br>ä¸¤ç§viewportséƒ½ä»¥CSSçš„ pixelsæ¥åº¦é‡ã€‚å½“ä½ é€šè¿‡ç¼©æ”¾æ”¹å˜visualviewportæ—¶ï¼Œlayoutviewportä¿å­˜ä¸å˜ã€‚<p></p>
<p></p><p id="line12"></p>
<p><font face="STCAIYUN" color="#883958" size="3">å±å¹•å°ºå¯¸</font><br></p><br><strong>ç†è§£layout viewport</strong><br>è®¸å¤šç§»åŠ¨è®¾å¤‡æµè§ˆå™¨åœ¨åˆå§‹é»˜è®¤æ‰“å¼€ä»¥æœ€å°ç¼©æ”¾æ¨¡å¼æ‰“å¼€ç½‘ç«™ï¼ˆä¹Ÿå°±æ˜¯åœ¨æ‰‹æœºå±å¹•ä¸Šå±•ç¤ºå®Œæ•´å®½åº¦çš„é¡µé¢ï¼‰<p></p>
<p><img src="/images/viewports/21.jpg" alt><br>æ­¤æ—¶æµè§ˆå™¨å·²ç»é€‰æ‹©å¥½ä»–ä»¬çš„layoutviewportçš„å°ºå¯¸ å®ƒå®Œæ•´è¦†ç›–äº†æœ€å°ç¼©æ”¾æ¨¡å¼ä¸‹çš„ç§»åŠ¨æµè§ˆå™¨çš„å±å¹•ï¼Œè¿™ä¸ªæ—¶å€™layoutviewportçš„å®½åº¦é«˜åº¦å’Œæœ€å°ç¼©æ”¾æ¨¡å¼ä¸‹èƒ½åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºçš„å†…å®¹çš„å®½åº¦å’Œé«˜åº¦ä¸€è‡´ã€‚<br><br></p>
<p><font face="STCAIYUN" color="red" size="3">é‚£ä¹ˆç§»åŠ¨ç«¯å¦‚ä½•è®¡ç®—layoutviewportçš„å°ºå¯¸ï¼Ÿ</font><br><code>document. documentElement. clientWidth/Height</code></p>
<p><img src="/images/viewports/25.jpg" alt><br><strong>ç†è§£visual viewport</strong></p>
<p><font face="STCAIYUN" color="red" size="3">é‚£ä¹ˆç§»åŠ¨ç«¯å¦‚ä½•è®¡ç®—visualviewportçš„å°ºå¯¸ï¼Ÿ</font><br><code>window.innerWidth/Height</code> éšç€ç”¨æˆ·çš„ç¼©æ”¾æµè§ˆå™¨ å€¼ä¼šæ”¹å˜ æ›´å¤š æ›´å°‘çš„CSS pixelsæ”¾è¿›äº†å±å¹•<br><img src="/images/viewports/27.jpg" alt><br><strong>å±å¹•å°ºå¯¸ screen</strong><br>å’Œpcæµè§ˆå™¨ä¸€æ · screen.width/heightæ ‡ç¤ºäº†è®¾ç½®å±å¹•çš„å°ºå¯¸ ä»¥è®¾å¤‡çš„pixels æ˜¾ç„¶ è¿™è·Ÿå¼€å‘äººå‘˜æ²¡æœ‰ä»€ä¹ˆå…³ç³»</p>
<p></p><p id="line13"></p>
<p><font face="STCAIYUN" color="#883958" size="3">é¡µé¢çš„æ»šåŠ¨ç§»ä½</font><br></p><br>ä½ åŒæ ·éœ€è¦çŸ¥é“å½“å‰çš„è™šæ‹Ÿè§†å£ç›¸å¯¹äºå¸ƒå±€è§†å£çš„è·ç¦» è¿™å«åš<code>æ»šåŠ¨ä½ç§»</code> ï¼Œå®ƒåƒåœ¨pcç«¯è·å–ä¸€æ ·<br>ä½¿ç”¨<strong>window.pageX/YOffset</strong><p></p>
<p><img src="/images/viewports/29.jpg" alt></p>
<p></p><p id="line14"></p>
<p><font face="STCAIYUN" color="#883958" size="3">htmlå…ƒç´ ä»¥åŠåº¦é‡html</font><br></p><br>htmlå…ƒç´ çš„æ•´ä½“å°ºå¯¸ï¼Œå’Œpcç«¯ä¸€è‡´ ä½¿ç”¨<code>document.documentElement.offsetWidth/Height</code>ï¼Œå…ƒç´ ä»¥CSS pixelsåº¦é‡<p></p>
<p><img src="/images/viewports/30.jpg" alt></p>
<p></p><p id="line15"></p>
<p><font face="STCAIYUN" color="#883958" size="3">å…³äºäº‹ä»¶åæ ‡</font><br></p><br>åŒpcæµè§ˆå™¨ åªéœ€è¦å…³æ³¨ pageX/Y<p></p>
<p><img src="/images/viewports/32.jpg" alt></p>
<p></p><p id="line16"></p>
<p><font face="STCAIYUN" color="#883958" size="3">åª’ä½“æŸ¥è¯¢width/heightä¸ device-width/height</font><br></p><br>ä¹Ÿå¦‚åŒpcæµè§ˆå™¨<br> <code>width/height</code>ä½¿ç”¨cssçš„pixelsåº¦é‡layoutviewport å³<code>document. documentElement. clientWidth/Height</code><br><code>device-width/height</code>ä½¿ç”¨è®¾å¤‡çš„pixels å³ <code>screen.width/height.</code><br>æ‰€æœ‰æµè§ˆå™¨éƒ½éµå¾ªè¿™ä¸ªåŸç†<p></p>
<p></p><p id="line17"></p>
<p><font face="STCAIYUN" color="#883958" size="3">viewportçš„metaæ ‡ç­¾</font><br></p><br><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;meta <span class="attribute">name</span>=<span class="string">"viewport"</span> <span class="attribute">content</span>=<span class="string">"width=320"</span>&gt;</span><br></pre></td></tr></table></figure><p></p>
<p>æœ€åˆè¿™æ˜¯appleçš„ä¸€ä¸ªhtmlæ‰©å±•æ ‡ç­¾ï¼Œè¢«å¾ˆå¤šæµè§ˆå™¨å¤ç”¨<br>è®¾ç½® <code>è™šæ‹Ÿè§†å£</code>çš„å®½åº¦</p>
<p>å‡è®¾ä½ ç°åœ¨åˆ›å»ºä¸€ä¸ªé¡µé¢  å¹¶ä¸ä¸ºå®ƒè®¾ç½®å®½åº¦ é‚£ä¹ˆå®ƒä¼šä¼¸å±•å¼€æ¥å æ®100%çš„viewlayoutçš„å®½åº¦ ç»å¤§å¤šæ•°æµè§ˆå™¨ç¼©å°è¿™ä¸ªé¡µé¢åœ¨ä¸€å±çš„å®½åº¦ä¸Šæ˜¾ç¤ºè¿™ä¸ªlayoutviewport</p>
<p><img src="/images/viewports/33.jpg" alt><br>å½“ç”¨æˆ·æ”¾å¤§é¡µé¢  ç»å¤§å¤šæ•°ä¼šä¿å­˜å…ƒç´ çš„å®½åº¦ï¼ˆä¿æŒå…ƒç´ çš„å®šä½ä¸å˜ï¼‰è€Œå¯¼è‡´æ–‡å­—è¶…å‡ºå±å¹•<br><img src="/images/viewports/34.jpg" alt><br>å½“ä½ è®¾ç½®<br><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;meta <span class="attribute">name</span>=<span class="string">"viewport"</span> <span class="attribute">content</span>=<span class="string">"width=320"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>ä½ ç½‘ç«™çš„layoutviewportå˜æˆäº†320pxã€‚é¡µé¢çš„åˆå§‹çŠ¶æ€å°±å¾ˆæ­£ç¡®äº†<br><img src="/images/viewports/36.jpg" alt></p>
<ul>
<li>Part1:<a href="http://www.quirksmode.org/mobile/viewports.html" target="_blank" rel="noopener">http://www.quirksmode.org/mobile/viewports.html</a></li>
<li>Part2:<a href="http://www.quirksmode.org/mobile/viewports2.html" target="_blank" rel="noopener">http://www.quirksmode.org/mobile/viewports2.html</a></li>
</ul>
]]></content>
      <tags>
        <tag>mobile</tag>
      </tags>
  </entry>
  <entry>
    <title>Vueå¼€å‘ä¸­å°æŠ€å·§</title>
    <url>/2019/10/24/vue/</url>
    <content><![CDATA[<p>è®°å½•æ—¥å¸¸å¼€å‘ä¸­ä¸å¸¸ç”¨çš„ä¸€äº›å°æŠ€å·§</p>
<h1 id="require-context"><a href="#require-context" class="headerlink" title="require.context()"></a>require.context()</h1><p>1.åœºæ™¯:å¦‚é¡µé¢éœ€è¦å¯¼å…¥å¤šä¸ªç»„ä»¶,åŸå§‹å†™æ³•:</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> titleCom <span class="keyword">from</span> <span class="string">'@/components/home/titleCom'</span></span><br><span class="line"><span class="keyword">import</span> bannerCom <span class="keyword">from</span> <span class="string">'@/components/home/bannerCom'</span></span><br><span class="line"><span class="keyword">import</span> cellCom <span class="keyword">from</span> <span class="string">'@/components/home/cellCom'</span></span><br><span class="line">components:&#123;titleCom,bannerCom,cellCom&#125;</span><br></pre></td></tr></table></figure>
<p>2.è¿™æ ·å°±å†™äº†å¤§é‡é‡å¤çš„ä»£ç ,åˆ©ç”¨ require.context å¯ä»¥å†™æˆ</p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">const<span class="built_in"> path</span> = require(<span class="string">'path'</span>)</span><br><span class="line">const files = require.<span class="keyword">context</span>(<span class="string">'@/components/home'</span>,<span class="built_in"> false</span>, /\.vue$/)</span><br><span class="line">const modules = &#123;&#125;</span><br><span class="line">files.keys().forEach<span class="built_in">(key</span> =&gt; &#123;</span><br><span class="line">  const<span class="built_in"> name</span> =<span class="built_in"> path</span>.basename<span class="built_in">(key</span>, <span class="string">'.vue'</span>)</span><br><span class="line">  modules<span class="built_in">[name</span>] = files<span class="built_in">(key</span>).<span class="keyword">default</span> || files<span class="built_in">(key</span>)</span><br><span class="line">&#125;)</span><br><span class="line">components:modules</span><br></pre></td></tr></table></figure>
<p>APIæ–¹æ³•</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">å®é™…ä¸Šæ˜¯ webpack çš„æ–¹æ³•,vue å·¥ç¨‹ä¸€èˆ¬åŸºäº webpack,æ‰€ä»¥å¯ä»¥ä½¿ç”¨</span><br><span class="line"><span class="built_in">require</span>.context(<span class="built_in">directory</span>,useSubdirectories,regExp)</span><br><span class="line">æ¥æ”¶ä¸‰ä¸ªå‚æ•°:</span><br><span class="line"><span class="built_in">directory</span>ï¼šè¯´æ˜éœ€è¦æ£€ç´¢çš„ç›®å½•</span><br><span class="line">useSubdirectoriesï¼šæ˜¯å¦æ£€ç´¢å­ç›®å½•</span><br><span class="line">regExp: åŒ¹é…æ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼,ä¸€èˆ¬æ˜¯æ–‡ä»¶å</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="watchç”¨æ³•"><a href="#watchç”¨æ³•" class="headerlink" title="watchç”¨æ³•"></a>watchç”¨æ³•</h1><h2 id="å¸¸ç”¨ç”¨æ³•"><a href="#å¸¸ç”¨ç”¨æ³•" class="headerlink" title="å¸¸ç”¨ç”¨æ³•"></a>å¸¸ç”¨ç”¨æ³•</h2><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">created()&#123;</span><br><span class="line">  <span class="keyword">this</span>.getList()</span><br><span class="line">&#125;,</span><br><span class="line">watch: &#123;</span><br><span class="line">  inpVal()&#123;</span><br><span class="line">    <span class="keyword">this</span>.getList()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç«‹å³æ‰§è¡Œ"><a href="#ç«‹å³æ‰§è¡Œ" class="headerlink" title="ç«‹å³æ‰§è¡Œ"></a>ç«‹å³æ‰§è¡Œ</h2><p>å¯ä»¥ç›´æ¥åˆ©ç”¨ watch çš„immediateå’Œhandlerå±æ€§ç®€å†™</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">watch:</span> <span class="string">&#123;</span></span><br><span class="line"><span class="attr">  inpVal:</span><span class="string">&#123;</span></span><br><span class="line"><span class="attr">    handler:</span> <span class="string">'getList'</span><span class="string">,</span></span><br><span class="line"><span class="attr">      immediate:</span> <span class="literal">true</span></span><br><span class="line">  <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="æ·±åº¦ç›‘å¬"><a href="#æ·±åº¦ç›‘å¬" class="headerlink" title="æ·±åº¦ç›‘å¬"></a>æ·±åº¦ç›‘å¬</h2><p>watch çš„ deep å±æ€§,æ·±åº¦ç›‘å¬,ä¹Ÿå°±æ˜¯ç›‘å¬å¤æ‚æ•°æ®ç±»å‹</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">watch</span>:&#123;</span><br><span class="line">  <span class="attribute">inpValObj</span>:&#123;</span><br><span class="line">    <span class="built_in">handler</span>(newVal,oldVal)&#123;</span><br><span class="line">      console.<span class="built_in">log</span>(newVal)</span><br><span class="line">      console.<span class="built_in">log</span>(oldVal)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="selector-tag">deep</span><span class="selector-pseudo">:true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç»„ä»¶é€šä¿¡"><a href="#ç»„ä»¶é€šä¿¡" class="headerlink" title="ç»„ä»¶é€šä¿¡"></a>ç»„ä»¶é€šä¿¡</h1><h2 id="props"><a href="#props" class="headerlink" title="props"></a>props</h2><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ•°ç»„:ä¸å»ºè®®ä½¿ç”¨</span></span><br><span class="line">props:[]</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è±¡</span></span><br><span class="line">props:&#123;</span><br><span class="line"> inpVal:&#123;</span><br><span class="line">  type:Number, <span class="comment">//ä¼ å…¥å€¼é™å®šç±»å‹</span></span><br><span class="line">  <span class="comment">// type å€¼å¯ä¸ºString,Number,Boolean,Array,Object,Date,Function,Symbol</span></span><br><span class="line">  <span class="comment">// type è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”é€šè¿‡ instanceof æ¥è¿›è¡Œæ£€æŸ¥ç¡®è®¤</span></span><br><span class="line">  required: <span class="literal">true</span>, <span class="comment">//æ˜¯å¦å¿…ä¼ </span></span><br><span class="line">  <span class="keyword">default</span>:<span class="number">200</span>,  <span class="comment">//é»˜è®¤å€¼,å¯¹è±¡æˆ–æ•°ç»„é»˜è®¤å€¼å¿…é¡»ä»ä¸€ä¸ªå·¥å‚å‡½æ•°è·å–å¦‚ default:()=&gt;[]</span></span><br><span class="line">  validator:(<span class="keyword">value</span>) &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªå€¼å¿…é¡»åŒ¹é…ä¸‹åˆ—å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ª</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'success'</span>, <span class="string">'warning'</span>, <span class="string">'danger'</span>].indexOf(<span class="keyword">value</span>) !== <span class="number">-1</span></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Attrå’Œlisteners"><a href="#Attrå’Œlisteners" class="headerlink" title="Attrå’Œlisteners"></a>Attrå’Œlisteners</h1><h2 id="attrs"><a href="#attrs" class="headerlink" title="attrs"></a>attrs</h2><p>åœºæ™¯:å¦‚æœçˆ¶ä¼ å­æœ‰å¾ˆå¤šå€¼,é‚£ä¹ˆåœ¨å­ç»„ä»¶éœ€è¦å®šä¹‰å¤šä¸ª props</p>
<p>attrsè·å–æœªåœ¨ props å®šä¹‰çš„å€¼</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">// çˆ¶ç»„ä»¶</span><br><span class="line">&lt;home <span class="built_in">title</span>=<span class="string">"è¿™æ˜¯æ ‡é¢˜"</span> <span class="built_in">width</span>=<span class="string">"80"</span> <span class="built_in">height</span>=<span class="string">"80"</span> imgUrl=<span class="string">"imgUrl"</span>/&gt;</span><br><span class="line"></span><br><span class="line">// å­ç»„ä»¶</span><br><span class="line">mounted() &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(this.$attrs) //&#123;<span class="built_in">title</span>: <span class="string">"è¿™æ˜¯æ ‡é¢˜"</span>, <span class="built_in">width</span>: <span class="string">"80"</span>, <span class="built_in">height</span>: <span class="string">"80"</span>, imgUrl: <span class="string">"imgUrl"</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å¯¹åº”çš„å¦‚æœå­ç»„ä»¶å®šä¹‰äº† props,æ‰“å°çš„å€¼å°±æ˜¯å‰”é™¤å®šä¹‰çš„å±æ€§</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">prop<span class="variable">s:</span> &#123;</span><br><span class="line">  width: &#123;</span><br><span class="line">    <span class="built_in">type</span>: String,</span><br><span class="line">    defaul<span class="variable">t:</span> <span class="string">''</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">mounted() &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(this.$attrs) //&#123;title: <span class="string">"è¿™æ˜¯æ ‡é¢˜"</span>, heigh<span class="variable">t:</span> <span class="string">"80"</span>, imgUr<span class="variable">l:</span> <span class="string">"imgUrl"</span>&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="listenersåœºæ™¯"><a href="#listenersåœºæ™¯" class="headerlink" title="listenersåœºæ™¯"></a>listenersåœºæ™¯</h2><p>å­ç»„ä»¶å†…éœ€è¦è°ƒç”¨çˆ¶ç»„ä»¶çš„æ–¹æ³•è§£å†³ï¼š<br>çˆ¶ç»„ä»¶çš„æ–¹æ³•å¯ä»¥é€šè¿‡v-on=â€listenersâ€ä¼ å…¥å†…éƒ¨ç»„ä»¶</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç»„ä»¶</span></span><br><span class="line">&lt;home @change=<span class="string">"change"</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­ç»„ä»¶</span></span><br><span class="line"><span class="function"><span class="title">mounted</span><span class="params">()</span></span> &#123;</span><br><span class="line">  console.log(this.<span class="variable">$listeners</span>) <span class="comment">//å³å¯æ‹¿åˆ° change äº‹ä»¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="root"><a href="#root" class="headerlink" title="$root"></a>$root</h1><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç»„ä»¶</span></span><br><span class="line">mounted()&#123;</span><br><span class="line">  console.<span class="built-in">log</span>(this.<span class="symbol">$</span>root) <span class="comment">//è·å–æ ¹å®ä¾‹,æœ€åæ‰€æœ‰ç»„ä»¶éƒ½æ˜¯æŒ‚è½½åˆ°æ ¹å®ä¾‹ä¸Š</span></span><br><span class="line">  console.<span class="built-in">log</span>(this.<span class="symbol">$</span>root.<span class="symbol">$</span>children[<span class="number">0</span>]) <span class="comment">//è·å–æ ¹å®ä¾‹çš„ä¸€çº§å­ç»„ä»¶</span></span><br><span class="line">  console.<span class="built-in">log</span>(this.<span class="symbol">$</span>root.<span class="symbol">$</span>children[<span class="number">0</span>].<span class="symbol">$</span>children[<span class="number">0</span>]) <span class="comment">//è·å–æ ¹å®ä¾‹çš„äºŒçº§å­ç»„ä»¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="sync"><a href="#sync" class="headerlink" title=".sync"></a>.sync</h1><p>åœ¨ <a href="mailto:vue@1.x" target="_blank" rel="noopener">vue@1.x</a> çš„æ—¶å€™æ›¾ä½œä¸ºåŒå‘ç»‘å®šåŠŸèƒ½å­˜åœ¨ï¼Œå³å­ç»„ä»¶å¯ä»¥ä¿®æ”¹çˆ¶ç»„ä»¶ä¸­çš„å€¼; åœ¨ <a href="mailto:vue@2.0" target="_blank" rel="noopener">vue@2.0</a> çš„ç”±äºè¿èƒŒå•é¡¹æ•°æ®æµçš„è®¾è®¡è¢«å¹²æ‰äº†; åœ¨ <a href="mailto:vue@2.3.0" target="_blank" rel="noopener">vue@2.3.0</a>+ ä»¥ä¸Šç‰ˆæœ¬åˆé‡æ–°å¼•å…¥äº†è¿™ä¸ª .sync ä¿®é¥°ç¬¦;</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çˆ¶ç»„ä»¶</span></span><br><span class="line">&lt;<span class="string">home :</span>title.sync=<span class="string">"title"</span> /&gt;</span><br><span class="line"><span class="comment">//ç¼–è¯‘æ—¶ä¼šè¢«æ‰©å±•ä¸º</span></span><br><span class="line">&lt;<span class="string">home :</span>title=<span class="string">"title"</span>  <span class="meta">@update</span>:title=<span class="string">"val =&gt; title = val"</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­ç»„ä»¶</span></span><br><span class="line"><span class="comment">// æ‰€ä»¥å­ç»„ä»¶å¯ä»¥é€šè¿‡$emit è§¦å‘ update æ–¹æ³•æ”¹å˜</span></span><br><span class="line">mounted()&#123;</span><br><span class="line">  <span class="keyword">this</span>.$emit(<span class="string">"update:title"</span>, <span class="string">'è¿™æ˜¯æ–°çš„title'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="è·¯ç”±ä¼ å‚æ–¹æ¡ˆ"><a href="#è·¯ç”±ä¼ å‚æ–¹æ¡ˆ" class="headerlink" title="è·¯ç”±ä¼ å‚æ–¹æ¡ˆ"></a>è·¯ç”±ä¼ å‚æ–¹æ¡ˆ</h1><p>æ–¹æ¡ˆä¸€</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±å®šä¹‰</span></span><br><span class="line">&#123;</span><br><span class="line">  path: '/<span class="keyword">describe</span>/:id',</span><br><span class="line">  name: '<span class="keyword">Describe</span>',</span><br><span class="line">  component: <span class="keyword">Describe</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é¡µé¢ä¼ å‚</span></span><br><span class="line">this.<span class="variable">$router</span>.push(&#123;</span><br><span class="line">  path: `/<span class="keyword">describe</span>/<span class="variable">$&#123;id&#125;</span>`,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// é¡µé¢è·å–</span></span><br><span class="line">this.<span class="variable">$route</span>.params.id</span><br></pre></td></tr></table></figure>
<p>æ–¹æ¡ˆäºŒ</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±å®šä¹‰</span></span><br><span class="line">&#123;</span><br><span class="line">  path: <span class="string">'/describe'</span>,</span><br><span class="line">  name: <span class="string">'Describe'</span>,</span><br><span class="line">  omponent: Describe</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é¡µé¢ä¼ å‚</span></span><br><span class="line">this.<span class="variable">$router</span>.push(&#123;</span><br><span class="line">  name: <span class="string">'Describe'</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    id: id</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// é¡µé¢è·å–</span></span><br><span class="line">this.<span class="variable">$route</span><span class="selector-class">.params</span><span class="selector-class">.id</span></span><br></pre></td></tr></table></figure>
<p>æ–¹æ¡ˆä¸‰</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±å®šä¹‰</span></span><br><span class="line">&#123;</span><br><span class="line">  path: '/<span class="keyword">describe</span>',</span><br><span class="line">  name: '<span class="keyword">Describe</span>',</span><br><span class="line">  component: <span class="keyword">Describe</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é¡µé¢ä¼ å‚</span></span><br><span class="line">this.<span class="variable">$router</span>.push(&#123;</span><br><span class="line">  path: '/<span class="keyword">describe</span>',</span><br><span class="line">    <span class="keyword">query</span>: &#123;</span><br><span class="line">      id: id</span><br><span class="line">  `&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// é¡µé¢è·å–</span></span><br><span class="line">this.<span class="variable">$route</span>.<span class="keyword">query</span>.id</span><br></pre></td></tr></table></figure>
<p>ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯” æ–¹æ¡ˆäºŒå‚æ•°ä¸ä¼šæ‹¼æ¥åœ¨è·¯ç”±åé¢,é¡µé¢åˆ·æ–°å‚æ•°ä¼šä¸¢å¤± æ–¹æ¡ˆä¸€å’Œä¸‰å‚æ•°æ‹¼æ¥åœ¨åé¢,ä¸‘,è€Œä¸”æš´éœ²äº†ä¿¡æ¯</p>
<h1 id="renderå‡½æ•°"><a href="#renderå‡½æ•°" class="headerlink" title="renderå‡½æ•°"></a>renderå‡½æ•°</h1><p>åœºæ™¯:æœ‰äº›ä»£ç åœ¨ template é‡Œé¢å†™ä¼šé‡å¤å¾ˆå¤š,æ‰€ä»¥è¿™ä¸ªæ—¶å€™ render å‡½æ•°å°±æœ‰ä½œç”¨å•¦</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® props ç”Ÿæˆæ ‡ç­¾</span></span><br><span class="line"><span class="comment">// åˆçº§</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div v-<span class="keyword">if</span>=<span class="string">"level === 1"</span>&gt; <span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &lt;p v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 2"</span>&gt; <span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &lt;h1 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 3"</span>&gt; <span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    &lt;h2 v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 4"</span>&gt; <span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">    &lt;strong v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 5"</span>&gt; <span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;/<span class="name">stong</span>&gt;</span></span></span><br><span class="line">    &lt;textarea v-<span class="keyword">else</span>-<span class="keyword">if</span>=<span class="string">"level === 6"</span>&gt; <span class="xml"><span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span></span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼˜åŒ–ç‰ˆ,åˆ©ç”¨ render å‡½æ•°å‡å°äº†ä»£ç é‡å¤ç‡</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;child :level=<span class="string">"level"</span>&gt;Hello world!<span class="xml"><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">'text/javascript'</span>&gt;</span><br><span class="line">  <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line">  Vue.component(<span class="string">'child'</span>, &#123;</span><br><span class="line">    render(h) &#123;</span><br><span class="line">      <span class="keyword">const</span> tag = [<span class="string">'div'</span>, <span class="string">'p'</span>, <span class="string">'strong'</span>, <span class="string">'h1'</span>, <span class="string">'h2'</span>, <span class="string">'textarea'</span>][<span class="keyword">this</span>.level<span class="number">-1</span>]</span><br><span class="line">      <span class="keyword">return</span> h(tag, <span class="keyword">this</span>.$slots.default)</span><br><span class="line">    &#125;,</span><br><span class="line">    props: &#123;</span><br><span class="line">      level: &#123;  <span class="attr">type</span>: <span class="built_in">Number</span>,  <span class="attr">required</span>: <span class="literal">true</span>  &#125; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)   </span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    name: <span class="string">'hehe'</span>,</span><br><span class="line">    data() &#123; <span class="keyword">return</span> &#123; <span class="attr">level</span>: <span class="number">3</span> &#125; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>2.render å’Œ template çš„å¯¹æ¯” å‰è€…é€‚åˆå¤æ‚é€»è¾‘,åè€…é€‚åˆé€»è¾‘ç®€å•; åè€…å±äºå£°æ˜æ˜¯æ¸²æŸ“ï¼Œå‰è€…å±äºè‡ªå®šRenderå‡½æ•°; å‰è€…çš„æ€§èƒ½è¾ƒé«˜ï¼Œåè€…æ€§èƒ½è¾ƒä½ã€‚</p>
<h1 id="è·¯ç”±çš„æŒ‰éœ€åŠ è½½"><a href="#è·¯ç”±çš„æŒ‰éœ€åŠ è½½" class="headerlink" title="è·¯ç”±çš„æŒ‰éœ€åŠ è½½"></a>è·¯ç”±çš„æŒ‰éœ€åŠ è½½</h1><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">webpack</span>&lt; 2<span class="selector-class">.4</span> æ—¶</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attribute">path</span>:<span class="string">'/'</span>,</span><br><span class="line">  name:<span class="string">'home'</span>,</span><br><span class="line">  components:resolve=&gt;<span class="built_in">require</span>([<span class="string">'@/components/home'</span>],resolve)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">webpack</span>&gt; 2<span class="selector-class">.4</span> æ—¶</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attribute">path</span>:<span class="string">'/'</span>,</span><br><span class="line">  name:<span class="string">'home'</span>,</span><br><span class="line">  components:()=&gt;<span class="built_in">import</span>(<span class="string">'@/components/home'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">import</span>()æ–¹æ³•ç”±<span class="selector-tag">es6</span>æå‡ºï¼Œ<span class="selector-tag">import</span>()æ–¹æ³•æ˜¯åŠ¨æ€åŠ è½½ï¼Œè¿”å›ä¸€ä¸ª<span class="selector-tag">Promise</span>å¯¹è±¡ï¼Œ<span class="selector-tag">then</span>æ–¹æ³•çš„å‚æ•°æ˜¯åŠ è½½åˆ°çš„æ¨¡å—ã€‚ç±»ä¼¼äº<span class="selector-tag">Node</span><span class="selector-class">.js</span>çš„<span class="selector-tag">require</span>æ–¹æ³•ï¼Œä¸»è¦<span class="selector-tag">import</span>()æ–¹æ³•æ˜¯å¼‚æ­¥åŠ è½½çš„ã€‚</span><br></pre></td></tr></table></figure>
<h1 id="åŠ¨æ€ç»„ä»¶"><a href="#åŠ¨æ€ç»„ä»¶" class="headerlink" title="åŠ¨æ€ç»„ä»¶"></a>åŠ¨æ€ç»„ä»¶</h1><figure class="highlight vhdl"><table><tr><td class="code"><pre><span class="line">&lt;<span class="keyword">component</span> v-bind:<span class="keyword">is</span>=<span class="string">"currentTabComponent"</span>&gt;&lt;/<span class="keyword">component</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™æ ·æ¯æ¬¡ç»„ä»¶éƒ½ä¼šé‡æ–°åŠ è½½,ä¼šæ¶ˆè€—å¤§é‡æ€§èƒ½,æ‰€ä»¥ å°±èµ·åˆ°äº†ä½œç”¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">"currentTabComponent"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·åˆ‡æ¢æ•ˆæœæ²¡æœ‰åŠ¨ç”»æ•ˆæœ,è¿™ä¸ªä¹Ÿä¸ç”¨ç€æ€¥,å¯ä»¥åˆ©ç”¨å†…ç½®çš„</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">"currentTabComponent"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="å‡½æ•°å¼ç»„ä»¶"><a href="#å‡½æ•°å¼ç»„ä»¶" class="headerlink" title="å‡½æ•°å¼ç»„ä»¶"></a>å‡½æ•°å¼ç»„ä»¶</h1><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span> <span class="attr">functional</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in props.arr"</span>&gt;</span></span><span class="template-variable">&#123;&#123;item&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h1 id="mixins"><a href="#mixins" class="headerlink" title="mixins"></a>mixins</h1><p>åœºæ™¯:æœ‰äº›ç»„ä»¶æœ‰äº›é‡å¤çš„ js é€»è¾‘,å¦‚æ ¡éªŒæ‰‹æœºéªŒè¯ç ,è§£ææ—¶é—´ç­‰,mixins å°±å¯ä»¥å®ç°è¿™ç§æ··å…¥ mixins å€¼æ˜¯ä¸€ä¸ªæ•°ç»„</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> mixin=&#123;</span><br><span class="line">    created()&#123;</span><br><span class="line">      <span class="keyword">this</span>.dealTime()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">      dealTime()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'è¿™æ˜¯mixinçš„dealTimeé‡Œé¢çš„æ–¹æ³•'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  mixins:[mixin]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Vue-nextTick"><a href="#Vue-nextTick" class="headerlink" title="Vue.nextTick"></a>Vue.nextTick</h1><p>2.1.0 æ–°å¢ åœºæ™¯:é¡µé¢åŠ è½½æ—¶éœ€è¦è®©æ–‡æœ¬æ¡†è·å–ç„¦ç‚¹ ç”¨æ³•:åœ¨ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œå»¶è¿Ÿå›è°ƒã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè·å–æ›´æ–°åçš„ DOM</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">mounted</span><span class="params">()</span></span>&#123; <span class="comment">//å› ä¸º mounted é˜¶æ®µ dom å¹¶æœªæ¸²æŸ“å®Œæ¯•,æ‰€ä»¥éœ€è¦$nextTick</span></span><br><span class="line">  this.<span class="variable">$nextTick</span>(() =&gt; &#123;</span><br><span class="line">    this.<span class="variable">$refs</span><span class="selector-class">.inputs</span><span class="selector-class">.focus</span>() <span class="comment">//é€šè¿‡ $refs è·å–dom å¹¶ç»‘å®š focus æ–¹æ³•</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Vue-version"><a href="#Vue-version" class="headerlink" title="Vue.version"></a>Vue.version</h1><p>åœºæ™¯:æœ‰äº›å¼€å‘æ’ä»¶éœ€è¦é’ˆå¯¹ä¸åŒ vue ç‰ˆæœ¬åšå…¼å®¹,æ‰€ä»¥å°±ä¼šç”¨åˆ° Vue.version ç”¨æ³•:Vue.version()å¯ä»¥è·å– vue ç‰ˆæœ¬</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="keyword">version</span> = Number(Vue.<span class="keyword">version</span>.<span class="keyword">split</span>('.')[0])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">version</span> === 2) &#123;</span><br><span class="line">  <span class="comment">// Vue v2.x.x</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">version</span> === 1) &#123;</span><br><span class="line">  <span class="comment">// Vue v1.x.x</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// Unsupported versions of Vue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Vue-config-performance"><a href="#Vue-config-performance" class="headerlink" title="Vue.config.performance"></a>Vue.config.performance</h1><p>ç›‘å¬æ€§èƒ½</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">Vue.config.performance</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h1 id="Vue-config-warnHandler"><a href="#Vue-config-warnHandler" class="headerlink" title="Vue.config.warnHandler"></a>Vue.config.warnHandler</h1><p>2.4.0 æ–°å¢ 1.åœºæ™¯:ä¸º Vue çš„è¿è¡Œæ—¶è­¦å‘Šèµ‹äºˆä¸€ä¸ªè‡ªå®šä¹‰å¤„ç†å‡½æ•°,åªä¼šåœ¨å¼€å‘è€…ç¯å¢ƒä¸‹ç”Ÿæ•ˆ 2.ç”¨æ³•:</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">Vue.config.warnHandler = <span class="function"><span class="keyword">function</span> <span class="params">(msg, vm, trace)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// `trace` æ˜¯ç»„ä»¶çš„ç»§æ‰¿å…³ç³»è¿½è¸ª</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="v-pre"><a href="#v-pre" class="headerlink" title="v-pre"></a>v-pre</h1><p>åœºæ™¯:vue æ˜¯å“åº”å¼ç³»ç»Ÿ,ä½†æ˜¯æœ‰äº›é™æ€çš„æ ‡ç­¾ä¸éœ€è¦å¤šæ¬¡ç¼–è¯‘,è¿™æ ·å¯ä»¥èŠ‚çœæ€§èƒ½</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-pre</span>&gt;</span></span><span class="template-variable">&#123;&#123; this will not be compiled &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>   æ˜¾ç¤ºçš„æ˜¯</span><span class="template-variable">&#123;&#123; this will not be compiled &#125;&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-pre</span>&gt;</span></span><span class="template-variable">&#123;&#123;msg&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>Â  Â  Â å³ä½¿dataé‡Œé¢å®šä¹‰äº†msgè¿™é‡Œä»ç„¶æ˜¯æ˜¾ç¤ºçš„</span><span class="template-variable">&#123;&#123;msg&#125;&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<h1 id="v-cloak"><a href="#v-cloak" class="headerlink" title="v-cloak"></a>v-cloak</h1><p>åœºæ™¯:åœ¨ç½‘é€Ÿæ…¢çš„æƒ…å†µä¸‹,åœ¨ä½¿ç”¨vueç»‘å®šæ•°æ®çš„æ—¶å€™ï¼Œæ¸²æŸ“é¡µé¢æ—¶ä¼šå‡ºç°å˜é‡é—ªçƒ<br>ç”¨æ³•:è¿™ä¸ªæŒ‡ä»¤ä¿æŒåœ¨å…ƒç´ ä¸Šç›´åˆ°å…³è”å®ä¾‹ç»“æŸç¼–è¯‘ã€‚å’Œ CSS è§„åˆ™å¦‚ [v-cloak] { display: none } ä¸€èµ·ç”¨æ—¶ï¼Œè¿™ä¸ªæŒ‡ä»¤å¯ä»¥éšè—æœªç¼–è¯‘çš„ Mustache æ ‡ç­¾ç›´åˆ°å®ä¾‹å‡†å¤‡å®Œæ¯•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// template ä¸­</span></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"#app"</span> v-cloak&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;value.name&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// css ä¸­</span></span><br><span class="line">[v-cloak] &#123;</span><br><span class="line">    display: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥è§£å†³é—ªçƒ,ä½†æ˜¯ä¼šå‡ºç°ç™½å±,è¿™æ ·å¯ä»¥ç»“åˆéª¨æ¶å±ä½¿ç”¨</p>
<h1 id="v-once"><a href="#v-once" class="headerlink" title="v-once"></a>v-once</h1><p>åœºæ™¯:æœ‰äº› template ä¸­çš„é™æ€ dom æ²¡æœ‰æ”¹å˜,è¿™æ—¶å°±åªéœ€è¦æ¸²æŸ“ä¸€æ¬¡,å¯ä»¥é™ä½æ€§èƒ½å¼€é”€</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-once</span>&gt;</span> è¿™æ—¶åªéœ€è¦åŠ è½½ä¸€æ¬¡çš„æ ‡ç­¾<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>v-once å’Œ v-pre çš„åŒºåˆ«: v-onceåªæ¸²æŸ“ä¸€æ¬¡ï¼›v-preä¸ç¼–è¯‘,åŸæ ·è¾“å‡º</p>
<h1 id="äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="äº‹ä»¶ä¿®é¥°ç¬¦"></a>äº‹ä»¶ä¿®é¥°ç¬¦</h1><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.stop</span>:é˜»æ­¢å†’æ³¡</span><br><span class="line"><span class="selector-class">.prevent</span>:é˜»æ­¢é»˜è®¤è¡Œä¸º</span><br><span class="line"><span class="selector-class">.self</span>:ä»…ç»‘å®šå…ƒç´ è‡ªèº«è§¦å‘</span><br><span class="line"><span class="selector-class">.once</span>: <span class="number">2.1</span>.<span class="number">4</span> æ–°å¢,åªè§¦å‘ä¸€æ¬¡</span><br><span class="line"><span class="selector-class">.passive</span>: <span class="number">2.3</span>.<span class="number">0</span> æ–°å¢,æ»šåŠ¨äº‹ä»¶çš„é»˜è®¤è¡Œä¸º (å³æ»šåŠ¨è¡Œä¸º) å°†ä¼šç«‹å³è§¦å‘,ä¸èƒ½å’Œ<span class="selector-class">.prevent</span> ä¸€èµ·ä½¿ç”¨</span><br></pre></td></tr></table></figure>
<h1 id="Vue-router"><a href="#Vue-router" class="headerlink" title="Vue.$router"></a>Vue.$router</h1><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.$router.push():è·³è½¬åˆ°ä¸åŒçš„urlï¼Œä½†è¿™ä¸ªæ–¹æ³•å›å‘historyæ ˆæ·»åŠ ä¸€ä¸ªè®°å½•ï¼Œç‚¹å‡»åé€€ä¼šè¿”å›åˆ°ä¸Šä¸€ä¸ªé¡µé¢</span><br><span class="line"><span class="keyword">this</span>.$router.replace():ä¸ä¼šæœ‰è®°å½•</span><br><span class="line"><span class="keyword">this</span>.$router.go(n):nå¯ä¸ºæ­£æ•°å¯ä¸ºè´Ÿæ•°ã€‚æ­£æ•°è¿”å›ä¸Šä¸€ä¸ªé¡µé¢,ç±»ä¼¼ window.history.go(n)</span><br></pre></td></tr></table></figure>
<h1 id="Vue-route"><a href="#Vue-route" class="headerlink" title="Vue.$route"></a>Vue.$route</h1><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">this.<span class="variable">$route</span><span class="selector-class">.params</span><span class="selector-class">.id</span>:è·å–é€šè¿‡ params æˆ–/:idä¼ å‚çš„å‚æ•°</span><br><span class="line">this.<span class="variable">$route</span><span class="selector-class">.query</span><span class="selector-class">.id</span>:è·å–é€šè¿‡ query ä¼ å‚çš„å‚æ•°</span><br></pre></td></tr></table></figure>
<h1 id="è°ƒè¯•-template"><a href="#è°ƒè¯•-template" class="headerlink" title="è°ƒè¯• template"></a>è°ƒè¯• template</h1><p>åœºæ™¯:åœ¨Vueå¼€å‘è¿‡ç¨‹ä¸­, ç»å¸¸ä¼šé‡åˆ°templateæ¨¡æ¿æ¸²æŸ“æ—¶JavaScriptå˜é‡å‡ºé”™çš„é—®é¢˜, æ­¤æ—¶ä¹Ÿè®¸ä½ ä¼šé€šè¿‡console.logæ¥è¿›è¡Œè°ƒè¯• è¿™æ—¶å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒæŒ‚è½½ä¸€ä¸ª log å‡½æ•°</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">Vue.prototype.<span class="symbol">$</span><span class="built-in">log</span> = window.console.<span class="built-in">log</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»„ä»¶å†…éƒ¨</span></span><br><span class="line">&lt;<span class="built-in">div</span>&gt;&#123;&#123;<span class="symbol">$</span><span class="built-in">log</span>(info)&#125;&#125;&lt;/<span class="built-in">div</span>&gt;</span><br></pre></td></tr></table></figure>
<h1 id="vue-loader-å°æŠ€å·§"><a href="#vue-loader-å°æŠ€å·§" class="headerlink" title="vue-loader å°æŠ€å·§"></a>vue-loader å°æŠ€å·§</h1><h2 id="preserveWhitespace"><a href="#preserveWhitespace" class="headerlink" title="preserveWhitespace"></a>preserveWhitespace</h2><p>åœºæ™¯:å¼€å‘ vue ä»£ç ä¸€èˆ¬ä¼šæœ‰ç©ºæ ¼,è¿™ä¸ªæ—¶å€™æ‰“åŒ…å‹ç¼©å¦‚æœä¸å»æ‰ç©ºæ ¼ä¼šåŠ å¤§åŒ…çš„ä½“ç§¯ é…ç½®preserveWhitespaceå¯ä»¥å‡å°åŒ…çš„ä½“ç§¯</p>
<p>{<br>  vue: {<br>    preserveWhitespace: false<br>  }<br>}</p>
<h2 id="transformToRequire"><a href="#transformToRequire" class="headerlink" title="transformToRequire"></a>transformToRequire</h2><p>åœºæ™¯:ä»¥å‰åœ¨å†™ Vue çš„æ—¶å€™ç»å¸¸ä¼šå†™åˆ°è¿™æ ·çš„ä»£ç ï¼šæŠŠå›¾ç‰‡æå‰ require ä¼ ç»™ä¸€ä¸ªå˜é‡å†ä¼ ç»™ç»„ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// page ä»£ç </span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">avatar</span> <span class="attr">:img-src</span>=<span class="string">"imgSrc"</span>&gt;</span><span class="tag">&lt;/<span class="name">avatar</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    created () &#123;</span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.imgSrc = <span class="built_in">require</span>(<span class="string">'./assets/default-avatar.png'</span>)</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨:é€šè¿‡é…ç½® transformToRequire åï¼Œå°±å¯ä»¥ç›´æ¥é…ç½®ï¼Œè¿™æ ·vue-loaderä¼šæŠŠå¯¹åº”çš„å±æ€§è‡ªåŠ¨ require ä¹‹åä¼ ç»™ç»„ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vue-cli 2.xåœ¨vue-loader.conf.js é»˜è®¤é…ç½®æ˜¯</span></span><br><span class="line">transformToRequire: &#123;</span><br><span class="line">    video: [<span class="string">'src'</span>, <span class="string">'poster'</span>],</span><br><span class="line">    source: <span class="string">'src'</span>,</span><br><span class="line">    img: <span class="string">'src'</span>,</span><br><span class="line">    image: <span class="string">'xlink:href'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®æ–‡ä»¶,å¦‚æœæ˜¯vue-cli2.x åœ¨vue-loader.conf.jsé‡Œé¢ä¿®æ”¹</span></span><br><span class="line">  avatar: [<span class="string">'default-src'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue-cli 3.x åœ¨vue.config.js</span></span><br><span class="line"><span class="comment">// vue-cli 3.x å°†transformToRequireå±æ€§æ¢ä¸ºäº†transformAssetUrls</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  pages,</span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config</span><br><span class="line">      .module</span><br><span class="line">        .rule(<span class="string">'vue'</span>)</span><br><span class="line">        .use(<span class="string">'vue-loader'</span>)</span><br><span class="line">        .loader(<span class="string">'vue-loader'</span>)</span><br><span class="line">        .tap(<span class="function"><span class="params">options</span> =&gt;</span> &#123;</span><br><span class="line">      options.transformAssetUrls = &#123;</span><br><span class="line">        avatar: <span class="string">'img-src'</span>,</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> options;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// page ä»£ç å¯ä»¥ç®€åŒ–ä¸º</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;avatar img-src=<span class="string">"./assets/default-avatar.png"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">avatar</span>&gt;</span></span></span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br></pre></td></tr></table></figure>
<h1 id="ä¸ºè·¯å¾„è®¾ç½®åˆ«å"><a href="#ä¸ºè·¯å¾„è®¾ç½®åˆ«å" class="headerlink" title="ä¸ºè·¯å¾„è®¾ç½®åˆ«å"></a>ä¸ºè·¯å¾„è®¾ç½®åˆ«å</h1><p>1.åœºæ™¯:åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¼•å…¥å„ç§æ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ã€CSSã€JSç­‰ï¼Œä¸ºäº†é¿å…å†™å¾ˆé•¿çš„ç›¸å¯¹è·¯å¾„ï¼ˆ../ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¸åŒçš„ç›®å½•é…ç½®ä¸€ä¸ªåˆ«å</p>
<p>2.vue-cli 2.x é…ç½®</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">// åœ¨ webpack.base.config.jsä¸­çš„ <span class="built_in">resolve</span> é…ç½®é¡¹ï¼Œåœ¨å…¶ alias ä¸­å¢åŠ åˆ«å</span><br><span class="line"><span class="built_in">resolve</span>: &#123;</span><br><span class="line">    extension<span class="variable">s:</span> [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">    alia<span class="variable">s:</span> &#123;</span><br><span class="line">      <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span>,</span><br><span class="line">      <span class="string">'@'</span>: <span class="built_in">resolve</span>(<span class="string">'src'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<p>3.vue-cli 3.x é…ç½®</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">// åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºvue.<span class="built_in">config</span>.js</span><br><span class="line">var <span class="built_in">path</span> = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span> <span class="params">(dir)</span></span> &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(__dirname)</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">path</span>.join(__dirname, dir)</span><br><span class="line">&#125;</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  chainWebpack: <span class="built_in">config</span> =&gt; &#123;</span><br><span class="line">    <span class="built_in">config</span>.resolve.alias</span><br><span class="line">      .set(key, value) // key,valueè‡ªè¡Œå®šä¹‰ï¼Œæ¯”å¦‚.set(<span class="string">'@@'</span>, resolve(<span class="string">'src/components'</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="img-åŠ è½½å¤±è´¥"><a href="#img-åŠ è½½å¤±è´¥" class="headerlink" title="img åŠ è½½å¤±è´¥"></a>img åŠ è½½å¤±è´¥</h1><p>åœºæ™¯:æœ‰äº›æ—¶å€™åå°è¿”å›å›¾ç‰‡åœ°å€ä¸ä¸€å®šèƒ½æ‰“å¼€,æ‰€ä»¥è¿™ä¸ªæ—¶å€™åº”è¯¥åŠ ä¸€å¼ é»˜è®¤å›¾ç‰‡</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// page ä»£ç </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">"imgUrl"</span> @<span class="attr">error</span>=<span class="string">"handleError"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span></span><br><span class="line">  data()&#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="actionscript">      imgUrl:<span class="string">''</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    handleError(e)&#123;</span><br><span class="line"><span class="actionscript">      e.target.src=reqiure(<span class="string">'å›¾ç‰‡è·¯å¾„'</span>) <span class="comment">//å½“ç„¶å¦‚æœé¡¹ç›®é…ç½®äº†transformToRequire,å‚è€ƒä¸Šé¢ 27.2</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h1><h2 id="å±€éƒ¨æ ·å¼"><a href="#å±€éƒ¨æ ·å¼" class="headerlink" title="å±€éƒ¨æ ·å¼"></a>å±€éƒ¨æ ·å¼</h2><p>1.Vueä¸­styleæ ‡ç­¾çš„scopedå±æ€§è¡¨ç¤ºå®ƒçš„æ ·å¼åªä½œç”¨äºå½“å‰æ¨¡å—ï¼Œæ˜¯æ ·å¼ç§æœ‰åŒ–.</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸå§‹ä»£ç </span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="selector-tag">div</span> class=<span class="string">"demo"</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">span</span> class=<span class="string">"content"</span>&gt;</span><br><span class="line">      Vue<span class="selector-class">.js</span> scoped</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=<span class="string">"less"</span> scoped&gt;</span><br><span class="line">  .demo&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    .<span class="attribute">content</span>&#123;</span><br><span class="line">      <span class="attribute">color</span>: red;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµè§ˆå™¨æ¸²æŸ“æ•ˆæœ</span></span><br><span class="line">&lt;<span class="selector-tag">div</span> data-v-fed36922&gt;</span><br><span class="line">  Vue<span class="selector-class">.js</span> scoped</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;style type=<span class="string">"text/css"</span>&gt;</span><br><span class="line"><span class="selector-class">.demo</span>[data-v-<span class="number">039</span>c5b43] &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.demo</span> <span class="selector-class">.content</span>[data-v-<span class="number">039</span>c5b43] &#123; <span class="comment">//.demo ä¸Šå¹¶æ²¡æœ‰åŠ  data å±æ€§</span></span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<h2 id="deep-å±æ€§"><a href="#deep-å±æ€§" class="headerlink" title="deep å±æ€§"></a>deep å±æ€§</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// ä¸Šé¢æ ·å¼åŠ ä¸€ä¸ª /deep/</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"less"</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.demo</span>&#123;</span></span><br><span class="line">    font-size: 14px;</span><br><span class="line">  &#125;</span><br><span class="line">  .demo /deep/ .content&#123;</span><br><span class="line">    color: blue;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// æµè§ˆå™¨ç¼–è¯‘å</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-class">.demo</span><span class="selector-attr">[data-v-039c5b43]</span> &#123;</span></span><br><span class="line">  font-size: 14px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="css"><span class="selector-class">.demo</span><span class="selector-attr">[data-v-039c5b43]</span> <span class="selector-class">.content</span> &#123;</span></span><br><span class="line">  color: blue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»ä¸è§„èŒƒç”Ÿäº§å¥—è·¯çœ‹æ•ˆç‡</title>
    <url>/2017/07/22/%E4%BB%8E%E4%B8%8D%E8%A7%84%E8%8C%83%E5%9B%A2%E9%98%9F%E7%9C%8B%E6%95%88%E7%8E%87/</url>
    <content><![CDATA[<p>æ ‡é¢˜å¥½åƒæ˜¯å¥åºŸè¯ï¼Œâ€ä¸è§„èŒƒâ€ ä½•è°ˆ <font face="STCAIYUN" color="red" size="5">æ•ˆç‡</font> å‘¢ï¼Ÿ</p>
<p><img src="http://oucjferwh.bkt.clouddn.com/wunai.jpg" alt></p>
<ol>
<li><font face="STCAIYUN" color="#83933b" size="4">ä½•ä¸ºæ•ˆç‡</font></li>
<li><font face="STCAIYUN" color="#83933b" size="4">ä»äº§å“çœ‹æ•ˆç‡</font></li>
<li><font face="STCAIYUN" color="#83933b" size="4">ä»UIçœ‹æ•ˆç‡</font></li>
<li><font face="STCAIYUN" color="#83933b" size="4">ä»å¼€å‘çœ‹æ•ˆç‡</font></li>
<li><font face="STCAIYUN" color="#83933b" size="4">ä»æµ‹è¯•çœ‹æ•ˆç‡ </font>



</li>
</ol>
<p><strong>ä½•ä¸ºæ•ˆç‡ï¼Ÿ</strong></p>
<p><a href="https://baike.baidu.com/item/%E6%95%88%E7%8E%87/868847?fr=aladdin" target="_blank" rel="noopener">ç™¾åº¦ç™¾ç§‘</a>ä¸Šå¤§æ¦‚æ˜¯è¿™ä¹ˆå®šä¹‰çš„:æ˜¯æŒ‡åœ¨ç»™å®šæŠ•å…¥å’ŒæŠ€æœ¯ç­‰æ¡ä»¶ä¸‹ï¼Œ<font face="STCAIYUN" color="red" size="4">æœ€æœ‰æ•ˆåœ°</font>ä½¿ç”¨èµ„æºä»¥æ»¡è¶³è®¾å®šçš„æ„¿æœ›å’Œéœ€è¦çš„è¯„ä»·æ–¹å¼</p>
<p>å¯¹æˆ‘æ¥è¯´æœ€ç›´è§‚çš„åˆ¤æ–­æ–¹å¼å°±æ˜¯  <font face="STCAIYUN" color="red" size="4">é¡¹ç›®æ˜¯å¦æœ‰å»¶æœŸ çº¿ä¸Šæ˜¯å¦æœ‰bug</font></p>
<ul>
<li><font face="STCAIYUN" color="darkorange" size="4">æ•ˆç‡æœ‰å¤šé‡è¦ï¼Ÿ</font>

<p>å¤§éƒ¨åˆ†çš„ç”µå­å‚å·¥èµ„éƒ½æ˜¯æŒ‰ä»¶è®¡è´¹çš„ï¼Œå¤šåŠ³å¤šå¾—ï¼Œå•ä½æ—¶é—´äº§å‡ºä¸æ”¶å…¥èƒ½æ­£æ¯”ï¼Œæ‰€ä»¥å·¥äººä»¬éƒ½éå¸¸åŠªåŠ› è¿™æ˜¯è‡ªå‘æ€§è¡Œä¸º æ‰€ä»¥ä¹Ÿæ˜¯æœ€ä»»æ€¨çš„ã€‚</p>
<p>å¯¹æˆ‘è€Œè¨€ æ•ˆç‡èƒ½å¸¦æ¥å¥½å¿ƒæƒ… å¥½çŠ¶æ€ä»¥åŠå¥½çš„ç”Ÿæ´»æ€ åºŸè¯ å¤§å®¶éƒ½ä¸€æ · â€“  </p>
</li>
</ul>
<p><strong>ä»äº§å“çœ‹æ•ˆç‡</strong><br>ä¸€æ¬¾äº§å“çš„æˆåŠŸä¸å¦ æœ‰å¤šæ–¹ä¾¿çš„å†³å®šå› ç´  äº§å“æœ€ç»ˆéƒ½æ˜¯é¢å‘ç”¨æˆ·çš„ ä¸€ä¸ªä¸èƒ½ä¸ºç”¨æˆ·åˆ›é€ ä»·å€¼çš„äº§å“åº”è¯¥æ˜¯æ²¡æœ‰ä½¿ç”¨ä»·å€¼çš„ï¼Œäº§å“æœ¬å°±æ˜¯æå‡æ•ˆç‡çš„ä¸€ç§æ–¹å¼</p>
<p>é‚£ä¹ˆ æ¥ä¸‹æ¥  æˆ‘è¦å¼€å§‹åæ§½äº†</p>
<font face="STCAIYUN" color="darkorange" size="4">å¦‚æœäº§å“éœ€æ±‚ä¸æ˜ç¡®æˆ–è€…éœ€æ±‚ä¸å®Œæ•´  é¡¹ç›®è¦ä¸è¦å¼€å§‹åšï¼Ÿ</font><br>ä¸€èˆ¬æ¥è¯´ ä¸è¦ ç»å¯¹ä¸è¦ é™¤éæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸ç›¸å¹²çš„æ¨¡å— æ˜‚ åŸºæœ¬ä¹Ÿä¸å¤ªå¯èƒ½<br>ä½†æ˜¯å°¼ ä¸ºäº†æ‰€è°“çš„å·¥æœŸ äº§å“å¤§å¤§ä¸€èˆ¬ä¼šè¿™ä¹ˆè¯´  åšå‘—  å…ˆåšç€  æˆ‘è¿™ä¹ˆå•ï¼ˆwuï¼‰çº¯ï¼ˆnaiï¼‰çš„ æ¯æ¬¡éƒ½è¢«å¥—è·¯ä½ğŸ¤¡ ç„¶ååæ¥è®¡ç®—å·¥æ—¶çš„æ—¶å€™ ï¼š å“¦ ä½ ä¸æ˜¯ä»é‚£ä¸ªä»€ä¹ˆä»€ä¹ˆæ—¶å€™å°±å¼€å§‹äº†å—ï¼ŸğŸ‘ğŸ½<br>è¿™è¿˜ä¸æ˜¯æœ€ä¸»è¦çš„ï¼Œæ¯•ç«Ÿ æ—¶é—´å°±åƒæµ·ç»µé‡Œçš„æ°´ æŒ¤ä¸€æŒ¤æ€»ä¼šæœ‰çš„ğŸ˜‚<br><br>æœ€ä¸»è¦çš„å½“ç„¶æ˜¯<font face="STCAIYUN" color="red" size="4">æ”¹éœ€æ±‚</font>å•¦ è¿™å¤§æ¦‚æ˜¯æ‰€æœ‰äº§å“æœ€æ“…é•¿çš„<br><br>è¿™ä¸¤è€…æœ¬è´¨ä¸Šæ˜¯æ²¡æœ‰çŸ›ç›¾çš„ï¼Œåªä¸è¿‡äº§å“æ›´å¤šçš„ä»¥ç›®æ ‡ä¸ºå¯¼å‘ï¼Œéœ€æ±‚åªæ˜¯æ‰‹æ®µï¼Œè€Œå¯¹å¼€å‘æ¥è¯´ æŠ€æœ¯æ˜¯æ‰‹æ®µ éœ€æ±‚æ˜¯ç›®æ ‡ åªä¸è¿‡äº§å“æ›´å®¹æ˜“ä¸»è§‚ï¼Œæ¯”å¦‚éœ€æ±‚ï¼Œæ¯”å¦‚è¯´åŠŸèƒ½ï¼Œæ¯”å¦‚è¯´äº¤äº’ï¼Œè¿™äº›éƒ½å—åˆ°ä¸ªäººç»éªŒï¼Œçœ¼ç•Œï¼Œå­¦è¯†å¾ˆå¤§å½±å“ã€‚æœä¸‰æš®å››ï¼Œæœä»¤å¤•æ”¹ï¼Œæ˜¯å¸¸æœ‰çš„äº‹æƒ…ã€‚<br><br><strong>è¯´çœŸçš„</strong><br>äº§å“çš„åŠŸèƒ½ã€è´¨é‡ã€å‘å¸ƒæ—¶é—´å’Œéœ€è¦æŠ•å…¥çš„èµ„æºè¿™å››è€…ä¸èƒ½éƒ½æ˜¯å°é—­æ¡ä»¶ï¼Œå¦åˆ™å¯èƒ½æ— è§£<br><br>è€Œä¸”ç°åœ¨çš„äº§å“å¾ˆæ˜¯èªæ˜å•Š éœ€æ±‚ç»™äº†ï¼Œå¼€å§‹åšäº†,åšåˆ°æœ€åå‘ç°è¿™ç§æƒ…å†µä¸‹ä¸æ˜¯å¾ˆåˆç†ï¼Œç®€å•å•Š æ”¹å‘— åæ­£åšåˆ°è¿™é‡Œæˆ‘é€»è¾‘ä¹Ÿæ‹æ¸…æ¥šäº†ï¼Œä¹ŸçŸ¥é“è¯¥å’‹åŠäº†<font face="STCAIYUN" color="#83933b" size="3">äº§å“é»˜æƒ³åˆ°</font>

<p>å‘ƒ.. è¿™ä¸¤å¤©åˆšé‡åˆ°ä¸ªç±»ä¼¼çš„æƒ…å†µ å“¦ ä¸å¥½æ„æ€ï¼Œæ˜¯<font face="STCAIYUN" color="red" size="5">ç»å¸¸é‡åˆ°</font>ï¼Œææµ‹ä¸€å‘¨ä¹Ÿæµ‹äº†<font face="STCAIYUN" color="red" size="5">ä¸€å‘¨</font>äº†ï¼Œä»£ç ä¸Šä½“éªŒç‰ˆï¼ˆé¢„ä¸Šçº¿ï¼‰äº†</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">äº§å“ï¼šå’¦ï¼Ÿè¿™å—ä¸æ˜¯é‚£æ ·å„¿çš„å—ï¼Ÿæ€ä¹ˆæ˜¯è¿™æ ·çš„ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šï¼Ÿ å‰ä¸¤å¤©ä¸æ˜¯ä¸“é—¨è®¨è®ºè¿‡è¿™ä¸ªé—®é¢˜å—ï¼Œè¿™ä¸ªå°±æ˜¯è¿™æ ·å„¿çš„ï¼</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šå“¦ï¼Ÿæ˜¯å—ï¼Ÿ ä½†æ˜¯è¿™æ ·å„¿çœ‹èµ·æ¥å¥½è¯¡å¼‚å•Šï¼å°±åº”è¯¥æ˜¯é‚£æ ·å„¿çš„ æ”¹ä¸€ä¸‹å§</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼š<span class="string">...</span>å½“åˆæ¥å£è®¾è®¡çš„å°±æ˜¯è¿™æ ·å„¿çš„ï¼Œæ€ä¹ˆä¸æ—©è¯´ï¼Ÿè¿™éƒ½è¦ä¸Šçº¿å•¦ï¼ğŸ˜©</span><br><span class="line"></span><br><span class="line">äº§å“ï¼š<span class="string">"ä¹‹å‰æµç¨‹æ²¡èµ°é€š ä¸å¤ªæ¸…æ¥šè¿™å—å„¿çš„é€»è¾‘ï¼Œç°åœ¨æ”¹ä¸€ä¸‹å§"</span> ç„¶åå°±èµ°äº†</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼š<span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰å°±æ˜¯<strong>æ’æœŸ</strong></p>
<p>äº§å“ç»å¸¸è¿™ä¹ˆä¸€å¥è¯ï¼šå› ä¸ºæˆ‘ä»¬çš„ä¸Šçº¿æ—¶é—´æ˜¯XXå· æµ‹è¯•éœ€è¦ XXå¤© æ‰€ä»¥ å¼€å‘æ’ä¸‹æœŸå§ ï¼Ÿ</p>
<p>â€¦..</p>
<p>æ’å®ŒæœŸä¹‹å..</p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line">äº§å“ï¼šæ˜‚æ˜‚ï¼Œä½ è¿™å„¿ä¸è¡Œå•Š æ—¶é—´å¤ªé•¿äº† èƒ½ä¸èƒ½ç¼©çŸ­ç‚¹</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šæˆ‘æŒ‰å·¥æ—¶ç®—çš„ æ¯ä¸€é¡¹ éƒ½åˆ—å‡ºæ¥äº† ä¸ä¼šå·®å¤ªå¤š</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šè¿™ä¸è¡Œå•Š å› ä¸ºæˆ‘ä»¬è¦XXæå®¡ æµ‹è¯•éœ€è¦XXå¤© æ‰€ä»¥ä½ å¿…é¡» XXå¤©ææµ‹</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šè¿™ç­‰äº XX å¤©çš„å·¥æœŸ ä½ ç»™æˆ‘å‹åˆ° XXï¼<span class="number">2</span> å¤©</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šå˜¿å˜¿ğŸ˜‰</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼š...</span><br><span class="line"></span><br><span class="line">å¼€å‘OSï¼š<span class="string">"èµ¶ç´§å¼€å‘ ä¸ºäº†ç»™æµ‹è¯•è…¾æ—¶é—´ğŸ˜‚ğŸ˜­ğŸ™ˆï¼Œå°¼èŒç»™å¼€å‘æ—¶é—´å……è¶³äº† é—®é¢˜è‡ªç„¶å°±ä¼šå°‘å¾ˆå¤šå¥½å— æµ‹è¯•å¥½åƒæ˜¯æœ€é‡è¦çš„å™»"</span></span><br></pre></td></tr></table></figure>
<p>ç™¾åº¦è¿‡ç±»ä¼¼çš„é—®é¢˜ æœ€å¥½çš„åŠæ³•<font face="STCAIYUN" color="red" size="3">æ˜¯è®©äº§å“ä¹Ÿå­¦ä¼šåŸºç¡€çš„ç¼–ç¨‹ï¼Œäº†è§£æ¯ä¸€ä¸ªå®ç°éƒ½æ˜¯éœ€è¦è€—è´¹èµ„æºçš„ï¼Œè¿™æ ·æ‰èƒ½åŸºäºå¯¹æœ‰é™èµ„æºçš„ç†è§£ï¼Œåšå‡ºæ›´è°¨æ…çš„è§„åˆ’ã€‚</font></p>
<font face="STCAIYUN" color="#83933b" size="3">ç„¶è€Œï¼Œè¿™åŸºæœ¬ä¸å¯èƒ½ï¼Œæ‰€ä»¥..</font>

<p>å®é™…ä¸Š é‚£äº›<font face="STCAIYUN" color="#83933b" size="4">éå¸¸ç´§æ€¥</font>çš„éœ€æ±‚ï¼Œè¿™ä¹ˆä¸€ææˆäº†æ‹–å»¶çš„ç¬¬ä¸€ä¸ªå…³é”®ç‚¹<br><br></p>
<p><img src="http://oucjferwh.bkt.clouddn.com/tuxie.jpeg" alt="tuxie"></p>
<p><strong>ä»UIçœ‹æ•ˆç‡</strong></p>
<p>å‘ƒ . å¯¹äºç”¨æˆ·æ¥è¯´ ä¸€ä¸ªäº§å“èƒ½ä¸èƒ½å¸å¼•åˆ°ä½ ï¼Œæœ€æµ…æ˜¾ä¹Ÿæœ€é‡è¦çš„æ˜¯<font face="STCAIYUN" color="red" size="5">çœ¼ç¼˜</font>ï¼Œè¯´ä¿—æ°”ç‚¹å°±æ˜¯é¢œå€¼<br>è€Œä¸” UIé“¾æ¥ äº§å“ä¸å¼€å‘ è‡ªç„¶ä¹Ÿæ˜¯é©¬è™ä¸å¾—çš„ æ·±åˆ»ç†è§£åŸå‹çš„ç²¾é«“ ç„¶ååˆ©ç”¨æ™ºæ…§çš„å°è„‘ç“œè®¾è®¡æˆç”¨æˆ·æƒ³è¦çš„æ ·å­ï¼Œä¸Šé¢è¯´äº† ä»–ä»¬æœ€é‡è¦çš„å·¥ä½œæ˜¯ <font face="STCAIYUN" color="red" size="5">æ·±åˆ»ç†è§£åŸå‹çš„ç²¾é«“</font>ï¼Œå› ä¸º å¯¹äº<font face="STCAIYUN" color="#83933b" size="4">ç¾</font>ï¼Œè®¾è®¡å¸ˆæ€»æ˜¯æœ‰ä¸ä¸€æ ·çš„å®šä¹‰ï¼Œå°±æ¯”å¦‚ <font face="STCAIYUN" color="gold" size="4">æƒ…äººçœ¼é‡Œå‡ºè¥¿æ–½</font></p>
<p>éå¸¸ä¸å¹¸ æˆ‘ä»¬UIä¹Ÿæ˜¯å¿…é¡»è¦åæ§½çš„å¯¹è±¡</p>
<p>ç›´æ¥ä¸Šæ—¥å¸¸</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">å¼€å‘ï¼šè®¾è®¡å°å“¥ï¼Œå¯¹æ¯”åŸå‹ æ˜¯ä¸æ˜¯ç¼ºäº†ä¸€å¼ å›¾</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šæœç´¢ä¸­çŠ¶æ€</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šæ²‰é»˜</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šå“¦ é‚£ä¸ªä¸å°±æ˜¯åœ¨æœªæœç´¢çš„çŠ¶æ€åŸºç¡€ä¸ŠæŠŠå¯¼èˆªå»æ‰å—ï¼Ÿè¿˜ç”¨å‡ºå›¾å—ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ä¸€åˆ†é’Ÿåï½ï½</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šçªç„¶æ‰”å‡ºæ¥ä¸€å¼ å›¾  <span class="meta">@å¼€å‘:å¥½äº†</span></span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šç…äº†ä¸€çœ¼ <span class="meta">@è®¾è®¡ï¼šå—¯</span> ï¼Ÿä¸æ˜¯è¿™æ ·å„¿çš„å§</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šï¼Ÿ</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šæŠŠäº§å“çš„è¯ <span class="meta">@è®¾è®¡ï¼šâ€œå“¦</span> é‚£ä¸ªä¸å°±æ˜¯åœ¨æœªæœç´¢çš„çŠ¶æ€åŸºç¡€ä¸ŠæŠŠå¯¼èˆªå»æ‰å—ï¼Ÿè¿˜ç”¨å‡ºå›¾å—ï¼Ÿâ€</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šæ²‰é»˜</span><br><span class="line"></span><br><span class="line">ä¸¤åˆ†é’Ÿåï½ï½</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šæ‰”å‡ºæ¥ä¸€å¼ å›¾ å‘ ä¸Šä¼ äº†</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šå—¯ ç°åœ¨æ‰æ˜¯å¯¹çš„</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šå—¯</span><br></pre></td></tr></table></figure>
<p>ç±»ä¼¼çš„äº‹æƒ…ç®€ç›´æ—¥å¸¸</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">ä¸Šåˆï½</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šä»Šå¤©å‘¨äº” éœ€è¦æŠŠUIæçš„é—®é¢˜éƒ½æ”¹å®Œ</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šok</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šok</span><br><span class="line"></span><br><span class="line">ä¸‹åˆï½</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šä»€ä¹ˆæ—¶å€™æœ‰ç©ºï¼Œå½“é¢æ”¹</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šå—¯</span><br><span class="line"></span><br><span class="line">ä¸‹åˆå››ç‚¹ï½</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šä»€ä¹ˆæ—¶å€™æœ‰ç©º</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šç°åœ¨è¿‡å»</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šå—¯</span><br><span class="line"></span><br><span class="line">æ”¹äº†å¤§æ¦‚æœ‰ä¸¤ä¸ªä¹‹å è®¾è®¡è¢«å«èµ°</span><br><span class="line"></span><br><span class="line">åˆè¿‡äº†ä¸€ä¸ªå°æ—¶ï½</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šå¿«ä¸‹ç­äº† å•¥æ—¶å€™æ”¹å°¼</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šä»Šå¤©æ¯”è¾ƒå¿™ ç°åœ¨å¯ä»¥å¼€å§‹äº†</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼š å—¯ï¼Ÿæˆ‘çœ‹äº†ä¸€ä¸‹ ä½ æ‹¿åˆ°çš„ä¸æ˜¯æœ€æ–°ç‰ˆå§ å¥½äº›é—®é¢˜ç°åœ¨ä¸èƒ½å¤ç°äº†</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šå“¦</span><br><span class="line"></span><br><span class="line">ä¸€ä¸ªå°æ—¶ä¹‹å</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šæ”¹å®Œäº† æˆ‘ä¸‹ç­äº†å•Š ä»Šå¤©æœ‰ç‚¹äº‹å„¿</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šå—¯ å¥½çš„ ä¸‹ç­å§</span><br><span class="line"></span><br><span class="line">å¼€å‘ èµ°äº†</span><br><span class="line"></span><br><span class="line">ä¸¤ä¸ªå°æ—¶å å¿™å®Œ å¼€å‘éƒ½åˆ°å®¶äº†ï½ï½</span><br><span class="line"></span><br><span class="line">äº§å“ï¼š<span class="meta">@å¼€å‘ï¼šåœ¨å“ªé‡Œå‘¢</span> å•¥æ—¶å€™å›æ¥</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šï¼Ÿæˆ‘åˆ°å®¶äº†å•Š</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šä½ å’‹èµ°äº†ï¼Ÿè®¾è®¡å°å“¥è¿˜åœ¨ç­‰ä½ å‘¢</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šï¼Ÿæˆ‘èµ°çš„æ—¶å€™è·Ÿä»–è¯´äº†å•Š ä»–çŸ¥é“å•Š</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šæˆ‘ä¸æ˜¯è¯´äº†ä»Šå¤©è¦æ”¹å®Œå— è®¾è®¡reviewäº† è¿˜æœ‰ä¸€ç‚¹é—®é¢˜</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼š... é‚£æˆ‘æ˜å¤©å»åŠ ç­å§</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒå¤©ï¼Œåˆ°å…¬å¸ä¹‹å</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼šåœ¨ç¾¤é‡Œ<span class="meta">@è®¾è®¡</span><span class="meta">@äº§å“</span> ï¼šè¿™ä¸ªåªæœ‰æˆªå›¾çœ‹ä¸å‡ºæ¥å“ªæœ‰é—®é¢˜å™»</span><br><span class="line"></span><br><span class="line">è®¾è®¡ï¼šæ²‰é»˜</span><br><span class="line"></span><br><span class="line">äº§å“ï¼šæ²‰é»˜</span><br><span class="line"></span><br><span class="line">å¼€å‘ï¼š...</span><br></pre></td></tr></table></figure>
<p><strong>ä»å¼€å‘çœ‹æ•ˆç‡</strong></p>
<p>å¼€å‘æ•ˆç‡æ— ç–‘å­˜åœ¨äºä¸¤æ–¹é¢</p>
<p>å¼ºå¥çš„æ¡†æ¶æ”¯æ’‘ä¸å‡†ç¡®çš„æ‹†åˆ†ä¼°æœŸ</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸ä¼šå»¶æœŸçš„ ä¹Ÿç®—æ˜¯è¿™å‡ ä¸ªç¯èŠ‚å½“ä¸­æœ€å¯æ§çš„</p>
<p><strong>ä»æµ‹è¯•çœ‹æ•ˆç‡</strong></p>
<p>ä½ ç†è§£ä¸€ä¸ªå¼€å‘åªç”¨äº†ä¸€å¤©çš„åŠŸèƒ½æµ‹è¯•æµ‹äº†å››å¤©çš„å¿ƒæƒ…å—</p>
<p>ä½ ç†è§£ä¸€ä¸ªå¼€å‘ç”¨äº†ä¸€å‘¨ æµ‹è¯•ç”¨äº†9ä¸ªå·¥ä½œæ—¥çš„å¿ƒç—›å—</p>
<p>ğŸ™Š</p>
<p>ç»“è¯­ï¼šğŸ’Š</p>
]]></content>
      <tags>
        <tag>æ‚è°ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯é˜²åˆ·å®ç°</title>
    <url>/2018/12/26/%E5%89%8D%E7%AB%AF%E9%98%B2%E5%88%B7/</url>
    <content><![CDATA[<p>å‰æ®µæ—¶é—´å†™äº†å‰ç«¯é˜²åˆ·é€»è¾‘ ä½œæ­¤è®°å½•<br>å½“æ—¶çš„éœ€æ±‚</p>
<hr>
<blockquote>
<p>é˜²åˆ·é€»è¾‘1 24å°æ—¶å†… ä¸€ä¸ªæ‰‹æœºå·åªèƒ½æäº¤ä¸‰æ¬¡ ç¬¬å››æ¬¡æäº¤çš„æ—¶å€™ æç¤º å·²æäº¤æˆåŠŸ è¯·è€å¿ƒç­‰å¾… 400<br>é˜²åˆ·é€»è¾‘2 24å°æ—¶å†… æäº¤ä¸‰ä¸ªæ‰‹æœºå· æäº¤ç¬¬å››ä¸ªæ—¶ æç¤º 401</p>
</blockquote>
<a id="more"></a>
<p><strong>æ­¥éª¤ä¸€ é¡µé¢åŠ è½½ è·å–cookieä¸­å½“å‰çš„ä¿¡æ¯</strong></p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"> componentDidMount() &#123;</span><br><span class="line">    <span class="comment">// è·å–cookieé‡Œå­˜çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    let cookieSaveInfo = getCookie(COOKIE_CONFIG.FINANCIAL_SAVE_INFO) <span class="string">|| "</span>&#123;&#125;<span class="string">";</span></span><br><span class="line">    <span class="comment">//todo...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç‚¹å‡»ä¿å­˜æŒ‰é’® é˜²åˆ·é€»è¾‘</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">saveInfo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; userInfoFromCookie, setModal &#125; = <span class="keyword">this</span>;</span><br><span class="line">  </span><br><span class="line">   <span class="comment">// è·å–æ‰‹æœºå·åˆ—è¡¨</span></span><br><span class="line">   <span class="keyword">let</span> phoneList = <span class="built_in">Object</span>.keys(userInfoFromCookie); <span class="comment">// ['12','21212','212']</span></span><br><span class="line">  </span><br><span class="line">   <span class="comment">// è·å–å½“å‰å­˜çš„æ‰‹æœºå·çš„ä¸ªæ•°</span></span><br><span class="line">   <span class="keyword">let</span> phoneListLength = phoneList.length;</span><br><span class="line">   <span class="comment">// å½“å‰è¾“å…¥çš„å­˜åœ¨æ‰‹æœºå·åˆ—è¡¨ä¸­</span></span><br><span class="line">   <span class="keyword">if</span> (phone <span class="keyword">in</span> userInfoFromCookie) &#123;</span><br><span class="line">       <span class="keyword">if</span> (userInfoFromCookie[phone] &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">           <span class="comment">// å½“å‰çš„æ‰‹æœºå·å­˜åœ¨æ‰‹æœºåˆ—è¡¨ä¸­ çœ‹å½“å‰æ˜¯ç¬¬å‡ æ¬¡ å¤§äºä¸‰æ¬¡æç¤º</span></span><br><span class="line">         </span><br><span class="line">          setModal(<span class="number">400</span>);</span><br><span class="line">          <span class="comment">//todo...</span></span><br><span class="line">           <span class="keyword">return</span>; <span class="comment">//é˜²å¾¡å¼ç¼–ç¨‹</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (phoneListLength &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">       <span class="comment">// å¦‚æœå½“å‰åˆ—è¡¨ä¸­å·²ç»æœ‰ä¸‰ä¸ªä¸åŒçš„æ‰‹æœºå· åˆ™æç¤º401</span></span><br><span class="line">       setModal(<span class="number">401</span>);</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">//å¯ä»¥å‘èµ·è¯·æ±‚</span></span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¯·æ±‚æˆåŠŸçš„å›è°ƒ</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> saveFunc = <span class="function">(<span class="params">resData</span>) =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">   <span class="keyword">let</span> thePhoneCount = userInfoFromCookie[phone] || <span class="number">1</span>;</span><br><span class="line">   <span class="keyword">if</span> (resData.error_code === <span class="number">200</span>) &#123;</span><br><span class="line">   </span><br><span class="line">       <span class="comment">// å­˜cookie è§„åˆ™ çœ‹ä¸‹å½“å‰æ‰‹æœºå·åœ¨ä¸åœ¨åˆ—è¡¨é‡Œ åœ¨çš„è¯ å°±æ›´æ–°æ¬¡æ•° ä¸åœ¨çš„æ•°å°±è®¾ç½®è¿™ä¸ªkey</span></span><br><span class="line">       <span class="keyword">if</span> (phone <span class="keyword">in</span> userInfoFromCookie) &#123;</span><br><span class="line">           userInfoFromCookie[phone] = thePhoneCount + <span class="number">1</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           userInfoFromCookie[phone] = thePhoneCount;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// cookieå­˜å‚¨</span></span><br><span class="line">       setCookie(COOKIE_CONFIG.FINANCIAL_SAVE_INFO, <span class="built_in">JSON</span>.stringify(userInfoFromCookie), <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>);</span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
  </entry>
  <entry>
    <title>ä¸è¦å†é—®å…³äºç¼“å­˜çš„é—®é¢˜äº†</title>
    <url>/2019/01/21/%E4%B8%8D%E8%A6%81%E5%86%8D%E9%97%AE%E5%85%B3%E4%BA%8E%E7%BC%93%E5%AD%98%E7%9A%84%E9%97%AE%E9%A2%98%E4%BA%86/</url>
    <content><![CDATA[<p>èƒŒæ™¯ï¼š<br>å‰ç«¯eréœ€è¦å…³æ³¨çš„ç‚¹ï¼Œ<code>ç¼“å­˜</code><br>å®ƒåœ¨ç§»åŠ¨ç«¯ä¸Šå°¤å…¶ä¸¥é‡ï¼Œå› ä¸ºæ‰‹æœºéšæ—¶éšåœ°ä¼šç¼“å­˜ä½ çš„èµ„æºï¼Œè¦æƒ³æ¸…ç¼“å­˜ï¼Œä¸åƒPCä½¿ç”¨å¼ºåˆ¶åˆ·æ–°ï¼Œè¿˜è¦æ‰‹åŠ¨æ‰¾åˆ°æµè§ˆå™¨çš„ç¼“å­˜ï¼Œæœ‰æ—¶å€™è¿˜è¦é‡å¯ç­‰<br>æ‰€ä»¥ ç”¨å®è·µç†è§£ç¼“å­˜æœºåˆ¶ å†™ä¸‹æ­¤æ–‡è®°å½•</p>
<p>ä¸ºäº†å¯¹æ¯”ç†è§£æœ¬æ–‡ä¼šæ¶‰åŠåˆ°</p>
<ul>
<li>DNSç¼“å­˜</li>
<li>CDNç¼“å­˜</li>
<li>æµè§ˆå™¨ç¼“å­˜(HTTPç¼“å­˜)</li>
</ul>
<hr>
<a id="more"></a>
<h2 id="å…ˆæ¢³ç†ä»¥ä¸‹webç¼“å­˜çš„ä¼˜ç¼ºç‚¹"><a href="#å…ˆæ¢³ç†ä»¥ä¸‹webç¼“å­˜çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="å…ˆæ¢³ç†ä»¥ä¸‹webç¼“å­˜çš„ä¼˜ç¼ºç‚¹"></a>å…ˆæ¢³ç†ä»¥ä¸‹webç¼“å­˜çš„ä¼˜ç¼ºç‚¹</h2><h3 id="ç¼“å­˜çš„ä¼˜åŠ¿"><a href="#ç¼“å­˜çš„ä¼˜åŠ¿" class="headerlink" title="ç¼“å­˜çš„ä¼˜åŠ¿"></a>ç¼“å­˜çš„ä¼˜åŠ¿</h3><ul>
<li>å‡å°‘ç½‘ç»œå»¶è¿Ÿ åŠ å¿«é¡µé¢æ‰“å¼€é€Ÿåº¦</li>
<li>é™ä½æœåŠ¡å™¨å‹åŠ›</li>
</ul>
<h3 id="ç¼“å­˜çš„ç¼ºç‚¹"><a href="#ç¼“å­˜çš„ç¼ºç‚¹" class="headerlink" title="ç¼“å­˜çš„ç¼ºç‚¹"></a>ç¼“å­˜çš„ç¼ºç‚¹</h3><ul>
<li>ç¼“å­˜æ²¡æœ‰æ¸…ç†æœºåˆ¶ï¼ˆæ—¶é—´ä¸€é•¿ å½“ä½ ä¸éœ€è¦æµè§ˆä¹‹å‰çš„è¿™äº›ç½‘é¡µï¼Œä»–ä»¬å°±å˜æˆäº†æ— ç”¨æ–‡ä»¶ï¼‰</li>
<li>ç»™å¼€å‘å¸¦æ¥å›°æ‰°</li>
</ul>
<h2 id="DNSç¼“å­˜"><a href="#DNSç¼“å­˜" class="headerlink" title="DNSç¼“å­˜"></a>DNSç¼“å­˜</h2><h3 id="ä»€ä¹ˆæ˜¯DNSï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯DNSï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯DNSï¼Ÿ"></a>ä»€ä¹ˆæ˜¯DNSï¼Ÿ</h3><p>å…¨ç§° <code>Domain Name System</code> åŸŸåè§£æç³»ç»Ÿ</p>
<hr>
<p>ä¸‡ç»´ç½‘ä¸Šä½œä¸ºåŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„IPæ•°ä¸²ã€‚DNSåè®®è¿è¡Œåœ¨UDPåè®®ä¹‹ä¸Šï¼Œä½¿ç”¨ç«¯å£å·53ã€‚</p>
<hr>
<h3 id="DNSè§£æ"><a href="#DNSè§£æ" class="headerlink" title="DNSè§£æ"></a>DNSè§£æ</h3><p>ç®€å•çš„è¯´,é€šè¿‡åŸŸå,æœ€ç»ˆå¾—åˆ°è¯¥åŸŸåå¯¹åº”çš„IPåœ°å€çš„è¿‡ç¨‹å«åšåŸŸåè§£æï¼ˆæˆ–ä¸»æœºåè§£æï¼‰</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">www</span><span class="selector-class">.dnscache</span><span class="selector-class">.com</span> (åŸŸå)  <span class="selector-tag">-</span> <span class="selector-tag">DNS</span>è§£æ <span class="selector-tag">-</span>&gt; 11<span class="selector-class">.222</span><span class="selector-class">.33</span><span class="selector-class">.444</span> (<span class="selector-tag">IP</span>åœ°å€)</span><br></pre></td></tr></table></figure>
<h3 id="DNSç¼“å­˜-1"><a href="#DNSç¼“å­˜-1" class="headerlink" title="DNSç¼“å­˜"></a>DNSç¼“å­˜</h3><p>æœ‰DNSçš„åœ°æ–¹,å°±æœ‰ç¼“å­˜ã€‚æµè§ˆå™¨ã€æ“ä½œç³»ç»Ÿã€Local DNSã€æ ¹åŸŸåæœåŠ¡å™¨ï¼Œå®ƒä»¬éƒ½ä¼šå¯¹DNSç»“æœåšä¸€å®šç¨‹åº¦çš„ç¼“å­˜ã€‚</p>
<hr>
<h3 id="DNSæŸ¥è¯¢è¿‡ç¨‹"><a href="#DNSæŸ¥è¯¢è¿‡ç¨‹" class="headerlink" title="DNSæŸ¥è¯¢è¿‡ç¨‹"></a>DNSæŸ¥è¯¢è¿‡ç¨‹</h3><hr>
<ol>
<li>é¦–å…ˆæœç´¢æµè§ˆå™¨è‡ªèº«çš„DNSç¼“å­˜,å¦‚æœå­˜åœ¨ï¼Œåˆ™åŸŸåè§£æåˆ°æ­¤å®Œæˆã€‚</li>
<li>å¦‚æœæµè§ˆå™¨è‡ªèº«çš„ç¼“å­˜é‡Œé¢æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„æ¡ç›®ï¼Œé‚£ä¹ˆä¼šå°è¯•è¯»å–æ“ä½œç³»ç»Ÿçš„hostsæ–‡ä»¶çœ‹æ˜¯å¦å­˜åœ¨å¯¹åº”çš„æ˜ å°„å…³ç³»,å¦‚æœå­˜åœ¨ï¼Œåˆ™åŸŸåè§£æåˆ°æ­¤å®Œæˆã€‚</li>
<li>å¦‚æœæœ¬åœ°hostsæ–‡ä»¶ä¸å­˜åœ¨æ˜ å°„å…³ç³»ï¼Œåˆ™æŸ¥æ‰¾æœ¬åœ°DNSæœåŠ¡å™¨(ISPæœåŠ¡å™¨,æˆ–è€…è‡ªå·±æ‰‹åŠ¨è®¾ç½®çš„DNSæœåŠ¡å™¨),å¦‚æœå­˜åœ¨,åŸŸååˆ°æ­¤è§£æå®Œæˆã€‚</li>
<li>å¦‚æœæœ¬åœ°DNSæœåŠ¡å™¨è¿˜æ²¡æ‰¾åˆ°çš„è¯,å®ƒå°±ä¼šå‘æ ¹æœåŠ¡å™¨å‘å‡ºè¯·æ±‚,è¿›è¡Œé€’å½’æŸ¥è¯¢ã€‚</li>
</ol>
<h2 id="CDNç¼“å­˜"><a href="#CDNç¼“å­˜" class="headerlink" title="CDNç¼“å­˜"></a>CDNç¼“å­˜</h2><h3 id="ä»€ä¹ˆæ˜¯CDNï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯CDNï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯CDNï¼Ÿ"></a>ä»€ä¹ˆæ˜¯CDNï¼Ÿ</h3><p>å…¨ç§° Content Delivery Network,å³å†…å®¹åˆ†å‘ç½‘ç»œã€‚<br>ç±»ä¼¼äºç«è½¦ç«™ä»£å”®ç‚¹ è¿™æ ·å„¿ ä¹˜å®¢ä¸ç”¨å†å»å”®ç¥¨å¤§å…å»æ’é˜Ÿä¹°ç¥¨ å‡è½»äº†å”®ç¥¨å¤§å…çš„å‹åŠ›ï¼ˆèµ·åˆ°åˆ†æµä½œç”¨,å‡è½»æœåŠ¡å™¨è´Ÿè½½å‹åŠ›ï¼‰</p>
<hr>
<p>ç”¨æˆ·åœ¨æµè§ˆç½‘ç«™çš„æ—¶å€™ï¼Œ<code>CDN</code>ä¼šé€‰æ‹©ä¸€ä¸ªç¦»ç”¨æˆ·æœ€è¿‘çš„CDNè¾¹ç¼˜èŠ‚ç‚¹æ¥å“åº”ç”¨æˆ·çš„è¯·æ±‚ï¼Œè¿™æ ·æµ·å—ç§»åŠ¨ç”¨æˆ·çš„è¯·æ±‚å°±ä¸ä¼šåƒé‡Œè¿¢è¿¢è·‘åˆ°åŒ—äº¬ç”µä¿¡æœºæˆ¿çš„æœåŠ¡å™¨ï¼ˆå‡è®¾æºç«™éƒ¨ç½²åœ¨åŒ—äº¬ç”µä¿¡æœºæˆ¿ï¼‰ä¸Šäº†ã€‚</p>
<h3 id="CDNç¼“å­˜-1"><a href="#CDNç¼“å­˜-1" class="headerlink" title="CDNç¼“å­˜"></a>CDNç¼“å­˜</h3><p><code>CDNç¼“å­˜</code>,åœ¨æµè§ˆå™¨æœ¬åœ°ç¼“å­˜å¤±æ•ˆå,æµè§ˆå™¨ä¼šå‘CDNè¾¹ç¼˜èŠ‚ç‚¹å‘èµ·è¯·æ±‚ã€‚ç±»ä¼¼æµè§ˆå™¨ç¼“å­˜,CDNè¾¹ç¼˜èŠ‚ç‚¹ä¹Ÿå­˜åœ¨ç€ä¸€å¥—ç¼“å­˜æœºåˆ¶ã€‚CDNè¾¹ç¼˜èŠ‚ç‚¹ç¼“å­˜ç­–ç•¥å› æœåŠ¡å•†ä¸åŒè€Œä¸åŒï¼Œä½†ä¸€èˆ¬éƒ½ä¼šéµå¾ª<code>http</code>æ ‡å‡†åè®®ï¼Œé€šè¿‡httpå“åº”å¤´ä¸­çš„<br><code>Cache-control: max-age   //åé¢ä¼šæåˆ°</code>çš„å­—æ®µæ¥è®¾ç½®CDNè¾¹ç¼˜èŠ‚ç‚¹æ•°æ®ç¼“å­˜æ—¶é—´ã€‚</p>
<hr>
<p><strong>CDNè¾¹ç¼˜èŠ‚ç‚¹æ•°æ®ç¼“å­˜æœºåˆ¶</strong></p>
<ul>
<li>å½“æµè§ˆå™¨å‘CDNèŠ‚ç‚¹è¯·æ±‚æ•°æ®æ—¶ï¼ŒCDNèŠ‚ç‚¹ä¼šåˆ¤æ–­ç¼“å­˜æ•°æ®æ˜¯å¦è¿‡æœŸï¼Œ</li>
<li>æœªè¿‡æœŸï¼šç›´æ¥å°†ç¼“å­˜æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>è¿‡æœŸï¼šCDNèŠ‚ç‚¹å‘æœåŠ¡å™¨å‘å‡ºå›æºè¯·æ±‚ï¼Œæ‹‰å–æœ€æ–°æ•°æ®åŒæ—¶æ›´æ–°æœ¬åœ°ç¼“å­˜ï¼Œå¹¶å°†æœ€æ–°æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ </li>
</ul>
<p>CDNæœåŠ¡å•†ä¸€èˆ¬ä¼šæä¾›åŸºäº<font color="red">æ–‡ä»¶åç¼€ã€ç›®å½•å¤šä¸ªç»´åº¦æ¥æŒ‡å®šCDNç¼“å­˜æ—¶é—´</font>ï¼Œä¸ºç”¨æˆ·æä¾›æ›´ç²¾ç»†åŒ–çš„ç¼“å­˜ç®¡ç†ã€‚</p>
<hr>
<h3 id="CDN-ä¼˜åŠ¿"><a href="#CDN-ä¼˜åŠ¿" class="headerlink" title="CDN ä¼˜åŠ¿"></a>CDN ä¼˜åŠ¿</h3><ol>
<li>CDNèŠ‚ç‚¹è§£å†³äº†è·¨è¿è¥å•†å’Œè·¨åœ°åŸŸè®¿é—®çš„é—®é¢˜ï¼Œè®¿é—®å»¶æ—¶å¤§å¤§é™ä½ã€‚</li>
<li>å¤§éƒ¨åˆ†è¯·æ±‚åœ¨CDNè¾¹ç¼˜èŠ‚ç‚¹å®Œæˆï¼ŒCDNèµ·åˆ°äº†åˆ†æµä½œç”¨ï¼Œå‡è½»äº†æºæœåŠ¡å™¨çš„è´Ÿè½½ã€‚</li>
</ol>
<hr>
<h2 id="æµè§ˆå™¨ç¼“å­˜ï¼ˆHTTPç¼“å­˜ï¼‰"><a href="#æµè§ˆå™¨ç¼“å­˜ï¼ˆHTTPç¼“å­˜ï¼‰" class="headerlink" title="æµè§ˆå™¨ç¼“å­˜ï¼ˆHTTPç¼“å­˜ï¼‰"></a>æµè§ˆå™¨ç¼“å­˜ï¼ˆHTTPç¼“å­˜ï¼‰</h2><p>å¯¹äºä¸€ä¸ªæ•°æ®è¯·æ±‚æ¥è¯´ï¼Œå¯ä»¥åˆ†ä¸ºå‘èµ·ç½‘ç»œè¯·æ±‚ åç«¯å¤„ç†  æµè§ˆå™¨å“åº”ä¸‰ä¸ªæ­¥éª¤<br>æµè§ˆå™¨ç¼“å­˜å¯ä»¥ iå¸®åŠ©æˆ‘ä»¬åœ¨ç¬¬ä¸€æ­¥å’Œç¬¬ä¸‰æ­¥ä¸­ä¼˜åŒ–æ€§èƒ½<br>æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜è€Œä¸å‘èµ·è¯·æ±‚</p>
<p>ç›¯ç€è¿™å¼ å›¾<br><img src="/images/cache/cache_detail.png" alt="cache_detai"></p>
<h3 id="ä»€ä¹ˆæ˜¯æµè§ˆå™¨ç¼“å­˜ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æµè§ˆå™¨ç¼“å­˜ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æµè§ˆå™¨ç¼“å­˜ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æµè§ˆå™¨ç¼“å­˜ï¼Ÿ</h3><p><img src="/images/cache/cachehttp.png" alt="cachehttp"><br>æµè§ˆå™¨ç¼“å­˜å…¶å®å°±æ˜¯æµè§ˆå™¨ä¿å­˜é€šè¿‡HTTPè·å–çš„æ‰€æœ‰èµ„æº,æ˜¯æµè§ˆå™¨å°†ç½‘ç»œèµ„æºå­˜å‚¨åœ¨æœ¬åœ°çš„ä¸€ç§è¡Œä¸ºã€‚</p>
<p>æˆ‘ä»¬ä»ä¸¤ä¸ªæ–¹é¢æ¥çœ‹æµè§ˆå™¨ç¼“å­˜</p>
<ul>
<li>ç¼“å­˜ä½ç½®</li>
<li>ç¼“å­˜ç­–ç•¥</li>
</ul>
<h3 id="ç¼“å­˜çš„èµ„æºå»å“ªé‡Œäº†ï¼ˆç¼“å­˜ä½ç½®ï¼‰"><a href="#ç¼“å­˜çš„èµ„æºå»å“ªé‡Œäº†ï¼ˆç¼“å­˜ä½ç½®ï¼‰" class="headerlink" title="ç¼“å­˜çš„èµ„æºå»å“ªé‡Œäº†ï¼ˆç¼“å­˜ä½ç½®ï¼‰?"></a>ç¼“å­˜çš„èµ„æºå»å“ªé‡Œäº†ï¼ˆç¼“å­˜ä½ç½®ï¼‰?</h3><p>ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®,æµè§ˆå™¨å­˜å‚¨äº†èµ„æº,é‚£å®ƒæŠŠèµ„æºå­˜å‚¨åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p>
<ul>
<li>memory cache(å­˜åœ¨å†…å­˜)</li>
</ul>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">MemoryCacheé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†èµ„æºç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œç­‰å¾…ä¸‹æ¬¡è®¿é—®æ—¶ä¸éœ€è¦é‡æ–°ä¸‹è½½èµ„æºï¼Œè€Œç›´æ¥ä»å†…å­˜ä¸­è·å–ã€‚Webkitæ—©å·²æ”¯æŒmemoryCacheã€‚</span><br><span class="line">ç›®å‰Webkitèµ„æºåˆ†æˆä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸»èµ„æºï¼Œæ¯”å¦‚HTMLé¡µé¢ï¼Œæˆ–è€…ä¸‹è½½é¡¹ï¼Œä¸€ç±»æ˜¯æ´¾ç”Ÿèµ„æºï¼Œæ¯”å¦‚HTMLé¡µé¢ä¸­å†…åµŒçš„å›¾ç‰‡æˆ–è€…è„šæœ¬é“¾æ¥ï¼Œåˆ†åˆ«å¯¹åº”ä»£ç ä¸­ä¸¤ä¸ªç±»ï¼šMainResourceLoaderå’ŒSubresourceLoaderã€‚è™½ç„¶Webkitæ”¯æŒmemoryCacheï¼Œä½†æ˜¯ä¹Ÿåªæ˜¯é’ˆå¯¹æ´¾ç”Ÿèµ„æºï¼Œå®ƒå¯¹åº”çš„ç±»ä¸ºCachedResourceï¼Œç”¨äºä¿å­˜åŸå§‹æ•°æ®ï¼ˆæ¯”å¦‚CSSï¼Œ<span class="keyword">JS</span>ç­‰ï¼‰ï¼Œä»¥åŠè§£ç è¿‡çš„å›¾ç‰‡æ•°æ®ã€‚</span><br></pre></td></tr></table></figure>
<ul>
<li>disk cacheï¼ˆå­˜åœ¨ç£ç›˜ï¼‰</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DiskCacheé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†èµ„æºç¼“å­˜åˆ°ç£ç›˜ä¸­ï¼Œç­‰å¾…ä¸‹æ¬¡è®¿é—®æ—¶ä¸éœ€è¦é‡æ–°ä¸‹è½½èµ„æºï¼Œè€Œç›´æ¥ä»ç£ç›˜ä¸­è·å–ï¼Œå®ƒçš„ç›´æ¥æ“ä½œå¯¹è±¡ä¸ºCurlCacheManagerã€‚</span><br></pre></td></tr></table></figure>
<p><img src="/images/cache/huancunduibi.png" alt="huancunduibi"></p>
<h3 id="è®¿é—®ç¼“å­˜ä¼˜å…ˆçº§"><a href="#è®¿é—®ç¼“å­˜ä¼˜å…ˆçº§" class="headerlink" title="è®¿é—®ç¼“å­˜ä¼˜å…ˆçº§"></a>è®¿é—®ç¼“å­˜ä¼˜å…ˆçº§</h3><ol>
<li>å…ˆåœ¨å†…å­˜ä¸­æŸ¥æ‰¾,å¦‚æœæœ‰,ç›´æ¥åŠ è½½ã€‚</li>
<li>å¦‚æœå†…å­˜ä¸­ä¸å­˜åœ¨,åˆ™åœ¨ç¡¬ç›˜ä¸­æŸ¥æ‰¾,å¦‚æœæœ‰ç›´æ¥åŠ è½½ã€‚</li>
<li>å¦‚æœç¡¬ç›˜ä¸­ä¹Ÿæ²¡æœ‰,é‚£ä¹ˆå°±è¿›è¡Œç½‘ç»œè¯·æ±‚ã€‚</li>
<li>è¯·æ±‚è·å–çš„èµ„æºç¼“å­˜åˆ°ç¡¬ç›˜å’Œå†…å­˜ã€‚</li>
</ol>
<h3 id="æµè§ˆå™¨ç¼“å­˜çš„åˆ†ç±»ï¼ˆç¼“å­˜ç­–ç•¥ï¼‰"><a href="#æµè§ˆå™¨ç¼“å­˜çš„åˆ†ç±»ï¼ˆç¼“å­˜ç­–ç•¥ï¼‰" class="headerlink" title="æµè§ˆå™¨ç¼“å­˜çš„åˆ†ç±»ï¼ˆç¼“å­˜ç­–ç•¥ï¼‰"></a>æµè§ˆå™¨ç¼“å­˜çš„åˆ†ç±»ï¼ˆç¼“å­˜ç­–ç•¥ï¼‰</h3><h4 id="å¼ºç¼“å­˜"><a href="#å¼ºç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h4><h4 id="åå•†ç¼“å­˜"><a href="#åå•†ç¼“å­˜" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h4><p>éœ€è¦è¯´æ˜çš„æ˜¯ æµè§ˆå™¨ä¼šå…ˆåˆ¤æ–­æ˜¯å¦å‘½ä¸­å¼ºç¼“å­˜</p>
<h3 id="æµè§ˆå™¨ç¼“å­˜çš„ä¼˜ç‚¹"><a href="#æµè§ˆå™¨ç¼“å­˜çš„ä¼˜ç‚¹" class="headerlink" title="æµè§ˆå™¨ç¼“å­˜çš„ä¼˜ç‚¹"></a>æµè§ˆå™¨ç¼“å­˜çš„ä¼˜ç‚¹</h3><ol>
<li>å‡å°‘äº†å†—ä½™çš„æ•°æ®ä¼ è¾“ èŠ‚çœäº†ç½‘è´¹</li>
<li>å‡å°‘äº†æœåŠ¡å™¨çš„è´Ÿæ‹…ï¼Œå¤§å¤§æå‡äº†ç½‘ç«™çš„æ€§èƒ½</li>
<li>åŠ å¿«äº†å®¢æˆ·ç«¯åŠ è½½ç½‘é¡µçš„é€Ÿåº¦</li>
</ol>
<p><strong>æµè§ˆå™¨åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚å‘ç”Ÿåï¼Œå†æ¬¡è¯·æ±‚æ—¶ï¼š</strong></p>
<ol>
<li>éªŒè¯æ˜¯å¦å‘½ä¸­å¼ºç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼Œå°±ç›´æ¥ä½¿ç”¨ç¼“å­˜äº†ã€‚</li>
<li>å¦‚æœæ²¡æœ‰å‘½ä¸­å¼ºç¼“å­˜ï¼Œå°±å‘è¯·æ±‚åˆ°æœåŠ¡å™¨æ£€æŸ¥æ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ã€‚</li>
<li>å¦‚æœå‘½ä¸­åå•†ç¼“å­˜ï¼ŒæœåŠ¡å™¨ä¼šè¿”å› 304 å‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚</li>
<li>å¦åˆ™ï¼Œè¿”å›æœ€æ–°çš„èµ„æºã€‚</li>
</ol>
<h4 id="å¼ºç¼“å­˜-1"><a href="#å¼ºç¼“å­˜-1" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h4><p>å¼ºç¼“å­˜æ˜¯åˆ©ç”¨httpçš„è¿”å›å¤´ä¸­çš„<code>Expires</code>æˆ–è€…<code>Cache-Control</code>ä¸¤ä¸ªå­—æ®µæ¥æ§åˆ¶çš„ï¼Œç”¨æ¥è¡¨ç¤ºèµ„æºçš„ç¼“å­˜æ—¶é—´ã€‚</p>
<font color="red">Expires</font>:<br>è¯¥å­—æ®µæ˜¯http1.0æ—¶çš„è§„èŒƒï¼Œå®ƒçš„å€¼ä¸ºä¸€ä¸ªç»å¯¹æ—¶é—´çš„GMTæ ¼å¼çš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚Expires:Mon,18 Oct 2066 23:59:59 GMTã€‚è¿™ä¸ªæ—¶é—´ä»£è¡¨ç€è¿™ä¸ªèµ„æºçš„å¤±æ•ˆæ—¶é—´ï¼Œåœ¨æ­¤æ—¶é—´ä¹‹å‰ï¼Œå³å‘½ä¸­ç¼“å­˜ã€‚è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œç”±äºå¤±æ•ˆæ—¶é—´æ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´ï¼Œæ‰€ä»¥å½“æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯æ—¶é—´åå·®è¾ƒå¤§æ—¶ï¼Œå°±ä¼šå¯¼è‡´ç¼“å­˜æ··ä¹±ã€‚<br><br>â€”â€”-<br><font color="red">Cache-Control</font>:<br>Cache-Controlæ˜¯http1.1æ—¶å‡ºç°çš„headerä¿¡æ¯ï¼Œä¸»è¦æ˜¯åˆ©ç”¨è¯¥å­—æ®µçš„max-ageå€¼æ¥è¿›è¡Œåˆ¤æ–­ï¼Œå®ƒæ˜¯ä¸€ä¸ªç›¸å¯¹æ—¶é—´ï¼Œä¾‹å¦‚Cache-Control:max-age=3600ï¼Œä»£è¡¨ç€èµ„æºçš„æœ‰æ•ˆæœŸæ˜¯3600ç§’ã€‚cache-controlé™¤äº†è¯¥å­—æ®µå¤–ï¼Œè¿˜æœ‰ä¸‹é¢å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„è®¾ç½®å€¼ï¼š<br><br><em> no-cacheï¼šä¸ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚éœ€è¦ä½¿ç”¨ç¼“å­˜åå•†ï¼Œå…ˆä¸æœåŠ¡å™¨ç¡®è®¤è¿”å›çš„å“åº”æ˜¯å¦è¢«æ›´æ”¹ï¼Œå¦‚æœä¹‹å‰çš„å“åº”ä¸­å­˜åœ¨ETagï¼Œé‚£ä¹ˆè¯·æ±‚çš„æ—¶å€™ä¼šä¸æœåŠ¡ç«¯éªŒè¯ï¼Œå¦‚æœèµ„æºæœªè¢«æ›´æ”¹ï¼Œåˆ™å¯ä»¥é¿å…é‡æ–°ä¸‹è½½ã€‚
</em> no-storeï¼šç›´æ¥ç¦æ­¢æ¸¸è§ˆå™¨ç¼“å­˜æ•°æ®ï¼Œæ¯æ¬¡ç”¨æˆ·è¯·æ±‚è¯¥èµ„æºï¼Œéƒ½ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæ¯æ¬¡éƒ½ä¼šä¸‹è½½å®Œæ•´çš„èµ„æºã€‚<br><em> publicï¼šå¯ä»¥è¢«æ‰€æœ‰çš„ç”¨æˆ·ç¼“å­˜ï¼ŒåŒ…æ‹¬ç»ˆç«¯ç”¨æˆ·å’ŒCDNç­‰ä¸­é—´ä»£ç†æœåŠ¡å™¨ã€‚
</em> privateï¼šåªèƒ½è¢«ç»ˆç«¯ç”¨æˆ·çš„æµè§ˆå™¨ç¼“å­˜ï¼Œä¸å…è®¸CDNç­‰ä¸­ç»§ç¼“å­˜æœåŠ¡å™¨å¯¹å…¶ç¼“å­˜ã€‚<br><br><br><font color="red">Cache-Controlä¸Expireså¯ä»¥åœ¨æœåŠ¡ç«¯é…ç½®åŒæ—¶å¯ç”¨ï¼ŒåŒæ—¶å¯ç”¨çš„æ—¶å€™Cache-Controlä¼˜å…ˆçº§é«˜ã€‚</font>

<h2 id="åå•†ç¼“å­˜-1"><a href="#åå•†ç¼“å­˜-1" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h2><p>å½“å¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ ¹æ® <code>header</code> ä¸­çš„éƒ¨åˆ†ä¿¡æ¯æ¥åˆ¤æ–­æ˜¯å¦å‘½ä¸­ç¼“å­˜ã€‚å¦‚æœå‘½ä¸­ï¼Œåˆ™è¿”å›<code>304</code> ï¼Œå‘Šè¯‰æµè§ˆå™¨èµ„æºæœªæ›´æ–°ï¼Œå¯ä½¿ç”¨æœ¬åœ°çš„ç¼“å­˜ã€‚</p>
<hr>
<p>headerï¼š <code>Last-Modify/If-Modify-Since</code>å’Œ <code>ETag/If-None-Match</code>.</p>
<p><strong>Last-Modify/If-Modify-Since</strong><br>æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸€ä¸ªèµ„æºçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨è¿”å›çš„ header ä¸­ä¼šåŠ ä¸Š Last-Modifyï¼ŒLast-modify æ˜¯ä¸€ä¸ªæ—¶é—´æ ‡è¯†è¯¥èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚<br>å½“æµè§ˆå™¨å†æ¬¡è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œrequest çš„è¯·æ±‚å¤´ä¸­ä¼šåŒ…å« If-Modify-Sinceï¼Œè¯¥å€¼ä¸ºç¼“å­˜ä¹‹å‰è¿”å›çš„ Last-Modifyã€‚æœåŠ¡å™¨æ”¶åˆ° If-Modify-Since åï¼Œæ ¹æ®èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´åˆ¤æ–­æ˜¯å¦å‘½ä¸­ç¼“å­˜ã€‚<br>å¦‚æœå‘½ä¸­ç¼“å­˜ï¼Œåˆ™è¿”å› 304ï¼Œå¹¶ä¸”ä¸ä¼šè¿”å›èµ„æºå†…å®¹ï¼Œå¹¶ä¸”ä¸ä¼šè¿”å› Last-Modifyã€‚</p>
<font color="red">ç¼ºç‚¹:</font><br>1. <strong>çŸ­æ—¶é—´å†…èµ„æºå‘ç”Ÿäº†æ”¹å˜</strong>,<code>Last-Modified</code>å¹¶ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚<br>2. <strong>å‘¨æœŸæ€§å˜åŒ–</strong>,å¦‚æœè¿™ä¸ªèµ„æºåœ¨ä¸€ä¸ªå‘¨æœŸå†…ä¿®æ”¹å›åŸæ¥çš„æ ·å­äº†ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„ï¼Œä½†æ˜¯ <code>Last-Modified</code> å¯ä¸è¿™æ ·è®¤ä¸º,å› æ­¤ä¾¿æœ‰äº† <code>ETag</code><br><br><strong>ETag/If-None-Match</strong><br>ä¸ <code>Last-Modify/If-Modify-Since</code> ä¸åŒçš„æ˜¯ï¼Œ<code>Etag/If-None-Match</code>è¿”å›çš„æ˜¯ä¸€ä¸ªæ ¡éªŒç ã€‚<code>ETag</code> å¯ä»¥ä¿è¯æ¯ä¸€ä¸ªèµ„æºæ˜¯å”¯ä¸€çš„ï¼Œèµ„æºå˜åŒ–éƒ½ä¼šå¯¼è‡´ <code>ETag</code>å˜åŒ–ã€‚æœåŠ¡å™¨æ ¹æ®æµè§ˆå™¨ä¸Šé€çš„ <code>If-None-Match</code> å€¼æ¥åˆ¤æ–­æ˜¯å¦å‘½ä¸­ç¼“å­˜ã€‚<br>ä¸ <code>Last-Modified</code> ä¸ä¸€æ ·çš„æ˜¯ï¼Œå½“æœåŠ¡å™¨è¿”å› <code>304 Not Modified</code>çš„å“åº”æ—¶ï¼Œç”±äº <code>ETag</code>é‡æ–°ç”Ÿæˆè¿‡ï¼Œ<code>response header</code>ä¸­è¿˜ä¼šæŠŠè¿™ä¸ª <code>ETag</code> è¿”å›ï¼Œå³ä½¿è¿™ä¸ª <code>ETag</code> è·Ÿä¹‹å‰çš„æ²¡æœ‰å˜åŒ–ã€‚<br><br><font color="red">Last-Modified ä¸ ETag æ˜¯å¯ä»¥ä¸€èµ·ä½¿ç”¨çš„ï¼ŒæœåŠ¡å™¨ä¼šä¼˜å…ˆéªŒè¯ ETagï¼Œä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šç»§ç»­æ¯”å¯¹ Last-Modifiedï¼Œæœ€åæ‰å†³å®šæ˜¯å¦è¿”å› 304ã€‚</font>


<hr>
<h3 id="å®è·µæ£€éªŒ"><a href="#å®è·µæ£€éªŒ" class="headerlink" title="å®è·µæ£€éªŒ"></a>å®è·µæ£€éªŒ</h3><p>æˆ‘è®¨åŒæ–‡å­—è®°å¿†ï¼Œæ‰€ä»¥æ¯«ä¸çŠ¹è±«é€‰äº†ç†å·¥ç§‘ï½ï½<br><code>talk is cheap , show me your code</code></p>
<p>âš ï¸ å®è·µè¿‡ç¨‹æ§åˆ¶å°ä¸è¦ç¦ç”¨ç¼“å­˜</p>
<p>åˆ©ç”¨<code>koa</code>å¯åŠ¨<code>server</code>æœåŠ¡ <code>portï¼š8000</code></p>
<p>å¼•å…¥é™æ€èµ„æº åŠ è½½å‰ç«¯æ¨¡ç‰ˆ å»å†…è’™çš„èˆªæ‹ å“ˆå“ˆå“ˆ æœ‰æˆ‘</p>
<p><img src="/images/cache/cache_one.png" alt="cache_one"></p>
<p>å¦‚å›¾å¯è§ åˆæ¬¡è®¿é—® æ­£å¸¸åŠ è½½æ¨¡ç‰ˆé¡µé¢<code>cache</code>ä¸å›¾ç‰‡èµ„æº<code>1.jpeg</code></p>
<p><strong>å®ç°å¼ºç¼“å­˜</strong></p>
<hr>
<ol>
<li><strong>æœåŠ¡ç«¯</strong>è®¾ç½®å“åº”å¤´Cache-Control èµ„æºæœ‰æ•ˆæœŸä¸º300ç§’</li>
</ol>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">app.use(<span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line"> </span><br><span class="line">  ctx.<span class="keyword">set</span>(&#123;</span><br><span class="line">    <span class="string">'Cache-Control'</span>: <span class="string">'max-age=300'</span>  </span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åˆ·æ–°é¡µé¢</li>
</ol>
<p><img src="/images/cache/cache1.png" alt="cache1"><br>å“åº”å¤´çš„<code>Cache-Control</code>å˜æˆäº† max-age=300</p>
<p><font color="red">éªŒè¯è®¿é—®ç¼“å­˜çš„ä¼˜å…ˆçº§:</font><br>ç¬¬ä¸€æ¬¡çš„ç½‘ç»œè¯·æ±‚,æµè§ˆå™¨æŠŠå›¾ç‰‡èµ„æºç¼“å­˜åˆ°äº†ç£ç›˜å’Œå†…å­˜é‡Œï¼Œæ ¹æ®çº¦å®š åº”è¯¥ä¼šå…ˆä»å†…å­˜ä¸­æ‰¾èµ„æº</p>
<ol>
<li>å†æ¬¡åˆ·æ–°é¡µé¢</li>
</ol>
<p> <img src="/images/cache/cache-----.png" alt="cache-----"></p>
<p>ç¡®å®æ˜¯ä»å†…å­˜è·å–çš„</p>
<p>4.å…³æ‰é¡µé¢å†é‡æ–°æ‰“å¼€ ï¼ˆå†…å­˜æ˜¯å­˜åœ¨è¿›ç¨‹ä¸­çš„,æ‰€ä»¥å…³é—­è¯¥é¡µé¢,å†…å­˜ä¸­çš„èµ„æºä¹Ÿè¢«é‡Šæ”¾æ‰äº†,ç£ç›˜ä¸­çš„èµ„æºæ˜¯æ°¸ä¹…æ€§çš„,æ‰€ä»¥è¿˜å­˜åœ¨ï¼‰<br><img src="/images/cache/cache_disk.png" alt="cache_disk"></p>
<p>from disk cache ä»ç£ç›˜ä¸­è·å–èµ„æº</p>
<p>5.æ¥ä¸‹æ¥ æœ‰æ•ˆæœŸ 300ç§’ å.<br><img src="/images/cache/cachehuancunshixiao.png" alt="cachehuancunshixiao"><br>ç¼“å­˜å¤±æ•ˆ é‡æ–°å‘æœåŠ¡å™¨è½½å…¥èµ„æº</p>
<hr>
<p><strong>å®ç°åå•†ç¼“å­˜</strong><br>åå•†ç¼“å­˜æœ¬åœ°æµ‹è¯•ç›´æ¥æ‹¦æˆªurlç»™å®šcode</p>
<p>Cache-Control å–é»˜è®¤å€¼ no-cache</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">app.use( async(ctx, <span class="keyword">next</span>) =&gt; &#123;</span><br><span class="line"><span class="regexp">//</span> <span class="regexp">//</span> å¼ºåˆ¶ç¼“å­˜</span><br><span class="line"><span class="regexp">//</span>  ctx.set(&#123;</span><br><span class="line"><span class="regexp">//</span>    <span class="string">'Cache-Control'</span>: <span class="string">'max-age=300'</span>  </span><br><span class="line"><span class="regexp">//</span>  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> åå•†ç¼“å­˜æµ‹è¯•</span><br><span class="line"><span class="keyword">if</span>(ctx.url === <span class="string">'/imgs/1.jpeg'</span>)&#123;</span><br><span class="line">  ctx.status = <span class="number">304</span>;</span><br><span class="line">  return;</span><br><span class="line">&#125;</span><br><span class="line">await <span class="keyword">next</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/images/cache/xieshang.png" alt="xieshang"></p>
<p>æœåŠ¡å™¨è¿”å›<code>304</code> åŒæ—¶<code>size</code>å˜å°äº†å¾ˆå¤š å› ä¸ºåªè¿”å›äº†å¿…è¦ä¿¡æ¯</p>
<p>ä¹Ÿå¯åˆ©ç”¨ ç°æˆçš„æ’ä»¶å¸®æˆ‘ä»¬è®¡ç®—æ–‡ä»¶çš„ETag<br><code>npm install koa-tag -D
npm install koa-conditional-get -D</code><br>å°±ä¸æ¼”ç¤ºäº†</p>
<p>åŠ è½½èµ„æºå‘ç”Ÿå˜åŒ–ï¼ˆæ¯”å¦‚æ¢äº†å¼ å›¾ç‰‡ï¼‰<code>ETag</code>æ”¹å˜ ä¼šå¯¼è‡´åå•†ç¼“å­˜ç­–ç•¥å¤±æ•ˆ</p>
<p>ç„¶å  å°±è¡Œäº†. ğŸ˜Š</p>
<p>å¦‚æœä½ æƒ³äº²è‡ªä½“éªŒ</p>
<p><a href>æºç åœ¨è¿™é‡Œ</a></p>
<p>day day up</p>
]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>ç¼“å­˜</tag>
      </tags>
  </entry>
  <entry>
    <title>2018 å†™åœ¨å¹´ç»ˆçš„è¯</title>
    <url>/2019/01/21/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p>2018å¹´ç»ˆæ€»ç»“</p>
]]></content>
      <categories>
        <category>æ‚è°ˆ</category>
      </categories>
  </entry>
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºå¼€å‘å¸¸è§é—®é¢˜</title>
    <url>/2017/07/19/%E5%BC%80%E5%8F%91%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h2 id="åœºæ™¯ä¸€ï¼šé¦–é¡µå¢åŠ ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½æ— æ•ˆï¼Ÿ"><a href="#åœºæ™¯ä¸€ï¼šé¦–é¡µå¢åŠ ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½æ— æ•ˆï¼Ÿ" class="headerlink" title="åœºæ™¯ä¸€ï¼šé¦–é¡µå¢åŠ ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½æ— æ•ˆï¼Ÿ"></a>åœºæ™¯ä¸€ï¼šé¦–é¡µå¢åŠ ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½æ— æ•ˆï¼Ÿ</h2><p>ç»è¿‡å„ç§å°è¯• é—®é¢˜å®šä½åˆ°äº†æ˜¯å› ä¸º åœ¨<code>scroll-view</code>ä¸­ä½¿ç”¨äº†<code>onPullDownRefresh</code>ï¼Œæœ€åé€šè¿‡æ”¹é¦–é¡µçš„ä»£ç ç»“æ„è¾¾åˆ°äº†é¢„æœŸç»“æœ</p>
<p>ç»“è®ºï¼š<font face="STCAIYUN" color="#83933b" size="3"><br>åœ¨æ»šåŠ¨ scroll-view æ—¶ä¼šé˜»æ­¢é¡µé¢å›å¼¹ï¼Œæ‰€ä»¥åœ¨ scroll-view ä¸­æ»šåŠ¨ï¼Œæ˜¯æ— æ³•è§¦å‘ onPullDownRefresh</font></p>
<p>å¦‚æœéè¦åœ¨<code>scroll-view</code>ä½¿ç”¨ä¸‹æ‹‰åˆ·æ–°ï¼Œ<font face="STCAIYUN" color="#83933b" size="3">å®˜æ–¹ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆ</font>æ˜¯ç›‘å¬é¡µé¢çš„æ»šåŠ¨äº‹ä»¶ <code>bindscroll</code>  å„.. ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³• åªä¸è¿‡æˆ‘çš„æ›´ç²—é²ä¸€äº›</p>
<p><strong>å…¶ä»–éœ€è¦æ³¨æ„çš„ï¼š</strong></p>
<ul>
<li>ä¸è¦åœ¨<code>scroll-view</code>ä¸­ä½¿ç”¨ <code>textarea</code>ã€<code>map</code>ã€<code>canvas</code>ã€<code>video</code> ç»„ä»¶</li>
<li>ç›®å‰åªéªŒè¯è¿‡ <code>textarea</code> æš‚ä¸”æ”¾åˆ°åœºæ™¯äºŒå§</li>
<li><code>scroll-into-view</code> çš„ä¼˜å…ˆçº§é«˜äº <code>scroll-top</code></li>
</ul>
<h2 id="åœºæ™¯äºŒï¼šæ— æ³•åœ¨-scroll-viewä¸­ä½¿ç”¨textareaï¼Ÿ"><a href="#åœºæ™¯äºŒï¼šæ— æ³•åœ¨-scroll-viewä¸­ä½¿ç”¨textareaï¼Ÿ" class="headerlink" title="åœºæ™¯äºŒï¼šæ— æ³•åœ¨ scroll-viewä¸­ä½¿ç”¨textareaï¼Ÿ"></a>åœºæ™¯äºŒï¼šæ— æ³•åœ¨ scroll-viewä¸­ä½¿ç”¨textareaï¼Ÿ</h2><font face="STCAIYUN" color="red" size="3">è¿™æ˜¯ä¸ªåªæœ‰åœ¨çœŸæœºä¸Šæ‰ä¼šå‡ºç°çš„bug</font>

<p>åˆšå¼€å§‹ä»¥ä¸ºæ˜¯ä¸èƒ½åœ¨æŸäº›ç‰¹å®šçš„ç»„ä»¶å†…ä½¿ç”¨<code>textarea</code> å‡ ç•ªå°è¯• å‘ç°æ˜¯å› ä¸º <code>textarea</code>ç»„ä»¶ä¸å…¶ä»–ç»„ä»¶çš„å±‚çº§å…³ç³» åæ¥å‘ç° <font face="STCAIYUN" color="#83933b" size="3">æ–‡æ¡£åœ¨æœ€ä¸‹æ–¹ç”¨æœ€å°å·çš„å­—ä½“ç»™æ ‡æ³¨å‡ºæ¥äº†å·²ç»ï¼</font><font face="STCAIYUN" color="red" size="3">åè¡€</font></p>
<p>ç»“è®ºï¼š<font face="STCAIYUN" color="#83933b" size="3"><br><code>textarea</code>ç»„ä»¶æ˜¯ç”±å®¢æˆ·ç«¯åˆ›å»ºçš„åŸç”Ÿç»„ä»¶ï¼Œä»–çš„å±‚çº§æ˜¯æœ€é«˜çš„ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ è¦ä¿è¯æœ¬é¡µé¢ä¸­ æ—  </font><font face="STCAIYUN" color="red" size="3">å¼¹å±‚</font>ä¹‹ç±»ä¸€åˆ‡å¯èƒ½ä¼šè¦†ç›–åˆ°é¡µé¢çš„é¬¼ã€‚<br></p>
<p><strong>å…¶ä»–éœ€è¦æ³¨æ„çš„ï¼š</strong></p>
<ul>
<li>ä¸è¦åœ¨ <code>scroll-view</code> ä¸­ä½¿ç”¨ <code>textarea</code> ç»„ä»¶ã€‚</li>
<li>css åŠ¨ç”»å¯¹ textarea ç»„ä»¶æ— æ•ˆ</li>
<li>textarea çš„ <code>blur</code> äº‹ä»¶ä¼šæ™šäºé¡µé¢ä¸Šçš„ tap äº‹ä»¶ï¼Œå¦‚æœéœ€è¦åœ¨ button çš„ç‚¹å‡»äº‹ä»¶è·å– textareaï¼Œå¯ä»¥ä½¿ç”¨ <code>form</code> çš„ bindsubmitã€‚</li>
<li>å®˜æ–¹é—ç•™bug: <code>textarea</code> åœ¨åˆ—è¡¨æ¸²æŸ“æ—¶ï¼Œæ–°å¢åŠ çš„ textarea åœ¨è‡ªåŠ¨èšç„¦æ—¶çš„ä½ç½®è®¡ç®—é”™è¯¯ã€‚<h2 id="åœºæ™¯ä¸‰ï¼štextareaçš„placeholderä¸å›ºå®šçš„é—®é¢˜"><a href="#åœºæ™¯ä¸‰ï¼štextareaçš„placeholderä¸å›ºå®šçš„é—®é¢˜" class="headerlink" title="åœºæ™¯ä¸‰ï¼štextareaçš„placeholderä¸å›ºå®šçš„é—®é¢˜"></a>åœºæ™¯ä¸‰ï¼štextareaçš„placeholderä¸å›ºå®šçš„é—®é¢˜</h2></li>
</ul>
<p>å½“æŠŠ<code>textarea</code>æ”¾åˆ°ä¸€ä¸ª<code>positionï¼šfixed</code>ä¸­çš„å…ƒç´ ä¸­æ—¶ï¼Œä¼šå‘ç°è¿™ä¸ª<code>textarea</code>ä¹Ÿä¼šè·Ÿç€å›ºå®šä½ç½®ï¼Œä½†æ˜¯<code>textarea</code>çš„placeholderå†…å®¹ä¸ä¼šå›ºå®šï¼Œå½“æ»šåŠ¨é¡µé¢æ—¶ï¼Œplaceholderçš„å†…å®¹ä¼šè·Ÿç€æ»šåŠ¨</p>
<p>è§£å†³æ–¹å¼ï¼š<font face="STCAIYUN" color="red" size="3">ç»™<code>textarea</code>ç»„ä»¶å¢åŠ å±æ€§fixed<br></font></p>
<p>ç»“è®ºï¼š<font face="STCAIYUN" color="#83933b" size="3">è¸©å‘å¤§æ³•å¥½</font></p>
<h2 id="åœºæ™¯å››ï¼šå¾®ä¿¡å°ç¨‹åºçš„å…¼å®¹é—®é¢˜"><a href="#åœºæ™¯å››ï¼šå¾®ä¿¡å°ç¨‹åºçš„å…¼å®¹é—®é¢˜" class="headerlink" title="åœºæ™¯å››ï¼šå¾®ä¿¡å°ç¨‹åºçš„å…¼å®¹é—®é¢˜"></a>åœºæ™¯å››ï¼šå¾®ä¿¡å°ç¨‹åºçš„å…¼å®¹é—®é¢˜</h2><p><code>wx.request()</code>è¿”å›çš„çŠ¶æ€ç <code>res.statusCode</code>çš„å€¼ åœ¨IOSä¸‹æ˜¯<font face="STCAIYUN" color="red" size="3">init</font>å‹çš„æ•°æ® ä½†æ˜¯åœ¨ Android 6.0.1 ä¸Šå´æ˜¯ <font face="STCAIYUN" color="red" size="3">String</font> å‹æ•°æ®<br>è¦ç‰¹åˆ«æ³¨æ„åˆ¤æ–­çŠ¶æ€ç çš„æ–¹å¼</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">X</span><br><span class="line">wx.request(&#123;</span><br><span class="line">    url: <span class="string">'http://api.example.com'</span>,</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> <span class="params">(res)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (res.statusCode === <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="comment">// success</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// server failure</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">åƒè¿™æ ·ä½¿ç”¨ === å°±é”™äº† ä¸è¦åˆ¤æ–­ç±»å‹</span><br><span class="line">ä½¿ç”¨ ==å³å¯</span><br></pre></td></tr></table></figure>
<p>å°ç¨‹åºçš„WXMLæ²¡æœ‰HTMLçš„å®½å®¹åº¦â€‹é‚£ä¹ˆé«˜ï¼Œå•æ ‡ç­¾å¿…éœ€æ˜¯ /&gt; ç»“å°¾çš„ ä¸ç„¶ä¼šæŠ¥é”™ã€‚</p>
<h2 id="åœºæ™¯äº”ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜"><a href="#åœºæ™¯äº”ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜" class="headerlink" title="åœºæ™¯äº”ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜"></a>åœºæ™¯äº”ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜</h2><p>æ— è®ºç”¨å“ªä¸ªç»„ä»¶ å¿…é¡»æ—¶åˆ»æ³¨æ„å½“å‰å…¼å®¹çš„ç‰ˆæœ¬ åšä½ç‰ˆæœ¬å…¼å®¹</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"> <span class="selector-tag">wx</span><span class="selector-class">.openBluetoothAdapter</span>()</span><br><span class="line">&#125; <span class="selector-tag">else</span> &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœå¸Œæœ›ç”¨æˆ·åœ¨æœ€æ–°ç‰ˆæœ¬çš„å®¢æˆ·ç«¯ä¸Šä½“éªŒæ‚¨çš„å°ç¨‹åºï¼Œå¯ä»¥è¿™æ ·å­æç¤º</span></span><br><span class="line">  <span class="selector-tag">wx</span><span class="selector-class">.showModal</span>(&#123;</span><br><span class="line">    <span class="attribute">title</span>: <span class="string">'æç¤º'</span>,</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">'å½“å‰å¾®ä¿¡ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·å‡çº§åˆ°æœ€æ–°å¾®ä¿¡ç‰ˆæœ¬åé‡è¯•ã€‚'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Fundebug</code>èƒ½å¤Ÿå®æ—¶ç›‘æµ‹å°ç¨‹åºï¼Œæ•è·å°ç¨‹åºBugï¼Œç„¶ååé¦ˆç»™å¼€å‘è€…<br><a href="https://fundebug.com/" target="_blank" rel="noopener">Fundebug</a></p>
<h2 id="åœºæ™¯å…­ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜"><a href="#åœºæ™¯å…­ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜" class="headerlink" title="åœºæ™¯å…­ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜"></a>åœºæ™¯å…­ï¼šå°ç¨‹åºç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜</h2><p>ç»‘å®šäº‹ä»¶çš„æ—¶å€™ï¼Œå½“ä¸¤ä¸ªæ–¹æ³•é‡åæ—¶,åé¢çš„æ–¹æ³•ä¼šè¦†ç›–å‰é¢çš„æ–¹æ³•ï¼Œå¹¶ä¸”IDEä¸æŠ¥é”™</p>
<h2 id="åœºæ™¯ä¸ƒï¼šimage"><a href="#åœºæ™¯ä¸ƒï¼šimage" class="headerlink" title="åœºæ™¯ä¸ƒï¼šimage"></a>åœºæ™¯ä¸ƒï¼šimage</h2><p>å°ç¨‹åºçš„imageä¸HTML5çš„imgæœ€å¤§çš„åŒºåˆ«åœ¨äºï¼š<br>å°ç¨‹åºçš„imageæ˜¯æŒ‰ç…§<code>background-image</code>æ¥å®ç°çš„ã€‚<br>é»˜è®¤imageçš„é«˜å®½æ˜¯320*240ã€‚å¿…é¡»é€šè¿‡æ ·å¼å®šä¹‰å»è¦†ç›–è¿™ä¸ªé»˜è®¤é«˜å®½ï¼Œautoåœ¨è¿™é‡Œä¸ç”Ÿæ•ˆã€‚</p>
<font face="STCAIYUN" color="red" size="3">å¼€å‘è€…è¯´è¿™æ ·è®¾ç½®çš„åŸå› æ˜¯ï¼šå¦‚æœè®¾ç½® auto ï¼Œé¡µé¢å¸ƒå±€ä¼šå› ä¸ºå›¾ç‰‡åŠ è½½çš„è¿‡ç¨‹æœ‰ä¸€ä¸ªé—ªçš„ç°è±¡ï¼ˆä¾‹å¦‚é«˜åº¦ä» 0 åˆ° height ï¼‰ï¼Œæ‰€ä»¥è¦æ±‚ä¸€å®šè¦è®¾ç½®ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦ã€‚</font>

<p>å›¾ç‰‡åŒ…æ‹¬ä¸‰ç§ç¼©æ”¾æ¨¡å¼scaleToFillã€aspectFitã€aspectFillå’Œ9ç§è£å‰ªæ¨¡å¼ï¼Œä¸‰ç§ç¼©æ”¾æ¨¡å¼çš„å®ç°åŸç†å¯¹åº”å¦‚ä¸‹ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">scaleToFill&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">background</span>-<span class="built_in">size</span>:<span class="number">100</span>% <span class="number">100</span>%;<span class="comment">//ä¸ä¿æŒçºµæ¨ªæ¯”ç¼©æ”¾å›¾ç‰‡ï¼Œä½¿å›¾ç‰‡çš„å®½é«˜å®Œå…¨æ‹‰ä¼¸è‡³å¡«æ»¡ image å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aspectFit&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">background</span>-<span class="built_in">size</span>:contain;<span class="comment">//ä¿æŒçºµæ¨ªæ¯”ç¼©æ”¾å›¾ç‰‡ï¼Œä½¿å›¾ç‰‡çš„é•¿è¾¹èƒ½å®Œå…¨æ˜¾ç¤ºå‡ºæ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥å®Œæ•´åœ°å°†å›¾ç‰‡æ˜¾ç¤ºå‡ºæ¥ã€‚</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aspectFill&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">background</span>-<span class="built_in">size</span>:cover;<span class="comment">//ä¿æŒçºµæ¨ªæ¯”ç¼©æ”¾å›¾ç‰‡ï¼Œåªä¿è¯å›¾ç‰‡çš„çŸ­è¾¹èƒ½å®Œå…¨æ˜¾ç¤ºå‡ºæ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå›¾ç‰‡é€šå¸¸åªåœ¨æ°´å¹³æˆ–å‚ç›´æ–¹å‘æ˜¯å®Œæ•´çš„ï¼Œå¦ä¸€ä¸ªæ–¹å‘å°†ä¼šå‘ç”Ÿæˆªå–ã€‚</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åœºæ™¯å…«ï¼šnavigator"><a href="#åœºæ™¯å…«ï¼šnavigator" class="headerlink" title="åœºæ™¯å…«ï¼šnavigator"></a>åœºæ™¯å…«ï¼šnavigator</h2><p>navigatoræ”¯æŒç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„çš„è·³è½¬ï¼Œé»˜è®¤æ˜¯æ‰“å¼€æ–°é¡µé¢ï¼Œå½“å‰é¡µé¢æ‰“å¼€éœ€è¦åŠ redirectï¼›<br>navigatorä»…æ”¯æŒ<font face="STCAIYUN" color="red" size="3">5çº§</font>é¡µé¢çš„è·³è½¬ï¼›<br>navigatorä¸å¯è·³è½¬åˆ°å°ç¨‹åºå¤–çš„é“¾æ¥åœ°å€ï¼›</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">class</span>=<span class="string">"navigator"</span> <span class="attr">redirect</span>  <span class="attr">url</span>=<span class="string">"../login/index"</span> &gt;</span>ç™»å½•é¡µ<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨å°ç¨‹åºå¼€å‘å·¥å…·é‡Œï¼Œé»˜è®¤æ‰“å¼€æ–°é¡µé¢ï¼Œå·¥å…·å·¦ä¸Šè§’æœ‰è¿”å›æŒ‰é’®ã€‚åŠ ä¸Šredirectï¼Œå½“å‰é¡µæ‰“å¼€ï¼Œä¸å‡ºç°è¿”å›æŒ‰é’®ã€‚</p>
<h2 id="åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€"><a href="#åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€" class="headerlink" title="åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€"></a>åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€</h2><p>åœ¨åšä¼ ç»ŸH5çš„æ—¶å€™ï¼Œä¸ºäº†å…¼å®¹å„ç§ä½ç«¯è®¾å¤‡çš„æœºå‹ï¼Œé€šå¸¸ä¸å¤ªæ•¢è½»æ˜“å°è¯•flexï¼Œä½†åœ¨å°ç¨‹åºé‡Œå°±å¯ä»¥å¤§èƒ†çš„ä½¿ç”¨äº†ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.media</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">display</span>: flex;</span><br><span class="line"></span><br><span class="line"><span class="attribute">justify-content</span>:center;</span><br><span class="line"><span class="attribute">align-items</span>:center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.media</span> <span class="selector-class">.content</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€-1"><a href="#åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€-1" class="headerlink" title="åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€"></a>åœºæ™¯å…«ï¼šå¤§èƒ†ä½¿ç”¨flexå¸ƒå±€</h2><p>åœ¨åšä¼ ç»ŸH5çš„æ—¶å€™ï¼Œä¸ºäº†å…¼å®¹å„ç§ä½ç«¯è®¾å¤‡çš„æœºå‹ï¼Œé€šå¸¸ä¸å¤ªæ•¢è½»æ˜“å°è¯•flexï¼Œä½†åœ¨å°ç¨‹åºé‡Œå°±å¯ä»¥å¤§èƒ†çš„ä½¿ç”¨äº†ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.media</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">display</span>: flex;</span><br><span class="line"></span><br><span class="line"><span class="attribute">justify-content</span>:center;</span><br><span class="line"><span class="attribute">align-items</span>:center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.media</span> <span class="selector-class">.content</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åœºæ™¯å…«ï¼šé¡µé¢æœ€åä¸€ä¸ª-view-ç»„ä»¶-è®¾ç½®margin-bottomå±æ€§-IOS-æœºå‹-å¤±æ•ˆçš„é—®é¢˜"><a href="#åœºæ™¯å…«ï¼šé¡µé¢æœ€åä¸€ä¸ª-view-ç»„ä»¶-è®¾ç½®margin-bottomå±æ€§-IOS-æœºå‹-å¤±æ•ˆçš„é—®é¢˜" class="headerlink" title="åœºæ™¯å…«ï¼šé¡µé¢æœ€åä¸€ä¸ª view ç»„ä»¶ è®¾ç½®margin-bottomå±æ€§ IOS æœºå‹ å¤±æ•ˆçš„é—®é¢˜"></a>åœºæ™¯å…«ï¼šé¡µé¢æœ€åä¸€ä¸ª view ç»„ä»¶ è®¾ç½®margin-bottomå±æ€§ IOS æœºå‹ å¤±æ•ˆçš„é—®é¢˜</h2><p>è§£å†³æ–¹å¼ï¼š<font face="STCAIYUN" color="red" size="3">å½“å‰view å½“å‰ç»„ä»¶ä¸‹åŠ ä¸€ä¸ªåŒçº§view<br></font></p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">wxml</span><br><span class="line">    &lt;<span class="built_in">view</span>&gt;è¿™æ˜¯ä¸ªæŒ‰é’®&lt;/<span class="built_in">view</span>&gt;</span><br><span class="line">    &lt;<span class="built_in">view</span> class=<span class="string">"marginB"</span>&gt;&lt;/<span class="built_in">view</span>&gt;</span><br><span class="line"></span><br><span class="line">    css</span><br><span class="line"></span><br><span class="line">    .marginB&#123;</span><br><span class="line">        	<span class="built_in">height</span>: <span class="number">0rpx</span>;</span><br><span class="line">        	<span class="built_in">font</span>-size: <span class="number">0rpx</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h2 id="åœºæ™¯ä¹ï¼šå®ç°é•¿æŒ‰ä¿å­˜å›¾ç‰‡-çŸ­æŒ‰å›¾ç‰‡éšè—"><a href="#åœºæ™¯ä¹ï¼šå®ç°é•¿æŒ‰ä¿å­˜å›¾ç‰‡-çŸ­æŒ‰å›¾ç‰‡éšè—" class="headerlink" title="åœºæ™¯ä¹ï¼šå®ç°é•¿æŒ‰ä¿å­˜å›¾ç‰‡ çŸ­æŒ‰å›¾ç‰‡éšè—"></a>åœºæ™¯ä¹ï¼šå®ç°é•¿æŒ‰ä¿å­˜å›¾ç‰‡ çŸ­æŒ‰å›¾ç‰‡éšè—</h2><p>ç°æœ‰é—®é¢˜  ç”¨æˆ·ä½“éªŒä¸ä½³ é•¿æŒ‰éœ€è¦æŠ¬èµ·æ‰èƒ½å¼¹å‡º <code>sheetAction</code>èœå•</p>
<p>ç†æƒ³çŠ¶æ€ä¸‹æ˜¯é•¿æŒ‰å¼€å§‹è®¡æ—¶ 350ç§’ä¹‹åè‡ªåŠ¨å¼¹æ“ä½œèœå•</p>
<p>åˆ©ç”¨ <code>bindtouchstart</code> ä¸ <code>bindtouchend</code>äº‹ä»¶ç»“åˆ <code>bindtap</code>å®ç°</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">é—®é¢˜ä»£ç ä¸€</span><br><span class="line"></span><br><span class="line">WXML</span><br><span class="line"></span><br><span class="line">&lt;view  bindtouchstart=<span class="string">"mytouchstart"</span> bindtouchend=<span class="string">"mytouchend"</span> bindtap=<span class="string">"editAddress"</span> &gt;</span><br><span class="line"></span><br><span class="line">JS</span><br><span class="line"></span><br><span class="line">editAddress: <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;  </span><br><span class="line">   <span class="keyword">let</span> that = <span class="keyword">this</span>;  </span><br><span class="line">   <span class="comment">//è§¦æ‘¸æ—¶é—´è·ç¦»é¡µé¢æ‰“å¼€çš„æ¯«ç§’æ•°  </span></span><br><span class="line">   <span class="keyword">var</span> touchTime = that.data.touch_end - that.data.touch_start;  </span><br><span class="line">   <span class="built_in">console</span>.log(touchTime);  </span><br><span class="line">   <span class="comment">//å¦‚æœæŒ‰ä¸‹æ—¶é—´å¤§äº350ä¸ºé•¿æŒ‰  </span></span><br><span class="line">   <span class="keyword">if</span> (touchTime &gt; <span class="number">350</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO..</span></span><br><span class="line"></span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">//TODO..</span></span><br><span class="line"></span><br><span class="line">   &#125;  </span><br><span class="line"> &#125;,  </span><br><span class="line"> <span class="comment">//æŒ‰ä¸‹äº‹ä»¶å¼€å§‹  </span></span><br><span class="line"> mytouchstart: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;  </span><br><span class="line">   <span class="keyword">let</span> that = <span class="keyword">this</span>;  </span><br><span class="line">   that.setData(&#123;  </span><br><span class="line">     touch_start: e.timeStamp  </span><br><span class="line">   &#125;)  </span><br><span class="line">   <span class="built_in">console</span>.log(e.timeStamp + <span class="string">'- touch-start'</span>)  </span><br><span class="line"> &#125;,  </span><br><span class="line"> <span class="comment">//æŒ‰ä¸‹äº‹ä»¶ç»“æŸ  </span></span><br><span class="line"> mytouchend: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;  </span><br><span class="line">   <span class="keyword">let</span> that = <span class="keyword">this</span>;  </span><br><span class="line">   that.setData(&#123;  </span><br><span class="line">     touch_end: e.timeStamp  </span><br><span class="line">   &#125;)  </span><br><span class="line">   <span class="built_in">console</span>.log(e.timeStamp + <span class="string">'- touch-end'</span>)  </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>æ”¹è¿›</p>
<p>å°ç¨‹åºçš„äº‹ä»¶è§¦å‘é¡ºåº</p>
<p>å•å‡» touchstart â†’ touchend â†’ tap<br>åŒå‡» touchstart â†’ touchend â†’ tap â†’ touchstart â†’ touchend â†’ tap<br>é•¿æŒ‰ touchstart â†’ longtap â†’ touchend â†’ tap</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">é—®é¢˜ä»£ç äºŒ</span><br><span class="line"></span><br><span class="line">wxml</span><br><span class="line"></span><br><span class="line">&lt;view  bindlongtap=<span class="string">"longPress"</span>   bindtap=<span class="string">"tapFun"</span> style=<span class="string">"width: 100%;height:100%"</span> mode=<span class="string">"scaleToFill"</span> src=<span class="string">"&#123;&#123;img_url&#125;&#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">js</span><br><span class="line"></span><br><span class="line">longPress(e)&#123;</span><br><span class="line">  <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'ä½ ç‚¹å‡»äº†é•¿æŒ‰æ—¶é—´'</span>,e)</span><br><span class="line">  <span class="comment">// å¯ä»¥é€šè¿‡ wx.getSetting å…ˆæŸ¥è¯¢ä¸€ä¸‹ç”¨æˆ·æ˜¯å¦æˆæƒäº† "scope.record" è¿™ä¸ª scope</span></span><br><span class="line">  wx.getSetting(&#123;</span><br><span class="line">      success(res) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'222222222222222222'</span>)</span><br><span class="line">          <span class="keyword">if</span> (!res[<span class="string">'scope.writePhotosAlbum'</span>]) &#123;</span><br><span class="line">              wx.authorize(&#123;</span><br><span class="line">                  scope: <span class="string">'scope.writePhotosAlbum'</span>,</span><br><span class="line">                  success() &#123;</span><br><span class="line">                   <span class="comment">//  è°ƒèµ·æ“ä½œèœå•</span></span><br><span class="line">                   <span class="built_in">console</span>.log(<span class="string">'33333333333333333333'</span>)</span><br><span class="line">                   <span class="built_in">console</span>.log(<span class="string">'wx.showActionSheet()'</span>,wx.showActionSheet)</span><br><span class="line">                    wx.showActionSheet(&#123;</span><br><span class="line">                         itemList: [<span class="string">'ä¿å­˜åˆ°æœ¬åœ°'</span>],</span><br><span class="line">                         success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                           <span class="built_in">console</span>.log(<span class="string">'æ“ä½œèœå•å¼¹å‡ºæˆåŠŸ'</span>,<span class="string">'ç¬¬'</span>+res.tapIndex+<span class="string">'ä¸ªæ“ä½œèœå•å¼¹å‡ºæˆåŠŸ'</span>)</span><br><span class="line">                           <span class="comment">// ä¸‹è½½æ–‡ä»¶èµ„æºåˆ°æœ¬åœ°ã€‚å®¢æˆ·ç«¯ç›´æ¥å‘èµ·ä¸€ä¸ª HTTP GET è¯·æ±‚ï¼Œè¿”å›æ–‡ä»¶çš„æœ¬åœ°ä¸´æ—¶è·¯å¾„ã€‚</span></span><br><span class="line">                         <span class="keyword">if</span>(res.tapIndex ==<span class="number">0</span>)&#123;</span><br><span class="line">                          <span class="built_in">console</span>.log(<span class="string">'wx.downloadFile'</span>,wx.downloadFile)</span><br><span class="line">                           wx.downloadFile(&#123;</span><br><span class="line">                           url: that.data.img_url, <span class="comment">//ä»…ä¸ºç¤ºä¾‹ï¼Œå¹¶éçœŸå®çš„èµ„æº</span></span><br><span class="line">                           success: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                             wx.playVoice(&#123;</span><br><span class="line">                               filePath: res.tempFilePath</span><br><span class="line">                             &#125;);</span><br><span class="line">                             <span class="built_in">console</span>.log(<span class="string">'wx.playVoice()'</span>,wx.playVoice)</span><br><span class="line">                             <span class="built_in">console</span>.log(<span class="string">'å°†å›¾ç‰‡å…ˆä¿å­˜åˆ°æœ¬åœ°--res.tempFilePath'</span>,res.tempFilePath);</span><br><span class="line">                                     <span class="comment">// ç”¨æˆ·å·²ç»åŒæ„å°ç¨‹åºä½¿ç”¨åŠŸèƒ½ï¼Œåç»­è°ƒç”¨ wx.startRecord æ¥å£ä¸ä¼šå¼¹çª—è¯¢é—®</span></span><br><span class="line">                                     <span class="built_in">console</span>.log(<span class="string">'wx.saveImageToPhotosAlbum()'</span>,wx.saveImageToPhotosAlbum)</span><br><span class="line">                                     wx.saveImageToPhotosAlbum(&#123;</span><br><span class="line">                                       filePath:res.tempFilePath,</span><br><span class="line">                                       success(res) &#123;</span><br><span class="line">                                         wx.showToast(&#123;</span><br><span class="line">                                         title: <span class="string">'ä¿å­˜æˆåŠŸ'</span>,</span><br><span class="line">                                         icon: <span class="string">'success'</span></span><br><span class="line">                                       &#125;);</span><br><span class="line">                                       setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                                         wx.hideToast();</span><br><span class="line">                                       &#125;,<span class="number">3000</span>)</span><br><span class="line">                                       &#125;,</span><br><span class="line">                                       fail(res)&#123;</span><br><span class="line">                                         wx.showToast(&#123;</span><br><span class="line">                                         title: <span class="string">'ä¿å­˜å¤±è´¥'</span>,</span><br><span class="line">                                         icon: <span class="string">'success'</span></span><br><span class="line">                                       &#125;);</span><br><span class="line">                                       setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                                         wx.hideToast();</span><br><span class="line">                                       &#125;,<span class="number">3000</span>)</span><br><span class="line">                                       &#125;</span><br><span class="line">                                   &#125;)</span><br><span class="line"></span><br><span class="line">                           &#125;</span><br><span class="line">                         &#125;)</span><br><span class="line">                         &#125;</span><br><span class="line">                         &#125;,</span><br><span class="line">                         fail: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                           <span class="built_in">console</span>.log(<span class="string">'æ“ä½œèœå•å¼¹å‡ºå¤±è´¥'</span>,res.tapIndex)</span><br><span class="line">                         &#125;</span><br><span class="line">               &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tapFun: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">        that.setData(&#123;</span><br><span class="line">        qrShow:<span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¾ˆæ˜¾ç„¶ è¿™ä¹Ÿæ˜¯æœ‰é—®é¢˜çš„</span><br><span class="line"></span><br><span class="line">å› ä¸ºäº‹ä»¶æœºåˆ¶ã€‚æ€»ä¼šè§¦å‘ tapäº‹ä»¶ è¡¨ç°å½¢å¼æ¯” é—®é¢˜ä¸€è¿˜éš¾ä»¥æ¥å—</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œç»“åˆå‰ä¸¤ç§ è§£å†³åŠæ³•å¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">WXml</span><br><span class="line"></span><br><span class="line"> &lt;image  wx:<span class="keyword">if</span>=<span class="string">"&#123;&#123;img_url !=''&#125;&#125;"</span>  bindlongtap=<span class="string">"editAddress1"</span>   bindtouchstart=<span class="string">"mytouchstart"</span> bindtouchend=<span class="string">"mytouchend"</span>  style=<span class="string">"width: 100%;height:100%"</span> mode=<span class="string">"scaleToFill"</span> src=<span class="string">"&#123;&#123;img_url&#125;&#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">js</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‰ä¸‹äº‹ä»¶å¼€å§‹</span></span><br><span class="line">mytouchstart:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">  that.setData(&#123;</span><br><span class="line">    touch_start: e.timeStamp</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">console</span>.log(e.timeStamp + <span class="string">'- touch-start'</span>)</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‰ä¸‹äº‹ä»¶ç»“æŸ</span></span><br><span class="line">mytouchend:<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">  that.setData(&#123;</span><br><span class="line">    touch_end: e.timeStamp</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">console</span>.log(e.timeStamp + <span class="string">'- touch-end'</span>)</span><br><span class="line">  that.editAddress(e);</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­æ˜¯é•¿æŒ‰æ“ä½œè¿˜æ˜¯çŸ­æŒ‰æ“ä½œ</span></span><br><span class="line">editAddress: <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> that = <span class="keyword">this</span>;</span><br><span class="line">      <span class="keyword">if</span>(that.data.touch_end - that.data.touch_start &lt; <span class="number">350</span>)&#123;</span><br><span class="line">        that.setData(&#123;</span><br><span class="line">        qrShow:<span class="literal">false</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">editAddress1(e)&#123;&#125;   <span class="comment">// åŒé—®é¢˜äºŒ  longPressï¼ˆï¼‰</span></span><br></pre></td></tr></table></figure>
<h2 id="åœºæ™¯åï¼šç¬¬äºŒæ¬¡æ‰«ç è¿›å…¥å°ç¨‹åºçš„ç¼“å­˜é—®é¢˜"><a href="#åœºæ™¯åï¼šç¬¬äºŒæ¬¡æ‰«ç è¿›å…¥å°ç¨‹åºçš„ç¼“å­˜é—®é¢˜" class="headerlink" title="åœºæ™¯åï¼šç¬¬äºŒæ¬¡æ‰«ç è¿›å…¥å°ç¨‹åºçš„ç¼“å­˜é—®é¢˜"></a>åœºæ™¯åï¼šç¬¬äºŒæ¬¡æ‰«ç è¿›å…¥å°ç¨‹åºçš„ç¼“å­˜é—®é¢˜</h2>]]></content>
      <tags>
        <tag>issue</tag>
        <tag>wechat</tag>
      </tags>
  </entry>
  <entry>
    <title>å½»åº•ç†è§£jsæ˜¯å¦‚ä½•å·¥ä½œçš„</title>
    <url>/2018/11/17/%E5%BD%BB%E5%BA%95%E7%90%86%E8%A7%A3js%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84/</url>
    <content><![CDATA[<p>æ›¾ç» ä½ ä¸€å®šé‡åˆ°è¿‡ç±»ä¼¼è¿™æ ·å„¿çš„é¢˜ç›®</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">console.<span class="built_in">log</span>(<span class="string">'script start'</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'timer over'</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">Promise.resolve().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'promise1'</span>)</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'promise2'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">'script end'</span>)</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">script start</span><br><span class="line">script <span class="keyword">end</span></span><br><span class="line">promise1</span><br><span class="line">promise2</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ å¾ˆè½»æ¾çš„ç­”å¯¹å¹¶ä¸”èƒ½è¯´å‡ºåŸç† é‚£ä¹ˆæ­å–œä½ ï¼Œå€˜è‹¥æœ‰äº›ç–‘é—®ï¼Œé‚£ä¹ˆè¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œä½ ä¸€å®šä¼šå½»åº•ææ‡‚å®ƒçš„è¿è¡ŒåŸç†ã€‚</p>
<a id="more"></a>
<h3 id="é¦–å…ˆ-å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µ"><a href="#é¦–å…ˆ-å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µ" class="headerlink" title="é¦–å…ˆ  å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µ"></a>é¦–å…ˆ  å…ˆäº†è§£å‡ ä¸ªæ¦‚å¿µ</h3><blockquote>
<p>JavaScriptå¼•æ“</p>
</blockquote>
<p>jså¼•æ“æ˜¯æ‰§è¡Œjsçš„ç¨‹åºæˆ–è€…è§£é‡Šå™¨ æˆ‘ä»¬å¸¸è¯´çš„V8å¼•æ“å°±æ˜¯ä¸€ç§jså¼•æ“çš„å®ç°ï¼Œå…¶ä»–çš„è¿˜æœ‰åŸºäº<code>java</code>å¼€å‘çš„<code>Rhin</code> <code>Nashorn</code>ç­‰</p>
<p>V8å¼•æ“ ä½¿ç”¨åœ¨chrome å’Œnodeä¸­ï¼Œå®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆ</p>
<ul>
<li>å†…å­˜å † ï¼šè¿™æ˜¯å†…å­˜åˆ†é…å‘ç”Ÿçš„åœ°æ–¹</li>
<li>è°ƒç”¨æ ˆï¼š è¿™æ˜¯ä½ çš„ä»£ç æ‰§è¡Œæ—¶çš„åœ°æ–¹</li>
</ul>
<hr>
<blockquote>
<p>JSçš„ç‰¹æ€§</p>
</blockquote>
<font color="red">å•çº¿ç¨‹ å¼‚æ­¥ éé˜»å¡</font>

<p><strong>jsçš„å•çº¿ç¨‹</strong><br>ç”±äºjsçš„å•çº¿ç¨‹</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">console.<span class="built_in">log</span>('script start')</span><br><span class="line">console.<span class="built_in">log</span>('do something...')</span><br><span class="line">console.<span class="built_in">log</span>('script end')</span><br><span class="line"></span><br><span class="line"><span class="comment">// script start</span></span><br><span class="line"><span class="comment">// do something...</span></span><br><span class="line"><span class="comment">// script end</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆå¥½ç†è§£</p>
<p>é‚£å†æ¥çœ‹</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'3'</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> ç‚¹å‡»é¡µé¢</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'4'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'5'</span>)</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå®ƒçš„è¾“å‡ºæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ åº”è¯¥æ˜¯<code>1ï¼Œ2ï¼Œ4ï¼Œ5ï¼Œ3</code>ï¼Ÿ è€Œä¸æ˜¯<code>1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5</code>ï¼Œjsä¸æ˜¯ä¸€è¡Œä¸€è¡Œä»ä¸Šåˆ°ä¸‹æ‰§è¡Œçš„å— ä¸ºå•¥ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿ</p>
<p><strong>è¿™å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è¯´çš„é—®é¢˜</strong></p>
<p>ä¸ºä»€ä¹ˆä¸èƒ½åŒæ­¥æ‰§è¡Œï¼Ÿ</p>
<p>å¦‚æœä¸€ä¸ªä»»åŠ¡çš„å¤„ç†è€—æ—¶ï¼ˆæˆ–è€…æ˜¯ç­‰å¾…ï¼‰å¾ˆä¹…çš„è¯ï¼Œå¦‚ï¼šç½‘ç»œè¯·æ±‚ã€å®šæ—¶å™¨ã€ç­‰å¾…é¼ æ ‡ç‚¹å‡»ç­‰ï¼Œåé¢çš„ä»»åŠ¡ä¹Ÿå°±ä¼šè¢«é˜»å¡,å¯èƒ½ä¼šå‡ºç°ç™½å±çš„æƒ…å†µ ç”¨æˆ·ä½“éªŒæå…¶ä¸å‹å¥½</p>
<p>æ‰€å¹¸çš„æ˜¯ æµè§ˆå™¨ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„<code>webapi</code></p>
<p>å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</p>
<p>jsçš„å•çº¿ç¨‹æŒ‡çš„æ˜¯æµè§ˆå™¨ä¸­è´Ÿè´£è§£é‡Šå’Œæ‰§è¡Œjsä»£ç çš„åªæœ‰ä¸€ä¸ªçº¿ç¨‹ -jså¼•æ“çº¿ç¨‹ ä½†æ˜¯æµè§ˆå™¨çš„æ¸²æŸ“è¿›ç¨‹æ˜¯æä¾›å¤šä¸ªçº¿ç¨‹çš„ï¼Œé‡åˆ°å®šæ—¶å™¨ Domäº‹ä»¶æˆ–è€…æ˜¯ç½‘ç»œè¯·æ±‚çš„ä»»åŠ¡çš„æ—¶å€™ jså¼•æ“ä¼šå°†ä»–ä»¬äº¤ç»™webapi ä¹Ÿå°±æ˜¯æµè§ˆå™¨æä¾›çš„ç›¸åº”çº¿ç¨‹å»å¤„ç† è€Œjså¼•æ“çº¿ç¨‹ç»§ç»­å»å¤„ç†åé¢çš„ä»»åŠ¡ è¿™æ ·å„¿å®ç°äº†<strong>å¼‚æ­¥éé˜»å¡</strong><br>ä»¥ä¸‹æ˜¯æ—¥å¸¸çº¿ç¨‹ï¼š</p>
<ul>
<li>jså¼•æ“çº¿ç¨‹</li>
<li>äº‹ä»¶è§¦å‘çº¿ç¨‹</li>
<li>å®šæ—¶å™¨è§¦å‘çº¿ç¨‹</li>
<li>å¼‚æ­¥HTTPè¯·æ±‚çº¿ç¨‹</li>
<li>GUIæ¸²æŸ“çº¿ç¨‹</li>
</ul>
<p>å›¾ç¤ºçš„è¯ å¤§æ¦‚é•¿ä¸‹é¢è¿™æ ·å„¿<br><img src="/images/jsWorker/jsworker.jpg" alt="jsworke"><br>æ‰€ä»¥ è¿™é‡Œçš„ å›¾ä¾‹ä¸­çš„<code>setTimeout</code>ä¼šè¢«åˆ†é…åˆ°å®šæ—¶å™¨è§¦å‘çº¿ç¨‹å»ç»´æŠ¤ å»å®šæ—¶ï¼Œæ—¶é—´ä¸€åˆ° è¿˜æ˜¯ä¼šæŠŠå®ƒçš„å›è°ƒå¡åˆ°<code>æ¶ˆæ¯é˜Ÿåˆ—</code>ç­‰å¾…</p>
<p>é‚£ä¹ˆ åˆ°è¿™é‡Œ åˆå¼•å‡ºäº†ä¸¤ä¸ªé—®é¢˜<br>1.ä»€ä¹ˆå«æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ<br>2.jså¼•æ“ä»€ä¹ˆæ—¶å€™å¤„ç†è¿™ä¸ªå®šæ—¶å™¨ æ€ä¹ˆå¤„ç†ï¼Ÿ</p>
<p>JavaScript é€šè¿‡äº‹ä»¶å¾ªç¯ï¼ˆ event loopï¼‰çš„æœºåˆ¶æ¥è§£å†³è¿™äº›é—®é¢˜<br>çŒœå¯¹äº†å—ï¼Ÿ<br>äº‹ä»¶å¾ªç¯ æœºåˆ¶å’Œ æ¶ˆæ¯é˜Ÿåˆ— çš„ç»´æŠ¤æ˜¯ç”±<strong>äº‹ä»¶è§¦å‘çº¿ç¨‹</strong>ï¼ˆæµè§ˆå™¨æ¸²æŸ“å¼•æ“webapiä¹‹ä¸€ï¼‰æ§åˆ¶çš„</p>
<p>JSå¼•æ“çº¿ç¨‹ ä¼šç»´æŠ¤ä¸€ä¸ª æ‰§è¡Œæ ˆ</p>
<ol>
<li>åŒæ­¥å’Œå¼‚æ­¥ä»»åŠ¡è¿›å…¥ä¸åŒçš„æ‰§è¡Œåœºæ‰€ åŒæ­¥çš„è¿›å…¥<strong>ä¸»çº¿ç¨‹</strong> å¼‚æ­¥çš„è¿›å…¥Event Tableå¹¶æ³¨å†Œå‡½æ•°</li>
<li>å½“æŒ‡å®šçš„äº‹æƒ…å®Œæˆæ—¶ Event Tableä¼šå°†è¿™ä¸ªå‡½æ•°ç§»å…¥<strong>Event Queue</strong></li>
<li>ä¸»çº¿ç¨‹å†…çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¸ºç©ºï¼Œä¼šå»<strong>Event Queue</strong>è¯»å–å¯¹åº”çš„å‡½æ•°ï¼Œè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œ</li>
<li>ä¸Šè¿°è¿‡ç¨‹ä¼šä¸æ–­é‡å¤ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„<strong>Event Loop</strong>(äº‹ä»¶å¾ªç¯)ã€‚</li>
</ol>
<p>è¨€è¯­å¤ªè¿‡è‹ç™½ ä¸¾ä¸ªğŸŒ°ï½</p>
<p><img src="/images/jsWorker/jswork2.jpg" alt="jswork2"></p>
<p>æ‰€ä»¥ è¿™ä¸ªæ—¶å€™æ¥çœ‹<br>setTimeoutå¼‚æ­¥å‡½æ•°å¯¹åº”çš„å›è°ƒå‡½æ•°( () =&gt; {} )ä¼šåœ¨æ‰§è¡Œæ ˆä¸ºç©ºï¼Œä¸»ä»£ç å—æ‰§è¡Œå®Œäº†åæ‰ä¼šæ‰§è¡Œ</p>
<p>ç»“æœå°±ä¸æ„å¤–äº†å§</p>
<p>é‚£ä¹ˆ åƒè¿™æ ·</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'timer'</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>0å»¶æ—¶çš„æƒ…å†µæ˜¯å•¥æ„æ€å‘¢<br>åªæ˜¯ timerçš„å›è°ƒå‡½æ•°ä¼šç«‹å³åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—è€Œå·²ï¼Œå›è°ƒçš„æ‰§è¡Œè¿˜æ˜¯å¾—ç­‰æ‰§è¡Œæ ˆä¸ºç©ºï¼ˆJSå¼•æ“çº¿ç¨‹ç©ºé—²ï¼‰æ—¶æ‰§è¡Œã€‚</p>
<p>è¿˜æ²¡å®Œï½ï½</p>
<p>ES5ä¸­ä»¥ä¸Šæ ‡å‡†å°±å¤Ÿç”¨äº† ä½†æ˜¯ES6ä¸­æ–°å‡ºäº†ä¸€äº›API å¼•å‡ºäº†ä¸€äº›æ–°æ¦‚å¿µ</p>
<blockquote>
<p>å®ä»»åŠ¡ä¸å¾®ä»»åŠ¡</p>
</blockquote>
<p>å…ˆæ¥çœ‹ä¸€æ®µä»£ç  ä½ èƒ½ç«‹åˆ»è¯´å‡ºå®ƒçš„æ‰§è¡Œç»“æœå—</p>
<figure class="highlight scilab"><table><tr><td class="code"><pre><span class="line">console.<span class="built_in">log</span>(<span class="string">'script start'</span>)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'timer over'</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">Promise.resolve().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'promise1'</span>)</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'promise2'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">'script end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// script start</span></span><br><span class="line"><span class="comment">// script end</span></span><br><span class="line"><span class="comment">// promise1</span></span><br><span class="line"><span class="comment">// promise2</span></span><br><span class="line"><span class="comment">// timer over</span></span><br></pre></td></tr></table></figure>
<p>Whatï¼Ÿ timer over ä¼šåœ¨ promise1 promise2 ä¹‹åæ‰§è¡Œï¼Ÿ</p>
<p>å¥½çš„ ä¸è¦ç€æ€¥ å¾€ä¸‹çœ‹ğŸ‘‡<br>æ‰€æœ‰ä»»åŠ¡åˆ†ä¸º <code>å®ä»»åŠ¡</code> å’Œ <code>å¾®ä»»åŠ¡</code></p>
<ul>
<li>å®ä»»åŠ¡ï¼ˆmacrotaskï¼‰ï¼šä¸»ä»£ç å—ã€setTimeoutã€setIntervalç­‰ï¼ˆå¯ä»¥çœ‹åˆ°ï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸­çš„æ¯ä¸€ä¸ªäº‹ä»¶éƒ½æ˜¯ä¸€ä¸ª macrotaskï¼Œç°åœ¨ç§°ä¹‹ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—</li>
<li>å¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰ï¼šPromiseã€process.nextTickç­‰ åœ¨microtaskä¸­ process.nextTick ä¼˜å…ˆçº§é«˜äº Promiseï¼Œå®ƒç”¨æ¥è°ƒåº¦åº”åœ¨å½“å‰æ‰§è¡Œçš„è„šæœ¬æ‰§è¡Œç»“æŸåç«‹å³æ‰§è¡Œçš„ä»»åŠ¡</li>
</ul>
<p>äº‹ä»¶ï¼ˆä»»åŠ¡ï¼‰é˜Ÿåˆ—å’Œå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„è”ç³»ï¼š</p>
<ul>
<li>ä¸€ä¸ªäº‹ä»¶å¾ªç¯æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼›</li>
<li>æ¯ä¸ªäº‹ä»¶å¾ªç¯éƒ½æœ‰ä¸€ä¸ªmicrotaské˜Ÿåˆ—</li>
<li>macrotaské˜Ÿåˆ—å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œmicrotaské˜Ÿåˆ—ä¸æ˜¯ä»»åŠ¡é˜Ÿåˆ—</li>
<li>ä¸€ä¸ªä»»åŠ¡å¯ä»¥è¢«æ”¾å…¥åˆ°macrotaské˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥æ”¾å…¥microtaské˜Ÿåˆ—</li>
<li>å½“ä¸€ä¸ªä»»åŠ¡è¢«æ”¾å…¥microtaskæˆ–è€…macrotaské˜Ÿåˆ—åï¼Œå‡†å¤‡å·¥ä½œå°±å·²ç»ç»“æŸï¼Œè¿™æ—¶å€™å¯ä»¥å¼€å§‹æ‰§è¡Œä»»åŠ¡äº†</li>
</ul>
<p>jsçš„æ‰§è¡Œè§„åˆ™ï¼š</p>
<ol>
<li>æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼ˆæ ˆä¸­æ²¡æœ‰å°±ä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–ï¼‰</li>
<li>æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¾®ä»»åŠ¡ï¼Œå°±å°†å®ƒæ·»åŠ åˆ°å¾®ä»»åŠ¡çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­</li>
<li>å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å¾®ä»»åŠ¡ï¼ˆä¾æ¬¡æ‰§è¡Œï¼‰</li>
<li>å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå¼€å§‹æ£€æŸ¥æ¸²æŸ“ï¼Œç„¶åGUIçº¿ç¨‹æ¥ç®¡æ¸²æŸ“</li>
<li>æ¸²æŸ“å®Œæ¯•åï¼ŒJSå¼•æ“çº¿ç¨‹ç»§ç»­ï¼Œå¼€å§‹ä¸‹ä¸€ä¸ªå®ä»»åŠ¡ï¼ˆä»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ï¼‰</li>
</ol>
<p>æ‰€ä»¥ promise1 ä¸ promise1å±äºå¾®ä»»åŠ¡ ä¼šåœ¨ç¬¬ä¸€ä¸ªå®ä»»åŠ¡ç»“æŸä¹‹åç«‹å³æ‰§è¡Œ è€ŒsetTimeoutå³ä½¿å»¶æ—¶ä¸º0 ä¹Ÿæ˜¯è¦ç­‰åˆ°ä¸‹ä¸ªäº‹ä»¶å¾ªç¯å»æ‰§è¡Œçš„ğŸ˜Š</p>
<p>å†ç®€å•ç‚¹çš„è¯ é‚£å°±</p>
<p>macro-taské˜Ÿåˆ—åŒ…å«ä»»åŠ¡: a1, a2 , a3<br>micro-taské˜Ÿåˆ—åŒ…å«ä»»åŠ¡: b1, b2 , b3</p>
<p>æ‰§è¡Œé¡ºåºä¸ºï¼Œé¦–å…ˆæ‰§è¡Œmarco-taské˜Ÿåˆ—å¼€å¤´çš„ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ a1 ä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œåœ¨æ‰§è¡Œmicro-taské˜Ÿåˆ—é‡Œçš„æ‰€æœ‰ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ä¾æ¬¡æ‰§è¡Œb1, b2 , b3ï¼Œæ‰§è¡Œå®Œåæ¸…ç©ºmicro-taskä¸­çš„ä»»åŠ¡ï¼Œæ¥ç€æ‰§è¡Œmarco-taskä¸­çš„ç¬¬äºŒä¸ªä»»åŠ¡ï¼Œä¾æ¬¡å¾ªç¯ã€‚</p>
<p>å†ç®€å•ç‚¹çš„è¯ é‚£å°±.. ä¸Šå›¾å§ğŸ˜„</p>
<p><img src="/images/jsWorker/jsworker3.jpg" alt="jsworke">s</p>
<p>å¥½çš„ ç†è§£çš„è¯ å†æ¥ä¸€ä¸ªæ —å­ ä½ å¯èƒ½ç»§ç»­æ‡µé€¼</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;console.<span class="built_in">log</span>(<span class="number">1</span>)&#125;,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">new Promise(<span class="function"><span class="keyword">function</span><span class="params">(resolve,reject)</span></span>&#123;</span><br><span class="line">   console.<span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line">   resolve();</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;console.<span class="built_in">log</span>(<span class="number">3</span>)</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;console.<span class="built_in">log</span>(<span class="number">4</span>)&#125;);</span><br><span class="line"></span><br><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;console.<span class="built_in">log</span>(<span class="number">5</span>)&#125;);</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="number">6</span>);</span><br><span class="line">è¾“å‡º <span class="number">2</span>ï¼Œ<span class="number">6</span>ï¼Œ<span class="number">5</span> ï¼Œ<span class="number">3</span>ï¼Œ<span class="number">4</span>ï¼Œ<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>å®šä¹‰promiseçš„æ„é€ éƒ¨åˆ†æ˜¯åŒæ­¥çš„<br>å¦‚ä¸‹<br>script(ä¸»ç¨‹åºä»£ç )â€”â€”&gt;process.nextTickâ€”â€”&gt;promiseâ€”â€”&gt;setTimeout</p>
<p>å…³äº process.nextTick()<br>æ’å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—å°¾éƒ¨ï¼Œä½†åœ¨ä¸‹æ¬¡äº‹ä»¶é˜Ÿåˆ—ä¹‹å‰ä¼šæ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæŒ‡å®šçš„ä»»åŠ¡æ€»æ˜¯å‘ç”Ÿåœ¨æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡ä¹‹å‰ï¼Œå½“å‰ä¸»çº¿ç¨‹çš„æœ«å°¾ã€‚<br>å¤§è‡´æµç¨‹ï¼šå½“å‰â€æ‰§è¡Œæ ˆâ€çš„å°¾éƒ¨â€“&gt;ä¸‹ä¸€æ¬¡Event Loopï¼ˆä¸»çº¿ç¨‹è¯»å–â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼‰ä¹‹å‰â€“&gt;è§¦å‘processæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚<br>æœåŠ¡å™¨ç«¯nodeæä¾›çš„åŠæ³•ã€‚ç”¨æ­¤æ–¹æ³•å¯ä»¥ç”¨äºå¤„äºå¼‚æ­¥å»¶è¿Ÿçš„é—®é¢˜ã€‚<br>å¯ä»¥ç†è§£ä¸ºï¼šæ­¤æ¬¡ä¸è¡Œï¼Œé¢„çº¦ä¸‹æ¬¡ä¼˜å…ˆæ‰§è¡Œã€‚</p>
<p>å¥½çš„ å†å†æ¥ä¸€ä¸ªğŸ˜‚</p>
<figure class="highlight scilab"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(1)</span>&#125;,0); ï¼ˆ<span class="title">setTimeout1</span>ï¼‰</span></span><br><span class="line"></span><br><span class="line">new Promise(<span class="function"><span class="keyword">function</span><span class="params">(resolve,reject)</span>&#123;</span></span><br><span class="line">   console.<span class="built_in">log</span>(<span class="number">2</span>);  ï¼ˆpromise1ï¼‰</span><br><span class="line">   setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">resolve</span><span class="params">()</span>&#125;,0) ï¼ˆ<span class="title">setTimeout2</span>ï¼‰</span></span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(3)</span>  ï¼ˆ<span class="title">then1</span>ï¼‰</span></span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(4)</span>&#125;); ï¼ˆ<span class="title">then2</span>ï¼‰</span></span><br><span class="line"></span><br><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span><span class="params">()</span>&#123;<span class="title">console</span>.<span class="title">log</span><span class="params">(5)</span>&#125;); ï¼ˆ<span class="title">nextTick</span>ï¼‰</span></span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="number">6</span>); ï¼ˆ<span class="built_in">log</span>ï¼‰</span><br><span class="line">è¾“å‡ºï¼š <span class="number">2</span> <span class="number">6</span> <span class="number">5</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>åŒºåˆ«åœ¨äºpromiseçš„æ„é€ ä¸­ï¼Œæ²¡æœ‰åŒæ­¥çš„resolveï¼Œå› æ­¤promise.thenåœ¨å½“å‰çš„æ‰§è¡Œé˜Ÿåˆ—ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œåªæœ‰promiseä»pendingè½¬ç§»åˆ°resolveï¼Œæ‰ä¼šæœ‰thenæ–¹æ³•ï¼Œè€Œè¿™ä¸ªresolveæ˜¯åœ¨ä¸€ä¸ªsetTimoutæ—¶é—´ä¸­å®Œæˆçš„ï¼Œå› æ­¤3,4æœ€åè¾“å‡ºã€‚</p>
<p>å†™åˆ°è¿™é‡Œ æƒ³åˆ°ä¸€ä¸ªæŸä½å¤§å¸ˆçš„å¾ˆå½¢è±¡çš„ä¾‹å­</p>
<p>äº‹ä»¶å¾ªç¯é˜Ÿåˆ—å°±ç±»ä¼¼äºæ¸¸ä¹å›­æ¸¸æˆï¼Œç©è¿‡äº†ä¸€ä¸ªæ¸¸æˆä¹‹å ä½ éœ€è¦åˆ°é˜Ÿå°¾å»æ’é˜Ÿæ‰èƒ½å†ç©ä¸€æ¬¡ è€Œä»»åŠ¡é˜Ÿåˆ—ç±»ä¼¼wç©è¿‡äº†è¿™ä¸ªæ¸¸æˆä¹‹å æ’é˜Ÿæ¥ç€ç©<br>çœ‹åˆ°è¿™é‡Œ æ–‡ç« å¼€å¤´çš„é¢˜ç›®åº”è¯¥ä¸æˆé—®é¢˜äº† ç”šè‡³è¿˜è§‰å¾—so easy</p>
<p>å¥½çš„ åˆ°è¿™é‡Œ å°±å®Œäº† ä¸‹é¢æ˜¯ä¸¤ä¸ªjsè¿è¡Œæ—¶çš„æ¦‚å¿µ ä½ å¯ä»¥å‚²å¨‡çš„ç•¥è¿‡</p>
<hr>
<blockquote>
<p>jsæ‰§è¡Œæ—¶</p>
</blockquote>
<p>jsè°ƒç”¨æ ˆ</p>
<p>æ‹¥æœ‰ LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰æ•°æ®ç»“æ„çš„æ ˆï¼Œè¢«ç”¨æ¥å­˜å‚¨ä»£ç è¿è¡Œæ—¶åˆ›å»ºçš„æ‰€æœ‰<strong>æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ï¼Œè®°å½•äº†æˆ‘ä»¬åœ¨ç¨‹åºä¸­çš„ä½ç½®  å¦‚æœæˆ‘ä»¬è¿è¡Œåˆ°ä¸€ä¸ªå‡½æ•° å®ƒå°±ä¼šå°†å…¶æ”¾åˆ°æ ˆé¡¶ å½“ä»è¿™ä¸ªå‡½æ•°è¿”å›çš„æ—¶å€™ï¼Œå°±ä¼šå°†è¿™ä¸ªå‡½æ•°ä»æ ˆé¡¶å¼¹å‡ºï¼Œè¿™å°±æ˜¯è°ƒç”¨æ ˆåšçš„äº‹æƒ…</p>
<p>å½“ <code>JavaScript</code> å¼•æ“ç¬¬ä¸€æ¬¡é‡åˆ°ä½ çš„è„šæœ¬æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶ä¸”å‹å…¥å½“å‰æ‰§è¡Œæ ˆã€‚æ¯å½“å¼•æ“é‡åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå®ƒä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å¹¶å‹å…¥æ ˆçš„é¡¶éƒ¨ã€‚</p>
<p>å¼•æ“ä¼šæ‰§è¡Œé‚£äº›æ‰§è¡Œä¸Šä¸‹æ–‡ä½äºæ ˆé¡¶çš„å‡½æ•°ã€‚å½“è¯¥å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ä»æ ˆä¸­å¼¹å‡ºï¼Œæ§åˆ¶æµç¨‹åˆ°è¾¾å½“å‰æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸Šä¸‹æ–‡</p>
<hr>
<blockquote>
<p>jsæ‰§è¡Œä¸Šä¸‹æ–‡</p>
</blockquote>
<p>æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯è¯„ä¼°å’Œæ‰§è¡Œjsä»£ç çš„ç¯å¢ƒçš„æŠ½è±¡æ¦‚å¿µ<br>jsä»£ç åœ¨æ‰§è¡Œçš„æ—¶å€™ å®ƒéƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¿è¡Œ</p>
<p>å®ƒåˆ†ä¸ºä¸‰ç§ç±»å‹</p>
<ol>
<li>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</li>
</ol>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">å®ƒä¼šæ‰§è¡Œä¸¤ä»¶äº‹ï¼š åˆ›å»ºä¸€ä¸ªå…¨å±€<span class="built_in">window</span>å¯¹è±¡ å¹¶ä¸”è®¾ç½®<span class="keyword">this</span>çš„å€¼ç­‰äºè¿™ä¸ªå…¨å±€å¯¹è±¡ ä¸€ä¸ªç¨‹åºä¸­åªä¼šæœ‰ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å‡½æ•°è¢«è°ƒç”¨æ—¶å€™ ä¼šåˆ›å»ºä¸Šä¸‹æ–‡ï¼Œå‡½æ•°ä¸Šä¸‹æ–‡å¯ä»¥æœ‰ä»»æ„å¤šä¸ª  æ¯å½“ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»º å®ƒä¼šæŒ‰å®šä¹‰çš„é¡ºåº æ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>evalå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡</li>
</ol>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">æ‰§è¡Œåœ¨<span class="built_in">eval</span>å‡½æ•°å†…éƒ¨çš„ä»£ç ä¼šæœ‰ä»–è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡</span><br></pre></td></tr></table></figure>
<p><strong>jså¦‚ä½•åˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡</strong></p>
<p>ä¸¤ä¸ªé˜¶æ®µ</p>
<ul>
<li>åˆ›å»ºé˜¶æ®µ</li>
<li>æ‰§è¡Œé˜¶æ®µ</li>
</ul>
<p>ä»£ç æ‰§è¡Œæ ˆ æ‰§è¡Œä¸Šä¸‹æ–‡ç»å†åˆ›å»ºé˜¶æ®µ ä¼šå‘ç”Ÿ</p>
<ol>
<li>thiså€¼çš„åˆ¶å®š</li>
<li>åˆ›å»ºè¯æ³•ç¯å¢ƒç»„ä»¶</li>
<li>åˆ›å»ºå˜é‡ç¯å¢ƒç»„ä»¶</li>
</ol>
<hr>
<p>æœ€åçš„æœ€å</p>
<p>JavaScript æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œå†³å®šäºå®ƒçš„è®¾è®¡æœ€åˆæ˜¯ç”¨æ¥å¤„ç†æµè§ˆå™¨ç½‘é¡µçš„äº¤äº’ã€‚æµè§ˆå™¨è´Ÿè´£è§£é‡Šå’Œæ‰§è¡Œ JavaScript çš„çº¿ç¨‹åªæœ‰ä¸€ä¸ªï¼ˆæ‰€ä»¥è¯´æ˜¯å•çº¿ç¨‹ï¼‰ï¼Œå³JSå¼•æ“çº¿ç¨‹ï¼Œä½†æ˜¯æµè§ˆå™¨åŒæ ·æä¾›å…¶ä»–çº¿ç¨‹ï¼Œå¦‚ï¼šäº‹ä»¶è§¦å‘çº¿ç¨‹ã€å®šæ—¶å™¨è§¦å‘çº¿ç¨‹ç­‰</p>
]]></content>
      <categories>
        <category>js</category>
      </categories>
  </entry>
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åº åˆè§ç¯‡</title>
    <url>/2017/07/19/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%20%E5%88%9D%E8%A7%81%E7%AF%87/</url>
    <content><![CDATA[<ul>
<li><p><strong>é¢˜å¤–è¯</strong></p>
<ul>
<li><a href="#line6"> <font face="STCAIYUN" size="3">å…³äºå¾®ä¿¡å°ç¨‹åº</font></a></li>
<li><a href="#line5"> <font face="STCAIYUN" size="3">å°ç¨‹åºä¸ä¼ ç»ŸHTML5çš„åŒºåˆ«</font></a></li>
</ul>
</li>
<li><p><strong>æ¡†æ¶</strong></p>
<ul>
<li><a href="#line1"> <font face="STCAIYUN" size="3">ç›®å½•ç»“æ„ä¸é…ç½®</font></a></li>
<li><a href="#line2"> <font face="STCAIYUN" size="3">é€»è¾‘å±‚</font></a></li>
<li><a href="#line3"> <font face="STCAIYUN" size="3">è§†å›¾å±‚</font></a></li>
<li><a href="#line4"> <font face="STCAIYUN" size="3">è¿è¡Œæœºåˆ¶</font></a></li>
</ul>
</li>
</ul>
<p><br></p>
<a id="more"></a>
<p id="line6"><br><font face="STCAIYUN" color="#883958" size="4">å…³äºå¾®ä¿¡å°ç¨‹åº</font><br></p>

<p><strong>å°ç¨‹åºæ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ç€ä»€ä¹ˆæ ·çš„åŠŸèƒ½ï¼Ÿ</strong></p>
<p>Aï¼šå°ç¨‹åºæ˜¯ä¸€ç§ä¸éœ€è¦ä¸‹è½½å®‰è£…å³å¯ä½¿ç”¨çš„åº”ç”¨ï¼Œç”¨æˆ·æ‰«ä¸€æ‰«æˆ–è€…æœä¸€ä¸‹å³å¯æ‰“å¼€åº”ç”¨ã€‚ä¹Ÿä½“ç°äº†â€œç”¨å®Œå³èµ°â€çš„ç†å¿µï¼Œé€šè¿‡å…¬ä¼—å·å…³è”ï¼Œç”¨æˆ·å¯ä»¥å®ç°å…¬ä¼—å·ä¸å°ç¨‹åºä¹‹é—´ç›¸äº’è·³è½¬ã€‚</p>
<p><strong>å°ç¨‹åºå¯ä»¥å’Œç°æœ‰çš„App æ‰“é€šå—ï¼Ÿ</strong></p>
<p>Aï¼šå°ç¨‹åºå¯ä»¥å€ŸåŠ©å¾®ä¿¡è”åˆç™»å½•ï¼Œå’Œå¼€å‘è€…å·²æœ‰çš„App åå°çš„ç”¨æˆ·æ•°æ®è¿›è¡Œæ‰“é€šï¼Œä½†ä¸ä¼šæ”¯æŒå°ç¨‹åºå’ŒApp ç›´æ¥çš„è·³è½¬ï¼Œ<font face="STCAIYUN" color="red" size="4">ç°åœ¨æœ€æ–°ç‰ˆå·²ç»æ”¯æŒå°ç¨‹åºè·³è½¬åˆ°å¦ä¸€ä¸ªå°ç¨‹åºäº†</font></p>
<p id="line5"><br><font face="STCAIYUN" color="#883958" size="4">å°ç¨‹åºä¸ä¼ ç»ŸHTML5çš„åŒºåˆ«</font><br></p>

<ul>
<li><p><strong>å¼€å‘å·¥å…·ä¸åŒ</strong><br>åŒºåˆ«äºH5çš„å¼€å‘å·¥å…·+æµè§ˆå™¨Device Modeé¢„è§ˆçš„æ¨¡å¼ï¼Œå°ç¨‹åºçš„å¼€å‘åŸºäºè‡ªå·±çš„å¼€å‘è€…å·¥å…·ï¼Œå¯ä»¥å®ç°åŒæ­¥æœ¬åœ°æ–‡ä»¶+å¼€å‘è°ƒè¯•+ç¼–è¯‘+é¢„è§ˆ+ä¸Šä¼ +å‘å¸ƒç­‰ä¸€æ•´å¥—æµç¨‹ã€‚</p>
</li>
<li><p><strong>å¼€å‘è¯­è¨€ä¸åŒ</strong><br>å°ç¨‹åºè‡ªå·±å¼€å‘äº†ä¸€å¥—WXMLæ ‡ç­¾è¯­è¨€å’ŒWXSSæ ·å¼è¯­è¨€ï¼Œå¹¶éç›´æ¥ä½¿ç”¨æ ‡å‡†çš„HTML5+css3ã€‚</p>
</li>
<li><strong>ç»„ä»¶å°è£…ä¸åŒ</strong><br>å°ç¨‹åºç‹¬ç«‹å‡ºæ¥äº†å¾ˆå¤šåŸç”ŸAPPçš„ç»„ä»¶ï¼Œåœ¨HTML5éœ€è¦æ¨¡æ‹Ÿæ‰èƒ½å®ç°çš„åŠŸèƒ½ï¼Œå°ç¨‹åºé‡Œå¯ä»¥ç›´æ¥è°ƒç”¨ç»„ä»¶ã€‚</li>
</ul>
<p>ä¼ ç»ŸHTML5åœ¨åŠ è½½çš„æ—¶å€™å—é™äºç½‘ç»œç¯å¢ƒï¼Œéœ€è¦é¡ºåºåŠ è½½HTMLã€CSSã€JSï¼Œç„¶åè¿”å›æ•°æ®ï¼Œæœ€åæ¸²æŸ“é¡µé¢æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸­</p>
<p>å°ç¨‹åºçš„ä¸¤ä¸ªçº¿ç¨‹ï¼šé€»è¾‘å±‚å’Œè§†å›¾å±‚ä¼šåŒæ—¶è¿›è¡Œã€å¹¶è¡ŒåŠ è½½ï¼Œç”šè‡³è§†å›¾å±‚ä¼šæ›´æ—©æ‰§è¡Œï¼Œå½“è§†å›¾çº¿ç¨‹åŠ è½½å®Œï¼Œé€šçŸ¥é€»è¾‘å±‚ï¼Œé€»è¾‘å±‚ä¼šæŠŠå‡†å¤‡å¥½çš„æ•°æ®ç”¨setDataçš„æ–¹æ³•è¿”å›ç»™è§†å›¾çº¿ç¨‹</p>
<p id="line1"><br><font face="STCAIYUN" color="#883958" size="4">ç›®å½•ç»“æ„ä¸é…ç½®</font><br></p>

<p><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/config.html" target="_blank" rel="noopener">å®˜æ–¹æ¡†æ¶é…ç½®</a></p>
<p>å°ç¨‹åºåŒ…å«ä¸€ä¸ªæè¿°æ•´ä½“ç¨‹åºçš„appå’Œå¤šä¸ªæè¿°å„ä¸ªé¡µé¢çš„page<br>å°ç¨‹åºçš„ä¸»ä½“éƒ¨åˆ†ç”±ä¸‰ä¸ªæ–‡ä»¶ç»„æˆ å¿…é¡»æ”¾åœ¨<font face="STCAIYUN" color="#883958" size="3">é¡¹ç›®çš„æ ¹ç›®å½•</font>ä¸‹</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">app<span class="selector-class">.js</span> å°ç¨‹åºå…¥å£é€»è¾‘</span><br><span class="line">app<span class="selector-class">.json</span> å°ç¨‹åºçš„å…¬å…±è®¾ç½®</span><br><span class="line">å¯¹å¾®ä¿¡å°ç¨‹åºè¿›è¡Œå…¨å±€é…ç½®ï¼Œå†³å®šé¡µé¢æ–‡ä»¶çš„è·¯å¾„ã€çª—å£è¡¨ç°ã€è®¾ç½®ç½‘ç»œè¶…æ—¶æ—¶é—´ã€è®¾ç½®å¤š tab ç­‰</span><br><span class="line">app<span class="selector-class">.wxss</span> å°ç¨‹åºçš„å…¬å…±æ ·å¼è¡¨</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªç¨‹åºé¡µé¢ç”±å››ä¸ªé¡µé¢ç»„æˆ</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">wxml é¡µé¢ç»“æ„</span><br><span class="line">wxss é¡µé¢çš„æ ·å¼è¡¨ ï¼ˆä¸å¿…å¡«ï¼‰</span><br><span class="line"><span class="keyword">json </span>é¡µé¢çš„é…ç½® ï¼ˆä¸å¿…å¡«ï¼‰</span><br><span class="line"><span class="keyword">js </span>  é¡µé¢é€»è¾‘</span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="#83933b" size="3"><br>ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…å‡å°‘é…ç½®é¡¹ï¼Œæˆ‘ä»¬è§„å®šæè¿°é¡µé¢çš„è¿™å››ä¸ªæ–‡ä»¶å¿…é¡»å…·æœ‰ç›¸åŒçš„è·¯å¾„ä¸æ–‡ä»¶åã€‚</font>

<p id="line2"><br><font face="STCAIYUN" color="#883958" size="4">é€»è¾‘å±‚</font><br></p>

<p>å°ç¨‹åºå¼€å‘æ¡†æ¶çš„é€»è¾‘å±‚æ˜¯ç”±<font face="STCAIYUN" color="#83933b" size="3">Javascript</font>ç¼–å†™çš„<br>é€»è¾‘å±‚å°†æ•°æ®è¿›è¡Œå¤„ç†åå‘é€ç»™è§†å›¾å±‚ï¼ŒåŒæ—¶æ¥æ”¶è§†å›¾å±‚çš„åé¦ˆï¼Œä¸ºäº†æ–¹ä¾¿å¼€å‘ å°ç¨‹åºåšäº†ä»¥ä¸‹æ›´æ”¹</p>
<ol>
<li><font face="STCAIYUN" color="#83933b" size="3">å¢åŠ APPå’ŒPageæ–¹æ³•ï¼Œè¿›è¡Œç¨‹åºå’Œé¡µé¢çš„æ³¨å†Œ</font>

<p>APP()å‡½æ•°ç”¨æ¥æ³¨å†Œä¸€ä¸ªå°ç¨‹åº æ¥å—ä¸€ä¸ªobjectå‚æ•° ä¹Ÿå°±æ˜¯å°ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</p>
</li>
</ol>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">onLaunch</span>	ç›‘å¬å°ç¨‹åºåˆå§‹åŒ– å½“å°ç¨‹åºåˆå§‹åŒ–å®Œæˆæ—¶ï¼Œä¼šè§¦å‘ <span class="literal">on</span>Launchï¼ˆå…¨å±€åªè§¦å‘ä¸€æ¬¡ï¼‰</span><br><span class="line"><span class="literal">on</span>Show		ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬å°ç¨‹åºæ˜¾ç¤º	å½“å°ç¨‹åºå¯åŠ¨ï¼Œæˆ–ä»åå°è¿›å…¥å‰å°æ˜¾ç¤ºï¼Œä¼šè§¦å‘ <span class="literal">on</span>Show</span><br><span class="line"><span class="literal">on</span>Hide		ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬å°ç¨‹åºéšè—	å½“å°ç¨‹åºä»å‰å°è¿›å…¥åå°ï¼Œä¼šè§¦å‘ <span class="literal">on</span>Hide</span><br><span class="line"></span><br><span class="line">å‰å°ã€åå°å®šä¹‰ï¼š å½“ç”¨æˆ·ç‚¹å‡»å·¦ä¸Šè§’å…³é—­ï¼Œæˆ–è€…æŒ‰äº†è®¾å¤‡ Home é”®ç¦»å¼€å¾®ä¿¡ï¼Œå°ç¨‹åºå¹¶æ²¡æœ‰ç›´æ¥é”€æ¯ï¼Œè€Œæ˜¯è¿›å…¥äº†åå°ï¼›å½“å†æ¬¡è¿›å…¥å¾®ä¿¡æˆ–å†æ¬¡æ‰“å¼€å°ç¨‹åºï¼Œåˆä¼šä»åå°è¿›å…¥å‰å°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåªæœ‰å½“å°ç¨‹åºè¿›å…¥åå°ä¸€å®šæ—¶é—´ï¼Œæˆ–è€…ç³»ç»Ÿèµ„æºå ç”¨è¿‡é«˜ï¼Œæ‰ä¼šè¢«çœŸæ­£çš„é”€æ¯ã€‚</span><br><span class="line"></span><br><span class="line"><span class="literal">on</span>Error		é”™è¯¯ç›‘å¬å‡½æ•°	å½“å°ç¨‹åºå‘ç”Ÿè„šæœ¬é”™è¯¯ï¼Œæˆ–è€… api è°ƒç”¨å¤±è´¥æ—¶ï¼Œä¼šè§¦å‘ <span class="literal">on</span>Error å¹¶å¸¦ä¸Šé”™è¯¯ä¿¡æ¯</span><br><span class="line">å½“ç„¶äº† å¼€å‘è€…ä¹Ÿå¯ä»¥æ·»åŠ ä»»æ„çš„å‡½æ•°æˆ–æ•°æ®åˆ° Object å‚æ•°ä¸­ï¼Œç”¨ this å¯ä»¥è®¿é—®æ¯”å¦‚ç‚¹å‡» é•¿æŒ‰ äº‹ä»¶ç­‰</span><br></pre></td></tr></table></figure>
<p>  Page()å‡½æ•°ç”¨æ¥æ³¨å†Œä¸€ä¸ªé¡µé¢ æ¥å—ä¸€ä¸ªobjectå‚æ•° å…¶æŒ‡å®šé¡µé¢çš„åˆå§‹æ•°æ®ã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€äº‹ä»¶å¤„ç†å‡½æ•°ç­‰ã€‚</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">data</span>		            é¡µé¢çš„åˆå§‹æ•°æ®</span><br><span class="line"><span class="literal">on</span>Load(query)		   ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½</span><br><span class="line"><span class="literal">on</span>Ready		         ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œ</span><br><span class="line"><span class="literal">on</span>Show		         ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢æ˜¾ç¤º</span><br><span class="line"><span class="literal">on</span>Hide		         ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢éšè—</span><br><span class="line"><span class="literal">on</span>Unload		         ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢å¸è½½</span><br><span class="line"><span class="literal">on</span>PullDownRefresh		é¡µé¢ç›¸å…³äº‹ä»¶å¤„ç†å‡½æ•°--ç›‘å¬ç”¨æˆ·ä¸‹æ‹‰</span><br><span class="line"><span class="literal">on</span>ReachBottom		   é¡µé¢ä¸Šæ‹‰è§¦åº•äº‹ä»¶çš„å¤„ç†å‡½æ•°</span><br><span class="line"><span class="literal">on</span>ShareAppMessage		ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’è½¬å‘</span><br><span class="line"><span class="literal">on</span>PageScroll(scrollTop)		   é¡µé¢æ»šåŠ¨è§¦å‘äº‹ä»¶çš„å¤„ç†å‡½æ•° å‚æ•°ä»£è¡¨é¡µé¢å‚ç›´æ–¹å‘å·²ç»æ»šåŠ¨çš„è·ç¦»</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">route å­—æ®µå¯ä»¥è·å–åˆ°å½“å‰é¡µé¢çš„è·¯å¾„ã€‚</span><br><span class="line">æ³¨å†Œå‡½æ•°é‡Œ console.log(<span class="string">'this.route'</span>,<span class="keyword">this</span>.route)</span><br><span class="line"></span><br><span class="line">setData å‡½æ•°ä»¥key value çš„å½¢å¼æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ ç”¨äºå°†æ•°æ®ä»é€»è¾‘å±‚å‘é€åˆ°è§†å›¾å±‚ï¼Œæ”¹å˜å¯¹åº”çš„ <span class="keyword">this</span>.<span class="keyword">data</span>ä¸­ç›¸åº”keyçš„å€¼ã€‚</span><br><span class="line"><span class="keyword">set</span>çš„å€¼ä¸éœ€è¦åœ¨<span class="keyword">this</span>.<span class="keyword">data</span>ä¸­é¢„å…ˆå®šä¹‰</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setData(&#123;</span><br><span class="line">      name:<span class="string">'é©¬è¹'</span></span><br><span class="line">    &#125;)</span><br><span class="line">    console.log(<span class="string">'this.data'</span>,<span class="keyword">this</span>.<span class="keyword">data</span>)</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼š</span><br><span class="line"></span><br><span class="line">    ç›´æ¥ä¿®æ”¹ <span class="keyword">this</span>.<span class="keyword">data</span> è€Œä¸è°ƒç”¨ <span class="keyword">this</span>.setData æ˜¯æ— æ³•æ”¹å˜é¡µé¢çš„çŠ¶æ€çš„ï¼Œè¿˜ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´</span><br><span class="line">    å•æ¬¡è®¾ç½®çš„æ•°æ®ä¸èƒ½è¶…è¿‡<span class="number">1024</span>kBï¼Œè¯·å°½é‡é¿å…ä¸€æ¬¡è®¾ç½®è¿‡å¤šçš„æ•°æ®ã€‚</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><font face="STCAIYUN" color="#83933b" size="3">å¢åŠ getAPPå’ŒgetCurrentPagesæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥è·å–Appå®ä¾‹å’Œå½“å‰æŠ€æœ¯æ ˆ</font>

<p>å¯ä»¥æ ¹æ®å…¨å±€å‡½æ•°è·å–åˆ°å°ç¨‹åºçš„å®ä¾‹</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> appInstance = getApp()</span><br><span class="line"><span class="built_in">console</span>.log(appInstance.globalData)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'getCurrentPages()'</span>,getCurrentPages())</span><br></pre></td></tr></table></figure>
<font face="STCAIYUN" color="#b36666" size="3">å°tipsï¼š</font>

<ul>
<li><code>App()</code> å¿…é¡»åœ¨app.jsä¸­æ³¨å†Œï¼Œåªèƒ½æ³¨å†Œä¸€æ¬¡</li>
<li>åœ¨å®šä¹‰åœ¨<code>APP()</code>çš„å‡½æ•°ä¸­æƒ³è·å–appå®ä¾‹ï¼Œä¸è¦ç”¨<code>getApp()</code> çš„æ–¹å¼ ç›´æ¥ç”¨<font face="STCAIYUN" color="#b36666" size="3">this</font>å°±è¡Œ</li>
<li><p>ä¸è¦åœ¨onLaunchçš„æ—¶å€™è°ƒç”¨<code>getCurrentPages()</code>ï¼Œæ­¤æ—¶pageè¿˜æ²¡æœ‰ç”Ÿæˆ<br><br><br>3 . <font face="STCAIYUN" color="#83933b" size="3">æ¯ä¸ªé¡µé¢æœ‰ç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œå¹¶æä¾›æ¨¡å—åŒ–çš„èƒ½åŠ›</font></p>
<p>  åœ¨javascriptæ–‡ä»¶ä¸­å£°æ˜çš„å˜é‡å’Œå‡½æ•°åªæ˜¯åœ¨è¯¥æ–‡ä»¶ä¸­æœ‰æ•ˆ</p>
<p>   æˆ‘ä»¬å¯ä»¥å°†ä¸€äº›å…¬å…±çš„ä»£ç æŠ½ç¦»æˆä¸ºä¸€ä¸ªå•ç‹¬çš„ js æ–‡ä»¶ï¼Œä½œä¸ºä¸€ä¸ªæ¨¡å—ã€‚æ¨¡å—åªæœ‰é€šè¿‡ module.exports æˆ–è€… exports æ‰èƒ½å¯¹å¤–æš´éœ²æ¥å£ã€‚</p>
<pre><code>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š

exports æ˜¯ module.exports çš„ä¸€ä¸ªå¼•ç”¨ï¼Œå› æ­¤åœ¨æ¨¡å—é‡Œè¾¹éšæ„æ›´æ”¹ exports çš„æŒ‡å‘ä¼šé€ æˆæœªçŸ¥çš„é”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬æ›´æ¨èå¼€å‘è€…é‡‡ç”¨ module.exports æ¥æš´éœ²æ¨¡å—æ¥å£ï¼Œé™¤éä½ å·²ç»æ¸…æ™°çŸ¥é“è¿™ä¸¤è€…çš„å…³ç³»ã€‚
å°ç¨‹åºç›®å‰ä¸æ”¯æŒç›´æ¥å¼•å…¥ node_modules , å¼€å‘è€…éœ€è¦ä½¿ç”¨åˆ° node_modules æ—¶å€™éœ€è¦æ‹·è´å‡ºç›¸å…³çš„ä»£ç åˆ°å°ç¨‹åºçš„ç›®å½•ä¸­ã€‚
</code></pre></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;name&#125;</span> !`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayGoodbye</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Goodbye <span class="subst">$&#123;name&#125;</span> !`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports.sayHello = sayHello</span><br><span class="line">exports.sayGoodbye = sayGoodbye</span><br><span class="line"></span><br><span class="line">å¼•ç”¨</span><br><span class="line"><span class="keyword">var</span> common = <span class="built_in">require</span>(<span class="string">'common.js'</span>)  <span class="built_in">require</span> æš‚æ—¶ä¸æ”¯æŒç»å¯¹è·¯å¾„</span><br><span class="line">Page(&#123;</span><br><span class="line">  helloMINA: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    common.sayHello(<span class="string">'MINA'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  goodbyeMINA: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    common.sayGoodbye(<span class="string">'MINA'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>4 .  <font face="STCAIYUN" color="#83933b" size="3">ç”±äºæ¡†æ¶å¹¶éè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œæ‰€ä»¥ JavaScript åœ¨ web ä¸­ä¸€äº›èƒ½åŠ›éƒ½æ— æ³•ä½¿ç”¨ï¼Œå¦‚ documentï¼Œwindow ç­‰ã€‚ </font></p>
<p>5 . <font face="STCAIYUN" color="#83933b" size="3">å¼€å‘è€…å†™çš„æ‰€æœ‰ä»£ç æœ€ç»ˆå°†ä¼šæ‰“åŒ…æˆä¸€ä»½ JavaScriptï¼Œå¹¶åœ¨å°ç¨‹åºå¯åŠ¨çš„æ—¶å€™è¿è¡Œï¼Œç›´åˆ°å°ç¨‹åºé”€æ¯ï¼Œ </font></p>
<p><strong>é¡µé¢è·¯ç”±</strong><br>åœ¨å°ç¨‹åºä¸­æ‰€æœ‰é¡µé¢çš„è·¯ç”±å…¨éƒ¨ç”±æ¡†æ¶è¿›è¡Œç®¡ç†ã€‚<br>æ¡†æ¶ä»¥æ ˆçš„å½¢å¼ç»´æŠ¤äº†å½“å‰çš„æ‰€æœ‰é¡µé¢ã€‚ å½“å‘ç”Ÿè·¯ç”±åˆ‡æ¢çš„æ—¶å€™ï¼Œé¡µé¢æ ˆçš„è¡¨ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">åˆå§‹åŒ–-&gt; æ–°é¡µé¢å…¥æ ˆ</span><br><span class="line">æ‰“å¼€æ–°é¡µé¢-&gt; æ–°é¡µé¢å…¥æ ˆ</span><br><span class="line">é¡µé¢é‡å®šå‘-&gt; å½“å‰é¡µé¢å‡ºæ ˆ æ–°é¡µé¢å…¥æ ˆ</span><br><span class="line">é¡µé¢è¿”å›-&gt; é¡µé¢ä¸æ–­å‡ºæ ˆï¼Œç›´åˆ°ç›®æ ‡è¿”å›é¡µï¼Œæ–°é¡µé¢å…¥æ ˆ</span><br><span class="line">Tabåˆ‡æ¢-&gt;  é¡µé¢å…¨éƒ¨å‡ºæ ˆ åªç•™ä¸‹æ–°çš„Tabé¡µé¢</span><br><span class="line">é‡åŠ è½½-&gt;  é¡µé¢å…¨éƒ¨å‡ºæ ˆ åªç•™ä¸‹æ–°çš„é¡µé¢</span><br></pre></td></tr></table></figure>
 <font face="STCAIYUN" color="#b36666" size="3">å°tipsï¼š</font><br><em>  <code>navigateTo</code>, <code>redirectTo</code> åªèƒ½æ‰“å¼€é tabBar é¡µé¢ã€‚
</em>  switchTab åªèƒ½æ‰“å¼€ tabBar é¡µé¢<br><em>  reLaunch å¯ä»¥æ‰“å¼€ä»»æ„é¡µé¢
</em> é¡µé¢åº•éƒ¨çš„ tabBar ç”±é¡µé¢å†³å®šï¼Œå³åªè¦æ˜¯å®šä¹‰ä¸º tabBar çš„é¡µé¢ï¼Œåº•éƒ¨éƒ½æœ‰ tabBarã€‚<br><p id="line3"><br><font face="STCAIYUN" color="#883958" size="4">è§†å›¾å±‚</font><br></p><br><br><strong>WXml </strong><br>WXMLï¼ˆWeiXin Markup Languageï¼‰æ˜¯æ¡†æ¶è®¾è®¡çš„ä¸€å¥—æ ‡ç­¾è¯­è¨€ï¼Œç»“åˆåŸºç¡€ç»„ä»¶ã€äº‹ä»¶ç³»ç»Ÿï¼Œå¯ä»¥æ„å»ºå‡ºé¡µé¢çš„ç»“æ„ã€‚<br>WXMLåœ¨è¯­æ³•ä¸Šæ›´æ¥è¿‘XMLè¯­è¨€ï¼Œéµå¾ªSGMLè§„èŒƒï¼ŒåŒºåˆ«äºHTMLè¯­è¨€éšæ„çš„æ ‡ç­¾é—­åˆæ–¹å¼ï¼Œ<font face="STCAIYUN" color="#883958" size="4">WXMLè¯­è¨€å¿…é¡»åŒ…æ‹¬å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾</font>

<p><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/" target="_blank" rel="noopener">åŸºæœ¬è¯­æ³•</a><br>WXML ä¸­çš„åŠ¨æ€æ•°æ®å‡æ¥è‡ªå¯¹åº” Page çš„ dataã€‚ä¸åŒäº Vue å®ƒæ˜¯<code>å•å‘ç»‘å®š</code> å¿…é¡»é€šè¿‡è°ƒç”¨äº‹ä»¶æ¥<code>setData</code>æ–°çš„æ•°æ®</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span>&gt;</span> </span><span class="template-variable">&#123;&#123; message &#125;</span><span class="xml">&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml">Page(</span><span class="template-variable">&#123;</span></span><br><span class="line"><span class="template-variable">  data: &#123;</span></span><br><span class="line"><span class="template-variable">    message: 'Hello MINA!'</span></span><br><span class="line"><span class="template-variable">  &#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">&#125;)</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">èŠ±æ‹¬å·å’Œå¼•å·ä¹‹é—´ä¸èƒ½ç•™ç©ºï¼Œå¦åˆ™å°†æœ€ç»ˆè¢«è§£ææˆä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;[1,2,3]&#125;</span><span class="xml"><span class="tag"><span class="string">&#125; "</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-variable">&#123;&#123;item&#125;</span><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml">ç­‰åŒäº</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;[1,2,3] + ' '&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span> &gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-variable">&#123;&#123;item&#125;</span><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">å½“ wx:for çš„å€¼ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šå°†å­—ç¬¦ä¸²è§£ææˆå­—ç¬¦ä¸²æ•°ç»„</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"yishu"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-variable">&#123;&#123;item&#125;</span><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml">===</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;['y','i','s','h','u']&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-variable">&#123;&#123;item&#125;</span><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;condition&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span> <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;length &gt; 5&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span> <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">å…³é”®å­— éœ€è¦åœ¨åŒå¼•å·ä¹‹å†… checked="false"ï¼Œå…¶è®¡ç®—ç»“æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè½¬æˆ boolean ç±»å‹åä»£è¡¨çœŸå€¼ã€‚</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">checkbox</span> <span class="attr">checked</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;false&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span> <span class="tag">&lt;/<span class="name">checkbox</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">hidden</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;flag ? true : false&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span> Hidden <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">æ¡ä»¶æ¸²æŸ“</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;length &gt; 5&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span> 1 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:elif</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;length &gt; 2&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span> 2 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:else</span>&gt;</span> 3 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">å¦‚æœæƒ³ä¸€æ¬¡æ€§åˆ¤æ–­å¤šä¸ªç»„ä»¶æ ‡ç­¾  å¯ä»¥è¿™ä¹ˆå†™</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;true&#125;</span><span class="xml"><span class="tag"><span class="string">&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">view</span>&gt;</span> view1 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">view</span>&gt;</span> view2 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span></span><br><span class="line"><span class="xml"> æ˜¯ä¸€ä¸ªåŒ…è£…å…ƒç´ ï¼Œä¸ä¼šåœ¨é¡µé¢ä¸­åšä»»ä½•æ¸²æŸ“ï¼Œåªæ¥å—æ§åˆ¶å±æ€§ã€‚å½“ç„¶äº† æˆ‘æ˜¯ç»å¸¸ç”¨Viewæ ‡ç­¾åŒ…è£¹çš„</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"> å…³äº wx:if ä¸ hidden</span></span><br><span class="line"><span class="xml"> ç®€å•æ¥è¯´ hiddenä¸ºtrueçš„ç»„ä»¶å§‹ç»ˆè¢«æ¸²æŸ“ åªæ˜¯åˆ‡æ¢ displayä¸noneçŠ¶æ€</span></span><br><span class="line"><span class="xml"> è€Œ wx:ifåªæœ‰åœ¨æ¡ä»¶æˆç«‹çš„æƒ…å†µä¸‹æ‰ä¼šè¢«çœŸçš„æ¸²æŸ“</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ¨¡ç‰ˆ æ¨¡æ¿æ‹¥æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼Œåªèƒ½ä½¿ç”¨dataä¼ å…¥çš„æ•°æ®ã€‚</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"msgItem"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">text</span>&gt;</span> </span><span class="template-variable">&#123;&#123;index&#125;&#125;</span><span class="xml">: </span><span class="template-variable">&#123;&#123;msg&#125;&#125;</span><span class="xml"> <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">text</span>&gt;</span> Time: </span><span class="template-variable">&#123;&#123;time&#125;&#125;</span><span class="xml"> <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">å¼•ç”¨</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span> <span class="attr">is</span>=<span class="string">"msgItem"</span> <span class="attr">data</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;...item&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><strong>äº‹ä»¶ ï¼ˆå†’æ³¡ éå†’æ³¡ï¼‰</strong><br><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/event.html" target="_blank" rel="noopener">äº‹ä»¶API</a><br>äº‹ä»¶æ˜¯è§†å›¾å±‚åˆ°é€»è¾‘å±‚çš„é€šè®¯æ–¹å¼ï¼Œå½“ç»„ä»¶è§¦å‘äº‹ä»¶æ—¶ï¼Œé€»è¾‘å±‚ç»‘å®šè¯¥äº‹ä»¶çš„å¤„ç†å‡½æ•°ä¼šæ”¶åˆ°ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ã€‚<br>å†’æ³¡äº‹ä»¶<br>touchstart    æ‰‹æŒ‡è§¦æ‘¸åŠ¨ä½œå¼€å§‹<br>touchmove    æ‰‹æŒ‡è§¦æ‘¸åç§»åŠ¨<br>touchcancel    æ‰‹æŒ‡è§¦æ‘¸åŠ¨ä½œè¢«æ‰“æ–­ï¼Œå¦‚æ¥ç”µæé†’ï¼Œå¼¹çª—<br>touchend    æ‰‹æŒ‡è§¦æ‘¸åŠ¨ä½œç»“æŸ<br>tap    æ‰‹æŒ‡è§¦æ‘¸åé©¬ä¸Šç¦»å¼€<br>longtap æ‰‹æŒ‡è§¦æ‘¸åï¼Œè¶…è¿‡350mså†ç¦»å¼€</p>
<font face="STCAIYUN" color="#83933b" size="3">bindäº‹ä»¶ç»‘å®šä¸ä¼šé˜»æ­¢å†’æ³¡äº‹ä»¶å‘ä¸Šå†’æ³¡ï¼Œ<br>catchäº‹ä»¶ç»‘å®šå¯ä»¥é˜»æ­¢å†’æ³¡äº‹ä»¶å‘ä¸Šå†’æ³¡ã€‚</font><br><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">è§†å›¾å±‚</span><br><span class="line">&lt;<span class="keyword">view</span> id=<span class="string">"tapTest"</span> data-<span class="keyword">hi</span>=<span class="string">"WeChat"</span> bindtap=<span class="string">"tapName"</span>&gt; Click me! &lt;/<span class="keyword">view</span>&gt;</span><br><span class="line">é€»è¾‘å±‚</span><br><span class="line">Page(&#123;</span><br><span class="line">  tapName: <span class="function"><span class="keyword">function</span><span class="params">(event)</span> &#123;</span></span><br><span class="line">    console.<span class="built_in">log</span>(event)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><br><strong>æ–‡ä»¶å¼•å…¥</strong><br>WXML æä¾›ä¸¤ç§æ–‡ä»¶å¼•ç”¨æ–¹å¼importå’Œincludeã€‚<br><br>importå¯ä»¥åœ¨è¯¥æ–‡ä»¶ä¸­ä½¿ç”¨ç›®æ ‡æ–‡ä»¶å®šä¹‰çš„ template<br><br><br><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!-- item.wxml --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"item"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">text</span>&gt;</span></span><span class="template-variable">&#123;&#123;text&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">å¼•å…¥æ¨¡ç‰ˆ</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">import</span> <span class="attr">src</span>=<span class="string">"item.wxml"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span> <span class="attr">is</span>=<span class="string">"item"</span> <span class="attr">data</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123;text: 'forbar'&#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></span><br></pre></td></tr></table></figure><br><br><code>import</code> æœ‰ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œå³åªä¼š<br><font face="STCAIYUN" color="#83933b" size="3">import ç›®æ ‡æ–‡ä»¶ä¸­å®šä¹‰çš„ templateï¼Œè€Œä¸ä¼š import ç›®æ ‡æ–‡ä»¶ import çš„ templateã€‚</font>

<p><code>include</code>å¯ä»¥å°†ç›®æ ‡æ–‡ä»¶é™¤äº†<code>&lt;template/&gt;</code>çš„æ•´ä¸ªä»£ç å¼•å…¥ ä¹Ÿå°±æ˜¯è¯´ copyåˆ°äº†å½“å‰å¼•å…¥çš„ä½ç½®</p>
<p><strong>WXSS</strong><br>WXSS(WeiXin Style Sheets)æ˜¯ä¸€å¥—æ ·å¼è¯­è¨€ï¼Œç”¨äºæè¿° WXML çš„ç»„ä»¶æ ·å¼ã€‚</p>
<p>WXSSæ”¯æŒçš„å•ä½æœ‰<code>pxã€remå’Œrpx</code>ï¼Œå…¶ä¸­remå’Œrpxå¯ä»¥é’ˆå¯¹å±å¹•å®¹å™¨è¿›è¡Œé€‚é…ï¼Œpxåˆ™ä¸ºå›ºå®šå°ºå¯¸ã€‚<br>å…¶ä¸­<code>1rpx=0.5px</code>ï¼Œåœ¨WXSSå’ŒWXMLä¸­å®šä¹‰çš„rpxå•ä½æœ€ç»ˆä¼šè½¬æ¢ä¸ºåœ¨æ‰‹æœºç«¯å¯ä»¥è¯†åˆ«çš„<code>rem</code>å•ä½ã€‚</p>
<p><strong>å»ºè®®</strong>ï¼š<font face="STCAIYUN" color="red" size="3">å¼€å‘å¾®ä¿¡å°ç¨‹åºæ—¶è®¾è®¡å¸ˆå¯ä»¥ç”¨ iPhone6 ä½œä¸ºè§†è§‰ç¨¿çš„æ ‡å‡†ã€‚<br>æˆ‘ä»¬æ‹¿åˆ°750çš„è®¾è®¡ç¨¿ï¼Œåœ¨PSä¸­é‡å–çš„å®¹å™¨å¤§å°ï¼Œå¯ä»¥ç›´æ¥å®šä¹‰ä¸ºrpxï¼Œä¸éœ€è¦è¿›è¡Œ2å€å°ºå¯¸çš„æ¢ç®—ï¼Œrpxçš„å•ä½ä¸å…‰åœ¨æ ·å¼ä¸­ä¼šè‡ªé€‚åº”ï¼Œå†™åœ¨WXMLçš„styleé‡Œä¹Ÿä¼šæ ¹æ®å±å¹•è‡ªé€‚åº”ã€‚</font></p>
<p>åƒCSSä¸€æ · å¯ä»¥ä½¿ç”¨<code>@import</code>è¯­å¥å¯ä»¥å¯¼å…¥å¤–è”æ ·å¼è¡¨ï¼Œ@importåè·Ÿéœ€è¦å¯¼å…¥çš„å¤–è”æ ·å¼è¡¨çš„<font face="STCAIYUN" color="#83933b" size="3"> ç›¸å¯¹è·¯å¾„</font></p>
<p><code>import &quot;../../wxss/common.wxss&quot;;</code></p>
<p>ä¸ºäº†æé«˜æ¸²æŸ“é€Ÿåº¦å°½é‡é¿å…é™æ€æ ·å¼å­˜åœ¨äºstyleä¸­ï¼Œé™¤ééœ€è¦æ¥æ”¶åŠ¨æ€æ ·å¼æ‰åº”è¯¥å†™åœ¨è¡Œå†…<font face="STCAIYUN" color="#83933b" size="3">ï¼ˆè²Œä¼¼è¯´äº†ä¸€å¥åºŸè¯ï¼‰</font></p>
<p><code>&lt;view style=&quot;color:;&quot; /&gt;</code></p>
<p>å…¨å±€æ ·å¼ä¸å±€éƒ¨æ ·å¼<br>å…¨å±€æ ·å¼éƒ½åœ¨<code>app.wxss</code>ä¸­å®šä¹‰ pageé‡Œçš„wxssæ–‡ä»¶å®šä¹‰çš„æ˜¯å±€éƒ¨æ ·å¼ å±€éƒ¨æ ·å¼å¯ä»¥è¦†ç›–åŒåçš„å…¨å±€æ ·å¼</p>
<p id="line4"><br><font face="STCAIYUN" color="#883958" size="4">è¿è¡Œæœºåˆ¶</font><br></p>

<ul>
<li>å°ç¨‹åºæ²¡æœ‰é‡å¯çš„æ¦‚å¿µ</li>
<li>å½“å°ç¨‹åºè¿›å…¥åå°ï¼Œå®¢æˆ·ç«¯ä¼šç»´æŒä¸€æ®µæ—¶é—´çš„è¿è¡ŒçŠ¶æ€ï¼Œè¶…è¿‡ä¸€å®šçš„æ—¶é—´åä¼šè‡ªåŠ¨é”€æ¯ï¼ˆç›®å‰æ˜¯äº”åˆ†é’Ÿï¼‰</li>
<li>ç½®é¡¶çš„å°ç¨‹åºä¸ä¼šè¢«å¾®ä¿¡ä¸»åŠ¨é”€æ¯</li>
<li>å½“æ”¶åˆ°å†…å­˜è­¦å·æ—¶å°ç¨‹åºä¼šé”€æ¯</li>
</ul>
]]></content>
      <tags>
        <tag>wechat</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­ç§˜setStateæœºåˆ¶</title>
    <url>/2018/11/23/%E6%8F%AD%E7%A7%98setState%E6%9C%BA%E5%88%B6/</url>
    <content><![CDATA[<p>å‰è¨€ï¼šstateæ˜¯reactä¸­é‡è¦çš„æ¦‚å¿µï¼Œ reactæ˜¯é€šè¿‡ç®¡ç†çŠ¶æ€æ¥å®ç°å¯¹ç»„ä»¶çš„ç®¡ç†ï¼Œé‚£ä¹ˆ reactæ˜¯å¦‚ä½•æ§åˆ¶ç»„ä»¶çš„çŠ¶æ€ åˆæ˜¯å¦‚ä½•åˆ©ç”¨çŠ¶æ€æ¥ç®¡ç†ç»„ä»¶çš„å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æ‰€çŸ¥é“çš„ç‰ˆæœ¬ å¤§æ¦‚æ˜¯ é€šè¿‡<code>this.state</code>æ¥è®¿é—®<code>state</code>ï¼Œé€šè¿‡<code>setState()</code>æ–¹æ³•æ¥æ›´æ–°<code>state</code>ï¼Œå½“<code>this.state()</code>è¢«è°ƒç”¨çš„æ—¶å€™ <code>React</code>ä¼šé‡æ–°è°ƒç”¨<code>render</code>æ–¹æ³•æ¥é‡æ–°æ¸²æŸ“<code>UI</code></p>
<p>é‚£å¥½çš„ å…ˆæ¥çœ‹ä¸€é“é¢˜å§</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">export <span class="keyword">default</span> class SetState extends React.Component &#123;</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        super();</span><br><span class="line">        this.<span class="keyword">state</span> = &#123;</span><br><span class="line">            val:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillMount()&#123;</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentWillMountç¬¬ä¸€æ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentWillMountç¬¬äºŒæ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val)</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount()&#123;</span><br><span class="line">        // debugger;</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬ä¸€æ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val)</span><br><span class="line">        this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">        console.<span class="keyword">log</span>('componentDidMountç¬¬äºŒæ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val)</span><br><span class="line">        <span class="built_in">set</span>Timeout(()=&gt;&#123;</span><br><span class="line">            // debugger;</span><br><span class="line">            console.<span class="keyword">log</span>('å¼€å§‹<span class="built_in">set</span>Timeout',this.<span class="keyword">state</span>.val)</span><br><span class="line">            this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">            console.<span class="keyword">log</span>('ç¬¬ä¸‰æ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val) </span><br><span class="line"></span><br><span class="line">            this.<span class="built_in">set</span>State(&#123;val:this.<span class="keyword">state</span>.val+<span class="number">1</span>&#125;);</span><br><span class="line">            console.<span class="keyword">log</span>('ç¬¬å››æ¬¡è¾“å‡º',this.<span class="keyword">state</span>.val) </span><br><span class="line">        &#125;,<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    render()&#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é“é¢˜çš„ç­”æ¡ˆæ˜¯ <code>0 0 1 1 2 3 4</code></p>
<p>å‡å¦‚ç»“æœä¸ä½ å¿ƒä¸­çš„ç­”æ¡ˆå¹¶ä¸å®Œå…¨ç›¸åŒï¼Œé‚£ä¹ˆä½ åº”è¯¥æ„Ÿå…´è¶£è¿™èƒŒåç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆ.</p>
<a id="more"></a>
<h2 id="äº†è§£setState"><a href="#äº†è§£setState" class="headerlink" title="äº†è§£setState"></a>äº†è§£setState</h2><ol>
<li>setStateæ˜¯åŒæ­¥æ‰§è¡Œçš„ ä½†æ˜¯stateå¹¶ä¸ä¸€å®šä¼šåŒæ­¥æ›´æ–°ï¼ˆå¼‚æ­¥æ›´æ–°ï¼‰</li>
</ol>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">å®é™…ä¸Šreactçš„å¼‚æ­¥æ›´æ–°é€šè¿‡ä¸€ä¸ªé˜Ÿåˆ—æœºåˆ¶æ¥å®ç°ï¼Œå½“æ‰§è¡Œ<span class="keyword">state</span>æ—¶ éœ€è¦å°†æ›´æ–°çš„<span class="keyword">state</span>åˆå¹¶åæ”¾å…¥çŠ¶æ€é˜Ÿåˆ—è€Œä¸ä¼šç«‹åˆ»æ›´æ–° é˜Ÿåˆ—æœºåˆ¶å¯ä»¥é«˜æ•ˆçš„æ‰¹é‡æ›´æ–°<span class="keyword">state</span> å¦‚æœåœ¨éæ„é€ æ–¹æ³•é‡Œæ›´æ”¹å€¼  ç±»ä¼¼ this.<span class="keyword">state</span>.name='yishu' æ˜¯ä¸ä¼šè¢«æ”¾åˆ°çŠ¶æ€é˜Ÿåˆ—ä¸­ å½“ä¸‹æ¬¡è°ƒç”¨<span class="built_in">set</span>Stateå¹¶å¯¹çŠ¶æ€é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ—¶ å°†ä¼šå¿½ç•¥å®ƒè€Œé€ æˆæ— æ³•é¢„çŸ¥çš„é”™è¯¯</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>setStateåœ¨Reactç”Ÿå‘½å‘¨æœŸå’Œåˆæˆäº‹ä»¶ä¸­æ‰¹é‡è¦†ç›–æ‰§è¡Œ</li>
</ol>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">åœ¨Reactçš„ç”Ÿå‘½å‘¨æœŸé’©å­å’Œåˆæˆäº‹ä»¶ä¸­ï¼Œå¤šæ¬¡æ‰§è¡Œ<span class="keyword">set</span>Stateï¼Œä¼šæ‰¹é‡æ‰§è¡Œï¼Œå¤šæ¬¡åŒæ­¥æ‰§è¡Œçš„<span class="keyword">set</span>Stateï¼Œä¼šè¿›è¡Œåˆå¹¶ï¼Œç±»ä¼¼äºObject.assign</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>setStateåœ¨åŸç”Ÿäº‹ä»¶ï¼ŒsetTimeoutï¼ŒsetIntervalï¼ŒPromiseç­‰å¼‚æ­¥æ“ä½œä¸­ï¼Œstateä¼šåŒæ­¥æ›´æ–°</li>
</ol>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">å½“æ‰§è¡Œåˆ° <span class="built_in">set</span>Timeout çš„æ—¶å€™ï¼ŒæŠŠå®ƒä¸¢åˆ°åˆ—é˜Ÿé‡Œï¼Œå¹¶æ²¡æœ‰å»æ‰§è¡Œï¼Œè€Œæ˜¯å…ˆæ‰§è¡Œçš„ finally ä¸»è¿›ç¨‹ä»£ç å—ï¼Œç­‰ finally æ‰§è¡Œå®Œäº†ï¼Œ isBatchingUpdates åˆå˜ä¸ºäº† false ï¼Œå¯¼è‡´æœ€åå»æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ <span class="built_in">set</span>State æ—¶å€™ï¼Œ requestWork èµ°çš„æ˜¯å’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·çš„ expirationTime === Sync ifåˆ†æ”¯ï¼Œæ‰€ä»¥è¡¨ç°å°±ä¼šå’ŒåŸç”Ÿäº‹ä»¶ä¸€æ ·ï¼Œå¯ä»¥åŒæ­¥æ‹¿åˆ°æœ€æ–°çš„<span class="keyword">state</span>çš„å€¼ã€‚</span><br></pre></td></tr></table></figure>
<p>å…³äºsetStateè¿™ä¸ªæ–¹æ³• æºç è®°è½½</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ReactComponent.prototype.setState = <span class="function"><span class="keyword">function</span><span class="params">(partialState, callback)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="keyword">this</span>.updater.enqueueSetState(<span class="keyword">this</span>, partialState);</span><br><span class="line">  <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">    <span class="keyword">this</span>.updater.enqueueCallback(<span class="keyword">this</span>, callback, <span class="string">'setState'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">  enqueueSetState: <span class="function"><span class="keyword">function</span><span class="params">(publicInstance, partialState)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">    <span class="keyword">var</span> queue =internalInstance._pendingStateQueue ||</span><br><span class="line">      (internalInstance._pendingStateQueue = []);</span><br><span class="line">    queue.push(partialState);</span><br><span class="line"></span><br><span class="line">    enqueueUpdate(internalInstance);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<p>setStateæ–¹æ³•å®é™…ä¸Šä¼šæ‰§è¡Œ <code>enqueueSetState</code>æ–¹æ³• é€šè¿‡<code>_pendingStateQueue</code>æ›´æ–°é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ“ä½œ æœ€ç»ˆé€šè¿‡<code>enqueueUpdate</code>æ‰§è¡Œstateæ›´æ–°</p>
<h2 id="setStateè°ƒç”¨æ ˆ"><a href="#setStateè°ƒç”¨æ ˆ" class="headerlink" title="setStateè°ƒç”¨æ ˆ"></a>setStateè°ƒç”¨æ ˆ</h2><p><img src="/images/setState/setState1.png" alt></p>
<p>å¦‚å›¾ï¼šé€šè¿‡å˜é‡isBatchingUpdate æ¥å†³å®šå½“å‰æ˜¯åº”è¯¥èµ°æ‰¹é‡æ›´æ–° è¿˜æ˜¯ç«‹å³æ›´æ–° ä¸ºtrueæ—¶ è¯´æ˜å½“å‰åœ¨æ‰¹é‡æ›´æ–°æ¨¡å¼ ä¸ºfalseçš„è¯ ä¼šç«‹å³æ›´æ–°</p>
<p>ä¸ºäº†æ›´å¥½çš„ç†è§£ æ¶‰åŠåˆ°éƒ¨åˆ†æºç </p>
<p>enqueueUpdate ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enqueueUpdate</span><span class="params">(component)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœä¸å¤„äºæ‰¹é‡æ›´æ–°æ¨¡å¼ æ›´æ–°</span></span><br><span class="line">  <span class="keyword">if</span> (!batchingStrategy.isBatchingUpdates) &#123;</span><br><span class="line">batchingStrategy.batchedUpdates(enqueueUpdate, component);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å¦‚æœå¤„äºæ‰¹é‡æ›´æ–°æ¨¡å¼ åˆ™å°†è¯¥ç»„ä»¶ä¿å­˜åœ¨ dirtyComponents ä¸­</span></span><br><span class="line">  dirtyComponents.push(component);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿™ä¸ª<code>batchingStrategy</code>ç©¶ç«Ÿæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ å…¶å®å®ƒåªæ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œå®šä¹‰äº† isBatchingUpdates å’Œ batchedUpdates æ–¹æ³• å…¶ä¸­transaction.perform çš„è°ƒç”¨ æ¶‰åŠåˆ°äº†<font color="red">äº‹åŠ¡</font>çš„æ¦‚å¿µ</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// batchedUpdates æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> ReactDefaultBatchingStrategy = &#123;</span><br><span class="line">  isBatchingUpdates: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">   batchedUpdates: <span class="function"><span class="keyword">function</span><span class="params">(callback, a, b, c, d, e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> alreadyBatchingUpdates = ReactDefaultBatchingStrategy.isBatchingUpdates;</span><br><span class="line"></span><br><span class="line">    ReactDefaultBatchingStrategy.isBatchingUpdates = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (alreadyBatchingUpdates) &#123;</span><br><span class="line">      callback(a, b, c, d, e);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      transaction.perform(callback, <span class="literal">null</span>, a, b, c, d, e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="äº‹åŠ¡æœºåˆ¶"><a href="#äº‹åŠ¡æœºåˆ¶" class="headerlink" title="äº‹åŠ¡æœºåˆ¶"></a>äº‹åŠ¡æœºåˆ¶</h2><p>äº‹åŠ¡å°±æ˜¯å°†éœ€è¦æ‰§è¡Œçš„æ–¹æ³•ä½¿ç”¨wrapperå°è£…èµ·æ¥ å†é€šè¿‡äº‹åŠ¡æä¾›çš„performæ–¹æ³•æ‰§è¡Œ<br><img src="/images/setState/setState2.png" alt><br>æ‰§è¡Œ perform ä¹‹å‰ å…ˆæ‰§è¡Œ  wrapper ä¸­çš„initæ–¹æ³• æ‰§è¡Œå®Œ performä¹‹å å†æ‰§è¡Œ æ‰€æœ‰çš„closeæ–¹æ³•<br>å‡å¦‚æœ‰ä¸€ä¸ªäº‹åŠ¡ test æ‰§è¡Œé¡ºåºè¡¨ç°ä¸º </p>
<p><code>init-&gt;test-&gt;close</code></p>
<h2 id="æ­ç§˜setStateæœºåˆ¶"><a href="#æ­ç§˜setStateæœºåˆ¶" class="headerlink" title="æ­ç§˜setStateæœºåˆ¶"></a>æ­ç§˜setStateæœºåˆ¶</h2><p>é‚£ä¹ˆ è¯´äº†è¿™ä¹ˆå¤šï¼Œäº‹åŠ¡æ˜¯æ€ä¹ˆå¯¼è‡´å‰é¢æ‰€è¿°çš„setStateçš„å„ç§ä¸åŒè¡¨ç°å‘¢.</p>
<p>åœ¨æ•´ä¸ªReactç»„ä»¶æ¸²æŸ“åˆ°Domä¸­çš„è¿‡ç¨‹å°±å¤„äºä¸€ä¸ªå¤§çš„äº‹åŠ¡ä¸­ ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸå’Œåˆæˆäº‹ä»¶æ‰§è¡Œå‰åéƒ½ä¼šæ‰§è¡Œinit å’Œ closeï¼Œinitä¼šè°ƒç”¨batchedUpdateæ–¹æ³•å°†isBatchingUpdateså˜é‡ç½®ä¸ºtrueï¼Œå¼€å¯æ‰¹é‡æ›´æ–°ï¼Œè€Œcloseä¼šå°†isBatchingUpdatesç½®ä¸ºfalseï¼ŒsetStateçš„æ›´æ–°ä¼šè¢«å­˜å…¥é˜Ÿåˆ—ä¸­ï¼Œå¾…åŒæ­¥ä»£ç æ‰§è¡Œå®Œåï¼Œå†æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„stateæ›´æ–°ã€‚</p>
<p>è€Œåœ¨åŸç”Ÿäº‹ä»¶å’Œå¼‚æ­¥æ“ä½œä¸­ï¼Œä¸ä¼šæ‰§è¡Œpreé’©å­ï¼Œæˆ–è€…ç”Ÿå‘½å‘¨æœŸçš„ä¸­çš„å¼‚æ­¥æ“ä½œä¹‹å‰æ‰§è¡Œäº†preé’©å­ï¼Œä½†æ˜¯posé’©å­ä¹Ÿåœ¨å¼‚æ­¥æ“ä½œä¹‹å‰æ‰§è¡Œå®Œäº†ï¼ŒisBatchingUpdateså¿…å®šä¸ºfalseï¼Œä¹Ÿå°±ä¸ä¼šè¿›è¡Œæ‰¹é‡æ›´æ–°</p>
<h2 id="è·å–æ­£ç¡®çš„stateå€¼"><a href="#è·å–æ­£ç¡®çš„stateå€¼" class="headerlink" title="è·å–æ­£ç¡®çš„stateå€¼"></a>è·å–æ­£ç¡®çš„stateå€¼</h2><p>ä»¥ä¸‹ï¼š</p>
<ol>
<li>setStateå‡½æ•°å¼</li>
<li>æ”¾åˆ°setTimeoutï¼ŒPromiseç­‰å¼‚æ­¥ä¸­æ‰§è¡Œ</li>
<li>æ”¾åˆ°componentDidUpdateä¸­</li>
</ol>
<h2 id="è¯´åœ¨æœ€åçš„è¯"><a href="#è¯´åœ¨æœ€åçš„è¯" class="headerlink" title="è¯´åœ¨æœ€åçš„è¯"></a>è¯´åœ¨æœ€åçš„è¯</h2><p>æ‰€ä»¥ å¼€ç¯‡çš„ç»“æœåº”è¯¥å¯ä»¥ç†è§£äº†å§</p>
<p>æˆ‘ä»¬æŠŠdidMountä¸­å››æ¬¡è°ƒç”¨å½’ç±»ï¼Œå‰ä¸¤æ¬¡ä¸€ç±» å› ä¸ºå®ƒä»¬åœ¨åŒä¸€ä¸ªè°ƒç”¨æ ˆä¸­æ‰§è¡Œ setTimeoutä¸­çš„ä¸¤æ¬¡å±äºå¦ä¸€ç±»ï¼Œæˆ‘ä»¬é‡ç‚¹çœ‹ç¬¬ä¸€ç±»ï¼Œæ—©åœ¨setStateè°ƒç”¨ä¹‹å‰  ReactDefaultBatchingStrategy.isBatchingUpdateså·²ç»è¢«è®¾ç½®ä¸ºtrueï¼Œæ‰€ä»¥ä¸¤æ¬¡çš„setSateå¹¶æ²¡æœ‰ç”Ÿæ•ˆ è€Œæ˜¯è¢«æ”¾è¿›äº†é˜Ÿåˆ—ä¸­<br>å†çœ‹setTimeoutä¸­çš„ä¸¤æ¬¡state æ­¤æ—¶çš„isBatchingUpdatesä¸ºfalseï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†å¿ƒçš„stateé©¬ä¸Šç”Ÿæ•ˆ æ²¡æœ‰èµ°åˆ°é˜Ÿåˆ—çš„åˆ†æ”¯ï¼ˆå¯å‚è€ƒè°ƒç”¨æ ˆå›¾ï¼‰ä¹Ÿå°±æ˜¯è¯´ ç¬¬ä¸€æ¬¡æ‰§è¡ŒsetStateæ—¶ å€¼å°±ä¸º1 åŠ 1ä¹‹åå˜ä¸º2 ç¬¬äºŒæ¬¡æ‰“å°åŒç†</p>
<p>å‚è€ƒï¼šæ·±å…¥reactæŠ€æœ¯æ ˆä¸€ä¹¦ å¸Œæœ›é€šè¿‡setState æ·±å…¥æºç  çŸ¥å…¶ç„¶ä¹ŸçŸ¥å…¶æ‰€ä»¥ç„¶</p>
]]></content>
      <categories>
        <category>react</category>
      </categories>
  </entry>
  <entry>
    <title>æ·±å…¥ç†è§£Javascript ç³»åˆ—ä¸€ï¼šç¼–å†™é«˜è´¨é‡ä»£ç çš„åŸºæœ¬è¦ç‚¹</title>
    <url>/2018/03/20/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3js%E7%B3%BB%E5%88%97%E4%B8%80/</url>
    <content><![CDATA[<p><a href="http://www.cnblogs.com/TomXu/archive/2011/12/28/2286877.html" target="_blank" rel="noopener">æ±¤å§†å¤§å”çš„åŸæ–‡é“¾æ¥</a></p>
<a id="more"></a>
<h2 id="ä¹¦å†™å¯ç»´æŠ¤çš„ä»£ç "><a href="#ä¹¦å†™å¯ç»´æŠ¤çš„ä»£ç " class="headerlink" title="ä¹¦å†™å¯ç»´æŠ¤çš„ä»£ç "></a>ä¹¦å†™å¯ç»´æŠ¤çš„ä»£ç </h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç›®æ ‡ï¼šå¯è¯»çš„ ä¸€è‡´çš„ å¯é¢„æµ‹çš„ çœ‹ä¸Šå»å°±åƒæ˜¯åŒä¸€ä¸ªäººå†™çš„</span><br></pre></td></tr></table></figure>
<h2 id="jsçš„å˜é‡é—®é¢˜"><a href="#jsçš„å˜é‡é—®é¢˜" class="headerlink" title="jsçš„å˜é‡é—®é¢˜"></a>jsçš„å˜é‡é—®é¢˜</h2><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">jsé€šè¿‡å‡½æ•°ç®¡ç†ä½œç”¨åŸŸ</span><br><span class="line">åœ¨ä»»ä½•å‡½æ•°å¤–é¢ä¸Šå£°æ˜çš„å˜é‡ æˆ–è€… ä¸å£°æ˜å°±ç›´æ¥ä½¿ç”¨çš„ï¼ˆéšå«çš„å…¨å±€æ¦‚å¿µï¼‰ å‡ä¸ºå…¨å±€å˜é‡</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> uu; <span class="comment">// æ˜¾å¼å…¨å±€å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span><span class="params">(x, y)</span> </span>&#123;</span><br><span class="line">   <span class="comment">// ä¸æ¨èå†™æ³•: éšå¼å…¨å±€å˜é‡</span></span><br><span class="line">   result = x + y;</span><br><span class="line">   <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ›å»ºéšå¼å…¨å±€å˜é‡ åä¾‹ï¼Œå‹¿ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> a = b = <span class="number">0</span>;å‘ç”Ÿçš„åŸå› æ˜¯ è¿™ä¸ªä»å³å¾€å·¦èµ‹å€¼ b = <span class="number">0</span>  æ­¤æ—¶ bæ˜¯æœªå£°æ˜çš„</span><br><span class="line">   ç›¸å½“äº</span><br><span class="line">   <span class="keyword">var</span> a = (b = <span class="number">0</span>);</span><br><span class="line">   ä½ å¯ä»¥è¿™ä¸ªå®šä¹‰å±€éƒ¨å˜é‡ï¼ˆæ­£ç¡®å†™æ³•ï¼‰</span><br><span class="line">   <span class="keyword">var</span> a, b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="éšå¼å…¨å±€å˜é‡-ä¸æ˜¾å¼å…¨å±€å˜é‡çš„å·®å¼‚"><a href="#éšå¼å…¨å±€å˜é‡-ä¸æ˜¾å¼å…¨å±€å˜é‡çš„å·®å¼‚" class="headerlink" title="éšå¼å…¨å±€å˜é‡ ä¸æ˜¾å¼å…¨å±€å˜é‡çš„å·®å¼‚"></a><font color="green">éšå¼å…¨å±€å˜é‡ ä¸æ˜¾å¼å…¨å±€å˜é‡çš„å·®å¼‚</font></h4><ul>
<li>é€šè¿‡varåˆ›å»ºçš„å…¨å±€å˜é‡æ˜¯ä¸èƒ½è¢«åˆ é™¤çš„</li>
<li>æ— varåˆ›å»ºçš„éšå¼å…¨å±€å˜é‡ æ˜¯èƒ½è¢«åˆ é™¤çš„</li>
</ul>
<h6 id="å…³äºéšå¼å…¨å±€å˜é‡çš„è§£é‡Š"><a href="#å…³äºéšå¼å…¨å±€å˜é‡çš„è§£é‡Š" class="headerlink" title="å…³äºéšå¼å…¨å±€å˜é‡çš„è§£é‡Š"></a>å…³äºéšå¼å…¨å±€å˜é‡çš„è§£é‡Š</h6><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">ä¸ç®¡ä¸€ä¸ªå˜é‡æœ‰æ²¡æœ‰ç”¨è¿‡ï¼ŒJavaScriptè§£é‡Šå™¨åå‘éå†ä½œç”¨åŸŸé“¾æ¥æŸ¥æ‰¾æ•´ä¸ªå˜é‡çš„<span class="keyword">var</span>å£°æ˜ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°<span class="keyword">var</span>ï¼Œè§£é‡Šå™¨åˆ™å‡å®šè¯¥å˜é‡æ˜¯å…¨å±€å˜é‡ï¼Œå¦‚æœè¯¥å˜é‡ç”¨äºäº†èµ‹å€¼æ“ä½œçš„è¯ï¼Œä¹‹å‰å¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œè§£é‡Šå™¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºå®ƒï¼Œè¿™å°±æ˜¯è¯´åœ¨åŒ¿åé—­åŒ…é‡Œä½¿ç”¨æˆ–åˆ›å»ºå…¨å±€å˜é‡éå¸¸å®¹æ˜“ é¿å…åˆ›å»ºå¼å…¨å±€å˜é‡ æ–¹å¼</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="params">($, YAHOO)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œï¼Œæˆ‘ä»¬çš„ä»£ç å°±å¯ä»¥ä½¿ç”¨å…¨å±€çš„jQueryå¯¹è±¡äº†ï¼ŒYAHOOä¹Ÿæ˜¯ä¸€æ ·</span></span><br><span class="line">&#125; (jQuery, YAHOO))</span><br><span class="line">å°†å…¨å±€å˜é‡å½“åšä¸€ä¸ªå‚æ•°ä¼ å…¥åŒ¿åå‡½æ•°å†…ä½¿ç”¨ jqueryæºç å°±ç”¨è¿™ç§æ–¹å¼</span><br></pre></td></tr></table></figure>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">åœ¨æŠ€æœ¯ä¸Š éšå¼å…¨å±€å˜é‡ å¹¶ä¸æ˜¯çœŸæ­£çš„å…¨å±€å˜é‡ ä½†ä»–ä»¬æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§</span><br><span class="line">å±æ€§æ˜¯å¯ä»¥é€šè¿‡<span class="keyword">delete</span> æ“ä½œç¬¦åˆ é™¤çš„</span><br></pre></td></tr></table></figure>
<h4 id="å¦‚ä½•è®¿é—®å…¨å±€å˜é‡"><a href="#å¦‚ä½•è®¿é—®å…¨å±€å˜é‡" class="headerlink" title="å¦‚ä½•è®¿é—®å…¨å±€å˜é‡"></a><font color="green">å¦‚ä½•è®¿é—®å…¨å±€å˜é‡</font></h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ä¸€èˆ¬æƒ…å†µä¸‹ å…¨å±€å¯¹è±¡å¯ä»¥é€šè¿‡<span class="built_in">window</span>å±æ€§åœ¨ä»»ä½•ä½ç½®è®¿é—®</span><br><span class="line">ä¹Ÿå¯ä»¥</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gobal =<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¿™ç§æ–¹æ³•å¯ä»¥éšæ—¶è·å–å…¨å±€å˜é‡ <span class="keyword">this</span>æ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡</span><br></pre></td></tr></table></figure>
<h4 id="å˜é‡ä¸å‡½æ•°çš„é¢„è§£æï¼ˆå˜é‡æå‡ï¼‰"><a href="#å˜é‡ä¸å‡½æ•°çš„é¢„è§£æï¼ˆå˜é‡æå‡ï¼‰" class="headerlink" title="å˜é‡ä¸å‡½æ•°çš„é¢„è§£æï¼ˆå˜é‡æå‡ï¼‰"></a><font color="green">å˜é‡ä¸å‡½æ•°çš„é¢„è§£æï¼ˆå˜é‡æå‡ï¼‰</font></h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> a = <span class="number">1</span>,</span><br><span class="line">       b = <span class="number">2</span>,</span><br><span class="line">       sum = a + b,</span><br><span class="line">       myobject = &#123;&#125;,</span><br><span class="line">       i, <span class="comment">// undefined</span></span><br><span class="line">       j; <span class="comment">//undefined</span></span><br><span class="line">   <span class="comment">// function body...</span></span><br><span class="line">&#125;</span><br><span class="line">å˜é‡åˆå§‹åŒ–å¯ä»¥é˜²æ­¢é€»è¾‘é”™è¯¯ ä¹Ÿè§£å†³äº†<span class="keyword">var</span>æ•£å¸ƒçš„é—®é¢˜</span><br><span class="line"></span><br><span class="line"><span class="comment">// åä¾‹</span></span><br><span class="line">myname = <span class="string">"global"</span>; <span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    alert(myname); <span class="comment">// "undefined"</span></span><br><span class="line">    <span class="keyword">var</span> myname = <span class="string">"local"</span>; <span class="comment">// å£°æ˜mynameçš„å˜é‡è¢«å½“åšå±€éƒ¨å˜é‡é¢„è§£æäº†</span></span><br><span class="line">    alert(myname); <span class="comment">// "local"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ç›¸å½“äº</span><br><span class="line">myname = <span class="string">"global"</span>; <span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> mynameï¼› <span class="comment">// === var myname == undefined</span></span><br><span class="line">     alert(myname); <span class="comment">// "undefined"</span></span><br><span class="line">     myname = <span class="string">"local"</span>;</span><br><span class="line">     alert(myname); <span class="comment">// "local"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ã€å»¶ä¼¸ã€‘js-æ˜¯å¦‚ä½•æ‰§è¡Œçš„"><a href="#ã€å»¶ä¼¸ã€‘js-æ˜¯å¦‚ä½•æ‰§è¡Œçš„" class="headerlink" title="ã€å»¶ä¼¸ã€‘js æ˜¯å¦‚ä½•æ‰§è¡Œçš„"></a><font color="green">ã€å»¶ä¼¸ã€‘js æ˜¯å¦‚ä½•æ‰§è¡Œçš„</font></h4><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">ä»£ç å¤„ç† åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ</span><br><span class="line"><span class="number">1.</span>å˜é‡ å‡½æ•°å£°æ˜ ä»¥åŠ æ­£å¸¸æ ¼å¼çš„å‚æ•°åˆ›å»º è¿™æ˜¯ä¸€ä¸ªè§£æå’Œè¿›å…¥ä¸Šä¸‹æ–‡çš„é˜¶æ®µ</span><br><span class="line"><span class="number">2.</span>ä»£ç æ‰§è¡Œ å‡½æ•°è¡¨è¾¾å¼å’Œ å£°æ˜çš„å˜é‡è¢«åˆ›å»º</span><br></pre></td></tr></table></figure>
<h2 id="jsçš„å¾ªç¯é—®é¢˜"><a href="#jsçš„å¾ªç¯é—®é¢˜" class="headerlink" title="jsçš„å¾ªç¯é—®é¢˜"></a>jsçš„å¾ªç¯é—®é¢˜</h2><h4 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h4><figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line">ç¼“å­˜ æ•°ç»„ ä»¥åŠ HTMLCollection çš„é•¿åº¦</span><br><span class="line">å½“è¦å¾ªç¯çš„æ˜¯ä¸€ä¸ªé›†åˆå¯¹è±¡æ—¶å€™ å¦‚æœä¸ç¼“å­˜é•¿åº¦ ä½ è¦å®æ—¶æŸ¥è¯¢Dom è€ŒDomæ“ä½œä¸€èˆ¬æ¥è®²æ¯”è¾ƒæ˜‚è´µ</span><br><span class="line"></span><br><span class="line">åƒè¿™æ ·</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (var i = <span class="number">0</span>, <span class="built_in">max</span> = myarray.<span class="built_in">length</span>; i &lt; <span class="built_in">max</span>; i++) &#123;</span><br><span class="line">   <span class="comment">// ä½¿ç”¨myarray[i]åšç‚¹ä»€ä¹ˆ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å°½é‡ä¸è¦ä½¿ç”¨i++</span><br><span class="line">åƒè¿™æ ·å„¿</span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span></span><br><span class="line">i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">è¿˜æœ‰ä¸¤ç§æ”¹è¿›å½¢å¼ï¼ˆå‚è€ƒï¼‰</span><br><span class="line">å°‘äº†ä¸€ä¸ªå˜é‡(æ— <span class="built_in">max</span>)</span><br><span class="line">å‘ä¸‹æ•°åˆ°<span class="number">0</span>ï¼Œé€šå¸¸æ›´å¿«ï¼Œå› ä¸ºå’Œ<span class="number">0</span>åšæ¯”è¾ƒè¦æ¯”å’Œæ•°ç»„é•¿åº¦æˆ–æ˜¯å…¶ä»–ä¸æ˜¯<span class="number">0</span>çš„ä¸œè¥¿ä½œæ¯”è¾ƒæ›´æœ‰æ•ˆç‡</span><br><span class="line"></span><br><span class="line">åƒè¿™æ ·</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ç§å˜åŒ–çš„å½¢å¼ï¼š</span></span><br><span class="line"></span><br><span class="line">var i, myarray = [];</span><br><span class="line"><span class="keyword">for</span> (i = myarray.<span class="built_in">length</span>; iâ€“-;) &#123;</span><br><span class="line">  <span class="comment">//....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§ä½¿ç”¨whileå¾ªç¯ï¼š</span></span><br><span class="line"></span><br><span class="line">var myarray = [],</span><br><span class="line">    i = myarray.<span class="built_in">length</span>;</span><br><span class="line"><span class="keyword">while</span> (iâ€“-) &#123;</span><br><span class="line">   <span class="comment">// ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="for-inå¾ªç¯"><a href="#for-inå¾ªç¯" class="headerlink" title="for-inå¾ªç¯"></a>for-inå¾ªç¯</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ä¹Ÿç§° â€˜æšä¸¾â€™ åº”è¯¥ç”¨åœ¨éæ•°ç»„å¯¹è±¡çš„éå†ä¸Š ä¸æ¨èç”¨æ¥å¾ªç¯æ•°ç»„ï¼ˆæ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ ä½†æ˜¯ <span class="keyword">for</span>-<span class="keyword">in</span>ä¸­ å±æ€§åˆ—è¡¨çš„é¡ºåºæ˜¯ä¸èƒ½ä¿è¯çš„ï¼‰</span><br><span class="line"></span><br><span class="line">å€¼å¾—è¯´æ˜çš„æ˜¯ æˆ‘ä»¬å¹³å¸¸è€æ˜¯å¿½ç•¥ä¸€ä¸ªå¾ˆé‡è¦çš„æ–¹æ³•</span><br><span class="line">hasOwnProperty() éå†å¯¹è±¡å±æ€§çš„æ—¶å€™å¯ä»¥è¿‡æ»¤æ‰ä»åŸå‹é“¾ä¸Šä¸‹æ¥çš„å±æ€§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> man = &#123;</span><br><span class="line">	    hands:<span class="number">2</span>,</span><br><span class="line">		legs:<span class="number">2</span>,</span><br><span class="line">		heads:<span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Object</span>.prototype.clone === <span class="string">'undefined'</span>)&#123;</span><br><span class="line">	    <span class="built_in">Object</span>.prototype.clone = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	        <span class="comment">//ã€‚ã€‚ã€‚ã€‚</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//	ä¸ºäº†é¿å…æšä¸¾ å‡ºç°cloneæ–¹æ³•</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> man) &#123;</span><br><span class="line"><span class="comment">//	    æ–¹å¼ä¸€ è¿‡æ»¤åŸå‹å±æ€§</span></span><br><span class="line">	    <span class="keyword">if</span> (man.hasOwnProperty(i)) &#123;</span><br><span class="line"><span class="comment">//            console.log(i, "1:", man[i]);</span></span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		æ–¹å¼äºŒ å–æ¶ˆObjectã€‚prototypeä¸Šçš„æ–¹æ³•</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(man,i))&#123;</span><br><span class="line"><span class="comment">//            console.log(i, "1:", man[i]);</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//æˆ–è€… é¿å…é•¿å±æ€§æŸ¥æ‰¾</span></span><br><span class="line">		<span class="keyword">var</span> hasOwn = <span class="built_in">Object</span>.prototype.hasOwnProperty;</span><br><span class="line">        <span class="keyword">if</span> (hasOwn.call(man,i))&#123;</span><br><span class="line"><span class="comment">//            console.log(i, "1:", man[i]);</span></span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç»™åŸå‹è‡ªå®šä¹‰æ·»åŠ æ–¹æ³•"><a href="#ç»™åŸå‹è‡ªå®šä¹‰æ·»åŠ æ–¹æ³•" class="headerlink" title="ç»™åŸå‹è‡ªå®šä¹‰æ·»åŠ æ–¹æ³•"></a>ç»™åŸå‹è‡ªå®šä¹‰æ·»åŠ æ–¹æ³•</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Object</span>.prototype.myMethod ï¼==<span class="string">"function"</span>)&#123;</span><br><span class="line">    <span class="built_in">Object</span>.prototype.myMethod = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="é¿å…éšå¼ç±»å‹è½¬æ¢"><a href="#é¿å…éšå¼ç±»å‹è½¬æ¢" class="headerlink" title="é¿å…éšå¼ç±»å‹è½¬æ¢"></a>é¿å…éšå¼ç±»å‹è½¬æ¢</h2><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">jså˜é‡åœ¨æ¯”è¾ƒæ—¶ä¼šéšå¼ç±»å‹è½¬æ¢</span><br><span class="line">ä¸ºäº†é¿å…å¼•èµ·æ··ä¹±çš„éšå¼ç±»å‹è½¬æ¢ æ¯”è¾ƒå€¼å’Œè¡¨è¾¾å¼ç±»å‹çš„æ—¶å€™å§‹ç»ˆä½¿ç”¨</span><br><span class="line"><span class="section">=== å’Œ !== æ“ä½œç¬¦</span></span><br></pre></td></tr></table></figure>
<h2 id="é¿å…-eval-ä¸ç»™-ç»™setInterval-setTimeout-å’ŒFunction-æ„é€ å‡½æ•°ä¼ é€’å­—ç¬¦ä¸²"><a href="#é¿å…-eval-ä¸ç»™-ç»™setInterval-setTimeout-å’ŒFunction-æ„é€ å‡½æ•°ä¼ é€’å­—ç¬¦ä¸²" class="headerlink" title="é¿å… eval() ä¸ç»™ ç»™setInterval(), setTimeout()å’ŒFunction()æ„é€ å‡½æ•°ä¼ é€’å­—ç¬¦ä¸²"></a>é¿å… eval() ä¸ç»™ ç»™setInterval(), setTimeout()å’ŒFunction()æ„é€ å‡½æ•°ä¼ é€’å­—ç¬¦ä¸²</h2><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åé¢ç¤ºä¾‹</span></span><br><span class="line">setTimeout(<span class="string">"myFunc()"</span>, <span class="number">1000</span>);</span><br><span class="line">setTimeout(<span class="string">"myFunc(1, 2, 3)"</span>, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´å¥½çš„</span></span><br><span class="line">setTimeout(myFunc, <span class="number">1000</span>);</span><br><span class="line">setTimeout(function () &#123;</span><br><span class="line">   myFunc(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<h2 id="parseInt-æ•°å€¼è½¬æ¢ä¸åº”è¯¥å¿½ç•¥ç¬¬äºŒä¸ªå‚æ•°"><a href="#parseInt-æ•°å€¼è½¬æ¢ä¸åº”è¯¥å¿½ç•¥ç¬¬äºŒä¸ªå‚æ•°" class="headerlink" title="parseInt()æ•°å€¼è½¬æ¢ä¸åº”è¯¥å¿½ç•¥ç¬¬äºŒä¸ªå‚æ•°"></a>parseInt()æ•°å€¼è½¬æ¢ä¸åº”è¯¥å¿½ç•¥ç¬¬äºŒä¸ªå‚æ•°</h2><figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">åœ¨ECMAScript <span class="number">3</span>ä¸­ï¼Œå¼€å¤´ä¸ºâ€<span class="number">0</span>â€³çš„å­—ç¬¦ä¸²è¢«å½“åš<span class="number">8</span>è¿›åˆ¶å¤„ç†äº†ï¼Œä½†è¿™å·²åœ¨ECMAScript <span class="number">5</span>ä¸­æ”¹å˜äº†ã€‚ä¸ºäº†é¿å…çŸ›ç›¾å’Œæ„å¤–çš„ç»“æœï¼Œæ€»æ˜¯æŒ‡å®šåŸºæ•°å‚æ•°</span><br><span class="line"></span><br><span class="line"><span class="built_in">var</span> <span class="built_in">month</span> = <span class="string">"06"</span>,</span><br><span class="line">    <span class="built_in">year</span> = <span class="string">"09"</span>;</span><br><span class="line"><span class="built_in">month</span> = parseInt(<span class="built_in">month</span>, <span class="number">10</span>);</span><br><span class="line"><span class="built_in">year</span> = parseInt(<span class="built_in">year</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h2 id="ç¼–ç è§„èŒƒ"><a href="#ç¼–ç è§„èŒƒ" class="headerlink" title="ç¼–ç è§„èŒƒ"></a>ç¼–ç è§„èŒƒ</h2><ul>
<li>ç¼–ç è§„èŒƒ</li>
<li>ä»£ç ç¼©è¿›</li>
<li>æŠ€æœ¯ä¸Šå¯ä»¥çœç•¥çš„èŠ±æ‹¬å·( åªæœ‰ä¸€æ¡è¯­å¥çš„forå¾ªç¯{}) ä¹Ÿä¸è¦çœç•¥</li>
<li>ä¸è¦çœç•¥åˆ†å·;</li>
<li>å·¦èŠ±æ‹¬å·çš„ä½ç½®</li>
<li>é€‚å½“çš„åœ°æ–¹ä½¿ç”¨ç©ºæ ¼ â€“ åˆ—è¡¨æ¨¡æ ·è¡¨è¾¾å¼ï¼ˆç›¸å½“äºé€—å·ï¼‰å’Œç»“æŸè¯­å¥ï¼ˆç›¸å¯¹äºå®Œæˆäº†â€œæƒ³æ³•â€ï¼‰åé¢æ·»åŠ é—´éš”</li>
<li>å‘½åè§„èŒƒ</li>
<li>æ³¨é‡Š</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">if (true) &#123;</span><br><span class="line">   alert("It's TRUE!");</span><br><span class="line">&#125;</span><br><span class="line">æˆ–è€…</span><br><span class="line">if (true)</span><br><span class="line">&#123;</span><br><span class="line">   alert("It's TRUE!");</span><br><span class="line">&#125;</span><br><span class="line">ä½†æ˜¯å¦‚æœè¦è¿”å›ä¸€ä¸ªå¯¹è±¡è‡ªå˜é‡çš„è¯</span><br><span class="line">function func() &#123;</span><br><span class="line">   return  // === return undefined;</span><br><span class="line">  // ä¸‹é¢ä»£ç ä¸æ‰§è¡Œ</span><br><span class="line">   &#123;</span><br><span class="line">      name : "Batman"</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ç»“è®º</span><br><span class="line">æ€»ä¹‹ï¼Œæ€»æ˜¯ä½¿ç”¨èŠ±æ‹¬å·ï¼Œå¹¶å§‹ç»ˆæŠŠåœ¨ä¸ä¹‹å‰çš„è¯­å¥æ”¾åœ¨åŒä¸€è¡Œï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ç©ºæ ¼</span><br><span class="line"></span><br><span class="line">forå¾ªç¯åˆ†å·åˆ†å¼€åçš„çš„éƒ¨åˆ†ï¼šå¦‚for (var i = 0; i &lt; 10; i += 1) &#123;...&#125;</span><br><span class="line">forå¾ªç¯ä¸­åˆå§‹åŒ–çš„å¤šå˜é‡(iå’Œmax)ï¼šfor (var i = 0, max = 10; i &lt; max; i += 1) &#123;...&#125;</span><br><span class="line">åˆ†éš”æ•°ç»„é¡¹çš„é€—å·çš„åé¢ï¼švar a = [1, 2, 3];</span><br><span class="line">å¯¹è±¡å±æ€§é€—å·çš„åé¢ä»¥åŠåˆ†éš”å±æ€§åå’Œå±æ€§å€¼çš„å†’å·çš„åé¢ï¼švar o = &#123;a: 1, b: 2&#125;;</span><br><span class="line">é™å®šå‡½æ•°å‚æ•°ï¼šmyFunc(a, b, c)</span><br><span class="line">å‡½æ•°å£°æ˜çš„èŠ±æ‹¬å·çš„å‰é¢ï¼šfunction myFunc() &#123;&#125;</span><br><span class="line">åŒ¿åå‡½æ•°è¡¨è¾¾å¼functionçš„åé¢ï¼švar myFunc = function () &#123;&#125;;</span><br><span class="line">èŠ±æ‹¬å·çš„é—´è·  æœ€å¥½ä½¿ç”¨ç©ºæ ¼</span><br><span class="line">æœ‰ä¸€ä¸ªç»å¸¸è¢«å¿½ç•¥çš„ä»£ç å¯è¯»æ€§æ–¹é¢æ˜¯å‚ç›´ç©ºæ ¼çš„ä½¿ç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ç©ºè¡Œæ¥åˆ†éš”ä»£ç å•å…ƒï¼Œå°±åƒæ˜¯æ–‡å­¦ä½œå“ä¸­ä½¿ç”¨æ®µè½åˆ†éš”ä¸€æ ·ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å‘½åè§„èŒƒ</span><br><span class="line"></span><br><span class="line">ä»¥å¤§å†™å­—æ¯å†™æ„é€ å‡½æ•°(Capitalizing Constructors)</span><br><span class="line"></span><br><span class="line">getName() å…¬å…±æ–¹æ³•</span><br><span class="line">_getFirst() ç§æœ‰æ–¹æ³•</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±å…¥ç†è§£Javascript ç³»åˆ—äºŒï¼šæ­ç§˜å‘½åå‡½æ•°è¡¨è¾¾å¼</title>
    <url>/2018/03/20/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3js%E7%B3%BB%E5%88%97%E4%BA%8C/</url>
    <content><![CDATA[<p><a href="http://www.cnblogs.com/TomXu/archive/2011/12/29/2290308.html" target="_blank" rel="noopener">æ±¤å§†å¤§å”çš„åŸæ–‡é“¾æ¥</a></p>
<a id="more"></a>
<h2 id="å‡½æ•°è¡¨è¾¾å¼-å’Œå‡½æ•°å£°æ˜"><a href="#å‡½æ•°è¡¨è¾¾å¼-å’Œå‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°è¡¨è¾¾å¼ å’Œå‡½æ•°å£°æ˜"></a>å‡½æ•°è¡¨è¾¾å¼ å’Œå‡½æ•°å£°æ˜</h2><h4 id="å‡½æ•°è¡¨è¾¾å¼"><a href="#å‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="å‡½æ•°è¡¨è¾¾å¼"></a>å‡½æ•°è¡¨è¾¾å¼</h4><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">å‡½æ•°åç§°ï¼ˆå¯é€‰ï¼‰ï¼ˆå‚æ•°ï¼šå¯é€‰ï¼‰&#123;å‡½æ•°ä½“&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h4><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">å‡½æ•°åç§°ï¼ˆå‚æ•°ï¼šå¯é€‰ï¼‰&#123;å‡½æ•°ä½“&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="å¦‚ä½•åŒºåˆ†ä¸¤è€…"><a href="#å¦‚ä½•åŒºåˆ†ä¸¤è€…" class="headerlink" title="å¦‚ä½•åŒºåˆ†ä¸¤è€…"></a>å¦‚ä½•åŒºåˆ†ä¸¤è€…</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">å‡½æ•°è¡¨è¾¾å¼ï¼šä¸å£°æ˜å‡½æ•°åç§°å’Œå£°æ˜äº†å‡½æ•°åç§°çš„å…¶ä»–æƒ…å†µ</span><br><span class="line">          å¦‚æœ <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125; æ˜¯ä½œä¸ºèµ‹å€¼è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†çš„è¯</span><br><span class="line">          åƒè¿™æ ·ï¼š</span><br><span class="line">           <span class="number">1.</span><span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125;; <span class="comment">// è¡¨è¾¾å¼ï¼Œå› ä¸ºå®ƒæ˜¯èµ‹å€¼è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†</span></span><br><span class="line">           <span class="number">2.</span><span class="keyword">new</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span></span>&#123;&#125;; <span class="comment">// è¡¨è¾¾å¼ï¼Œå› ä¸ºå®ƒæ˜¯newè¡¨è¾¾å¼</span></span><br><span class="line">           <span class="number">3.</span>è¢«æ‹¬å·æ‹¬ä½çš„(<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125;)ä»–æ˜¯è¡¨è¾¾å¼çš„åŸå› æ˜¯å› ä¸ºæ‹¬å· ()æ˜¯ä¸€ä¸ªåˆ†ç»„æ“ä½œç¬¦ï¼Œå®ƒçš„å†…éƒ¨åªèƒ½åŒ…å«è¡¨è¾¾å¼</span><br><span class="line">            (<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125;); <span class="comment">// å‡½æ•°è¡¨è¾¾å¼ï¼šåŒ…å«åœ¨åˆ†ç»„æ“ä½œç¬¦å†…</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å‡½æ•°å£°æ˜ï¼šå£°æ˜äº†å‡½æ•°åç§°ä¸”<span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125; è¢«åŒ…å«åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…ï¼ˆè§„åˆ™ï¼šåªèƒ½å‡ºç°åœ¨ç¨‹åºæˆ–å‡½æ•°ä½“å†…ï¼‰</span><br><span class="line">            åƒè¿™æ ·</span><br><span class="line">            (<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span></span>&#123;&#125; <span class="comment">// å£°æ˜ï¼Œå› ä¸ºå®ƒæ˜¯å‡½æ•°ä½“çš„ä¸€éƒ¨åˆ†</span></span><br><span class="line">            &#125;)();</span><br><span class="line">        æˆ–è€…ä½äºç¨‹åºæœ€é¡¶éƒ¨çš„è¯</span><br><span class="line">        åƒè¿™æ ·</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125; <span class="comment">// å£°æ˜ï¼Œå› ä¸ºå®ƒæ˜¯ç¨‹åºçš„ä¸€éƒ¨åˆ†</span></span><br></pre></td></tr></table></figure>
<h4 id="ä¸€äº›ç‰¹æ€§"><a href="#ä¸€äº›ç‰¹æ€§" class="headerlink" title="ä¸€äº›ç‰¹æ€§"></a>ä¸€äº›ç‰¹æ€§</h4><figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">å‡½æ•°å£°æ˜:ä¼šåœ¨ä»»ä½•è¡¨è¾¾å¼è¢«è§£æå’Œæ±‚å€¼ä¹‹å‰å…ˆè¢«è§£æå’Œæ±‚å€¼ å³ä½¿ä½ çš„å£°æ˜åœ¨æœ€åä¸€è¡Œ å®ƒä¹Ÿä¼šåœ¨åŒä½œç”¨åŸŸå†…çš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼ä¹‹å‰è¢«è§£æ/æ±‚å€¼</span></span><br></pre></td></tr></table></figure>
<h4 id="å‡½æ•°è¯­å¥"><a href="#å‡½æ•°è¯­å¥" class="headerlink" title="å‡½æ•°è¯­å¥"></a>å‡½æ•°è¯­å¥</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">å‡½æ•°è¯­å¥ä¸æ˜¯åœ¨å˜é‡åˆå§‹åŒ–æœŸé—´å£°æ˜çš„ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶å£°æ˜çš„â€”â€”ä¸å‡½æ•°è¡¨è¾¾å¼ä¸€æ ·ã€‚ä¸è¿‡ï¼Œå‡½æ•°è¯­å¥çš„æ ‡è¯†ç¬¦ä¸€æ—¦å£°æ˜èƒ½åœ¨å‡½æ•°çš„æ•´ä¸ªä½œç”¨åŸŸç”Ÿæ•ˆäº†ã€‚æ ‡è¯†ç¬¦æœ‰æ•ˆæ€§æ­£æ˜¯å¯¼è‡´å‡½æ•°è¯­å¥ä¸å‡½æ•°è¡¨è¾¾å¼ä¸åŒçš„å…³é”®æ‰€åœ¨</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤åˆ»ï¼Œfooè¿˜æ²¡ç”¨å£°æ˜</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'typeof foo1'</span>,<span class="keyword">typeof</span> foo)<span class="comment">// "undefined"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// è¿›å…¥è¿™é‡Œä»¥åï¼Œfooå°±è¢«å£°æ˜åœ¨æ•´ä¸ªä½œç”¨åŸŸå†…äº†</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">'11111'</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä»æ¥ä¸ä¼šèµ°åˆ°è¿™é‡Œï¼Œæ‰€ä»¥è¿™é‡Œçš„fooä¹Ÿä¸ä¼šè¢«å£°æ˜</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">'222'</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">typeof</span> foo; <span class="comment">// "function"</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'typeof foo2'</span>,<span class="keyword">typeof</span> foo)</span><br></pre></td></tr></table></figure>
<h4 id="å‘½åå‡½æ•°è¡¨è¾¾å¼"><a href="#å‘½åå‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="å‘½åå‡½æ•°è¡¨è¾¾å¼"></a>å‘½åå‡½æ•°è¡¨è¾¾å¼</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">å‘½åå‡½æ•°è¡¨è¾¾å¼ï¼Œç†æ‰€å½“ç„¶ï¼Œå°±æ˜¯å®ƒå¾—æœ‰åå­—ï¼Œå‰é¢çš„ä¾‹å­<span class="keyword">var</span> bar = <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;&#125;;å°±æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å‘½åå‡½æ•°è¡¨è¾¾å¼ï¼Œä½†æœ‰ä¸€ç‚¹éœ€è¦è®°ä½ï¼šè¿™ä¸ªåå­—åªåœ¨æ–°å®šä¹‰çš„å‡½æ•°ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œ è¿™å°±æ˜¯ ä¸å‡½æ•°è¯­å¥çš„åŒºåˆ«</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> foo; <span class="comment">// fooæ˜¯åœ¨å†…éƒ¨ä½œç”¨åŸŸå†…æœ‰æ•ˆ</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// fooåœ¨å¤–éƒ¨ç”¨äºæ˜¯ä¸å¯è§çš„</span></span><br><span class="line">  <span class="keyword">typeof</span> foo; <span class="comment">// "undefined"</span></span><br><span class="line">  f(); <span class="comment">// "function"</span></span><br><span class="line"></span><br><span class="line">  å‘½åå‡½æ•°è¡¨è¾¾å¼å‡ºç°çš„æ„ä¹‰ï¼šä¾¿äºè°ƒè¯• è°ƒè¯•å™¨åœ¨è°ƒè¯•çš„æ—¶å€™ä¼šå°†å®ƒçš„åå­—æ˜¾ç¤ºåœ¨è°ƒç”¨çš„æ ˆä¸Š</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>js</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘æ˜“ä¸æ·˜å®ç§»åŠ¨ç«¯é€‚é…å·¥ä½œæµæ€è€ƒä¸€</title>
    <url>/2017/08/09/%E7%BD%91%E6%98%93%E4%B8%8E%E6%B7%98%E5%AE%9D%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E5%B7%A5%E4%BD%9C%E6%B5%81/</url>
    <content><![CDATA[<p>æœ€è¿‘å°è¯•äº†è§£äº†ä¸€äº›ç§»åŠ¨ç«¯çš„æ¦‚å¿µ<br>å¾—ç©ºæ€»ç»“äº†ç½‘æ˜“ä¸æ·˜å®çš„ä¸€äº›é€‚é…æ–¹æ¡ˆï¼Œä¸ºåç»­å·¥ä½œè®°å½•ä¸€ä¸‹<br><a id="more"></a></p>
<p>##ç½‘æ˜“ç§»åŠ¨ç«¯é€‚é…æ–¹æ¡ˆ<br>è¦ç‚¹ï¼š<br><figure class="highlight qml"><table><tr><td class="code"><pre><span class="line">* ç½‘æ˜“é¡µé¢ä¸Šhtmlçš„<span class="built_in">font</span>-<span class="built_in">size</span>ä¸æ˜¯é¢„å…ˆé€šè¿‡åª’ä»‹æŸ¥è¯¢åœ¨cssé‡Œå®šä¹‰å¥½çš„ï¼Œè€Œæ˜¯é€šè¿‡jsè®¡ç®—å‡ºæ¥çš„</span><br><span class="line">* ä¸ºäº†æ–¹ä¾¿ï¼Œå–ä¸€ä¸ª<span class="number">100</span>pxçš„<span class="built_in">font</span>-<span class="built_in">size</span>ä¸ºå‚ç…§</span><br></pre></td></tr></table></figure></p>
<p>æ­¥éª¤ï¼š<br><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>æ‹¿è®¾è®¡ç¨¿ç«–ç€çš„æ¨ªå‘åˆ†è¾¨ç‡é™¤ä»¥<span class="number">100</span>å¾—åˆ°bodyçš„å®½åº¦</span><br><span class="line">  egï¼š  iphone6ï¼Œæ¨ªå‘åˆ†è¾¨ç‡ä¸º<span class="number">750</span>ï¼Œ<span class="built_in">width</span> =<span class="number">750</span> / <span class="number">100</span> = <span class="number">7.5</span>rem</span><br><span class="line">        iphone4/<span class="number">5</span>ï¼Œæ¨ªå‘åˆ†è¾¨ç‡ä¸º<span class="number">640</span>ï¼Œ<span class="built_in">width</span>ä¸º<span class="number">640</span> / <span class="number">100</span> = <span class="number">6.4</span>rem</span><br><span class="line"> <span class="number">2.</span>å¸ƒå±€æ—¶  csså°ºå¯¸ = è®¾è®¡ç¨¿æ ‡æ³¨å°ºå¯¸ï¼<span class="number">100</span></span><br><span class="line">   egï¼š<span class="number">210</span>px = <span class="number">210</span>/<span class="number">100</span> = <span class="number">2.1</span>rem       </span><br><span class="line">  <span class="number">3.</span>   Dom <span class="built_in">ready</span>ä»¥åè·å–htmlçš„font-<span class="built_in">size</span></span><br><span class="line">    âš ï¸ å½“è®¾å¤‡å®½åº¦ï¼ˆdeviceWidthå¤§äºè®¾è®¡ç¨¿çš„æ¨ªå‘åˆ†è¾¨ç‡æ—¶ htmlçš„font-<span class="built_in">size</span>å§‹ç»ˆç­‰äºæ¨ªå‘åˆ†è¾¨ç‡/bodyå…ƒç´ å®½ï¼‰</span><br><span class="line"> ä»£ç ä½“ç°</span><br><span class="line">   var deviceWidth = document.documentElement.clientWidth;</span><br><span class="line">        <span class="built_in">if</span>(deviceWidth &gt; <span class="number">640</span>) deviceWidth = <span class="number">640</span>;</span><br><span class="line">        document.documentElement.style.fontSize = deviceWidth / <span class="number">7.5</span> + <span class="string">'px'</span>;</span><br><span class="line"><span class="number">4.</span>font-<span class="built_in">size</span> å¯èƒ½éœ€è¦é¢å¤–çš„åª’ä½“æŸ¥è¯¢ è€Œä¸”ä¸è¦ç”¨rem</span><br><span class="line"></span><br><span class="line">   @media screen <span class="keyword">and</span> (<span class="built_in">max</span>-<span class="built_in">width</span>:<span class="number">321</span>px)&#123;</span><br><span class="line">           .m-navlist&#123;font-<span class="built_in">size</span>:<span class="number">15</span>px&#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          @media screen <span class="keyword">and</span> (<span class="built_in">min</span>-<span class="built_in">width</span>:<span class="number">321</span>px) <span class="keyword">and</span> (<span class="built_in">max</span>-<span class="built_in">width</span>:<span class="number">400</span>px)&#123;</span><br><span class="line">              .m-navlist&#123;font-<span class="built_in">size</span>:<span class="number">16</span>px&#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          @media screen <span class="keyword">and</span> (<span class="built_in">min</span>-<span class="built_in">width</span>:<span class="number">400</span>px)&#123;</span><br><span class="line">              .m-navlist&#123;font-<span class="built_in">size</span>:<span class="number">18</span>px&#125;</span><br><span class="line">          &#125;</span><br><span class="line"><span class="number">5.</span>å…³äºè§†å£çš„è®¾ç½®</span><br><span class="line">      &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"initial-scale=1,maximum-scale=1, minimum-scale=1"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>#æ·˜å®ç§»åŠ¨ç«¯é€‚é…æ–¹æ¡ˆ<br>è¦ç‚¹ï¼š<br><figure class="highlight nix"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>.è®¾ç½®è§†å£æ ‡ç­¾</span><br><span class="line"> &lt;meta <span class="attr">name="viewport"</span>   <span class="attr">content="width=device-width,</span> <span class="attr">initial-scale=1,</span> <span class="attr">maximum-scale=1,</span> <span class="attr">user-scalable=no"&gt;</span></span><br><span class="line">ä½¿å¾—æ•´ä¸ªç½‘é¡µåœ¨è®¾å¤‡å†…æ˜¾ç¤ºæ—¶é¡µé¢çš„å®½åº¦å§‹ç»ˆç­‰äºè®¾å¤‡å®½åº¦ï¼ˆdevice-widthï¼‰</span><br><span class="line"></span><br><span class="line"><span class="attr">scale</span>  =<span class="number">1</span> æ—¶ <span class="attr">device-width</span> = è®¾å¤‡çš„ç‰©ç†åˆ†è¾¨ç‡ï¼devicePixelRatioï¼ˆè®¾å¤‡åƒç´ æ¯”ï¼‰</span><br></pre></td></tr></table></figure></p>
 <font face="STCAIYUN" color="#83933b" size="4">æ‰‹æ·˜çš„å¸ƒå±€å‰ææ˜¯  åŠ¨æ€è®¾ç½® viewportçš„scale  ç›®çš„å°±æ˜¯ä¸ºäº†ä¿è¯é¡µé¢å¤§å°ä¸è®¾è®¡ç¨¿å¤§å°ä¸€è‡´</font><br><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">æ¯”å¦‚è®¾è®¡ç¨¿æ˜¯<span class="number">750</span>çš„æ¨ªå‘åˆ†è¾¨ç‡ é‚£ä¹ˆå®é™…é¡µé¢çš„device-width ä»¥iphone6æ¥è¯´ ä¹Ÿç­‰äº<span class="number">750</span></span><br><span class="line">è¿™æ ·çš„è¯è®¾è®¡ç¨¿ä¸Šæ ‡æ³¨çš„å°ºå¯¸åªè¦é™¤ä»¥æŸä¸€ä¸ªå€¼å°±èƒ½å¤Ÿè½¬æ¢æˆremäº†</span><br></pre></td></tr></table></figure><br><br>2.<font face="STCAIYUN" color="red" size="3">é‚£ä¹ˆ å¦‚ä½•åŠ¨æ€è®¾ç½®ï¼Ÿ</font>

<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> <span class="built_in">scale</span> = <span class="number">1</span> / devicePixelRatio;</span><br><span class="line">document.querySelector('meta[name=<span class="string">"viewport"</span>]').setAttribute('<span class="built_in">content</span>','initial-<span class="built_in">scale</span>=' + <span class="built_in">scale</span> + ', maximum-<span class="built_in">scale</span>=' + <span class="built_in">scale</span> + ', minimum-<span class="built_in">scale</span>=' + <span class="built_in">scale</span> + ', user-scalable=no');</span><br></pre></td></tr></table></figure>
<p>3.<font face="STCAIYUN" color="red" size="3">æ‰‹æ·˜å¸ƒå±€çš„ç¬¬äºŒä¸ªè¦ç‚¹å°±æ˜¯å…³äºhtmlå…ƒç´ çš„font-sizeè®¡ç®—å…¬å¼</font></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">font-size</span> = deviceWidth/<span class="number">10</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>å¯èƒ½ä¼šéœ€è¦é¢å¤–çš„åª’ä½“æŸ¥è¯¢ åŒç½‘æ˜“ ä¸ä½¿ç”¨rem<br>ä½†æ˜¯å‘¢ æ·˜å®çš„remä¸å¤ªå¥½è®¡ç®—  å¦‚æœå€ŸåŠ©less å°±å¥½ç®—å¤šäº†<br>ç±»ä¼¼ï¼š<br><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ªmixin</span></span><br><span class="line"><span class="variable">@baseFontSize:</span> <span class="number">75</span>;<span class="comment">//åŸºäºè§†è§‰ç¨¿æ¨ªå±å°ºå¯¸/100å¾—å‡ºçš„åŸºå‡†font-size</span></span><br><span class="line"><span class="selector-class">.px2rem</span>(<span class="variable">@name</span>, <span class="variable">@px</span>)&#123;</span><br><span class="line">    <span class="attribute">@&#123;name&#125;</span>: <span class="variable">@px</span> / <span class="variable">@baseFontSize</span> * <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä½¿ç”¨ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="selector-class">.px2rem</span>(height, <span class="number">240</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//lessç¿»è¯‘ç»“æœï¼š</span></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">3.2rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>4.<font face="STCAIYUN" color="red" size="3">å…ƒç´ çš„csså°ºå¯¸å¦‚ä½•è®¡ç®—ï¼Ÿ</font><br><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">æ¯”å¦‚ä¸€ä¸ªè®¾è®¡ç¨¿ä¸ŠæŸä¸€ä¸ªå…ƒç´ çš„é«˜æ˜¯ <span class="number">150</span>px</span><br><span class="line">csså°ºå¯¸ =  è®¾è®¡ç¨¿æ ‡è®°å°ºå¯¸/è¯¥è®¾è®¡ç¨¿å¯¹åº”çš„htmlçš„font-size</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´  è®¾è®¡ç¨¿æ˜¯<span class="number">750</span>  æ‰€ä»¥ font-size = <span class="number">750</span>/<span class="number">10</span> =<span class="number">75</span>px</span><br><span class="line"> <span class="number">150</span>/<span class="number">75</span> = <span class="number">2</span>rem</span><br></pre></td></tr></table></figure></p>
<p>å…³äºè¿™ç§åšæ³•çš„å…·ä½“å®ç°ï¼Œæ·˜å®å·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¼€æºçš„è§£å†³æ–¹æ¡ˆ</p>
<font face="STCAIYUN" color="bluegreen" size="5"><a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener">æ·˜å®ç§»åŠ¨ç«¯å¸ƒå±€æ–¹æ¡ˆ</a></font>

<p><font face="STCAIYUN" color="red" size="3">æ¯”è¾ƒç½‘æ˜“ä¸æ·˜å®çš„åšæ³•</font></p>
<p><font face="STCAIYUN" color="bluegreen" size="3">å…±åŒç‚¹ï¼š</font><br>éƒ½èƒ½é€‚é…æ‰€æœ‰çš„æ‰‹æœºè®¾å¤‡ï¼Œå¯¹äºpadï¼Œç½‘æ˜“ä¸æ·˜å®éƒ½ä¼šè·³è½¬åˆ°pcé¡µé¢ï¼Œä¸å†ä½¿ç”¨è§¦å±ç‰ˆçš„é¡µé¢<br>éƒ½éœ€è¦åŠ¨æ€è®¾ç½®htmlçš„font-size<br>å¸ƒå±€æ—¶å„å…ƒç´ çš„å°ºå¯¸å€¼éƒ½æ˜¯æ ¹æ®è®¾è®¡ç¨¿æ ‡æ³¨çš„å°ºå¯¸è®¡ç®—å‡ºæ¥ï¼Œç”±äºhtmlçš„font-sizeæ˜¯åŠ¨æ€è°ƒæ•´çš„ï¼Œæ‰€ä»¥èƒ½å¤Ÿåšåˆ°ä¸åŒåˆ†è¾¨ç‡ä¸‹é¡µé¢å¸ƒå±€å‘ˆç°ç­‰æ¯”å˜åŒ–<br>å®¹å™¨å…ƒç´ çš„font-sizeéƒ½ä¸ç”¨remï¼Œéœ€è¦é¢å¤–åœ°å¯¹font-sizeåšåª’ä»‹æŸ¥è¯¢<br>éƒ½èƒ½åº”ç”¨äºå°ºå¯¸ä¸åŒçš„è®¾è®¡ç¨¿ï¼Œåªè¦æŒ‰ä»¥ä¸Šæ€»ç»“çš„æ–¹æ³•å»ç”¨å°±å¯ä»¥äº†</p>
<p><font face="STCAIYUN" color="bluegreen" size="3">ä¸åŒç‚¹ï¼š</font><br>æ·˜å®çš„è®¾è®¡ç¨¿æ˜¯åŸºäº750çš„æ¨ªå‘åˆ†è¾¨ç‡ï¼Œç½‘æ˜“çš„è®¾è®¡ç¨¿æ˜¯åŸºäº640çš„æ¨ªå‘åˆ†è¾¨ç‡ï¼Œè¿˜è¦å¼ºè°ƒçš„æ˜¯ï¼Œè™½ç„¶è®¾è®¡ç¨¿ä¸åŒï¼Œä½†æ˜¯æœ€ç»ˆçš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œè®¾è®¡ç¨¿çš„å°ºå¯¸ä¸€ä¸ªå…¬å¸è®¾è®¡äººå‘˜çš„å·¥ä½œæ ‡å‡†ï¼Œæ¯ä¸ªå…¬å¸ä¸ä¸€æ ·è€Œå·²<br>æ·˜å®è¿˜éœ€è¦åŠ¨æ€è®¾ç½®viewportçš„scaleï¼Œç½‘æ˜“ä¸ç”¨<br>æœ€é‡è¦çš„åŒºåˆ«å°±æ˜¯ï¼šç½‘æ˜“çš„åšæ³•ï¼Œremå€¼å¾ˆå¥½è®¡ç®—ï¼Œæ·˜å®çš„åšæ³•è‚¯å®šå¾—ç”¨è®¡ç®—å™¨æ‰èƒ½ç”¨å¥½äº† ã€‚ä¸è¿‡è¦æ˜¯ä½ ä½¿ç”¨äº†lesså’Œsassè¿™æ ·çš„csså¤„ç†å™¨ï¼Œå°±å¥½åŠå¤šäº†</p>
]]></content>
      <tags>
        <tag>mobile</tag>
      </tags>
  </entry>
  <entry>
    <title>è®°æ¢¦ä¸€</title>
    <url>/2017/07/31/%E8%AE%B0%E6%A2%A6/</url>
    <content><![CDATA[<p>æ­¤æ—¶æ­¤åˆ» ï¼Œåå¤æ€ç´¢ç€æ˜¨æ™šçš„æ¢¦ï¼Œ<font face="STCAIYUN" color="red" size="4">äººç”Ÿå……æ»¡æ— å¥ˆï¼Œçæƒœçœ¼å‰äºº</font></p>
<p>å…·ä½“çš„æ•…äº‹èƒŒæ™¯è®°ä¸æ¸…äº† å¤§æ¦‚æ˜¯æœ‹å‹çš„å¥¶å¥¶è¹Šè··å»ä¸–äº†ï¼Œæˆ‘å»å¥¹å®¶å®‰æ…°å¥¹å¹¶è¯•å›¾æŸ¥äº‹æ•…åŸå› ï¼Œç»“æœç­‰æˆ‘å›å»æ‰¾ä»–ä»¬çš„æ—¶å€™å‘ç°è‡ªå·±å·²ç»å˜æˆäº†<font face="STCAIYUN" color="red" size="4">éšå½¢äºº</font> å…¶å®å°±æ˜¯å·²ç»æ­»æ‰äº†ï¼Œæ˜¾ç„¶æˆ‘è‡ªå·±ä¹Ÿä¸çŸ¥é“è‡ªå·±å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼Œäº‹å®å°±æ˜¯æˆ‘è¿˜åœ¨äººé—´ï¼Œå°±æ˜¯æˆ‘èƒ½çœ‹ä¸–äººï¼Œä¸–äººå†ä¹Ÿçœ‹ä¸åˆ°æˆ‘äº†</p>
<p>ç¬¬ä¸€ååº”æ˜¯ï¼š  <font face="STCAIYUN" color="red" size="4">æˆ‘è¦å›å®¶</font><br>æˆ‘ä¸çŸ¥é“ä»–ä»¬æ˜¯æ€ä¹ˆå¤„ç†ä¸–é—´çš„æˆ‘ï¼Œæˆ‘åªçŸ¥é“æˆ‘çš„çµé­‚å›å®¶äº†<br>æˆ‘ä¹Ÿè®°ä¸æ¸…çˆ¸å¦ˆæ˜¯å¦çŸ¥ä¸çŸ¥é“æˆ‘å·²ç»ä¸åœ¨äº†ï¼Œæˆ‘ç”¨åŠ›çš„è·Ÿä»–ä»¬è®²è¯ åªå¯æƒœä»–ä»¬å¤§å¤§å°å°å…¨éƒ½å¯¹æˆ‘è§†è€Œä¸è§ï¼Œæˆ‘æ¥ä¸åŠæ€è€ƒ ä¾ç„¶ç”¨åŠ›å‘¼å”¤ä»–ä»¬ï¼Œè¿½ç€æ‹‰ç€ï¼Œå…¨éƒ½æ²¡æœ‰ç”¨ï¼Œ <font face="STCAIYUN" color="yellow" size="3">æˆ‘å¥½æ— åŠ›â€¦</font></p>
<p>æƒ³åˆ°å¤šå¹´å‰çœ‹è¿‡ä¸€éƒ¨æ—¥æœ¬çš„æ¸©æƒ…ç”µå½±ï¼Œè®²çš„ä¹Ÿæ˜¯ä¸»äººå…¬æ„å¤–èº«æ•… åŒ–èº«éšå½¢äººå›å®¶ï¼Œå‘ç°è‡ªå·±æ²¡åŠæ³•è®©å®¶äººæ³¨æ„åˆ°ä¹Ÿæ˜¯å¾ˆç—›è‹¦ ä¸è¿‡ç”µå½±å°±æ˜¯ç”µå½± æœ‰ä¸€ä¸ªå·«å©†æ˜¯é˜´é˜³çœ¼ æˆäº† å®¶äººè·Ÿ â€œéšå½¢äººâ€æ²Ÿé€šçš„æ¡¥æ¢ï¼Œå¿…è¦çš„æ—¶å€™è¿˜ä¼šå¸®åŠ©å®¶äººåº¦è¿‡éš¾å…³  å½±ç‰‡æœ€åæ˜¯å·«å©†å¸®åŠ©éšå½¢äººé™„èº«äºè‡ªå·±èº«ä¸Šï¼Œä¸å¦»å­åšæœ€åçš„å‘Šåˆ«ï¼Œæœ€åå®‰ç¨³æŠ•èƒ<br>å°è±¡ä¸­è¿™æ‰æ˜¯é¬¼é­‚çš„æ­£ç¡®æ‰“å¼€æ–¹å¼ å›½äº§å‰§ä¸­çš„é¬¼é­‚ä»¿ä½›éƒ½å¾ˆå‰å®³çš„æ ·å­ï¼Œæœ‰ä»‡æŠ¥ä»‡ï¼Œæœ‰å†¤æŠ¥å†¤ï¼Œä¸€è¨€ä¸åˆå°±æ–½æ³• ä¹Ÿæ˜¯ï½</p>
<p>æˆ‘å½“æ—¶æƒ³èµ·æ¥é“¶è¡Œè´¦æˆ·è¿˜æœ‰é’± å°±æƒ³ç»™ä»–ä»¬è½¬è¿‡å»ï¼Œä½†æ˜¯è´Ÿè´£ç®¡æˆ‘çš„è­¦å¯Ÿï¼Œæš‚ä¸”å«ä»– <font face="STCAIYUN" color="red" size="4">çµé­‚æ‘†æ¸¡äºº</font> ï¼ˆ404å·ä¾¿åˆ©åº—),å¯¹è€¶ æˆ‘ä¸ºä»€ä¹ˆæ²¡å»404å·ä¾¿åˆ©åº—æ‰¾å¤å†¬é’å¸®æˆ‘å®ç°æ„¿æœ›ï¼Œå¤§æ¦‚æˆ‘é‡è§çš„æ˜¯èµµå ç¬‘cry ä»–è¯´ æˆ‘å¯ä»¥å¾€äººé—´è´¦æˆ·æ±‡æ¬¾ï¼Œå°±æ˜¯æœ‰æŸè€— 1Wåªèƒ½åˆ°è´¦1k è¿™å°¼ç›æ˜¯è·¨è¡Œæ‰‹ç»­è´¹å—ğŸ˜¢</p>
<p>ä¸è®°å¾—æœ€åæ˜¯å’‹è§£å†³çš„ï¼Œ åæ­£ä¸–ç•Œå°±å†ä¹Ÿæ²¡æœ‰æˆ‘äº†ï¼Œå°±ç®—å†æŒ£æ‰<br>æˆ‘å¼€å§‹å›å¿†ä¸€ç”Ÿï¼Œé‚£äº›æ´»è¿‡çš„å¹³æ·¡æ—¥å­ï¼Œèƒ½è®°èµ·æ¥çš„åªæœ‰æ¡©æ¡©ä»¶ä»¶çš„é—æ†¾</p>
<p>æˆ‘è¿˜æ²¡æœ‰å­é¡ºçˆ¶æ¯</p>
<p>ä¸Šæ¬¡ç”µè¯é‡Œæ²¡æœ‰å–Šä¸€å—“å­ çˆ¸å¦ˆæˆ‘çˆ±ä½ </p>
<p>æˆ‘åº”è¯¥å†å›ä¸€æ¬¡å®¶çš„</p>
<p>æƒ³åœ¨è€å®¶ç»™çˆ¹å¦ˆä¹°æˆ¿å­çš„é’±è¿˜æ²¡å­˜å¤Ÿ</p>
<p>å®¶åº­æ—…è¡Œçš„è®¡åˆ’å®¶é—¨å£è¿˜æ²¡å‡º</p>
<p>æƒ³èµ·æ¥è¿™äº›ç¢ç¢å¿µ</p>
<p>çªç„¶æˆ‘å°±å¼€å§‹æ€€å¿µäº†</p>
<p>æˆ‘æƒ³ï¼Œå¦‚æœæˆ‘åœ¨ä¸–çš„æ—¶å€™èƒ½æœ‰è¿™äº›å±æœºæ„Ÿ ç°åœ¨ä¹Ÿä¸ä¼šæœ‰è¿™ä¹ˆå¤šé—æ†¾äº†</p>
<p>ç§äººä¸€ç‚¹çš„æ˜¯</p>
<p>æ‹çˆ±è®°æœ‰è¿™ä¹ˆå¤šç‚¹æ»´ å¦ä¸€åŠè¿˜æ²¡æ·»åŠ <br>è¿™ä¸–ä¸Š é™¤äº†çˆ¸å¦ˆäº²äºº è¿ä¸ªè®°æŒ‚æˆ‘çš„äººéƒ½æ²¡æœ‰</p>
<p>å¥½æ‚²å“€</p>
<p>æ—©ä¸Šè¢«é—¹é’Ÿå«é†’ å‘ç°è‡ªå·±è¿˜æ´»ç€</p>
<p>æ„Ÿè°¢ä¸Šå¸ æœ‰äº›äº‹åªæœ‰å¤±å»è¿‡æ‰çŸ¥é“ æˆ‘æ‹¥æœ‰çš„è¿˜å¾ˆå¤š</p>
<p>è‡´æ¯ä¸€ä¸ªç©ºè™šçš„ä½ </p>
]]></content>
      <tags>
        <tag>æ‚è°ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>reactåŸºæœ¬æ¦‚å¿µè§£æ</title>
    <url>/2018/06/24/%E8%AF%BBreact%E5%AE%98%E7%BD%91/</url>
    <content><![CDATA[<p><a href="http://www.css88.com/react/docs/hello-world.html" target="_blank" rel="noopener">è¯»reactå®˜ç½‘</a></p>
<p>å…³äºreact ä½ å¿…é¡»è¦çŸ¥é“çš„äº‹æƒ…ï½</p>
<a id="more"></a>
<h2 id="reacté˜»æ­¢é»˜è®¤äº‹ä»¶"><a href="#reacté˜»æ­¢é»˜è®¤äº‹ä»¶" class="headerlink" title="reacté˜»æ­¢é»˜è®¤äº‹ä»¶"></a>reacté˜»æ­¢é»˜è®¤äº‹ä»¶</h2><p>åœ¨reacté˜»æ­¢é»˜è®¤è¡Œä¸º å¿…é¡»ä½¿ç”¨<br>  e.preventDefault();</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleClick</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'The link was clicked.'</span>);</span><br><span class="line">&#125;</span><br><span class="line">è¿™é‡Œï¼Œ e æ˜¯ä¸€ä¸ªåˆæˆçš„äº‹ä»¶ã€‚ React æ ¹æ® W3C è§„èŒƒ å®šä¹‰äº†è¿™ä¸ªåˆæˆäº‹ä»¶ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ‹…å¿ƒè·¨æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚æŸ¥çœ‹ SyntheticEvent å‚è€ƒæŒ‡å—äº†è§£æ›´å¤šã€‚</span><br></pre></td></tr></table></figure>
<p>åœ¨JSXå›è°ƒä¸­ä½ å¿…é¡»æ³¨æ„ this çš„æŒ‡å‘ã€‚ åœ¨ JavaScript ä¸­ï¼Œç±»æ–¹æ³•é»˜è®¤æ²¡æœ‰ ç»‘å®š çš„ã€‚å¦‚æœä½ å¿˜è®°ç»‘å®š this.handleClick å¹¶å°†å…¶ä¼ é€’ç»™onClickï¼Œé‚£ä¹ˆåœ¨ç›´æ¥è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œthis ä¼šæ˜¯ undefined ã€‚</p>
<p>è¿™ä¸æ˜¯ React ç‰¹æœ‰çš„è¡Œä¸ºï¼›è¿™æ˜¯ JavaScript ä¸­çš„å‡½æ•°å¦‚ä½•å·¥ä½œçš„ä¸€éƒ¨åˆ†ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœä½ å¼•ç”¨ä¸€ä¸ªåé¢æ²¡è·Ÿ () çš„æ–¹æ³•ï¼Œä¾‹å¦‚ onClick={this.handleClick} ï¼Œé‚£ä½ å°±åº”è¯¥ ç»‘å®š(bind) è¯¥æ–¹æ³•ã€‚</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Toggle</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;isToggleOn: <span class="literal">true</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™ä¸ªç»‘å®šæ˜¯å¿…è¦çš„ï¼Œä½¿`this`åœ¨å›è°ƒä¸­èµ·ä½œç”¨</span></span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(prevState =&gt; (&#123;</span><br><span class="line">      isToggleOn: !prevState.isToggleOn</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.state.isToggleOn ? <span class="symbol">'O</span>N' : <span class="symbol">'OF</span>F'&#125;</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ReactDOM</span>.render(</span><br><span class="line">  &lt;<span class="type">Toggle</span> /&gt;,</span><br><span class="line">  document.getElementById(<span class="symbol">'roo</span>t')</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>è§£å†³æ–¹å¼</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoggingButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// è¿™ä¸ªè¯­æ³•ç¡®ä¿ `this` ç»‘å®šåœ¨ handleClick ä¸­ã€‚</span></span><br><span class="line">  <span class="comment">// è­¦å‘Šï¼šè¿™æ˜¯ *å®éªŒæ€§çš„* è¯­æ³•ã€‚</span></span><br><span class="line">  handleClick = () =&gt; &#123;</span><br><span class="line">    console.log(<span class="symbol">'this</span> is:', <span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;</span><br><span class="line">        <span class="type">Click</span> me</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoggingButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    console.log(<span class="symbol">'this</span> is:', <span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªè¯­æ³•ç¡®ä¿ `this` è¢«ç»‘å®šåœ¨ handleClick ä¸­</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button onClick=&#123;(e) =&gt; <span class="keyword">this</span>.handleClick(e)&#125;&gt;</span><br><span class="line">        <span class="type">Click</span> me</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">è¿™æ ·ä¸å¥½  é—®é¢˜æ˜¯</span><br><span class="line">è¿™ä¸ªè¯­æ³•çš„é—®é¢˜æ˜¯ï¼Œæ¯æ¬¡ <span class="type">LoggingButton</span> æ¸²æŸ“æ—¶éƒ½åˆ›å»ºä¸€ä¸ªä¸åŒçš„å›è°ƒã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ç„¶è€Œï¼Œå¦‚æœè¿™ä¸ªå›è°ƒè¢«ä½œä¸º prop(å±æ€§) ä¼ é€’ç»™ä¸‹çº§ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å¯èƒ½éœ€è¦é¢å¤–çš„é‡å¤æ¸²æŸ“ã€‚æˆ‘ä»¬é€šå¸¸å»ºè®®åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œç»‘å®šï¼Œä»¥é¿å…è¿™ç±»æ€§èƒ½é—®é¢˜ã€‚</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦å‚æ•°ä¼ é€’ç»™äº‹ä»¶å¤„ç†ç¨‹åº</p>
<figure class="highlight hsp"><table><tr><td class="code"><pre><span class="line">&lt;<span class="keyword">button</span> <span class="keyword">onClick</span>=&#123;(e) =&gt; this.deleteRow(id, e)&#125;&gt;<span class="keyword">Delete</span> Row&lt;/<span class="keyword">button</span>&gt;</span><br><span class="line">&lt;<span class="keyword">button</span> <span class="keyword">onClick</span>=&#123;this.deleteRow.bind(this, id)&#125;&gt;<span class="keyword">Delete</span> Row&lt;/<span class="keyword">button</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨é€»è¾‘ &amp;&amp; æ“ä½œç¬¦çš„å†…è” if ç”¨æ³• æ¥è¿›è¡Œæ¡ä»¶æ¸²æŸ“</p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> Mailbox(props) &#123;</span><br><span class="line">  const unreadMessages = props.unreadMessages;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      </span><span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml">      </span><span class="xquery">&#123;unreadMessages.length &gt; <span class="number">8</span> ?</span></span><br><span class="line"><span class="xquery">        <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="xquery">          You have &#123;unreadMessages.length&#125;</span><span class="xml"> unread messages.</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">       : <span class="string">''</span></span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const messages = [<span class="string">'React'</span>, <span class="string">'Re: React'</span>, <span class="string">'Re:Re: React'</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Mailbox unreadMessages=&#123;messages&#125; /&gt;,</span><br><span class="line"> <span class="built_in"> document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">==</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> Mailbox(props) &#123;</span><br><span class="line">  const unreadMessages = props.unreadMessages;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      </span><span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml">      </span><span class="xquery">&#123;unreadMessages.length &gt; <span class="number">8</span> &amp;&amp;</span></span><br><span class="line"><span class="xquery">        <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span></span></span><br><span class="line"><span class="xquery">          You have &#123;unreadMessages.length&#125;</span><span class="xml"> unread messages.</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line">       </span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const messages = [<span class="string">'React'</span>, <span class="string">'Re: React'</span>, <span class="string">'Re:Re: React'</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Mailbox unreadMessages=&#123;messages&#125; /&gt;,</span><br><span class="line"> <span class="built_in"> document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">æ¡ä»¶æ¸²æŸ“çš„ä¸€ç§ç®€ä¾¿å†™æ³•ï¼ˆç±»ä¼¼äºä¸‰ç›®è¿ç®—ç¬¦ï¼‰</span><br><span class="line"></span><br><span class="line">å®ƒå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºåœ¨ JavaScript ä¸­ï¼Œ<span class="built_in"> true</span> &amp;&amp; expression æ€»æ˜¯ä¼šè¯„ä¼°ä¸º expression ï¼Œè€Œ<span class="built_in"> false</span> &amp;&amp; expression æ€»æ˜¯æ‰§è¡Œä¸º<span class="built_in"> false</span> ã€‚</span><br><span class="line"></span><br><span class="line">å› æ­¤ï¼Œå¦‚æœæ¡ä»¶ä¸º<span class="built_in"> true</span> ï¼Œåˆ™ &amp;&amp; åé¢çš„å…ƒç´ å°†æ˜¾ç¤ºåœ¨è¾“å‡ºä¸­ã€‚ å¦‚æœæ˜¯<span class="built_in"> false</span>ï¼ŒReact å°†ä¼šå¿½ç•¥å¹¶è·³è¿‡å®ƒã€‚</span><br><span class="line"></span><br><span class="line">æœ€lowçš„ä¸€ç§æ–¹å¼ä¹Ÿæ˜¯å€ŸåŠ©äºå…ƒç´ å˜é‡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> button = null;</span><br><span class="line">    <span class="keyword">if</span> (isLoggedIn) &#123;</span><br><span class="line">      button = &lt;LogoutButton onClick=&#123;this.handleLogoutClick&#125; /&gt;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      button = &lt;LoginButton onClick=&#123;this.handleLoginClick&#125; /&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">    è¿™å¯ä»¥å¸®åŠ©æ‚¨æœ‰æ¡ä»¶åœ°æ¸²æŸ“ç»„ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œè€Œè¾“å‡ºçš„å…¶ä½™éƒ¨åˆ†ä¸ä¼šæ›´æ”¹ã€‚</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ¡ä»¶æ“ä½œç¬¦çš„å†…è”if-else<br>å¦ä¸€ä¸ªç”¨äºæ¡ä»¶æ¸²æŸ“å…ƒç´ çš„å†…è”æ–¹æ³•æ˜¯ä½¿ç”¨ JavaScript çš„æ¡ä»¶æ“ä½œç¬¦ condition ? true : false ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = <span class="keyword">this</span>.state.isLoggedIn;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      The user <span class="keyword">is</span> &lt;b&gt;&#123;isLoggedIn ? <span class="string">'currently'</span> : <span class="string">'not'</span>&#125;&lt;/b&gt; logged <span class="keyword">in</span>.</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="é˜²æ­¢ç»„ä»¶æ¸²æŸ“-è¿”å›null"><a href="#é˜²æ­¢ç»„ä»¶æ¸²æŸ“-è¿”å›null" class="headerlink" title="é˜²æ­¢ç»„ä»¶æ¸²æŸ“ è¿”å›null"></a>é˜²æ­¢ç»„ä»¶æ¸²æŸ“ è¿”å›null</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WarningBanner</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!props.warn) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"warning"</span>&gt;</span><br><span class="line">      Warning!</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"> render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;WarningBanner warn=&#123;this.state.showWarning&#125; /</span>&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleToggleClick&#125;&gt;</span><br><span class="line">          &#123;<span class="keyword">this</span>.state.showWarning ? <span class="string">'Hide'</span> : <span class="string">'Show'</span>&#125;</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="reactå’Œkey"><a href="#reactå’Œkey" class="headerlink" title="reactå’Œkey"></a>reactå’Œkey</h2><p>é”®ï¼ˆkeyï¼‰<br>é”®(Keys) å¸®åŠ© React æ ‡è¯†å“ªä¸ªé¡¹è¢«ä¿®æ”¹ã€æ·»åŠ æˆ–è€…ç§»é™¤äº†ã€‚æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå”¯ä¸€ä¸å˜çš„é”®(Keys)æ¥æ ‡è¯†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">  &lt;li key=&#123;number.toString()&#125;&gt;</span><br><span class="line">    &#123;number&#125;</span><br><span class="line">  &lt;<span class="regexp">/li&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•æŒ‡å®škeyï¼Ÿ"><a href="#å¦‚ä½•æŒ‡å®škeyï¼Ÿ" class="headerlink" title="å¦‚ä½•æŒ‡å®škeyï¼Ÿ"></a>å¦‚ä½•æŒ‡å®škeyï¼Ÿ</h3><p>å¦‚æœä½ æå– ä¸€ä¸ª ListItem ç»„ä»¶ï¼Œåº”è¯¥æŠŠ key æ”¾ç½®åœ¨æ•°ç»„å¤„ç†çš„ <listitem> å…ƒç´ ä¸­ï¼Œä¸èƒ½æ”¾åœ¨ ListItem ç»„ä»¶è‡ªèº«ä¸­çš„ <li> æ ¹å…ƒç´ ä¸Šã€‚</li></listitem></p>
<figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> ListItem(props) &#123;</span><br><span class="line">  // æ­£ç¡®ï¼è¿™é‡Œä¸éœ€è¦æŒ‡å®š<span class="built_in"> key</span> ï¼š</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><span class="xquery">&#123;props.<span class="keyword">value</span>&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> NumberList(props) &#123;</span><br><span class="line">  const numbers = props.numbers;</span><br><span class="line">  const listItems = numbers.<span class="keyword">map</span>(<span class="built_in">(number</span>) =&gt;</span><br><span class="line">    // æ­£ç¡®<span class="built_in">ï¼key</span> åº”è¯¥åœ¨è¿™é‡Œè¢«æŒ‡å®š</span><br><span class="line">    &lt;ListItem<span class="built_in"> key</span>=<span class="built_in">&#123;number</span>.toString()&#125;</span><br><span class="line">              <span class="keyword">value</span>=<span class="built_in">&#123;number</span>&#125; /&gt;</span><br><span class="line"></span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">      </span><span class="xquery">&#123;listItems&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;NumberList numbers=&#123;numbers&#125; /&gt;,</span><br><span class="line"> <span class="built_in"> document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ä¸€ä¸ªå¥½çš„ç»éªŒå‡†åˆ™æ˜¯å…ƒç´ ä¸­è°ƒç”¨ <span class="keyword">map</span>() éœ€è¦ keys ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="ç»„åˆ-ç»§æ‰¿"><a href="#ç»„åˆ-ç»§æ‰¿" class="headerlink" title="ç»„åˆ ç»§æ‰¿"></a>ç»„åˆ ç»§æ‰¿</h2><p>reactæ‹¥æœ‰ä¸€ä¸ªå¼ºå¤§çš„ç»„åˆæ¨¡å‹ å»ºè®®ä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ä»¥å®ç°ä»£ç çš„é‡ç”¨</p>
<p>åŒ…å«  å¦‚æœä½ ä¸ç¡®å®šè¦ä½¿ç”¨ä»€ä¹ˆç»„ä»¶ åœ¨ å¼¹å±‚ç­‰é€šç”¨çš„å®¹å™¨ä¸­æ¯”è¾ƒå¸¸è§<br>å»ºè®®è¿™ç§ç»„ä»¶ä½¿ç”¨ç‰¹åˆ«çš„ children props æ¥ç›´æ¥ä¼ é€’</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FancyBorder</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#123;<span class="string">'FancyBorder FancyBorder-'</span> + props.color&#125;&gt;</span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function WelcomeDialog() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;FancyBorder color="blue"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;h1 className="Dialog-title"&gt;</span></span><br><span class="line"><span class="regexp">        Welcome</span></span><br><span class="line"><span class="regexp">      &lt;/</span>h1&gt;</span><br><span class="line">      &lt;p className=<span class="string">"Dialog-message"</span>&gt;</span><br><span class="line">        Thank you <span class="keyword">for</span> visiting our spacecraft!</span><br><span class="line">      &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>FancyBorder&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dialog</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;FancyBorder color=<span class="string">"blue"</span>&gt;</span><br><span class="line">      &lt;h1 className=<span class="string">"Dialog-title"</span>&gt;</span><br><span class="line">        &#123;props.title&#125;</span><br><span class="line">      &lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &lt;p className="Dialog-message"&gt;</span></span><br><span class="line"><span class="regexp">        &#123;props.message&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>p&gt;</span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line">    &lt;<span class="regexp">/FancyBorder&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class SignUpDialog extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  constructor(props) &#123;</span></span><br><span class="line"><span class="regexp">    super(props);</span></span><br><span class="line"><span class="regexp">    this.handleChange = this.handleChange.bind(this);</span></span><br><span class="line"><span class="regexp">    this.handleSignUp = this.handleSignUp.bind(this);</span></span><br><span class="line"><span class="regexp">    this.state = &#123;login: ''&#125;;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;Dialog title="Mars Exploration Program"</span></span><br><span class="line"><span class="regexp">              message="How should we refer to you?"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input value=&#123;this.state.login&#125;</span></span><br><span class="line"><span class="regexp">               onChange=&#123;this.handleChange&#125; /</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleSignUp&#125;&gt;</span><br><span class="line">          Sign Me Up!</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>Dialog&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleChange(e) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">login</span>: e.target.value&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSignUp() &#123;</span><br><span class="line">    alert(<span class="string">`Welcome aboard, <span class="subst">$&#123;<span class="keyword">this</span>.state.login&#125;</span>!`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è‡ªå®šä¹‰ç»„ä»¶å†™æ³•"><a href="#è‡ªå®šä¹‰ç»„ä»¶å†™æ³•" class="headerlink" title="è‡ªå®šä¹‰ç»„ä»¶å†™æ³•"></a>è‡ªå®šä¹‰ç»„ä»¶å†™æ³•</h2><p>ç”¨æˆ·è‡ªå®šä¹‰çš„ç»„ä»¶å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´</p>
<p>ä½†ä¸€ä¸ªå…ƒç´ ç±»å‹ä»¥å°å†™å­—æ¯å¼€å¤´ ä»–è¡¨ç¤ºå¼•ç”¨ä¸€ä¸ªç±»ä¼¼äº<div>æˆ–è€…<span>çš„å†…ç½®ç»„ä»¶<br>ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„ç±»å‹ï¼Œç±»ä¼¼äº <foo>ï¼Œä¼šè¢«ç¼–è¯‘æˆ React.createElement(Foo) ï¼Œå¯¹åº”äºè‡ªå®šä¹‰ç»„ä»¶ æˆ–è€…åœ¨ JavaScript æ–‡ä»¶ä¸­å¯¼å…¥çš„ç»„ä»¶ã€‚</foo></span></div></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ï¼è¿™æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œé¦–å­—æ¯åº”è¯¥å¤§å†™ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æ­£ç¡®ï¼è¿™ç§ä½¿ç”¨ &lt;div&gt; æ˜¯åˆæ³•çš„ï¼Œå› ä¸º div æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„HTMLæ ‡è®°ï¼š</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello &#123;props.toWhat&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HelloWorld</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// é”™è¯¯ï¼React è®¤ä¸º &lt;hello /&gt; æ˜¯ä¸€ä¸ª HTML æ ‡ç­¾ï¼Œå› ä¸ºå®ƒé¦–å­—æ¯åº”ä¸æ˜¯å¤§å†™çš„ï¼š</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">hello</span> <span class="attr">toWhat</span>=<span class="string">"World"</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<p>å­—ç¬¦ä¸²å­—é¢é‡</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">&lt;MyComponent message="hello world" /&gt;</span><br><span class="line">====</span><br><span class="line">&lt;MyComponent message=&#123;<span class="emphasis">'hello world'</span>&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>props(å±æ€§)é»˜è®¤ä¸ºtrue</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">&lt;MyTextBox autocomplete /&gt;</span><br><span class="line">===</span><br><span class="line">&lt;MyTextBox autocomplete=&#123;true&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>jsxä¸­çš„children</p>
<p>å­—ç¬¦ä¸²å˜é‡</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="params">&lt;MyComponent&gt;</span>Hello world!<span class="params">&lt;/MyComponent&gt;</span></span><br><span class="line">è¿™æ˜¯æœ‰æ•ˆçš„ JSX ï¼ŒMyComponent ç»„ä»¶ä¸­çš„ props.children å€¼ä¸ºå­—ç¬¦ä¸² <span class="string">"Hello world!"</span> ã€‚</span><br></pre></td></tr></table></figure>
<p>JSXä¼šåˆ é™¤æ¯è¡Œå¼€å¤´å’Œç»“å°¾çš„ç©ºæ ¼ï¼Œå¹¶ä¸”ä¹Ÿä¼šåˆ é™¤ç©ºè¡Œã€‚é‚»æ¥æ ‡ç­¾çš„ç©ºè¡Œä¹Ÿä¼šè¢«ç§»é™¤ï¼Œå­—ç¬¦ä¸²ä¹‹é—´çš„ç©ºæ ¼ä¼šè¢«å‹ç¼©æˆä¸€ä¸ªç©ºæ ¼ï¼Œå› æ­¤ä¸‹é¢çš„æ¸²æŸ“æ•ˆæœéƒ½æ˜¯ç›¸åŒçš„</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span>&gt;Hello World&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">div</span>&gt;</span><br><span class="line">  Hello World</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">div</span>&gt;</span><br><span class="line">  Hello</span><br><span class="line">  World</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">div</span>&gt;</span><br><span class="line"></span><br><span class="line">  Hello World</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
<p>Booleans, Null, å’Œ Undefined è¢«å¿½ç•¥<br>falseï¼Œnullï¼Œundefinedï¼Œå’Œ true éƒ½æ˜¯æœ‰æ•ˆçš„çš„ children(å­å…ƒç´ ) ã€‚ä½†æ˜¯å¹¶ä¸ä¼šè¢«æ¸²æŸ“ï¼Œä¸‹é¢çš„JSXè¡¨è¾¾å¼æ¸²æŸ“æ•ˆæœæ˜¯ç›¸åŒçš„ï¼š</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> /&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;false&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;null&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;undefined&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;true&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>åœ¨æœ‰æ¡ä»¶æ¸²æŸ“çš„æ—¶å€™éå¸¸æœ‰ç”¨ å¦‚æœ showheaderä¸ºtrueçš„æ—¶å€™ <header>ä¼šè¢«æ¸²æŸ“ï¼ˆå¿…é¡»ä¿è¯&amp;&amp;è¡¨è¾¾å¼ä¹‹å‰æ€»æ˜¯å¸ƒå°”å€¼ï¼‰</header></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  &#123;showHeader &amp;&amp; <span class="tag">&lt;<span class="name">Header</span> /&gt;</span>&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">Content</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœåœ¨è¾“å‡ºä¸­æƒ³è¦æ¸²æŸ“false true nullæˆ–è€…undefined å¿…é¡»å…ˆå°†å…¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">&lt;<span class="built-in">div</span>&gt;</span><br><span class="line">  My JavaScript <span class="keyword">variable</span> is <span class="comment">&#123;String(myVariable)&#125;.</span></span><br><span class="line">&lt;/<span class="built-in">div</span>&gt;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨propTypeè¿›è¡Œç±»å‹æ£€æŸ¥<br>å¯ä»¥é€šè¿‡èµ‹å€¼ç‰¹å®šçš„defaultå±æ€§ä¸ºproså®šä¹‰é»˜è®¤å€¼</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;h1&gt;<span class="type">Hello</span>, &#123;<span class="keyword">this</span>.props.name&#125;&lt;/h1&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®š props çš„é»˜è®¤å€¼ï¼š</span></span><br><span class="line"><span class="type">Greeting</span>.defaultProps = &#123;</span><br><span class="line">  name: <span class="symbol">'Strange</span>r'</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸²æŸ“ä¸º "Hello, Stranger":</span></span><br><span class="line"><span class="type">ReactDOM</span>.render(</span><br><span class="line">  &lt;<span class="type">Greeting</span> /&gt;,</span><br><span class="line">  document.getElementById(<span class="symbol">'exampl</span>e')</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">æˆ–è€…</span><br><span class="line"></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  static defaultProps = &#123;</span><br><span class="line">    name: <span class="symbol">'strange</span>r'</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;<span class="type">Hello</span>, &#123;<span class="keyword">this</span>.props.name&#125;&lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">propTypes çš„ç±»å‹æ£€æµ‹æ˜¯åœ¨defaultProps è§£æä¹‹åå‘ç”Ÿçš„ï¼Œå› æ­¤ä¹Ÿä¼šå¯¹é»˜è®¤å±æ€§ defaultProps è¿›è¡Œç±»å‹æ£€æµ‹ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="ES6-å£°æ˜classç»„ä»¶"><a href="#ES6-å£°æ˜classç»„ä»¶" class="headerlink" title="ES6 å£°æ˜classç»„ä»¶"></a>ES6 å£°æ˜classç»„ä»¶</h2><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Greeting</span>.defaultProps = &#123;</span><br><span class="line">  name: <span class="symbol">'Mar</span>y'</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="è®¾ç½®åˆå§‹åŒ–ç»„ä»¶"><a href="#è®¾ç½®åˆå§‹åŒ–ç»„ä»¶" class="headerlink" title="è®¾ç½®åˆå§‹åŒ–ç»„ä»¶"></a>è®¾ç½®åˆå§‹åŒ–ç»„ä»¶</h3><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;count: props.initialCount&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸€è‡´æ€§æ¯”è¾ƒï¼ˆdiffç®—æ³•çš„å®ç°ï¼‰"><a href="#ä¸€è‡´æ€§æ¯”è¾ƒï¼ˆdiffç®—æ³•çš„å®ç°ï¼‰" class="headerlink" title="ä¸€è‡´æ€§æ¯”è¾ƒï¼ˆdiffç®—æ³•çš„å®ç°ï¼‰"></a>ä¸€è‡´æ€§æ¯”è¾ƒï¼ˆdiffç®—æ³•çš„å®ç°ï¼‰</h2><figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨reactçš„æ—¶å€™ ä»»ä½•ä¸€ä¸ªå•ç‚¹æ—¶åˆ»å¯ä»¥è®¤ä¸º renderï¼ˆï¼‰å‡½æ•°çš„ä½œç”¨æ˜¯åˆ›å»ºreactå…ƒç´ æ ‘</span><br><span class="line">åœ¨ä¸‹ä¸€ä¸ª<span class="keyword">state</span>æˆ–è€…propsæ›´æ–°çš„æ—¶å€™ renderï¼ˆï¼‰å‡½æ•°å°†ä¼šè¿”å›ä¸€ä¸ªä¸åŒçš„reactå…ƒç´ æ ‘</span><br><span class="line">æ¥ä¸‹æ¥ reactå°†ä¼šæ‰¾å‡ºå¦‚ä½•é«˜æ•ˆçš„æ›´æ–°uiæ¥åŒ¹é…æœ€è¿‘æ—¶åˆ»çš„reactå…ƒç´ æ ‘</span><br></pre></td></tr></table></figure>
<p>reactåŸºäºä»¥ä¸‹ä¸¤ä¸ªå‡è®¾å®ç°äº†æ—¶é—´å¤æ‚åº¦ä¸ºoï¼ˆnï¼‰çš„ç®—æ³•</p>
<ul>
<li>ä¸åŒç±»å‹çš„ä¸¤ä¸ªå…ƒç´ å°†ä¼šäº§ç”Ÿä¸åŒçš„æ ‘ã€‚</li>
<li>å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ä¸€ä¸ªkey propæ¥æŒ‡ç¤ºåœ¨ä¸åŒçš„æ¸²æŸ“ä¸­é‚£ä¸ªé‚£äº›å…ƒç´ å¯ä»¥ä¿æŒç¨³å®š</li>
</ul>
<h3 id="diffç®—æ³•"><a href="#diffç®—æ³•" class="headerlink" title="diffç®—æ³•"></a>diffç®—æ³•</h3><p>å½“æ¯”è¾ƒä¸åŒçš„æ ‘ reactä¼šé¦–å…ˆæ¯”è¾ƒä¸¤ä¸ªæ ¹å…ƒç´  æ ¹æ®æ ¹çš„ç±»å‹ä¸åŒ å®ƒæœ‰ä¸åŒçš„è¡Œä¸º</p>
<h4 id="å…ƒç´ ç±»å‹ä¸ç›¸åŒæ—¶"><a href="#å…ƒç´ ç±»å‹ä¸ç›¸åŒæ—¶" class="headerlink" title="å…ƒç´ ç±»å‹ä¸ç›¸åŒæ—¶"></a>å…ƒç´ ç±»å‹ä¸ç›¸åŒæ—¶</h4><p>æ— è®ºä»€ä¹ˆæ—¶å€™ å½“æ ¹å…ƒç´ ç±»å‹ä¸åŒæ—¶ï¼Œreactå°†ä¼šé”€æ¯åŸå…ˆçš„æ ‘å¹¶é‡å†™æ„å»ºæ–°çš„æ ‘<br>å½“é”€æ¯åŸå…ˆçš„æ ‘æ—¶ ä¹‹å‰çš„domèŠ‚ç‚¹å°†é”€æ¯ï¼Œå®ä¾‹ç»„ä»¶æ‰§è¡Œ componentWillUnmount() ã€‚å½“æ„å»ºä¸€ä¸ªæ–°çš„æ ‘ æ–°çš„domèŠ‚ç‚¹å°†ä¼šæ’å…¥domä¸­ ç»„ä»¶å°†ä¼šæ‰§è¡ŒcomponentWillMount() ä»¥åŠ componentDidMount() ã€‚ä¸ä¹‹å‰æ—§çš„æ ‘ç›¸å…³çš„ state éƒ½ä¼šä¸¢å¤±ã€‚</p>
<h4 id="domå…ƒç´ ç±»å‹ç›¸åŒæ—¶"><a href="#domå…ƒç´ ç±»å‹ç›¸åŒæ—¶" class="headerlink" title="domå…ƒç´ ç±»å‹ç›¸åŒæ—¶"></a>domå…ƒç´ ç±»å‹ç›¸åŒæ—¶</h4><p>å½“å…ƒç´ ç±»å‹ç›¸åŒ reactä¼šæ¯”è¾ƒæ£€æŸ¥å®ƒä»¬çš„å±æ€§ï¼ˆattributesï¼‰ä¿ç•™ç›¸åŒçš„åº•å±‚domèŠ‚ç‚¹ åªæ›´æ–°å‘ç”Ÿæ”¹å˜çš„å±æ€§</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;div <span class="attribute">className</span>=<span class="string">"before"</span> <span class="attribute">title</span>=<span class="string">"stuff"</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="attribute">className</span>=<span class="string">"after"</span> <span class="attribute">title</span>=<span class="string">"stuff"</span> /&gt;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼ŒReact ä¼šä»…ä¿®æ”¹åº•å±‚ DOM èŠ‚ç‚¹çš„ className å±æ€§ã€‚<br>åœ¨å¤„ç†å®Œå½“å‰ DOM èŠ‚ç‚¹åï¼ŒReact ä¼šé€’å½’å¤„ç†å­èŠ‚ç‚¹ã€‚</p>
<h4 id="ç›¸åŒç±»å‹çš„ç»„ä»¶"><a href="#ç›¸åŒç±»å‹çš„ç»„ä»¶" class="headerlink" title="ç›¸åŒç±»å‹çš„ç»„ä»¶"></a>ç›¸åŒç±»å‹çš„ç»„ä»¶</h4><p>å½“ä¸€ä¸ªç»„ä»¶æ›´æ–°çš„æ—¶å€™ ç»„ä»¶å®ä¾‹ä¿æŒä¸å˜ ä»¥ä¾¿åœ¨æ¸²æŸ“ä¸­ä¿æŒstate reactä¼šæ›´æ–°ç»„ä»¶å®ä¾‹çš„å±æ€§æ¥åŒ¹é…æ–°çš„å…ƒç´  å¹¶åœ¨ç»„ä»¶å®ä¾‹ä¸­è°ƒç”¨componentWillReceiveProps() å’Œ componentWillUpdate()ã€‚æ¥ä¸‹æ¥ï¼Œ render() æ–¹æ³•ä¼šè¢«è°ƒç”¨å¹¶ä¸”diffç®—æ³•å¯¹ä¸Šä¸€æ¬¡çš„ç»“æœå’Œæ–°çš„ç»“æœè¿›è¡Œé€’å½’ã€‚</p>
<h4 id="å­å…ƒç´ é€’å½’"><a href="#å­å…ƒç´ é€’å½’" class="headerlink" title="å­å…ƒç´ é€’å½’"></a>å­å…ƒç´ é€’å½’</h4><figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span>&gt;<span class="built_in">first</span>&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span>&gt;<span class="built_in">second</span>&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span>&gt;<span class="built_in">first</span>&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span>&gt;<span class="built_in">second</span>&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span>&gt;<span class="built_in">third</span>&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">React ä¼šæ¯”è¾ƒä¸¤ä¸ª &lt;<span class="built_in">li</span>&gt;<span class="built_in">first</span>&lt;/<span class="built_in">li</span>&gt; æ ‘ä¸ä¸¤ä¸ª &lt;<span class="built_in">li</span>&gt;<span class="built_in">second</span>&lt;/<span class="built_in">li</span>&gt; æ ‘ï¼Œç„¶åæ’å…¥ &lt;<span class="built_in">li</span>&gt;<span class="built_in">third</span>&lt;/<span class="built_in">li</span>&gt; æ ‘ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Duke<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Villanova<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Connecticut<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Duke<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Villanova<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">React å°†ä¼šæ”¹å˜æ¯ä¸€ä¸ªå­èŠ‚ç‚¹è€Œæ²¡æœ‰æ„è¯†åˆ°éœ€è¦ä¿ç•™ <span class="tag">&lt;<span class="name">li</span>&gt;</span>Duke<span class="tag">&lt;/<span class="name">li</span>&gt;</span> å’Œ <span class="tag">&lt;<span class="name">li</span>&gt;</span>Villanova<span class="tag">&lt;/<span class="name">li</span>&gt;</span> ä¸¤ä¸ªå­æ ‘ã€‚è¿™ç§ä½æ•ˆæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</span><br></pre></td></tr></table></figure>
<p>æ€ä¹ˆè§£å†³ç±»ä¼¼çš„é—®é¢˜<br>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ reactæ”¯æŒä¸€ä¸ªkeyå±æ€§ å½“å­èŠ‚ç‚¹æœ‰äº†key reactä½¿ç”¨è¿™ä¸ªkeyå»æ¯”è¾ƒåŸæ¥çš„æ ‘çš„å­èŠ‚ç‚¹å’Œä¹‹åçš„å­èŠ‚ç‚¹ </p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"2015"</span>&gt;Duke&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"2016"</span>&gt;Villanova&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"2014"</span>&gt;Connecticut&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"2015"</span>&gt;Duke&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">  &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"2016"</span>&gt;Villanova&lt;/<span class="built_in">li</span>&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">ç°åœ¨ reactçŸ¥é“<span class="number">2014</span>çš„<span class="built_in">key</span>å…ƒç´ æ˜¯æ–°çš„ <span class="built_in">key</span>ä¸º<span class="number">2015</span>å’Œ<span class="number">2016</span>çš„ä¸¤ä¸ªå…ƒç´ ä»…ä»…åªæ˜¯è¢«ç§»åŠ¨è€Œå·²</span><br></pre></td></tr></table></figure>
<h2 id="ç‰‡æ®µ"><a href="#ç‰‡æ®µ" class="headerlink" title="ç‰‡æ®µ"></a>ç‰‡æ®µ</h2><p>è§£å†³ç—›ç‚¹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Table</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;table&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">          &lt;Columns /&gt;</span><br><span class="line">        &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>table&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ä¸ºäº†æ¸²æŸ“æœ‰æ•ˆçš„ HTML ï¼Œ &lt;Columns /&gt; éœ€è¦è¿”å›å¤šä¸ª &lt;td&gt; å…ƒç´ ã€‚å¦‚æœ &lt;Columns /&gt; çš„ render() å‡½æ•°é‡Œé¢ä½¿ç”¨ä¸€ä¸ªçˆ¶çº§ div ï¼Œé‚£ä¹ˆæœ€ç»ˆç”Ÿæˆçš„ HTML å°†æ˜¯æ— æ•ˆçš„ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Columns</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;td&gt;Hello&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;td&gt;World&lt;/</span>td&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">æœ€åä¼šæ¸²æŸ“æˆ</span></span><br><span class="line"><span class="regexp">&lt;table&gt;</span></span><br><span class="line"><span class="regexp">  &lt;tr&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;td&gt;Hello&lt;/</span>td&gt;</span><br><span class="line">      &lt;td&gt;World&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>table&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨æ–¹å¼</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Columns</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;React.Fragment&gt;</span><br><span class="line">        &lt;td&gt;Hello&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;td&gt;World&lt;/</span>td&gt;</span><br><span class="line">      &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">æ–°çš„å£°æ˜æ–¹å¼ï¼ˆçœ‹èµ·æ¥åƒç©ºæ ‡ç­¾ï¼‰</span></span><br><span class="line"><span class="regexp">class Columns extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;td&gt;Hello&lt;/</span>td&gt;</span><br><span class="line">        &lt;td&gt;World&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å¸¦keyçš„ç‰‡æ®µ</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Glossary</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;dl&gt;</span><br><span class="line">      &#123;props.items.map(<span class="function"><span class="params">item</span> =&gt;</span> (</span><br><span class="line">        <span class="comment">// æ²¡æœ‰`key`ï¼Œå°†ä¼šè§¦å‘ä¸€ä¸ªkeyè­¦å‘Š</span></span><br><span class="line">        &lt;React.Fragment key=&#123;item.id&#125;&gt;</span><br><span class="line">          &lt;dt&gt;&#123;item.term&#125;&lt;<span class="regexp">/dt&gt;</span></span><br><span class="line"><span class="regexp">          &lt;dd&gt;&#123;item.description&#125;&lt;/</span>dd&gt;</span><br><span class="line">        &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">      ))&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>dl&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">key æ˜¯å”¯ä¸€å¯ä»¥ä¼ é€’ç»™ Fragment çš„å±æ€§ã€‚åœ¨å°†æ¥ï¼Œæˆ‘ä»¬å¯èƒ½å¢åŠ é¢å¤–çš„å±æ€§æ”¯æŒï¼Œæ¯”å¦‚äº‹ä»¶å¤„ç†ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="æ’æ§½"><a href="#æ’æ§½" class="headerlink" title="æ’æ§½"></a>æ’æ§½</h3><p>Portals æä¾›äº†ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•ï¼Œå°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°çˆ¶ç»„ä»¶ DOM å±‚æ¬¡ç»“æ„ä¹‹å¤–çš„ DOM èŠ‚ç‚¹ã€‚</p>
<p><code>ReactDOM.createPortal(child, container)</code></p>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆchildï¼‰æ˜¯ä»»ä½•å¯æ¸²æŸ“çš„ React å­å…ƒç´ ï¼Œä¾‹å¦‚ä¸€ä¸ªå…ƒç´ ï¼Œå­—ç¬¦ä¸²æˆ– ç‰‡æ®µ(fragment)ã€‚</span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼ˆ<span class="keyword">container</span>ï¼‰åˆ™æ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="comment">// React è£…è½½ä¸€ä¸ªæ–°çš„ divï¼Œå¹¶å°† children æ¸²æŸ“åˆ°è¿™ä¸ª div ä¸­</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;<span class="keyword">this</span>.props.children&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">ç„¶è€Œï¼Œæœ‰æ—¶å€™å°†å­å…ƒç´ æ’å…¥åˆ° DOM èŠ‚ç‚¹çš„å…¶ä»–ä½ç½®ä¼šæœ‰ç”¨çš„ï¼š</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="comment">// React *ä¸* ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ divã€‚ å®ƒæŠŠ children æ¸²æŸ“åˆ° `domNode` ä¸­ã€‚</span></span><br><span class="line">  <span class="comment">// `domNode` å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ DOM èŠ‚ç‚¹ï¼Œä¸ç®¡å®ƒåœ¨ DOM ä¸­çš„ä½ç½®ã€‚</span></span><br><span class="line">  <span class="keyword">return</span> ReactDOM.createPortal(</span><br><span class="line">    <span class="keyword">this</span>.props.children,</span><br><span class="line">    domNode,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é”™è¯¯è¾¹ç•Œ"><a href="#é”™è¯¯è¾¹ç•Œ" class="headerlink" title="é”™è¯¯è¾¹ç•Œ"></a>é”™è¯¯è¾¹ç•Œ</h3><p>éƒ¨åˆ† UI ä¸­çš„ JavaScript é”™è¯¯ä¸åº”è¯¥ç ´åæ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œé”™è¯¯è¾¹ç•Œæ˜¯ React ç»„ä»¶ï¼Œå®ƒå¯ä»¥åœ¨å­ç»„ä»¶æ ‘çš„ä»»ä½•ä½ç½®æ•è· JavaScript é”™è¯¯ï¼Œè®°å½•è¿™äº›é”™è¯¯ï¼Œå¹¶æ˜¾ç¤ºä¸€ä¸ªå¤‡ç”¨ UI ** ï¼Œè€Œä¸æ˜¯ä½¿æ•´ä¸ªç»„ä»¶æ ‘å´©æºƒã€‚é”™è¯¯è¾¹ç•Œ(Error Boundaries) åœ¨æ¸²æŸ“ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä»¥åŠæ•´ä¸ªç»„ä»¶æ ‘ä¸‹çš„æ„é€ å‡½æ•°ä¸­æ•è·é”™è¯¯ã€‚</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; hasError: <span class="literal">false</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"> æœ‰è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³• è¯æ˜æ˜¯é”™è¯¯è¾¹ç•Œæ–¹å¼</span><br><span class="line">  componentDidCatch(error, info) &#123;</span><br><span class="line">    <span class="comment">// Display fallback UI</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; hasError: <span class="literal">true</span> &#125;);</span><br><span class="line">    <span class="comment">// You can also log the error to an error reporting service</span></span><br><span class="line">    logErrorToMyService(error, info);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasError) &#123;</span><br><span class="line">      <span class="comment">// You can render any custom fallback UI</span></span><br><span class="line">      <span class="keyword">return</span> &lt;h1&gt;<span class="type">Something</span> went wrong.&lt;/h1&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">è°ƒç”¨</span><br><span class="line">&lt;<span class="type">ErrorBoundary</span>&gt;</span><br><span class="line">  &lt;<span class="type">MyWidget</span> /&gt;</span><br><span class="line">&lt;/<span class="type">ErrorBoundary</span>&gt;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„é”™è¯¯è¾¹ç•Œ(Error Boundaries) ä»…å¯ä»¥æ•è·å…¶å­ç»„ä»¶çš„é”™è¯¯ã€‚é”™è¯¯è¾¹ç•Œæ— æ³•æ•è·å…¶è‡ªèº«çš„é”™è¯¯ã€‚å¦‚æœä¸€ä¸ªé”™è¯¯è¾¹ç•Œæ— æ³•æ¸²æŸ“é”™è¯¯ä¿¡æ¯ï¼Œåˆ™é”™è¯¯ä¼šå‘ä¸Šå†’æ³¡è‡³æœ€æ¥è¿‘çš„é”™è¯¯è¾¹ç•Œã€‚è¿™ä¹Ÿç±»ä¼¼äº JavaScript ä¸­ catch {} çš„å·¥ä½œæœºåˆ¶</p>
<p><a href="https://codepen.io/anon/pen/VdyBrE?editors=0010" target="_blank" rel="noopener">https://codepen.io/anon/pen/VdyBrE?editors=0010</a></p>
<h3 id="æœªæ•è·é”™è¯¯çš„æ–°è¡Œä¸º"><a href="#æœªæ•è·é”™è¯¯çš„æ–°è¡Œä¸º" class="headerlink" title="æœªæ•è·é”™è¯¯çš„æ–°è¡Œä¸º"></a>æœªæ•è·é”™è¯¯çš„æ–°è¡Œä¸º</h3><p>è¿™ä¸€æ”¹å˜æœ‰éå¸¸é‡è¦çš„æ„ä¹‰ã€‚è‡ª React 16 å¼€å§‹ï¼Œä»»ä½•æœªè¢«é”™è¯¯è¾¹ç•Œæ•è·çš„é”™è¯¯å°†ä¼šå¸è½½æ•´ä¸ª React ç»„ä»¶æ ‘ã€‚</p>
<p>æ—¶é—´å¤„ç†å™¨å¦‚ä½•å¤„ç†<br>é”™è¯¯è¾¹ç•Œæ— æ³•æ•è·äº‹ä»¶å¤„ç†å™¨å†…éƒ¨çš„é”™è¯¯ã€‚</p>
<p>å› ä¸ºæ—¶é—´å¤„ç†å™¨ä¸ä¼šåœ¨æ¸²æŸ“å‘¨æœŸå†…è§¦å‘<br>å› æ­¤è‹¥ä»–ä»¬æŠ›å‡ºå¼‚å¸¸ reactä»ç„¶èƒ½å¤ŸçŸ¥é“éœ€è¦åœ¨å±å¹•ä¸­æ˜¾ç¤ºä»€ä¹ˆ<br>å¦‚æœä½ éœ€è¦åœ¨äº‹ä»¶å¤„ç†å™¨å†…éƒ¨æ•è·é”™è¯¯ï¼Œä½¿ç”¨æ™®é€šçš„ JavaScript try / catch è¯­å¥ï¼š</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; error: <span class="literal">null</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  handleClick = () =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Do something that could throw</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123; error &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.error) &#123;</span><br><span class="line">      <span class="keyword">return</span> &lt;h1&gt;<span class="type">Caught</span> an error.&lt;/h1&gt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &lt;div onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;<span class="type">Click</span> <span class="type">Me</span>&lt;/div&gt;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>ä»£ç æ‹†åˆ†</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">import &#123; <span class="keyword">add</span><span class="bash"> &#125; from <span class="string">'./math'</span>;</span></span><br><span class="line"></span><br><span class="line">console.log(<span class="keyword">add</span><span class="bash">(16, 26));</span></span><br></pre></td></tr></table></figure>
<p>ä»¥å</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">"./math"</span>).then(<span class="function"><span class="params">math</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(math.add(<span class="number">16</span>, <span class="number">26</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å½“ Webpack é‡åˆ°è¿™ä¸ªè¯­æ³•æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å¯åŠ¨ ä»£ç æ‹†åˆ† æ¥æ‹†åˆ†ä½ çš„åº”ç”¨ç¨‹åºã€‚</p>
<p>react component</p>
<h3 id="Mounting-è£…è½½"><a href="#Mounting-è£…è½½" class="headerlink" title="Mounting(è£…è½½)"></a>Mounting(è£…è½½)</h3><p> å½“ç»„ä»¶å®ä¾‹è¢«åˆ›å»ºå¹¶ä¸”å°†å…¶æ’å…¥domæ—¶ zå’Œè°æ–¹æ³•å°†ä¼šè¢«è°ƒç”¨</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">constructor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">componentWillMount</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">render</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">componentDidMount</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Updating-æ›´æ–°"><a href="#Updating-æ›´æ–°" class="headerlink" title="Updating(æ›´æ–°)"></a>Updating(æ›´æ–°)</h3><p>æ”¹å˜propsæˆ–è€…stateå¯ä»¥è§¦å‘æ›´æ–°äº‹ä»¶ï¼Œåœ¨é‡æ–°æ¸²æŸ“ç»„ä»¶æ—¶å°†ä¼šè°ƒç”¨</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">componentWillReceiveProps</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">shouldComponentUpdate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">componentWillUpdate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">render</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">componentDidUpdate</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Unmounting-å¸è½½"><a href="#Unmounting-å¸è½½" class="headerlink" title="Unmounting(å¸è½½)"></a>Unmounting(å¸è½½)</h3><p>å½“ä¸€ä¸ªç»„ä»¶ä»Domä¸­åˆ é™¤æ—¶ å°†ä¼šè°ƒç”¨</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">componentWillUnmount</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<h3 id="render-æ–¹æ³•"><a href="#render-æ–¹æ³•" class="headerlink" title="render() æ–¹æ³•"></a>render() æ–¹æ³•</h3><p>render() å‡½æ•°åº”è¯¥æ˜¯çº¯å‡½æ•°ï¼Œè¿™æ„å‘³ç€å®ƒä¸ä¼šä¿®æ”¹ç»„ä»¶çŠ¶æ€ï¼Œæ¯æ¬¡è°ƒç”¨å®ƒæ—¶è¿”å›ç›¸åŒçš„ç»“æœ å¦‚æœ shouldComponentUpdate() æ–¹æ³•è¿”å› false ï¼Œrender() ä¸ä¼šè¢«è°ƒç”¨ã€‚</p>
<p>å½“è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥this.props å’Œ this.stateå¹¶è¿”å›å…¶ä¸­ä¸€ä¸ªç±»å‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">reactå…ƒç´ </span><br><span class="line">å­—ç¬¦ä¸²å’Œæ•°å­—</span><br><span class="line">Portals  ReactDOM.createPortal åˆ›å»ºã€‚</span><br><span class="line">null:ä¸æ¸²æŸ“ä»»ä½•ä¸œè¥¿</span><br><span class="line">å¸ƒå°”å€¼:ä¸æ¸²æŸ“ä»»ä½•ä¸œè¥¿ ï¼ˆé€šå¸¸å­˜åœ¨äº <span class="built_in">return</span> <span class="built_in">test</span> &amp;&amp; &lt;Child /&gt;å†™æ³•ï¼Œå…¶ä¸­ <span class="built_in">test</span> æ˜¯å¸ƒå°”å€¼ã€‚ï¼‰</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥è¿”å› null æˆ– false æ¥è¡¨ç¤ºä½ ä¸æƒ³è¦æ¸²æŸ“ä»»ä½•ä¸œè¥¿ å½“è¿”å› null æˆ– false æ—¶ï¼ŒReactDOM.findDOMNode(this) å°†è¿”å› null<br>å½“ä½ æƒ³è¿”å›å¤šä¸ªå…ƒç´ æ—¶ ç”¨æ•°ç»„æ“ä½œ</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="built_in">return</span> [</span><br><span class="line">    &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"A"</span>&gt;First item&lt;/<span class="built_in">li</span>&gt;,</span><br><span class="line">    &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"B"</span>&gt;Second item&lt;/<span class="built_in">li</span>&gt;,</span><br><span class="line">    &lt;<span class="built_in">li</span> <span class="built_in">key</span>=<span class="string">"C"</span>&gt;Third item&lt;/<span class="built_in">li</span>&gt;,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="constructor-æ–¹æ³•"><a href="#constructor-æ–¹æ³•" class="headerlink" title="constructor()æ–¹æ³•"></a>constructor()æ–¹æ³•</h3><p>ç»„ä»¶è¢«è£…è½½å‰è°ƒç”¨ï¼Œå½“å®ç°<code>react.component</code>æ—¶å­ç±»çš„constructor(æ„é€ å‡½æ•°)æ—¶ åº”è¯¥æœ€å…ˆè°ƒç”¨<code>super(props)</code> å¦åˆ™å°†æ‰¾ä¸åˆ°this æŠ¥é”™</p>
<p>å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–state é‡‡ç”¨<br>this.state={} çš„æ–¹å¼è€Œä¸æ˜¯ä½¿ç”¨setState()  æ„é€ å‡½æ•°ä¹Ÿç»å¸¸ç”¨äºå°†äº‹ä»¶å¤„ç†ç¨‹åºç»‘å®šåˆ°ç±»å®ä¾‹(ç›®å‰å¯ä»¥ç”¨ç®­å¤´å‡½æ•°è§£å†³æ­¤ç±»é—®é¢˜)<br>å¦‚æœstateéœ€è¦æ ¹æ®propsçš„å€¼æ¥åˆå§‹åŒ–ï¼Œå°±æ˜¯ä½ éœ€è¦è€ƒè™‘å˜é‡æå‡çš„æ—¶å€™</p>
<p>å¦‚æœä½ æ²¡æœ‰åˆå§‹åŒ– çŠ¶æ€(state) ï¼Œå¹¶ä¸”æ²¡æœ‰ç»‘å®šæ–¹æ³•ï¼Œä¸ç”¨å®ç°ä¸€ä¸ªæ„é€ å‡½æ•°</p>
<h3 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount()"></a>componentWillMount()</h3><p>åœ¨ç»„ä»¶è£…è½½ä¹‹å‰ç«‹å³è¢«è°ƒç”¨çš„æ–¹æ³• åœ¨renderä¹‹å‰æ¸²æŸ“ æ‰€ä»¥ ä¸ä¼šè§¦å‘render<br>ä¹Ÿæ˜¯æœåŠ¡ç«¯æ¸²æŸ“è°ƒç”¨çš„å”¯ä¸€çš„ç”Ÿå‘½å‘¨æœŸçš„<br>é’©å­</p>
<h3 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount()"></a>componentDidMount()</h3><p>ç»„ä»¶è£…è½½ä¹‹åç«‹å³è¢«è°ƒç”¨<br>åˆå§‹åŒ–éœ€è¦çš„domèŠ‚ç‚¹æˆ–ä»è¿œç¨‹åŠ è½½æ•°æ®çš„åœ°æ–¹<br>åœ¨è¿™é‡Œè°ƒç”¨<code>setState()</code>ä¼šè§¦render()<br>ä½†ä¼šåœ¨æµè§ˆå™¨æ›´æ–°å±å¹•ä¹‹å‰å‘ç”Ÿã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿ render() ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ï¼Œ ä¹Ÿå¯ä»¥ä¿è¯ç”¨æˆ·ä¸ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€</p>
<h3 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps()"></a>componentWillReceiveProps()</h3><p> åœ¨å·²è£…è½½ç»„ä»¶æ¥æ”¶æ–° props ä¹‹å‰è¢«è°ƒç”¨,<br> å¯ä»¥åœ¨æ­¤æ–¹æ³•ä¸­æ¯”è¾ƒthis.props å’Œ nextProps å¹¶ä½¿ç”¨ this.setState() æ‰§è¡ŒçŠ¶æ€è½¬æ¢ã€‚</p>
<h3 id="shouldComponentUpdate-nextProps-nextState"><a href="#shouldComponentUpdate-nextProps-nextState" class="headerlink" title="shouldComponentUpdate(nextProps, nextState)"></a>shouldComponentUpdate(nextProps, nextState)</h3><p>è®© React çŸ¥é“ç»„ä»¶çš„è¾“å‡ºæ˜¯å¦ä¸å— state æˆ– props å½“å‰å˜åŒ–çš„å½±å“ï¼Œé»˜è®¤è¡Œä¸ºæ˜¯åœ¨æ¯æ¬¡ state æ›´æ”¹æ—¶é‡æ–°æ¸²æŸ“ï¼Œå¹¶ä¸”åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥ä¾èµ–äºé»˜è®¤è¡Œä¸ºã€‚<br>å½“æ¥æ”¶åˆ°æ–°çš„ props æˆ– state æ—¶ï¼ŒshouldComponentUpdate() åœ¨æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨ã€‚ é»˜è®¤è¿”å› true ï¼Œå¯¹äºåˆå§‹(ç¬¬ä¸€æ¬¡)æ¸²æŸ“ï¼Œä¸è°ƒç”¨æ­¤æ–¹æ³•ï¼Œè¿”å› false ä¸ä¼šé˜»æ­¢å­ç»„ä»¶åœ¨ state æ›´æ”¹æ—¶é‡æ–°æ¸²æŸ“ ä½†æ˜¯<br><code>componentWillUpdate()</code> ï¼Œ<code>render()</code>å’Œ<code>componentDidUpdate()</code>å°†ä¸ä¼šè¢«è°ƒç”¨</p>
<h3 id="componentWillUpdate"><a href="#componentWillUpdate" class="headerlink" title="componentWillUpdate()"></a>componentWillUpdate()</h3><p>å½“æ¥æ”¶åˆ°stateæˆ–è€…propsï¼Œå®ƒä¼šåœ¨æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨</p>
<h3 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate()"></a>componentDidUpdate()</h3><p>åœ¨æ›´æ–°å‘ç”Ÿä¹‹ç«‹å³è¢«è°ƒç”¨ï¼Œå½“ç»„ä»¶å·²ç»æ›´æ–°æ—¶ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ“ä½œdom ä¹Ÿå¯ä»¥åšç½‘ç»œè¯·æ±‚</p>
<h3 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount()"></a>componentWillUnmount()</h3><p>å½“ç»„ä»¶è¢«å¸è½½å’Œé”€æ¯ä¹‹å‰ è¢«è°ƒç”¨ å¯ä»¥åœ¨æ­¤æ‰§è¡Œå¿…è¦çš„æ¸…ç† è®¡æ—¶å™¨ ç½‘ç»œè¯·æ±‚ æˆ–è€…åœ¨didmountåˆ›å»ºçš„å…ƒç´ </p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">componentDidMount</span><span class="params">()</span></span> &#123;</span><br><span class="line">  this<span class="selector-class">.serverRequest</span> = axios.get(<span class="string">'/api'</span>)</span><br><span class="line">    .then(posts =&gt; &#123;</span><br><span class="line">      this.setState(&#123;</span><br><span class="line">        posts</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">componentWillUnmount</span><span class="params">()</span></span> &#123;</span><br><span class="line">  this<span class="selector-class">.serverRequest</span><span class="selector-class">.abort</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="componentDidCatch"><a href="#componentDidCatch" class="headerlink" title="componentDidCatch()"></a>componentDidCatch()</h3><p>é”™è¯¯è¾¹ç•Œ å¯ä»¥åœ¨å…¶_å­ç»„ä»¶æ ‘ _ä¸­çš„ä»»ä½•ä½ç½®æ•è·jsé”™è¯¯ æ˜¾ç¤ºå¤‡ç”¨ui<br>é”™è¯¯è¾¹ç•Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ï¼Œä»¥åŠæ•´ä¸ªæ ‘ä¸‹çš„æ„é€ å‡½æ•°ä¸­æ•è·é”™è¯¯ã€‚</p>
<h3 id="setState"><a href="#setState" class="headerlink" title="setState()"></a>setState()</h3><p>setState() æ€»æ˜¯ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“ï¼Œé™¤é shouldComponentUpdate() è¿”å› false</p>
<p>setStateæ˜¯ä½œä¸ºä¸€ä¸ªè¯·æ±‚è€Œä¸æ˜¯ç«‹å³å‘½ä»¤æ¥æ›´æ–°ç»„ä»¶ ä¸ºäº†æ€§èƒ½è€ƒè™‘ reactå¯èƒ½ä¼šæ‰¹é‡ æˆ– å»¶è¿Ÿåˆ°åé¢æ›´æ–°å®ƒ ç„¶ååˆå¹¶å¤šä¸ªsetState()æ›´æ–°å¤šä¸ªç»„ä»¶<br>Reactä¸ä¿è¯ state æ›´æ–°å°±ç«‹å³åº”ç”¨(é‡æ–°æ¸²æŸ“)ã€‚æ‰€ä»¥æ›´æ–°ä¹‹åç«‹å³è¯»å–å¯èƒ½ä¼šæœ‰é—®é¢˜<br>ä½ å¯ä»¥ä½¿ç”¨ componentDidUpdateæˆ–è€…setStateå›è°ƒ <code>ï¼ˆsetState(updater, callback)ï¼‰</code></p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³é€šè¿‡ props.step åœ¨ <span class="keyword">state</span> ä¸­å¢åŠ ä¸€ä¸ªå€¼ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">this.<span class="built_in">set</span>State((prevState, props) =&gt; &#123;</span><br><span class="line">  return &#123;counter: prevState.counter + props.step&#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>State(<span class="keyword">state</span>Change, [callback])</span><br><span class="line">è¿™å°†æ‰§è¡Œ <span class="keyword">state</span>Change çš„æµ…åˆå¹¶åˆ°æ–°çš„ <span class="keyword">state</span> </span><br><span class="line"></span><br><span class="line">è¿™ç§ä¹Ÿæ˜¯å¼‚æ­¥çš„ä¼šè¿›è¡Œæ‰¹å¤„ç† å¦‚æœåŒä¸€æ—¶é—´æ®µéœ€è¦å¤šæ¬¡æ“ä½œ å¯èƒ½ä¼šè¢«è¦†ç›–</span><br><span class="line">Object.assign(</span><br><span class="line">  previousState,</span><br><span class="line">  &#123;quantity: <span class="keyword">state</span>.quantity + <span class="number">1</span>&#125;,</span><br><span class="line">  &#123;quantity: <span class="keyword">state</span>.quantity + <span class="number">1</span>&#125;,</span><br><span class="line">  ...</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">å¯ä»¥è¿™ä¹ˆä½¿ç”¨</span><br><span class="line">this.<span class="built_in">set</span>State((prevState) =&gt; &#123;</span><br><span class="line">  return &#123;counter: prevState.quantity + <span class="number">1</span>&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ä¼ é€’ä¸€ä¸ªæ›´æ–°å‡½æ•°å…è®¸ä½ åœ¨æ›´æ–°ä¸­è®¿é—®å½“å‰çš„çŠ¶æ€å€¼ã€‚ç”±äº setState è°ƒç”¨æ˜¯æ‰¹å¤„ç†çš„,è¿™å…è®¸ä½ é“¾å¼æ›´æ–°å¹¶ç¡®ä¿å®ƒä»¬å»ºç«‹åœ¨å½¼æ­¤ä¹‹ä¸Šï¼Œè€Œä¸æ˜¯äº§ç”Ÿå†²çªï¼š<br><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">incrementCount() &#123;</span><br><span class="line">  <span class="keyword">this</span>.setState((prevState) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;count: prevState.count + <span class="number">1</span>&#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">handleSomething() &#123;</span><br><span class="line">  <span class="comment">// this.state.count æ˜¯ 1ï¼Œç„¶åæˆ‘ä»¬è¿™æ ·åšï¼š</span></span><br><span class="line">  <span class="keyword">this</span>.incrementCount();</span><br><span class="line">  <span class="keyword">this</span>.incrementCount(); <span class="comment">// count ç°åœ¨æ˜¯ 3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ReactDOMServer"><a href="#ReactDOMServer" class="headerlink" title="ReactDOMServer"></a>ReactDOMServer</h2><p>ReactDOMServer å¯¹è±¡å…è®¸æ‚¨åœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“ç»„ä»¶ã€‚</p>
<p>renderToString()<br>renderToStaticMarkup()</p>
<p>æ¸²æŸ“æµ<br>renderToNodeStream()<br>renderToStaticNodeStream()</p>
<p>æ¸²æŸ“æµå¯ä»¥å‡å°ç¬¬ä¸€ä¸ªå­—èŠ‚(TTFB)æ¸²æŸ“æ—¶é—´ï¼Œåœ¨æ–‡æ¡£çš„ä¸‹ä¸€ä¸ªéƒ¨åˆ†ç”Ÿæˆä¹‹å‰ï¼Œå°†æ–‡æ¡£çš„å¼€å¤´å‘ä¸‹å‘é€åˆ°æµè§ˆå™¨ã€‚æ‰€æœ‰ä¸»æµæµè§ˆå™¨éƒ½ä¼šåœ¨æœåŠ¡å™¨ä»¥è¿™ç§æ–¹å¼æµå‡ºå†…å®¹æ—¶å¼€å§‹è§£æå’Œå‘ˆç°æ–‡æ¡£ã€‚</p>
<h4 id="èŠ‚æµ"><a href="#èŠ‚æµ" class="headerlink" title="èŠ‚æµ"></a>èŠ‚æµ</h4><p>æ˜¯é˜»æ­¢å‡½æ•°åœ¨ç»™å®šæ—¶é—´å†…è¢«å¤šæ¬¡è°ƒç”¨</p>
<h4 id="Debounceï¼ˆé˜²æŠ–ï¼‰"><a href="#Debounceï¼ˆé˜²æŠ–ï¼‰" class="headerlink" title="Debounceï¼ˆé˜²æŠ–ï¼‰"></a>Debounceï¼ˆé˜²æŠ–ï¼‰</h4><p>é˜²æŠ–ç¡®ä¿å‡½æ•°ä¸Šæ¬¡æ‰§è¡Œåçš„ä¸€æ®µæ—¶é—´å†…ï¼Œä¸ä¼šå†æ¬¡æ‰§è¡Œã€‚</p>
<h4 id="æ“ä½œcss"><a href="#æ“ä½œcss" class="headerlink" title="æ“ä½œcss"></a>æ“ä½œcss</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">let</span> className = <span class="string">'menu'</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.props.isActive) &#123;</span><br><span class="line">    className += <span class="string">' menu-active'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span>&gt;</span>Menu<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Virtual-DOM-and-Internals"><a href="#Virtual-DOM-and-Internals" class="headerlink" title="Virtual DOM and Internals"></a>Virtual DOM and Internals</h3><h4 id="ä»€ä¹ˆæ˜¯è™šæ‹Ÿdom"><a href="#ä»€ä¹ˆæ˜¯è™šæ‹Ÿdom" class="headerlink" title="ä»€ä¹ˆæ˜¯è™šæ‹Ÿdom"></a>ä»€ä¹ˆæ˜¯è™šæ‹Ÿdom</h4><p>è™šæ‹Ÿdomæ˜¯ä¸€ç§ç¼–ç¨‹æ¦‚å¿µï¼Œæ˜¯æŒ‡è™šæ‹Ÿçš„è§†å›¾è¢«ä¿ç•™åœ¨å†…å­˜ä¸­ é€šè¿‡å¦‚reactDomè¿™æ ·çš„åº“ä¸â€œçœŸå®â€çš„dom ä¿æŒåŒæ­¥<br>è™šæ‹ŸDOMæ˜¯ç”±JavaScriptåº“åœ¨æµè§ˆå™¨APIä¹‹ä¸Šå®ç°çš„ä¸€ç§æ¦‚å¿µ</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä¸ºreactæ¦‚å†µï¼Œæ„åœ¨å¯¹reactæœ‰ä¸ªæ•´ç†è®¤çŸ¥ï¼Œå…¶ä¸­çš„ä»»æ„ä¸€æ¡éƒ½å€¼å¾—æ·±å…¥ç ”ç©¶ï¼Œæ—¥åå¯èƒ½ä¼šé’ˆå¯¹æŸä¸€ä¸ªçŸ¥è¯†ç‚¹å•å¼€æ–‡ç« ï½ </p>
]]></content>
      <tags>
        <tag>js</tag>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title>é‡æ„å‰ç«¯ä½“ç³»ç³»åˆ— - æ„å»ºå‰ç«¯çŸ¥è¯†æ¶æ„</title>
    <url>/2020/03/12/relearning_front-end/</url>
    <content><![CDATA[<h2 id="é‡æ–°ç†è§£å‰ç«¯"><a href="#é‡æ–°ç†è§£å‰ç«¯" class="headerlink" title="é‡æ–°ç†è§£å‰ç«¯"></a>é‡æ–°ç†è§£å‰ç«¯</h2><p>å‰ç«¯å·¥ç¨‹å¸ˆå·²ç»æˆä¸ºç ”å‘ä½“ç³»ä¸­é‡è¦çš„å²—ä½ï¼Œä½†ä¸æ­¤ç›¸å¯¹æ˜¯å¤§éƒ¨åˆ†å‰ç«¯å·¥ç¨‹å¸ˆçš„çŸ¥è¯†å…¶å®éƒ½æ˜¯æ¥è‡ªäºå®è·µå’Œå·¥ä½œä¸­é›¶æ•£çš„å­¦ä¹ ï¼Œè¿™ä¸ªç°çŠ¶å°±å¼•å‘äº†ä¸€ç³»åˆ—çš„é—®é¢˜</p>
<ul>
<li>å‰ç«¯çš„åŸºç¡€çŸ¥è¯†è–„å¼±ï¼šæ•£ç‚¹è‡ªå­¦ + åŸºç¡€ä¸ç‰¢ </li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">åŸºç¡€çŸ¥è¯†çš„æ¬ ç¼ºä¼šè®©ä½ æŸæ‰‹æŸè„šï¼Œæ›´é™åˆ¶ä½ è§£å†³é—®é¢˜çš„æ€è·¯</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>æŠ€æœ¯ä¸Šå­˜åœ¨çŸ­æ¿ï¼Œå°±ä¼šå¯¼è‡´å‰ç«¯å¼€å‘è€…çš„ä¸Šå‡é€šé“ä¸ç”šé¡ºç•… </li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">å°å…¬å¸çš„ç¨‹åºå‘˜ï¼Œåªèƒ½é è‡ªå·±æ‘¸ç´¢ï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“é™·å…¥é‡å¤æ€§åŠ³åŠ¨çš„é™·é˜±ï¼Œæœ€ç»ˆè€½è¯¯è‡ªå·±çš„èŒä¸šå‘å±•</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>å‰ç«¯å·¥ç¨‹å¸ˆä¹Ÿä¼šé¢ä¸´æŠ€æœ¯å‘å±•é—®é¢˜å¸¦æ¥çš„æŒ‘æˆ˜ </li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">å‰ç«¯ç¤¾åŒºé«˜åº¦æ´»è·ƒï¼Œå‰ç«¯æ ‡å‡†ä¹Ÿåœ¨å¿«é€Ÿæ›´æ–°ï¼Œè¿™æ ·è“¬å‹ƒå‘å±•å¯¹æŠ€æœ¯æ¥è¯´æ— ç–‘æ˜¯å¥½äº‹ï¼Œä½†æ˜¯å‰¯ä½œç”¨ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œå®ƒä½¿å¾—å‰ç«¯å·¥ç¨‹å¸ˆçš„å­¦ä¹ å‹åŠ›å˜å¾—å¾ˆå¤§ã€‚</span><br></pre></td></tr></tbody></table></figure>

<p>å¤§éƒ¨åˆ†äººå­¦å‰ç«¯çš„æ–¹å¼æ˜¯ â€œåœŸæ³•å­¦å‰ç«¯â€ï¼Œä»–ä»¬å¯¹äºçŸ¥è¯†çš„ç†è§£åŸºæœ¬éƒ½åœç•™åœ¨ç‚¹ä¸Šï¼Œä»æ¥æ²¡æœ‰å¤§èŒƒå›´æŠŠè¿™äº›ç‚¹ä¸²æˆçº¿ï¼Œå½¢æˆè‡ªå·±çš„çŸ¥è¯†ä½“ç³»ï¼Œå› æ­¤æ‰ä¼šå‡ºç°é—æ¼å’Œç›²ç‚¹</p>
<a id="more"></a>
<h3 id="å‰ç«¯å·¥ç¨‹å¸ˆçš„æˆé•¿è§†è§’"><a href="#å‰ç«¯å·¥ç¨‹å¸ˆçš„æˆé•¿è§†è§’" class="headerlink" title="å‰ç«¯å·¥ç¨‹å¸ˆçš„æˆé•¿è§†è§’"></a>å‰ç«¯å·¥ç¨‹å¸ˆçš„æˆé•¿è§†è§’</h3><ul>
<li>æ˜¯ç«‹è¶³æ ‡å‡†ï¼Œç³»ç»Ÿæ€§æ€»ç»“å’Œæ•´ç†å‰ç«¯çŸ¥è¯†ï¼Œå»ºç«‹è‡ªå·±çš„è®¤çŸ¥å’Œæ–¹æ³•è®º</li>
<li>æ˜¯æ”¾çœ¼å›¢é˜Ÿï¼Œä»ä¸šåŠ¡å’Œå·¥ç¨‹è§’åº¦æ€è€ƒå‰ç«¯å›¢é˜Ÿçš„ä»·å€¼å’Œå‘å±•éœ€è¦ã€‚åªæœ‰è¿™æ ·åšï¼Œæ‰èƒ½å¤ŸæŒç»­å‘å±•ï¼Œåœ¨é«˜é€Ÿå‘å±•çš„æŠ€æœ¯å’Œå·¥ç¨‹æµªæ½®ä¸­ç¨³ç¨³ç«‹è¶³</li>
<li>ä»¥å®Œå¤‡ã€ä½“ç³»åŒ–çš„æ–¹å¼ç†è§£å’Œæ€è€ƒå‰ç«¯çš„åŸºç¡€çŸ¥è¯†å’Œå·¥ç¨‹å®è·µ</li>
</ul>
<p>äº‹å®ä¸Šï¼Œå‰ç«¯çš„èƒ½åŠ›å¯ä»¥å¸¦æ¥æ›´å¤šçš„ä¸šåŠ¡åœºæ™¯ï¼Œè¿™äº›æœ‰å¾…äºæˆ‘ä»¬å»å‘æ˜<br>å»ºç«‹è‡ªå·±çš„çŸ¥è¯†ä½“ç³»å’Œæ–¹æ³•è®ºï¼Œæ‰èƒ½å¤Ÿä¿æŒé¢†å…ˆä¼˜åŠ¿</p>
<h2 id="æ˜ç¡®å‰ç«¯çš„å­¦ä¹ è·¯çº¿å’Œæ–¹æ³•"><a href="#æ˜ç¡®å‰ç«¯çš„å­¦ä¹ è·¯çº¿å’Œæ–¹æ³•" class="headerlink" title="æ˜ç¡®å‰ç«¯çš„å­¦ä¹ è·¯çº¿å’Œæ–¹æ³•"></a>æ˜ç¡®å‰ç«¯çš„å­¦ä¹ è·¯çº¿å’Œæ–¹æ³•</h2><h3 id="å­¦ä¹ ç›®æ ‡"><a href="#å­¦ä¹ ç›®æ ‡" class="headerlink" title="å­¦ä¹ ç›®æ ‡"></a>å­¦ä¹ ç›®æ ‡</h3><ul>
<li>æ‘¸ç´¢å‡ºé€‚åˆä½ è‡ªå·±çš„å‰ç«¯å­¦ä¹ æ–¹æ³•</li>
<li>å¸®åŠ©å»ºç«‹å‰ç«¯æŠ€æœ¯çš„çŸ¥è¯†æ¶æ„</li>
<li>ç†è§£å‰ç«¯æŠ€æœ¯èƒŒåçš„æ ¸å¿ƒæ€æƒ³</li>
</ul>
<h3 id="å‰ç«¯å­¦ä¹ æ–¹æ³•"><a href="#å‰ç«¯å­¦ä¹ æ–¹æ³•" class="headerlink" title="å‰ç«¯å­¦ä¹ æ–¹æ³•"></a>å‰ç«¯å­¦ä¹ æ–¹æ³•</h3><h4 id="å»ºç«‹çŸ¥è¯†æ¶æ„"><a href="#å»ºç«‹çŸ¥è¯†æ¶æ„" class="headerlink" title="å»ºç«‹çŸ¥è¯†æ¶æ„"></a>å»ºç«‹çŸ¥è¯†æ¶æ„</h4><ul>
<li>å­¦ä¹ çš„è¿‡ç¨‹å®é™…ä¸Šå°±æ˜¯çŸ¥è¯†æ¶æ„ä¸æ–­è¿›åŒ–çš„è¿‡ç¨‹</li>
<li>é€šè¿‡çŸ¥è¯†æ¶æ„çš„è‡ªç„¶å»¶ä¼¸ï¼Œæˆ‘ä»¬å¯ä»¥æ›´è½»æ¾åœ°è®°å¿†ä¸€äº›åŸæœ¬éš¾ä»¥è®°ä½çš„ç‚¹ï¼Œè¿˜å¯ä»¥å‘ç°è¢«å¿½è§†çš„çŸ¥è¯†ç›²ç‚¹</li>
<li>å»ºç«‹çŸ¥è¯†æ¶æ„åŒæ ·åˆ©äºé¢è¯•</li>
</ul>
<h4 id="è¿½æœ¬æº¯æº"><a href="#è¿½æœ¬æº¯æº" class="headerlink" title="è¿½æœ¬æº¯æº"></a>è¿½æœ¬æº¯æº</h4><ul>
<li>æœ‰ä¸€äº›çŸ¥è¯†ï¼ŒèƒŒåæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ä½“ç³»</li>
<li>å…³æ³¨æŠ€æœ¯æå‡ºæ¥çš„èƒŒæ™¯ï¼Œæ‰¾åˆ°çŸ¥è¯†çš„æºå¤´</li>
<li>å…³æ³¨åŸå§‹çš„è®ºæ–‡æˆ–è€…æ–‡ç« ï¼Œå…³æ³¨ä½œè€…è¯´çš„è¯</li>
</ul>
<p>æ¯”å¦‚ å…³æ³¨ schemeï¼ŒJava ä¸ JS è¯­è¨€çš„å¼‚åŒ</p>
<h2 id="å‰ç«¯çŸ¥è¯†å›¾è°±"><a href="#å‰ç«¯çŸ¥è¯†å›¾è°±" class="headerlink" title="å‰ç«¯çŸ¥è¯†å›¾è°±"></a>å‰ç«¯çŸ¥è¯†å›¾è°±</h2><h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><p>ç”¨ä¸€å®šçš„è¯æ³•å’Œè¯­æ³•ï¼Œè¡¨è¾¾ä¸€å®šè¯­ä¹‰ï¼Œä»è€Œæ“ä½œè¿è¡Œæ—¶</p>
<p>æ‰€ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†</p>
<ul>
<li>è¿è¡Œæ—¶</li>
<li>æ–‡æ³•</li>
<li>è¯­ä¹‰</li>
</ul>
<p><img src="http://cdn.anruence.com/js%E5%9B%BE.png" alt="image"></p>
<h3 id="HTML-å’Œ-CSS"><a href="#HTML-å’Œ-CSS" class="headerlink" title="HTML å’Œ CSS"></a>HTML å’Œ CSS</h3><p>HTML çš„åŠŸèƒ½ä¸»è¦ç”±æ ‡ç­¾æ¥æ‰¿æ‹…ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆä¼šæŠŠæ ‡ç­¾åšä¸€äº›åˆ†ç±»</p>
<ul>
<li>æ–‡æ¡£å…ƒä¿¡æ¯ï¼šé€šå¸¸æ˜¯å‡ºç°åœ¨ head æ ‡ç­¾ä¸­çš„å…ƒç´ ï¼ŒåŒ…å«äº†æè¿°æ–‡æ¡£è‡ªèº«çš„ä¸€äº›ä¿¡æ¯ï¼›</li>
<li>è¯­ä¹‰ç›¸å…³ï¼šæ‰©å±•äº†çº¯æ–‡æœ¬ï¼Œè¡¨è¾¾æ–‡ç« ç»“æ„ã€ä¸åŒè¯­è¨€è¦ç´ çš„æ ‡ç­¾ï¼›</li>
<li>é“¾æ¥ï¼šæä¾›åˆ°æ–‡æ¡£å†…å’Œæ–‡æ¡£å¤–çš„é“¾æ¥ï¼›</li>
<li>æ›¿æ¢å‹æ ‡ç­¾ï¼šå¼•å…¥å£°éŸ³ã€å›¾ç‰‡ã€è§†é¢‘ç­‰å¤–éƒ¨å…ƒç´ æ›¿æ¢è‡ªèº«çš„ä¸€ç±»æ ‡ç­¾ï¼›</li>
<li>è¡¨å•ï¼šç”¨äºå¡«å†™å’Œæäº¤ä¿¡æ¯çš„ä¸€ç±»æ ‡ç­¾</li>
<li>è¡¨æ ¼ï¼šè¡¨å¤´ã€è¡¨å°¾ã€å•å…ƒæ ¼ç­‰è¡¨æ ¼çš„ç»“æ„</li>
</ul>
<p><img src="http://cdn.anruence.com/html%E5%9B%BE.png" alt="image"></p>
<h3 id="æµè§ˆå™¨çš„å®ç°åŸç†å’Œ-API"><a href="#æµè§ˆå™¨çš„å®ç°åŸç†å’Œ-API" class="headerlink" title="æµè§ˆå™¨çš„å®ç°åŸç†å’Œ API"></a>æµè§ˆå™¨çš„å®ç°åŸç†å’Œ API</h3><p><img src="http://cdn.anruence.com/liulanqi.png" alt="image"></p>
<h3 id="å‰ç«¯å·¥ç¨‹å®è·µ"><a href="#å‰ç«¯å·¥ç¨‹å®è·µ" class="headerlink" title="å‰ç«¯å·¥ç¨‹å®è·µ"></a>å‰ç«¯å·¥ç¨‹å®è·µ</h3><p><img src="http://cdn.anruence.com/qianduangongcheng.jpg" alt="image"></p>
<h3 id="å‰ç«¯çŸ¥è¯†æ¶æ„"><a href="#å‰ç«¯çŸ¥è¯†æ¶æ„" class="headerlink" title="å‰ç«¯çŸ¥è¯†æ¶æ„"></a>å‰ç«¯çŸ¥è¯†æ¶æ„</h3><p><img src="http://cdn.anruence.com/qiandaunzhishikuangjia.png" alt="image"></p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å»ºç«‹ä¸€ä¸ªç†è§£å‰ç«¯çš„å…¨æ™¯å›¾<br>è¿™æ ·ï¼Œä»»ä½•æ—¶å€™éƒ½èƒ½å¤Ÿä½“ç³»åœ°æ€è€ƒé—®é¢˜ï¼Œåˆ†æé—®é¢˜ï¼Œè§£å†³é—®é¢˜ï¼</p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å‰ç«¯ä½“ç³»</tag>
      </tags>
  </entry>
</search>
